# 股票指标数据功能说明

## 功能概述

股票指标数据功能是本项目的核心功能之一，用于计算和展示股票的各种技术指标。该功能通过Web界面展示个股的详细技术指标信息，帮助投资者进行技术分析。

## 功能实现流程

### 1. 数据获取流程
1. 用户在Web界面点击"股票指标数据"菜单项
2. 系统调用`/instock/data/indicators`接口
3. 通过`dataIndicatorsHandler.GetDataIndicatorsHandler`处理请求
4. 调用`stockfetch.fetch_stock_hist`获取历史行情数据
5. 使用`kline.visualization.get_plot_kline`生成可视化图表
6. 返回`stock_indicators.html`模板渲染结果

### 2. 指标计算流程
1. 每日通过`indicators_data_daily_job.py`计算所有股票的指标
2. 调用`calculate_indicator.get_indicators`计算具体指标值
3. 将结果存储到`cn_stock_indicators`数据表中

### 3. Web展示流程
1. 用户访问具体股票的指标页面
2. 系统查询`cn_stock_indicators`表获取数据
3. 使用Bokeh库生成交互式图表
4. 在前端页面展示各项指标的可视化结果

## 关联项目文件

### 核心文件
- `instock/web/dataIndicatorsHandler.py` - Web请求处理
- `instock/core/indicator/calculate_indicator.py` - 指标计算核心逻辑
- `instock/core/kline/visualization.py` - 图表可视化
- `instock/job/indicators_data_daily_job.py` - 每日指标计算任务
- `instock/core/tablestructure.py` - 数据表结构定义

### Web文件
- `instock/web/templates/stock_indicators.html` - 指标展示页面模板
- `instock/web/static/` - 前端静态资源

## 数据表结构

### cn_stock_indicators表
存储所有股票的指标计算结果，包含以下主要字段：
- 基础字段：date(日期)、code(代码)、name(名称)、open(开盘价)、high(最高价)、low(最低价)、close(收盘价)等
- MACD指标：macd(dif)、macds(macd)、macdh(histogram)
- KDJ指标：kdjk、kdjd、kdjj
- BOLL指标：boll_ub(上轨)、boll、boll_lb(下轨)
- RSI指标：rsi_6、rsi_12、rsi、rsi_24
- 其他技术指标：cr、wr、cci、atr、dma、obv、sar、psy、br、ar、mfi、vwma、ppo、wt、supertrend等

## 指标计算方法详解

参见单独的指标计算方法文档。