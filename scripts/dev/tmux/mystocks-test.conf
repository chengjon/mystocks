# MyStocks è‡ªåŠ¨åŒ–æµ‹è¯• tmux ä¼šè¯é…ç½®æ–‡ä»¶
# ç”¨æ³•: tmux source-file /opt/claude/mystocks_spec/scripts/tmux/mystocks-test.conf
# è¯´æ˜: åˆ›å»ºæµ‹è¯•ä¸“ç”¨ä¼šè¯ï¼ŒåŒ…å«æœåŠ¡ç®¡ç†ã€æµ‹è¯•æ‰§è¡Œã€æ—¥å¿—ç›‘æ§ä¸‰ä¸ªçª—æ ¼

# åˆ›å»ºæ–°çš„æµ‹è¯•ä¼šè¯
new-session -d -s mystocks-test

# è®¾ç½®ä¼šè¯é€‰é¡¹
set-option -g status on
set-option -g status-bg black
set-option -g status-fg green
set-option -g status-left ' MyStocks Test '
set-option -g status-right ' %Y-%m-%d %H:%M:%S '

# çª—æ ¼1: æœåŠ¡ç®¡ç†åŒº (å·¦ä¾§ï¼Œå æ¯”40%)
select-pane -t 0
split-window -h -p 60
send-keys -t 0 'cd /opt/claude/mystocks_spec' C-m
send-keys -t 0 'echo "ğŸ”§ MyStocks æœåŠ¡ç®¡ç†é¢æ¿"' C-m
send-keys -t 0 'echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"' C-m
send-keys -t 0 'echo "1. æŸ¥çœ‹PM2è¿›ç¨‹çŠ¶æ€: pm2 status"' C-m
send-keys -t 0 'echo "2. å¯åŠ¨æœåŠ¡: pm2 start mystocks.config.js"' C-m
send-keys -t 0 'echo "3. åœæ­¢æœåŠ¡: pm2 stop all"' C-m
send-keys -t 0 'echo "4. æŸ¥çœ‹æœåŠ¡æ—¥å¿—: pm2 logs"' C-m
send-keys -t 0 'echo "5. é‡å¯æœåŠ¡: pm2 restart all"' C-m
send-keys -t 0 'echo ""' C-m

# çª—æ ¼2: æµ‹è¯•æ‰§è¡ŒåŒº (å³ä¸Šï¼Œå æ¯”30%)
select-pane -t 1
split-window -v -p 50
send-keys -t 1 'cd /opt/claude/mystocks_spec/tests' C-m
send-keys -t 1 'echo "ğŸ§ª MyStocks æµ‹è¯•æ‰§è¡Œé¢æ¿"' C-m
send-keys -t 1 'echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"' C-m
send-keys -t 1 'echo "å¯ç”¨æµ‹è¯•å‘½ä»¤:"' C-m
send-keys -t 1 'echo "- å…¨é‡æµ‹è¯•: npx playwright test"' C-m
send-keys -t 1 'echo "- ç”¨æˆ·è®¤è¯: npx playwright test tests/e2e/login.spec.js"' C-m
send-keys -t 1 'echo "- APIæµ‹è¯•: npx playwright test tests/e2e/api-endpoints.spec.js"' C-m
send-keys -t 1 'echo "- ç”ŸæˆæŠ¥å‘Š: npx playwright show-report"' C-m
send-keys -t 1 'echo ""' C-m

# çª—æ ¼3: æ—¥å¿—ç›‘æ§åŒº (å³ä¸‹ï¼Œå æ¯”30%)
select-pane -t 2
send-keys -t 2 'cd /opt/claude/mystocks_spec' C-m
send-keys -t 2 'echo "ğŸ“Š MyStocks æ—¥å¿—ç›‘æ§é¢æ¿ (lnav)"' C-m
send-keys -t 2 'echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"' C-m
send-keys -t 2 'echo "å¯åŠ¨æ—¥å¿—ç›‘æ§å‘½ä»¤:"' C-m
send-keys -t 2 'echo "lnav logs/*.log tests/logs/*.log"' C-m
send-keys -t 2 'echo ""' C-m
send-keys -t 2 'echo "æ—¥å¿—æ–‡ä»¶ä½ç½®:"' C-m
send-keys -t 2 'echo "- æœåŠ¡æ—¥å¿—: logs/access.log, logs/error.log"' C-m
send-keys -t 2 'echo "- æµ‹è¯•æ—¥å¿—: tests/logs/playwright-*.log"' C-m
send-keys -t 2 'echo "- å‰ç«¯æ—¥å¿—: web/frontend/logs/*.log"' C-m
send-keys -t 2 'echo "- åç«¯æ—¥å¿—: web/backend/logs/*.log"' C-m
send-keys -t 2 'echo ""' C-m

# çª—æ ¼4: æ•°æ®åº“è¿æ¥ç›‘æ§ (æ–°å¢çª—æ ¼)
select-pane -t 2
split-window -v -p 33
send-keys -t 3 'cd /opt/claude/mystocks_spec' C-m
send-keys -t 3 'echo "ğŸ—„ï¸ MyStocks æ•°æ®åº“ç›‘æ§é¢æ¿"' C-m
send-keys -t 3 'echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"' C-m
send-keys -t 3 'echo "æ•°æ®åº“è¿æ¥æ£€æŸ¥:"' C-m
send-keys -t 3 'echo "- PostgreSQL: curl -s http://localhost:8000/api/system/database/health"' C-m
send-keys -t 3 'echo "- TDengine: curl -s http://localhost:8000/api/cache/monitoring/health"' C-m
send-keys -t 3 'echo "- ç¼“å­˜çŠ¶æ€: curl -s http://localhost:8000/api/cache/status"' C-m
send-keys -t 3 'echo ""' C-m

# é€‰æ‹©æœåŠ¡ç®¡ç†çª—æ ¼ä½œä¸ºé»˜è®¤çª—æ ¼
select-pane -t 0

# è®¾ç½®çª—æ ¼æ ‡é¢˜
set-window-option -g window-status-current-format ' #[fg=white,bg=blue] #I #W #[fg=blue,bg=default]#[default] '
rename-window -t 0 "ServiceManager"
rename-window -t 1 "TestExecutor"
rename-window -t 2 "LogMonitor"
rename-window -t 3 "DatabaseMonitor"

# æ˜¾ç¤ºä¼šè¯ä¿¡æ¯
display-message "âœ… MyStocks æµ‹è¯•ç¯å¢ƒå·²å‡†å¤‡å®Œæˆ"
display-message "ğŸ“ çª—æ ¼è¯´æ˜: [0]æœåŠ¡ç®¡ç† [1]æµ‹è¯•æ‰§è¡Œ [2]æ—¥å¿—ç›‘æ§ [3]æ•°æ®åº“ç›‘æ§"
display-message "ğŸš€ å¿«é€Ÿå¼€å§‹: çª—æ ¼0æ‰§è¡Œ 'pm2 start mystocks.config.js' å¯åŠ¨æœåŠ¡"
