# MyStocks å‹æµ‹æŒ‡å— (Load Testing Guide)

**ä»»åŠ¡**: Task 14.1 - Locustå‹æµ‹è„šæœ¬å’Œç”¨æˆ·è¡Œä¸ºå»ºæ¨¡
**çŠ¶æ€**: âœ… å®Œæˆ
**æ—¥æœŸ**: 2025-11-12

---

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†MyStocksç³»ç»Ÿçš„å®Œæ•´å‹æµ‹å¥—ä»¶ï¼ŒåŒ…æ‹¬ï¼š
- **Locustå‹æµ‹è„šæœ¬**: `load_test_locustfile.py` - 1000+å¹¶å‘ç”¨æˆ·æ¨¡æ‹Ÿ
- **ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡**: `load_test_user_behaviors.py` - 5ç§ç”¨æˆ·è§’è‰²å’Œè¡Œä¸ºæ¨¡å¼
- **å‹æµ‹åœºæ™¯å®šä¹‰**: `load_test_scenarios.py` - 4ç§å‹æµ‹åœºæ™¯

---

## ğŸ¯ ç›®æ ‡

é€šè¿‡å‹æµ‹éªŒè¯ç³»ç»Ÿçš„ä»¥ä¸‹æ€§èƒ½æŒ‡æ ‡ï¼š

| æŒ‡æ ‡ | ç›®æ ‡ | å¤‡æ³¨ |
|------|------|------|
| å¹¶å‘ç”¨æˆ·æ•° | 1000+ | æ¨¡æ‹Ÿæ—¥å¸¸å’Œé«˜å³°æµé‡ |
| å“åº”æ—¶é—´ P95 | < 1000ms | 95%è¯·æ±‚å“åº”æ—¶é—´ |
| å“åº”æ—¶é—´ P99 | < 2000ms | 99%è¯·æ±‚å“åº”æ—¶é—´ |
| é”™è¯¯ç‡ | < 1% | å®¹é”™èƒ½åŠ›éªŒè¯ |
| ååé‡ | > 500 req/s | å¹¶å‘å¤„ç†èƒ½åŠ› |
| ç¼“å­˜å‘½ä¸­ç‡ | > 70% | ç¼“å­˜ç­–ç•¥éªŒè¯ |
| æ•°æ®åº“è¿æ¥ | 60-100 | è¿æ¥æ± ä¼˜åŒ– |
| WebSocketè¿æ¥ | > 500 | å®æ—¶è¡Œæƒ…æ”¯æŒ |

---

## ğŸ“¦ æ–‡ä»¶ç»“æ„

```
scripts/tests/
â”œâ”€â”€ load_test_locustfile.py           # Locustä¸»è„šæœ¬ï¼ˆç›´æ¥è¿è¡Œï¼‰
â”œâ”€â”€ load_test_user_behaviors.py       # ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡åº“
â”œâ”€â”€ load_test_scenarios.py            # å‹æµ‹åœºæ™¯å®šä¹‰å’Œæ‰§è¡Œ
â”œâ”€â”€ LOAD_TESTING_GUIDE.md            # æœ¬æ–‡ä»¶
â””â”€â”€ load_test_reports/               # å‹æµ‹æŠ¥å‘Šç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
    â”œâ”€â”€ scenario_1_config.json       # åœºæ™¯1é…ç½®
    â”œâ”€â”€ scenario_2_config.json       # åœºæ™¯2é…ç½®
    â”œâ”€â”€ scenario_3_config.json       # åœºæ™¯3é…ç½®
    â”œâ”€â”€ scenario_4_config.json       # åœºæ™¯4é…ç½®
    â”œâ”€â”€ load_test_plan.json          # å®Œæ•´æµ‹è¯•è®¡åˆ’
    â””â”€â”€ load_test_scenarios.md       # åœºæ™¯è¯¦ç»†è¯´æ˜
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…Locust
pip install locust>=2.20.0

# æˆ–æ›´æ–°æ‰€æœ‰ä¾èµ–
pip install -r requirements.txt
```

### 2. ç”Ÿæˆå‹æµ‹é…ç½®

```bash
# ç”Ÿæˆæ‰€æœ‰åœºæ™¯çš„é…ç½®æ–‡ä»¶å’Œæµ‹è¯•è®¡åˆ’
cd /opt/claude/mystocks_spec
python scripts/tests/load_test_scenarios.py
```

è¾“å‡ºï¼š
```
âœ“ Generated: ./load_test_reports/scenario_1_config.json
âœ“ Generated: ./load_test_reports/scenario_2_config.json
âœ“ Generated: ./load_test_reports/scenario_3_config.json
âœ“ Generated: ./load_test_reports/scenario_4_config.json
âœ“ Generated: ./load_test_reports/load_test_plan.json
âœ“ Generated: ./load_test_reports/load_test_scenarios.md
```

### 3. è¿è¡Œå‹æµ‹

```bash
# åŸºæœ¬ç”¨æ³•ï¼šè¿è¡ŒLocust Web UI
cd /opt/claude/mystocks_spec
locust -f scripts/tests/load_test_locustfile.py --host=http://localhost:8000

# ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€: http://localhost:8089
# é…ç½®ç”¨æˆ·æ•°å’Œspawn_rateï¼Œç‚¹å‡»"Start swarming"
```

### 4. å‘½ä»¤è¡Œæ¨¡å¼ï¼ˆè‡ªåŠ¨åŒ–ï¼‰

```bash
# è¿è¡ŒåŸºå‡†æµ‹è¯•ï¼ˆ100ç”¨æˆ·ï¼Œ5åˆ†é’Ÿï¼‰
locust -f scripts/tests/load_test_locustfile.py \
  --headless \
  --users=100 \
  --spawn-rate=10 \
  --run-time=300s \
  --host=http://localhost:8000

# è¿è¡Œé«˜å³°è´Ÿè½½æµ‹è¯•ï¼ˆ1000ç”¨æˆ·ï¼Œ10åˆ†é’Ÿï¼‰
locust -f scripts/tests/load_test_locustfile.py \
  --headless \
  --users=1000 \
  --spawn-rate=50 \
  --run-time=600s \
  --host=http://localhost:8000 \
  --csv=load_test_reports/peak_load_results

# è¿è¡Œå‹åŠ›æµ‹è¯•ï¼ˆ2000ç”¨æˆ·ï¼Œ15åˆ†é’Ÿï¼‰
locust -f scripts/tests/load_test_locustfile.py \
  --headless \
  --users=2000 \
  --spawn-rate=100 \
  --run-time=900s \
  --host=http://localhost:8000 \
  --csv=load_test_reports/stress_test_results
```

---

## ğŸ“Š å‹æµ‹åœºæ™¯è¯¦è§£

### åœºæ™¯1: åŸºå‡†æµ‹è¯• (Baseline)

**ç›®çš„**: éªŒè¯åŸºç¡€APIæ€§èƒ½
**ç”¨æˆ·æ•°**: 100
**æŒç»­æ—¶é—´**: 5åˆ†é’Ÿ
**å¢é•¿é€Ÿç‡**: æ¯ç§’10ä¸ªç”¨æˆ·

**ç›®æ ‡**:
- âœ“ å“åº”æ—¶é—´ < 500ms (P95)
- âœ“ é”™è¯¯ç‡ < 1%
- âœ“ æ•°æ®åº“è¿æ¥ 20-30

**é€‚ç”¨åœºæ™¯**: å¼€å‘ç¯å¢ƒéªŒè¯ã€CI/CDæµç¨‹ä¸­çš„åŸºç¡€æ€§èƒ½æ£€æŸ¥

```bash
locust -f scripts/tests/load_test_locustfile.py \
  --headless --users=100 --spawn-rate=10 --run-time=300s \
  --host=http://localhost:8000 \
  --csv=load_test_reports/baseline_results
```

---

### åœºæ™¯2: æ­£å¸¸è´Ÿè½½ (Normal Load)

**ç›®çš„**: æ¨¡æ‹Ÿæ—¥å¸¸äº¤æ˜“æ—¶æ®µ
**ç”¨æˆ·æ•°**: 500
**æŒç»­æ—¶é—´**: 10åˆ†é’Ÿ
**å¢é•¿é€Ÿç‡**: æ¯ç§’25ä¸ªç”¨æˆ·

**ç”¨æˆ·åˆ†å¸ƒ**:
- æ—¥å†…äº¤æ˜“è€…: 150ä¸ª (30%)
- æ³¢æ®µäº¤æ˜“è€…: 125ä¸ª (25%)
- é•¿æœŸæŠ•èµ„è€…: 200ä¸ª (40%)
- åˆ†æå¸ˆ: 75ä¸ª (15%)
- ç›‘æ§: 25ä¸ª (5%)

**ç›®æ ‡**:
- âœ“ å“åº”æ—¶é—´ < 1s (P95)
- âœ“ é”™è¯¯ç‡ < 0.5%
- âœ“ ç¼“å­˜å‘½ä¸­ç‡ > 70%
- âœ“ æ•°æ®åº“è¿æ¥ 30-50

**é€‚ç”¨åœºæ™¯**: æ—¥å¸¸æ€§èƒ½éªŒè¯ã€è´Ÿè½½å‡è¡¡å™¨æµ‹è¯•

```bash
locust -f scripts/tests/load_test_locustfile.py \
  --headless --users=500 --spawn-rate=25 --run-time=600s \
  --host=http://localhost:8000 \
  --csv=load_test_reports/normal_load_results
```

---

### åœºæ™¯3: é«˜å³°è´Ÿè½½ (Peak Load)

**ç›®çš„**: æ¨¡æ‹Ÿå¼€ç›˜/æ”¶ç›˜é«˜å³°
**ç”¨æˆ·æ•°**: 1000
**æŒç»­æ—¶é—´**: 10åˆ†é’Ÿ
**å¢é•¿é€Ÿç‡**: æ¯ç§’50ä¸ªç”¨æˆ·

**ç”¨æˆ·åˆ†å¸ƒ**:
- æ—¥å†…äº¤æ˜“è€…: 150ä¸ª - é«˜é¢‘æŸ¥è¯¢ (2 req/s)
- æ³¢æ®µäº¤æ˜“è€…: 250ä¸ª - ä¸­é¢‘æŸ¥è¯¢ (0.8 req/s)
- é•¿æœŸæŠ•èµ„è€…: 400ä¸ª - ä½é¢‘æŸ¥è¯¢ (0.2 req/s)
- åˆ†æå¸ˆ: 150ä¸ª - åˆ†ææŸ¥è¯¢ (1.5 req/s)
- ç›‘æ§: 50ä¸ª - å¥åº·æ£€æŸ¥ (0.1 req/s)

**ç›®æ ‡**:
- âœ“ å“åº”æ—¶é—´ < 2s (P95)
- âœ“ é”™è¯¯ç‡ < 1%
- âœ“ WebSocketè¿æ¥ > 500
- âœ“ æ•°æ®åº“è¿æ¥ 60-100

**å‹åŠ›ç‚¹**:
- å¸‚åœºå¼€ç›˜ (9:30)
- åˆä¼‘æ—¶æ®µ (11:30-13:00)
- å¸‚åœºæ”¶ç›˜ (15:00)
- ç›˜åæ—¶æ®µ (18:00)

**é€‚ç”¨åœºæ™¯**: ç”Ÿäº§ç¯å¢ƒéªŒè¯ã€æ•…éšœæ¢å¤æµ‹è¯•

```bash
locust -f scripts/tests/load_test_locustfile.py \
  --headless --users=1000 --spawn-rate=50 --run-time=600s \
  --host=http://localhost:8000 \
  --csv=load_test_reports/peak_load_results
```

---

### åœºæ™¯4: å‹åŠ›æµ‹è¯• (Stress Test)

**ç›®çš„**: æµ‹è¯•ç³»ç»Ÿæé™
**ç”¨æˆ·æ•°**: 2000
**æŒç»­æ—¶é—´**: 15åˆ†é’Ÿ
**å¢é•¿é€Ÿç‡**: æ¯ç§’100ä¸ªç”¨æˆ·

**æµ‹è¯•é˜¶æ®µ**:
1. **Ramp-up** (200s): 0 â†’ 2000ç”¨æˆ·çº¿æ€§å¢åŠ 
2. **Sustained** (600s): ä¿æŒ2000ç”¨æˆ·
3. **Breakdown** (100s): ä¼˜é›…æ–­å¼€è¿æ¥

**ç›‘æ§é¡¹**:
- CPUä½¿ç”¨ç‡
- å†…å­˜æ¶ˆè€—
- ç½‘ç»œå¸¦å®½
- ç£ç›˜I/O
- æ•°æ®åº“è¿æ¥æ± 
- WebSocketè¿æ¥æ•°
- è¯·æ±‚é˜Ÿåˆ—æ·±åº¦

**å‘Šè­¦é˜ˆå€¼**:
- âš ï¸ é”™è¯¯ç‡ > 5%
- âš ï¸ å“åº”æ—¶é—´ P95 > 5s
- ğŸ”´ æ•°æ®åº“è¿æ¥æ±  > 90%åˆ©ç”¨ç‡
- ğŸ”´ WebSocketè¿æ¥å¤±è´¥ > 1%

**é€‚ç”¨åœºæ™¯**: å®¹é‡è§„åˆ’ã€ç³»ç»Ÿé™åˆ¶è¯†åˆ«ã€æ•…éšœæ³¨å…¥æµ‹è¯•

```bash
locust -f scripts/tests/load_test_locustfile.py \
  --headless --users=2000 --spawn-rate=100 --run-time=900s \
  --host=http://localhost:8000 \
  --csv=load_test_reports/stress_test_results
```

---

## ğŸ‘¥ ç”¨æˆ·è¡Œä¸ºæ¨¡å‹

### 5ç§ç”¨æˆ·è§’è‰²

#### 1. æ—¥å†…äº¤æ˜“è€… (Day Trader) - 15%
- **ä¼šè¯æ—¶é•¿**: 8å°æ—¶ (äº¤æ˜“æ—¶é—´)
- **è¯·æ±‚é¢‘ç‡**: 2.0 req/s (æœ€é«˜)
- **è‡ªé€‰è‚¡**: 20ä¸ª
- **æŸ¥è¯¢æ¯”ä¾‹**:
  - å®æ—¶è¡Œæƒ…: 40% (æœ€é¢‘ç¹)
  - Kçº¿æ•°æ®: 30%
  - èµ„é‡‘æµå‘: 15%
  - æœç´¢: 10%
  - è‡ªé€‰è‚¡ç®¡ç†: 5%
- **å…¸å‹æ“ä½œ**: å¿«é€ŸæŸ¥è¯¢å¤šåªè‚¡ç¥¨è¡Œæƒ…ï¼Œåˆ¤æ–­ä¹°å–ç‚¹

#### 2. æ³¢æ®µäº¤æ˜“è€… (Swing Trader) - 25%
- **ä¼šè¯æ—¶é•¿**: 2å°æ—¶
- **è¯·æ±‚é¢‘ç‡**: 0.8 req/s
- **è‡ªé€‰è‚¡**: 30ä¸ª
- **æŸ¥è¯¢æ¯”ä¾‹**:
  - Kçº¿æ•°æ®: 35%
  - èµ„é‡‘æµå‘: 25%
  - å®æ—¶è¡Œæƒ…: 20%
  - è¡Œä¸šåˆ†æ: 15%
  - è‡ªé€‰è‚¡ç®¡ç†: 5%
- **å…¸å‹æ“ä½œ**: åˆ†æå¤šå‘¨æœŸKçº¿ï¼Œç ”ç©¶è¡Œä¸šæµå‘

#### 3. é•¿æœŸæŠ•èµ„è€… (Investor) - 40%
- **ä¼šè¯æ—¶é•¿**: 30åˆ†é’Ÿ
- **è¯·æ±‚é¢‘ç‡**: 0.2 req/s (æœ€ä½)
- **è‡ªé€‰è‚¡**: 50ä¸ª
- **æŸ¥è¯¢æ¯”ä¾‹**:
  - å¸‚åœºæ¦‚è§ˆ: 30%
  - æœç´¢: 30%
  - è‡ªé€‰è‚¡ç®¡ç†: 20%
  - å®æ—¶è¡Œæƒ…: 15%
  - å†å²Kçº¿: 5%
- **å…¸å‹æ“ä½œ**: æµè§ˆå¸‚åœºæ¦‚å†µï¼Œç®¡ç†æŠ•èµ„ç»„åˆ

#### 4. åˆ†æå¸ˆ (Analyst) - 15%
- **ä¼šè¯æ—¶é•¿**: 4å°æ—¶
- **è¯·æ±‚é¢‘ç‡**: 1.5 req/s
- **è‡ªé€‰è‚¡**: 100ä¸ª
- **æŸ¥è¯¢æ¯”ä¾‹**:
  - è¡Œä¸šåˆ†æ: 25%
  - èµ„é‡‘æµå‘: 25%
  - å¤šå‘¨æœŸKçº¿: 20%
  - å‘Šè­¦å†å²: 20% (Task 15)
  - æœåŠ¡å¥åº·åº¦: 10%
- **å…¸å‹æ“ä½œ**: æ·±åº¦æ•°æ®åˆ†æï¼Œæ’°å†™ç ”ç©¶æŠ¥å‘Š

#### 5. ç›‘æ§ç”¨æˆ· (Monitoring) - 5%
- **ä¼šè¯æ—¶é•¿**: 24å°æ—¶ (åå°)
- **è¯·æ±‚é¢‘ç‡**: 0.1 req/s (å¾ˆä½)
- **è‡ªé€‰è‚¡**: 0ä¸ª
- **æŸ¥è¯¢æ¯”ä¾‹**:
  - å¥åº·æ£€æŸ¥: 40%
  - å‘Šè­¦å†å²: 40%
  - æœåŠ¡å¥åº·åº¦: 20%
- **å…¸å‹æ“ä½œ**: ç³»ç»Ÿå¥åº·ç›‘æ§ï¼Œå‘Šè­¦å“åº”

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡è§£è¯»

### å“åº”æ—¶é—´åˆ†å¸ƒ

```
P50 (ä¸­ä½æ•°)   : 50%çš„è¯·æ±‚åœ¨æ­¤æ—¶é—´ä»¥ä¸‹ (ç›®æ ‡: < 200ms)
P95 (ç™¾åˆ†ä½)   : 95%çš„è¯·æ±‚åœ¨æ­¤æ—¶é—´ä»¥ä¸‹ (ç›®æ ‡: < 1000ms)
P99 (ç™¾åˆ†ä½)   : 99%çš„è¯·æ±‚åœ¨æ­¤æ—¶é—´ä»¥ä¸‹ (ç›®æ ‡: < 2000ms)
```

### é”™è¯¯ç‡

```
< 0.1%: ä¼˜ç§€
0.1-0.5%: è‰¯å¥½
0.5-1%: å¯æ¥å—
> 1%: éœ€è¦ä¼˜åŒ–
```

### ååé‡ (RPS - Requests Per Second)

```
åœºæ™¯1 (100ç”¨æˆ·): é¢„æœŸ 100-200 RPS
åœºæ™¯2 (500ç”¨æˆ·): é¢„æœŸ 200-400 RPS
åœºæ™¯3 (1000ç”¨æˆ·): é¢„æœŸ 400-700 RPS
åœºæ™¯4 (2000ç”¨æˆ·): é¢„æœŸ ç³»ç»Ÿæé™ï¼Œå¯èƒ½å‡ºç°é™çº§
```

---

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å‘ç°çš„é—®é¢˜åœºæ™¯

å¦‚æœåœ¨å‹æµ‹ä¸­å‘ç°ä»¥ä¸‹é—®é¢˜ï¼Œå»ºè®®ä¼˜åŒ–æ–¹å‘ï¼š

#### å“åº”æ—¶é—´è¿‡é•¿ (P95 > 2000ms)
- [ ] æ£€æŸ¥æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½ (Task 14.3)
- [ ] å¢åŠ ç¼“å­˜å‘½ä¸­ç‡ (æŸ¥çœ‹ç¼“å­˜ç­–ç•¥)
- [ ] ä¼˜åŒ–APIç«¯ç‚¹é€»è¾‘
- [ ] æ£€æŸ¥ç½‘ç»œå»¶è¿Ÿ

#### é”™è¯¯ç‡å‡é«˜ (> 1%)
- [ ] æ£€æŸ¥æ•°æ®åº“è¿æ¥æ± æ˜¯å¦è€—å°½
- [ ] æ£€æŸ¥å†…å­˜å ç”¨æ˜¯å¦è¿‡é«˜
- [ ] æ£€æŸ¥ç£ç›˜ç©ºé—´
- [ ] æŸ¥çœ‹åº”ç”¨æ—¥å¿—ä¸­çš„é”™è¯¯

#### WebSocketè¿æ¥å¤±è´¥
- [ ] è°ƒæ•´WebSocketè¿æ¥æ± å¤§å°
- [ ] ä¼˜åŒ–æ¶ˆæ¯æ‰¹å¤„ç†
- [ ] å¢åŠ æœåŠ¡å™¨èµ„æº

---

## ğŸ“Š ç”Ÿæˆå‹æµ‹æŠ¥å‘Š

### CSVæ ¼å¼çš„ç»“æœæ–‡ä»¶

Locustä¼šç”ŸæˆCSVæ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹æ•°æ®ï¼š

```csv
Type,Name,requests,failures,median,average,min,max,Average Size,Requests/s,Failures/s
GET,/api/market/realtime/[stock_code],10000,50,250,300,50,2000,1024,50.0,0.25
POST,/api/auth/login,500,5,100,150,50,500,512,2.5,0.025
...
```

### åˆ†æCSVæŠ¥å‘Š

```bash
# æŸ¥çœ‹æŠ¥å‘Š
cat load_test_reports/peak_load_results_stats.csv

# ä½¿ç”¨Pythonåˆ†æ
python << 'EOF'
import pandas as pd

df = pd.read_csv('load_test_reports/peak_load_results_stats.csv')

# ç»Ÿè®¡æ±‡æ€»
print("Total Requests:", df['requests'].sum())
print("Total Failures:", df['failures'].sum())
print("Success Rate:", 1 - df['failures'].sum() / df['requests'].sum())
print("\nSlowest Endpoints:")
print(df.nlargest(5, 'average')[['Name', 'average']])

print("\nEndpoints with Most Failures:")
print(df[df['failures'] > 0].nlargest(5, 'failures')[['Name', 'failures']])
EOF
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: å‹æµ‹æ—¶å‡ºç°è¿æ¥é”™è¯¯

**ç—‡çŠ¶**: `Connection refused` æˆ– `Connection timeout`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥APIæœåŠ¡æ˜¯å¦è¿è¡Œ: `curl http://localhost:8000/health`
2. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
3. æ£€æŸ¥API_HOSTç¯å¢ƒå˜é‡è®¾ç½®
4. æ£€æŸ¥DNSè§£æ

```bash
# éªŒè¯æœåŠ¡è¿æ¥
curl -v http://localhost:8000/health
```

### Q2: å‹æµ‹è¿‡ç¨‹ä¸­å†…å­˜æŒç»­å¢é•¿

**ç—‡çŠ¶**: å†…å­˜å ç”¨ä¸æ–­ä¸Šå‡ï¼Œæœ€ç»ˆå¯¼è‡´ç³»ç»Ÿå´©æºƒ

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ˜¯å¦æœ‰å†…å­˜æ³„æ¼
2. å‡å°‘å¹¶å‘ç”¨æˆ·æ•°
3. å¢åŠ æµ‹è¯•é—´éš”
4. æ£€æŸ¥WebSocketè¿æ¥æ˜¯å¦æ­£ç¡®å…³é—­

### Q3: WebSocketè¿æ¥å¤±è´¥

**ç—‡çŠ¶**: WebSocketè¿æ¥å»ºç«‹å¤±è´¥æˆ–é¢‘ç¹æ–­å¼€

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥WebSocketç«¯å£æ˜¯å¦å¼€æ”¾
2. å¢åŠ WebSocketè¿æ¥è¶…æ—¶æ—¶é—´
3. æ£€æŸ¥åå‘ä»£ç†é…ç½® (nginx/haproxy)
4. è°ƒæ•´OSå±‚é¢çš„socketè¿æ¥é™åˆ¶

```bash
# æŸ¥çœ‹å½“å‰è¿æ¥é™åˆ¶
ulimit -n

# ä¸´æ—¶å¢åŠ é™åˆ¶ (éœ€è¦root)
ulimit -n 65536
```

### Q4: æ•°æ®åº“è¿æ¥æ± è€—å°½

**ç—‡çŠ¶**: `æ— å¯ç”¨è¿æ¥æ± ` æˆ– `è¿æ¥è¶…æ—¶`

**è§£å†³æ–¹æ¡ˆ**:
1. å¢åŠ è¿æ¥æ± å¤§å° (Task 14.3)
2. ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ—¶é—´
3. å®æ–½è¿æ¥å¤ç”¨ç­–ç•¥
4. æ·»åŠ è¿æ¥ç­‰å¾…è¶…æ—¶

---

## ğŸ“ ä¸‹ä¸€æ­¥å·¥ä½œ

åœ¨Task 14.1å®Œæˆåï¼Œå»ºè®®è¿›è¡Œï¼š

### Task 14.2: WebSocketæ€§èƒ½ä¼˜åŒ–
- [ ] è¿æ¥æ± ç®¡ç†
- [ ] æ¶ˆæ¯æ‰¹å¤„ç†
- [ ] å†…å­˜ä¼˜åŒ–

### Task 14.3: æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–
- [ ] è¿æ¥æ± è°ƒä¼˜
- [ ] æŸ¥è¯¢æ‰¹å¤„ç†
- [ ] ç¼“å­˜ç­–ç•¥ä¼˜åŒ–

### Task 14.4: å‹æµ‹æŠ¥å‘Šåˆ†æ
- [ ] æ€§èƒ½æŒ‡æ ‡åˆ†æ
- [ ] ç“¶é¢ˆè¯†åˆ«
- [ ] ä¼˜åŒ–å»ºè®®

---

## ğŸ“š å‚è€ƒèµ„æº

- **Locustå®˜æ–¹æ–‡æ¡£**: https://docs.locust.io/
- **Performance Testing Best Practices**: https://github.com/locustio/locust
- **MyStocks APIæ–‡æ¡£**: `/docs/api/README.md`
- **å‘Šè­¦å‡çº§æœºåˆ¶**: `/docs/api/TASK_15_COMPLETION_SUMMARY.md`

---

## âœ… æ¸…å•

### ä»»åŠ¡14.1å®Œæˆé¡¹

- [x] Locustä¸»è„šæœ¬ (`load_test_locustfile.py`) - 650+è¡Œ
  - [x] HTTPç”¨æˆ·è¡Œä¸º (StockBehaviors)
  - [x] WebSocketç”¨æˆ·è¡Œä¸º (WebSocketBehaviors)
  - [x] æƒé‡åˆ†å¸ƒ (40ç§APIç«¯ç‚¹)
  - [x] äº‹ä»¶ç›‘å¬å’Œæ—¥å¿—

- [x] ç”¨æˆ·è¡Œä¸ºå»ºæ¨¡ (`load_test_user_behaviors.py`) - 450+è¡Œ
  - [x] 5ç§ç”¨æˆ·è§’è‰²å®šä¹‰
  - [x] ç”¨æˆ·è¡Œä¸ºå·¥å‚ (UserBehaviorFactory)
  - [x] è¯·æ±‚åºåˆ—ç”Ÿæˆ (RequestSequenceGenerator)
  - [x] æµé‡æ¨¡å‹ç”Ÿæˆ (TrafficModelGenerator)
  - [x] æ€§èƒ½æŒ‡æ ‡æ”¶é›† (LoadTestMetrics)

- [x] å‹æµ‹åœºæ™¯å®šä¹‰ (`load_test_scenarios.py`) - 400+è¡Œ
  - [x] 4ç§å‹æµ‹åœºæ™¯
  - [x] åœºæ™¯é…ç½®ç”Ÿæˆ
  - [x] JSONé…ç½®è¾“å‡º
  - [x] Markdownæ–‡æ¡£è¾“å‡º

- [x] å®Œæ•´æ–‡æ¡£ (LOAD_TESTING_GUIDE.md) - æœ¬æ–‡ä»¶
  - [x] å¿«é€Ÿå¼€å§‹æŒ‡å—
  - [x] è¯¦ç»†åœºæ™¯è¯´æ˜
  - [x] æ€§èƒ½ä¼˜åŒ–å»ºè®®
  - [x] å¸¸è§é—®é¢˜è§£ç­”

### éªŒè¯æ­¥éª¤

```bash
# 1. éªŒè¯Pythonè„šæœ¬è¯­æ³•
python -m py_compile scripts/tests/load_test_locustfile.py
python -m py_compile scripts/tests/load_test_user_behaviors.py
python -m py_compile scripts/tests/load_test_scenarios.py

# 2. ç”Ÿæˆæ‰€æœ‰é…ç½®æ–‡ä»¶
python scripts/tests/load_test_scenarios.py

# 3. åˆ—å‡ºç”Ÿæˆçš„æ–‡ä»¶
ls -lah load_test_reports/

# 4. å¯åŠ¨Locustè¿›è¡Œæµ‹è¯• (å¯é€‰)
locust -f scripts/tests/load_test_locustfile.py --host=http://localhost:8000
```

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- é¡¹ç›®Issue: https://github.com/your-project/issues
- æŠ€æœ¯æ–‡æ¡£: `/docs/api/`
- ä»»åŠ¡è¯¦æƒ…: `.taskmaster/tasks/task-14.md`

---

**Task 14.1 Status**: âœ… COMPLETE
**Created**: 2025-11-12
**Last Updated**: 2025-11-12
