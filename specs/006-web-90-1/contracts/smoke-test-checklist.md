# çƒŸé›¾æµ‹è¯•æ¸…å• (Smoke Test Checklist)

**ç‰ˆæœ¬**: 1.0
**æ—¥æœŸ**: 2025-10-29
**ç›®çš„**: éƒ¨ç½²å‰å…³é”®åŠŸèƒ½å¿«é€ŸéªŒè¯
**æ‰§è¡Œæ—¶é—´**: 5-10 åˆ†é’Ÿ

---

## ğŸ“‹ ä»€ä¹ˆæ˜¯çƒŸé›¾æµ‹è¯•ï¼Ÿ

çƒŸé›¾æµ‹è¯•æ˜¯ä¸€ç»„å…³é”®çš„ã€å¿«é€Ÿçš„æµ‹è¯•ï¼Œç”¨äºéªŒè¯ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚è¿™äº›æµ‹è¯•åº”è¯¥åœ¨æ¯æ¬¡éƒ¨ç½²å‰è¿è¡Œï¼Œä»¥ç¡®ä¿åŸºæœ¬åŠŸèƒ½æ²¡æœ‰è¢«ç ´åã€‚

**ç‰¹ç‚¹**:
- âš¡ å¿«é€Ÿæ‰§è¡Œ (5-10 åˆ†é’Ÿ)
- ğŸ¯ è¦†ç›–å…³é”®è·¯å¾„
- ğŸš« å‘ç°ä¸¥é‡é—®é¢˜ç«‹å³åœæ­¢éƒ¨ç½²
- âœ… æ‰€æœ‰æµ‹è¯•å¿…é¡»é€šè¿‡æ‰èƒ½éƒ¨ç½²

---

## ğŸ¯ 7 é¡¹å…³é”®çƒŸé›¾æµ‹è¯•

### 1. ç³»ç»Ÿå¥åº·æ£€æŸ¥ (System Health Check)

**ç›®æ ‡**: éªŒè¯æ‰€æœ‰æœåŠ¡æ­£å¸¸å¯åŠ¨

**æµ‹è¯•æ­¥éª¤**:
```bash
# åç«¯å¥åº·æ£€æŸ¥
curl -f http://localhost:8000/health
# é¢„æœŸ: {"status":"healthy"}

# å‰ç«¯å¯è®¿é—®
curl -f http://localhost:5173
# é¢„æœŸ: HTTP 200

# æ•°æ®åº“è¿æ¥
PGPASSWORD=mystocks2025 psql -h localhost -U mystocks_user -d mystocks -c "SELECT 1;"
# é¢„æœŸ: è¿”å› 1
```

**é€šè¿‡æ ‡å‡†**:
- [ ] åç«¯å¥åº·æ£€æŸ¥è¿”å› `{"status":"healthy"}`
- [ ] å‰ç«¯é¡µé¢å¯è®¿é—® (HTTP 200)
- [ ] æ•°æ®åº“è¿æ¥æˆåŠŸ

**å¤±è´¥å¤„ç†**: å¦‚æœä»»ä½•ä¸€é¡¹å¤±è´¥ï¼Œ**åœæ­¢éƒ¨ç½²**ï¼Œæ£€æŸ¥æœåŠ¡é…ç½®

---

### 2. æ•°æ®åº“è¿æ¥æµ‹è¯• (Database Connectivity)

**ç›®æ ‡**: éªŒè¯æ•°æ®åº“å¯è¿æ¥ä¸”æœ‰æ•°æ®

**æµ‹è¯•æ­¥éª¤**:
```bash
# PostgreSQL è¿æ¥
source scripts/bash_aliases.sh
mt-db -c "SELECT COUNT(*) FROM cn_stock_top;"
# é¢„æœŸ: > 0

# æ£€æŸ¥æœ€æ–°æ•°æ®
mt-db -c "SELECT MAX(trade_date) FROM cn_stock_top;"
# é¢„æœŸ: æœ€è¿‘æ—¥æœŸï¼ˆä¸è¶…è¿‡2å¤©å‰ï¼‰
```

**é€šè¿‡æ ‡å‡†**:
- [ ] PostgreSQL è¿æ¥æˆåŠŸ
- [ ] æ ¸å¿ƒè¡¨æœ‰æ•°æ® (COUNT > 0)
- [ ] æ•°æ®æ—¶æ•ˆæ€§åˆæ ¼ (ä¸è¶…è¿‡2å¤©å‰)

**å¤±è´¥å¤„ç†**:
- å¦‚æœæ— æ•°æ®ï¼Œè¿è¡Œæ•°æ®é‡‡é›†: `python run_realtime_market_saver.py`
- å¦‚æœæ•°æ®è¿‡æœŸï¼Œæ£€æŸ¥å®šæ—¶ä»»åŠ¡

---

### 3. ç”¨æˆ·ç™»å½•æµç¨‹ (User Login Flow)

**ç›®æ ‡**: éªŒè¯ç”¨æˆ·å¯ä»¥æˆåŠŸç™»å½•

**æµ‹è¯•æ­¥éª¤**:
```bash
# æ–¹æ³• 1: ä½¿ç”¨ httpie
http POST http://localhost:8000/api/auth/login \
  username=admin password=admin123

# é¢„æœŸå“åº”:
{
  "access_token": "eyJ...",
  "token_type": "bearer"
}

# æ–¹æ³• 2: ä½¿ç”¨å¿«æ·å‘½ä»¤
TOKEN=$(mt-token)
echo "Token: $TOKEN"
```

**é€šè¿‡æ ‡å‡†**:
- [ ] ç™»å½• API è¿”å› HTTP 200
- [ ] å“åº”åŒ…å« `access_token` å­—æ®µ
- [ ] Token ä¸ä¸ºç©º

**å¤±è´¥å¤„ç†**: æ£€æŸ¥ç”¨æˆ·æ•°æ®åº“è¡¨å’Œè®¤è¯é…ç½®

---

### 4. ä»ªè¡¨ç›˜åŠ è½½æµ‹è¯• (Dashboard Loads)

**ç›®æ ‡**: éªŒè¯ä»ªè¡¨ç›˜é¡µé¢æ­£å¸¸åŠ è½½

**æµ‹è¯•æ­¥éª¤**:
```bash
# è·å– token
TOKEN=$(mt-token)

# æµ‹è¯•ä»ªè¡¨ç›˜æ±‡æ€» API
http GET http://localhost:8000/api/data/dashboard/summary \
  Authorization:"Bearer $TOKEN"

# é¢„æœŸ: HTTP 200 ä¸”æœ‰æ•°æ®
```

**æ‰‹åŠ¨éªŒè¯**:
1. æ‰“å¼€æµè§ˆå™¨: `http://localhost:5173/dashboard`
2. æ£€æŸ¥é¡µé¢æ­£å¸¸æ˜¾ç¤º
3. æ£€æŸ¥ 4 ä¸ªç»Ÿè®¡å¡ç‰‡æ˜¾ç¤ºæ•°æ®
4. æ£€æŸ¥ Console æ— é”™è¯¯ (F12)

**é€šè¿‡æ ‡å‡†**:
- [ ] API è¿”å› HTTP 200
- [ ] å“åº”æ•°æ®ä¸ä¸ºç©º
- [ ] æµè§ˆå™¨é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] Console æ—  JavaScript é”™è¯¯

**å¤±è´¥å¤„ç†**: æŒ‰ 5 å±‚éªŒè¯æ³•è¯Šæ–­ï¼ˆLayer 5 â†’ 2 â†’ 4ï¼‰

---

### 5. å…³é”® API ç«¯ç‚¹æµ‹è¯• (Critical APIs)

**ç›®æ ‡**: éªŒè¯æ ¸å¿ƒ API ç«¯ç‚¹æ­£å¸¸å·¥ä½œ

**æµ‹è¯• API åˆ—è¡¨**:

#### 5.1 é¾™è™æ¦œ API
```bash
TOKEN=$(mt-token)
http GET "http://localhost:8000/api/market/v3/dragon-tiger?limit=5" \
  Authorization:"Bearer $TOKEN"
```
- [ ] HTTP 200
- [ ] è¿”å› 5 æ¡æ•°æ®
- [ ] æ•°æ®ç»“æ„æ­£ç¡®

#### 5.2 èµ„é‡‘æµå‘ API
```bash
http GET "http://localhost:8000/api/market/v3/fund-flow?limit=5" \
  Authorization:"Bearer $TOKEN"
```
- [ ] HTTP 200
- [ ] è¿”å›æ•°æ®
- [ ] å“åº”æ—¶é—´ < 2 ç§’

#### 5.3 ETF æ•°æ® API
```bash
http GET "http://localhost:8000/api/market/v3/etf-data?limit=5" \
  Authorization:"Bearer $TOKEN"
```
- [ ] HTTP 200
- [ ] è¿”å›æ•°æ®

**é€šè¿‡æ ‡å‡†**: æ‰€æœ‰ 3 ä¸ª API éƒ½è¿”å› HTTP 200 ä¸”æœ‰æ•°æ®

**å¤±è´¥å¤„ç†**:
- æ£€æŸ¥ Layer 5 (æ•°æ®åº“æœ‰å¯¹åº”è¡¨çš„æ•°æ®)
- æ£€æŸ¥ Layer 2 (API è·¯ç”±å’Œé€»è¾‘)

---

### 6. å‰ç«¯èµ„æºåŠ è½½ (Frontend Assets)

**ç›®æ ‡**: éªŒè¯å‰ç«¯é™æ€èµ„æºæ­£å¸¸åŠ è½½

**æµ‹è¯•æ­¥éª¤**:
1. æ‰“å¼€æµè§ˆå™¨: `http://localhost:5173`
2. æ‰“å¼€ DevTools (F12) â†’ Network æ ‡ç­¾
3. åˆ·æ–°é¡µé¢
4. æ£€æŸ¥æ‰€æœ‰èµ„æºåŠ è½½çŠ¶æ€

**é€šè¿‡æ ‡å‡†**:
- [ ] æ‰€æœ‰ JS æ–‡ä»¶åŠ è½½æˆåŠŸ (HTTP 200)
- [ ] æ‰€æœ‰ CSS æ–‡ä»¶åŠ è½½æˆåŠŸ (HTTP 200)
- [ ] æ—  404 é”™è¯¯
- [ ] é¡µé¢æ¸²æŸ“å®Œæˆ

**å¤±è´¥å¤„ç†**:
- æ£€æŸ¥å‰ç«¯æ„å»º: `cd web/frontend && npm run build`
- æ£€æŸ¥é™æ€èµ„æºè·¯å¾„é…ç½®

---

### 7. æ•°æ®è¡¨æ ¼æ¸²æŸ“æµ‹è¯• (Data Table Rendering)

**ç›®æ ‡**: éªŒè¯è‡³å°‘ä¸€ä¸ªæ•°æ®è¡¨æ ¼æ­£å¸¸æ¸²æŸ“

**æµ‹è¯•æ­¥éª¤**:
1. æ‰“å¼€æµè§ˆå™¨: `http://localhost:5173/dragon-tiger`
2. ç­‰å¾…é¡µé¢åŠ è½½
3. æ£€æŸ¥è¡¨æ ¼æ˜¾ç¤º

**é€šè¿‡æ ‡å‡†**:
- [ ] è¡¨æ ¼ç»„ä»¶æ¸²æŸ“
- [ ] è¡¨æ ¼æœ‰æ•°æ®è¡Œ (è‡³å°‘ 1 è¡Œ)
- [ ] æ•°æ®æ ¼å¼æ­£ç¡® (æ—¥æœŸã€æ•°å­—ç­‰)
- [ ] è¡¨æ ¼äº¤äº’æ­£å¸¸ (æ’åºã€åˆ†é¡µç­‰)

**æ‰‹åŠ¨æ£€æŸ¥é¡¹**:
- è¡¨å¤´æ˜¾ç¤ºæ­£ç¡®
- æ•°æ®è¡Œæ˜¾ç¤ºå®Œæ•´
- æ—  "æš‚æ— æ•°æ®" æç¤º
- æ»šåŠ¨å’Œäº¤äº’æ­£å¸¸

**å¤±è´¥å¤„ç†**:
1. æ£€æŸ¥ Console é”™è¯¯
2. æ£€æŸ¥ Network ä¸­ API è¯·æ±‚
3. éªŒè¯ Layer 5 (æ•°æ®åº“) â†’ Layer 2 (API) â†’ Layer 4 (UI)

---

## ğŸš€ å¿«é€Ÿæ‰§è¡Œè„šæœ¬

### è‡ªåŠ¨åŒ–çƒŸé›¾æµ‹è¯•è„šæœ¬

```bash
#!/bin/bash
# è¿è¡Œæ‰€æœ‰çƒŸé›¾æµ‹è¯•

echo "=== è¿è¡ŒçƒŸé›¾æµ‹è¯• ==="

# æµ‹è¯• 1: ç³»ç»Ÿå¥åº·
echo "1. ç³»ç»Ÿå¥åº·æ£€æŸ¥..."
curl -f http://localhost:8000/health || exit 1

# æµ‹è¯• 2: æ•°æ®åº“è¿æ¥
echo "2. æ•°æ®åº“è¿æ¥æµ‹è¯•..."
source scripts/bash_aliases.sh
mt-db -c "SELECT COUNT(*) FROM cn_stock_top;" || exit 1

# æµ‹è¯• 3: ç™»å½•
echo "3. ç”¨æˆ·ç™»å½•æµ‹è¯•..."
TOKEN=$(mt-token) || exit 1

# æµ‹è¯• 4: ä»ªè¡¨ç›˜
echo "4. ä»ªè¡¨ç›˜ API æµ‹è¯•..."
http GET http://localhost:8000/api/data/dashboard/summary \
  Authorization:"Bearer $TOKEN" || exit 1

# æµ‹è¯• 5: å…³é”® API
echo "5. å…³é”® API æµ‹è¯•..."
http GET "http://localhost:8000/api/market/v3/dragon-tiger?limit=5" \
  Authorization:"Bearer $TOKEN" || exit 1

echo "=== æ‰€æœ‰çƒŸé›¾æµ‹è¯•é€šè¿‡ âœ“ ==="
```

**ä¿å­˜ä¸º**: `scripts/smoke_test.sh`

**ä½¿ç”¨æ–¹æ³•**:
```bash
chmod +x scripts/smoke_test.sh
./scripts/smoke_test.sh
```

---

## ğŸ“Š çƒŸé›¾æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```markdown
# çƒŸé›¾æµ‹è¯•æŠ¥å‘Š

**æ—¥æœŸ**: YYYY-MM-DD HH:mm
**ç‰ˆæœ¬**: v1.x.x
**ç¯å¢ƒ**: Production/Staging/Development
**æ‰§è¡Œäºº**: å§“å

## æµ‹è¯•ç»“æœ

| # | æµ‹è¯•é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|---|--------|------|------|
| 1 | ç³»ç»Ÿå¥åº·æ£€æŸ¥ | âœ… PASS | - |
| 2 | æ•°æ®åº“è¿æ¥ | âœ… PASS | - |
| 3 | ç”¨æˆ·ç™»å½• | âœ… PASS | - |
| 4 | ä»ªè¡¨ç›˜åŠ è½½ | âœ… PASS | - |
| 5 | å…³é”® API | âœ… PASS | - |
| 6 | å‰ç«¯èµ„æº | âœ… PASS | - |
| 7 | æ•°æ®è¡¨æ ¼ | âœ… PASS | - |

## æ€»ç»“

- æ€»æµ‹è¯•æ•°: 7
- é€šè¿‡: 7
- å¤±è´¥: 0
- æ‰§è¡Œæ—¶é—´: 8 åˆ†é’Ÿ

**éƒ¨ç½²å†³å®š**: âœ… æ‰¹å‡†éƒ¨ç½² / âŒ é˜»æ­¢éƒ¨ç½²

**ç­¾å­—**: __________
```

---

## ğŸ¯ é€šè¿‡æ ‡å‡†

### å…¨éƒ¨é€šè¿‡
âœ… **æ‰€æœ‰ 7 é¡¹æµ‹è¯•é€šè¿‡** â†’ æ‰¹å‡†éƒ¨ç½²

### éƒ¨åˆ†å¤±è´¥
âŒ **ä»»ä½•ä¸€é¡¹æµ‹è¯•å¤±è´¥** â†’ é˜»æ­¢éƒ¨ç½²

**ä¾‹å¤–æƒ…å†µ**:
- æµ‹è¯• 6 (å‰ç«¯èµ„æº) å¯ä»¥åœ¨ç¡®è®¤ä¸å½±å“åŠŸèƒ½çš„æƒ…å†µä¸‹æ”¾è¡Œ
- å…¶ä»– 6 é¡¹æµ‹è¯•å¿…é¡»å…¨éƒ¨é€šè¿‡

---

## ğŸ”„ æ‰§è¡Œé¢‘ç‡

### å¿…é¡»æ‰§è¡ŒçƒŸé›¾æµ‹è¯•çš„æ—¶æœº

1. **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰** (å¿…é¡»)
2. **æ¯æ—¥æ„å»ºå** (æ¨è)
3. **é‡å¤§åŠŸèƒ½åˆå¹¶å** (æ¨è)
4. **æ•°æ®åº“è¿ç§»å** (å¿…é¡»)
5. **é…ç½®å˜æ›´å** (æ¨è)

### æ‰§è¡Œæµç¨‹

```
ä»£ç æäº¤ â†’ å•å…ƒæµ‹è¯• â†’ é›†æˆæµ‹è¯• â†’ çƒŸé›¾æµ‹è¯• â†’ éƒ¨ç½²
                â†“          â†“          â†“
              é€šè¿‡       é€šè¿‡    é€šè¿‡/å¤±è´¥
                                    â†“
                              å¤±è´¥ â†’ å›æ»š
```

---

## ğŸ“ æ£€æŸ¥æ¸…å• (Checklist)

### éƒ¨ç½²å‰ç¡®è®¤

- [ ] å·²é˜…è¯»æœ¬çƒŸé›¾æµ‹è¯•æ¸…å•
- [ ] æ‰€æœ‰æœåŠ¡å·²å¯åŠ¨ (backend, frontend, database)
- [ ] å·²å‡†å¤‡å¥½è®¿é—® token
- [ ] æµè§ˆå™¨ DevTools å·²æ‰“å¼€
- [ ] çƒŸé›¾æµ‹è¯•è„šæœ¬å·²å‡†å¤‡å¥½

### æ‰§è¡Œè¿‡ç¨‹

- [ ] æµ‹è¯• 1: ç³»ç»Ÿå¥åº·æ£€æŸ¥ - é€šè¿‡
- [ ] æµ‹è¯• 2: æ•°æ®åº“è¿æ¥ - é€šè¿‡
- [ ] æµ‹è¯• 3: ç”¨æˆ·ç™»å½• - é€šè¿‡
- [ ] æµ‹è¯• 4: ä»ªè¡¨ç›˜åŠ è½½ - é€šè¿‡
- [ ] æµ‹è¯• 5: å…³é”® API - é€šè¿‡
- [ ] æµ‹è¯• 6: å‰ç«¯èµ„æº - é€šè¿‡
- [ ] æµ‹è¯• 7: æ•°æ®è¡¨æ ¼ - é€šè¿‡

### éƒ¨ç½²å†³å®š

- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æµ‹è¯•æŠ¥å‘Šå·²å¡«å†™
- [ ] éƒ¨ç½²å®¡æ‰¹å·²è·å¾—
- [ ] **å‡†å¤‡éƒ¨ç½²**

---

## ğŸ†˜ æ•…éšœæ’æŸ¥

### å¦‚æœçƒŸé›¾æµ‹è¯•å¤±è´¥

1. **ä¸è¦éƒ¨ç½²** - ç«‹å³åœæ­¢éƒ¨ç½²æµç¨‹
2. **è®°å½•å¤±è´¥** - è®°å½•å¤±è´¥çš„æµ‹è¯•é¡¹å’Œé”™è¯¯ä¿¡æ¯
3. **å¿«é€Ÿè¯Šæ–­** - ä½¿ç”¨ 5 å±‚éªŒè¯æ³•å®šä½é—®é¢˜
4. **ä¿®å¤é—®é¢˜** - ä¿®å¤åé‡æ–°è¿è¡ŒçƒŸé›¾æµ‹è¯•
5. **å†æ¬¡éªŒè¯** - ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

### å¸¸è§å¤±è´¥åœºæ™¯

**åœºæ™¯ 1: æ•°æ®åº“è¿æ¥å¤±è´¥**
- æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€
- éªŒè¯è¿æ¥é…ç½® (.env)
- æ£€æŸ¥ç½‘ç»œè¿é€šæ€§

**åœºæ™¯ 2: API è¿”å› 500**
- æŸ¥çœ‹åç«¯æ—¥å¿—: `tail -f /tmp/uvicorn.log`
- éªŒè¯æ•°æ®åº“æœ‰æ•°æ®
- æ£€æŸ¥ API è·¯ç”±é…ç½®

**åœºæ™¯ 3: å‰ç«¯é¡µé¢ç©ºç™½**
- æ£€æŸ¥ Console é”™è¯¯
- éªŒè¯å‰ç«¯æ„å»º
- æ£€æŸ¥ API è¯·æ±‚çŠ¶æ€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´éªŒè¯æµç¨‹](../../docs/development-process/definition-of-done.md)
- [æ•…éšœæ’æŸ¥æŒ‡å—](../../docs/development-process/troubleshooting.md)
- [API éªŒè¯æŒ‡å—](./api-verification-guide.md)
- [æ‰‹åŠ¨éªŒè¯æŒ‡å—](../../docs/development-process/manual-verification-guide.md)

---

**ç‰ˆæœ¬å†å²**:
- v1.0 (2025-10-29): åˆå§‹ç‰ˆæœ¬ï¼Œå®šä¹‰ 7 é¡¹å…³é”®çƒŸé›¾æµ‹è¯•

---

**è®°ä½**: çƒŸé›¾æµ‹è¯•æ˜¯éƒ¨ç½²çš„æœ€åä¸€é“é˜²çº¿ã€‚æ‰€æœ‰æµ‹è¯•å¿…é¡»é€šè¿‡æ‰èƒ½éƒ¨ç½²ï¼
