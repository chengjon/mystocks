# ğŸš€ å¿«é€Ÿè§£å†³æ–¹æ¡ˆ - ç®€åŒ–ç‰ˆå®æ—¶æ•°æ®ä¿å­˜å™¨

## âŒ é‡åˆ°çš„é—®é¢˜

æ‚¨è¿è¡ŒåŸç‰ˆç¨‹åºæ—¶é‡åˆ°çš„é”™è¯¯ï¼š
1. **TDengineé©±åŠ¨ç¼ºå¤±**: `name 'taos' is not defined`
2. **PostgreSQLæ•°æ®åº“ä¸å­˜åœ¨**: `database "quant_research" does not exist`
3. **å¤æ‚çš„æ•°æ®åº“ä¾èµ–**: éœ€è¦é…ç½®å¤šä¸ªæ•°æ®åº“

## âœ… ç®€åŒ–è§£å†³æ–¹æ¡ˆ

æˆ‘åˆ›å»ºäº†ä¸€ä¸ª**ç®€åŒ–ç‰ˆ**ï¼Œä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½ï¼š
- âœ… è·å–æ²ªæ·±Aè‚¡å®æ—¶æ•°æ®ï¼ˆä½¿ç”¨efinanceï¼‰
- âœ… ä¿å­˜åˆ°Redisçƒ­æ•°æ®å­˜å‚¨ï¼ˆå¯é€‰ï¼‰
- âœ… å¯¼å‡ºåˆ°CSVæ–‡ä»¶å¤‡ä»½ï¼ˆå…œåº•æ–¹æ¡ˆï¼‰
- âœ… æ”¯æŒå¼ºåˆ¶æ›´æ–°åŠŸèƒ½
- âŒ ç§»é™¤å¤æ‚çš„æ•°æ®åº“ä¾èµ–

## ğŸƒâ€â™‚ï¸ å¿«é€Ÿä½¿ç”¨

### 1. å®‰è£…ä¾èµ–
```bash
pip install efinance redis pandas python-dotenv
```

### 2. åŸºç¡€è¿è¡Œï¼ˆæ¨èï¼‰
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python db_manager/save_realtime_market_data_simple.py
```

### 3. å¼ºåˆ¶æ›´æ–°
```bash
python db_manager/save_realtime_market_data_simple.py --force-update
```

### 4. æŒ‡å®šå¸‚åœº
```bash
# æ²ªæ·±å¸‚åœº
python db_manager/save_realtime_market_data_simple.py --market hs

# ä¸Šæµ·å¸‚åœº
python db_manager/save_realtime_market_data_simple.py --market sh

# æ·±åœ³å¸‚åœº
python db_manager/save_realtime_market_data_simple.py --market sz
```

### 5. ä½¿ç”¨é…ç½®æ–‡ä»¶
```bash
python db_manager/save_realtime_market_data_simple.py --config db_manager/simple_config.env
```

## ğŸ“Š æ•°æ®å­˜å‚¨

### å­˜å‚¨ç­–ç•¥
```
efinance API â†’ ç®€åŒ–ç‰ˆä¿å­˜å™¨
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  åŒé‡å­˜å‚¨ç­–ç•¥  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Redis     â”‚    CSV      â”‚
        â”‚  (çƒ­æ•°æ®)    â”‚   (å¤‡ä»½)     â”‚
        â”‚  5åˆ†é’Ÿè¿‡æœŸ   â”‚   æ°¸ä¹…ä¿å­˜   â”‚
        â”‚  å¯é€‰é…ç½®    â”‚   å…œåº•æ–¹æ¡ˆ   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¦‚æœRedisä¸å¯ç”¨
- âœ… ç³»ç»Ÿä¼šè‡ªåŠ¨è·³è¿‡Rediså­˜å‚¨
- âœ… æ•°æ®ä»ä¼šä¿å­˜åˆ°CSVæ–‡ä»¶
- âœ… ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œä¸ä¼šæŠ¥é”™

## ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶

### CSVå¤‡ä»½æ–‡ä»¶
```
backup/
â”œâ”€â”€ realtime_market_hs_20250921_143022.csv
â”œâ”€â”€ realtime_market_hs_20250921_143522.csv
â””â”€â”€ ...
```

### Rediså­˜å‚¨é”®å
```
realtime_positions:hs:20250921_143022    # å¸¦æ—¶é—´æˆ³çš„æ•°æ®
realtime_positions:hs:latest             # æœ€æ–°æ•°æ®æŒ‡é’ˆ
```

## ğŸ”§ é…ç½®æ–‡ä»¶è¯´æ˜

### simple_config.env
```bash
# åŸºç¡€é…ç½®
MARKET_SYMBOL=hs          # å¸‚åœºä»£ç 
SAVE_TO_CSV=true          # CSVå¤‡ä»½å¼€å…³
CSV_BACKUP_DIR=./backup   # å¤‡ä»½ç›®å½•

# Redisé…ç½®ï¼ˆå¯é€‰ï¼‰
REDIS_HOST=localhost      # RedisæœåŠ¡å™¨
REDIS_PORT=6379          # Redisç«¯å£
CACHE_EXPIRE_SECONDS=300  # 5åˆ†é’Ÿè¿‡æœŸ
```

## ğŸ†š ä¸åŸç‰ˆå¯¹æ¯”

| åŠŸèƒ½ç‰¹æ€§ | åŸç‰ˆï¼ˆå¤æ‚ï¼‰ | ç®€åŒ–ç‰ˆ |
|---------|-------------|--------|
| **æ•°æ®è·å–** | âœ… efinance | âœ… efinance |
| **Rediså­˜å‚¨** | âœ… é€šè¿‡ç»Ÿä¸€æ¥å£ | âœ… ç›´æ¥è¿æ¥ |
| **CSVå¤‡ä»½** | âŒ æ—  | âœ… æœ‰ |
| **TDengineä¾èµ–** | âŒ å¿…éœ€ | âœ… æ— éœ€ |
| **PostgreSQLä¾èµ–** | âŒ å¿…éœ€ | âœ… æ— éœ€ |
| **MySQLä¾èµ–** | âŒ å¿…éœ€ | âœ… æ— éœ€ |
| **é…ç½®å¤æ‚åº¦** | âŒ é«˜ | âœ… ä½ |
| **è¿è¡ŒæˆåŠŸç‡** | âš ï¸ ä¾èµ–ç¯å¢ƒ | âœ… é«˜ |

## ğŸ¯ ä½¿ç”¨å»ºè®®

### ç«‹å³å¯ç”¨
```bash
# æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼
python db_manager/save_realtime_market_data_simple.py

# é¢„æœŸè¾“å‡ºï¼š
# âœ… æˆåŠŸè·å–å®æ—¶æ•°æ®ï¼Œå…± XXXX æ¡è®°å½•
# âœ… æ•°æ®å·²å¤‡ä»½åˆ°CSV: backup/realtime_market_hs_YYYYMMDD_HHMMSS.csv
# ğŸ‰ å®æ—¶æ•°æ®ä¿å­˜å®Œæˆï¼
```

### å¦‚æœéœ€è¦Redis
1. ç¡®ä¿RedisæœåŠ¡è¿è¡Œåœ¨localhost:6379
2. æˆ–ä¿®æ”¹simple_config.envä¸­çš„Redisé…ç½®

### å¦‚æœä¸éœ€è¦Redis
- ç¨‹åºä¼šè‡ªåŠ¨è·³è¿‡Redisï¼Œåªä¿å­˜CSV
- è¿™æ ·æ‚¨å°±æœ‰äº†å®Œæ•´çš„æ•°æ®å¤‡ä»½

## ğŸ”„ åç»­å‡çº§è·¯å¾„

å½“æ‚¨çš„ç¯å¢ƒå‡†å¤‡å¥½åï¼Œå¯ä»¥ï¼š
1. å®‰è£…å¹¶é…ç½®TDengineã€PostgreSQLç­‰æ•°æ®åº“
2. ä½¿ç”¨åŸç‰ˆçš„å¤æ‚ç³»ç»Ÿè·å¾—å®Œæ•´åŠŸèƒ½
3. ç®€åŒ–ç‰ˆçš„CSVæ–‡ä»¶å¯ä»¥å¯¼å…¥åˆ°ä»»ä½•æ•°æ®åº“

ç°åœ¨å…ˆç”¨ç®€åŒ–ç‰ˆè§£å†³æ‚¨çš„immediate needï¼