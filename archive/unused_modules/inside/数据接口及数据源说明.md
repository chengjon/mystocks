# 项目数据接口及数据源说明

## 1. 概述

本项目主要通过网络爬虫技术从多个数据源获取股票相关数据，包括实时行情、历史数据、资金流向、技术指标等。项目使用Python的requests库进行HTTP请求，并通过代理池管理来提高数据获取的稳定性和效率。

## 2. 主要数据源

### 2.1 东方财富网 (EastMoney)
- **网站地址**: https://www.eastmoney.com/
- **数据类型**: 
  - 股票实时行情数据
  - ETF基金数据
  - 股票资金流向数据
  - 行业/概念资金流向数据
  - 龙虎榜数据
  - 大宗交易数据
  - 分红配送数据
- **接口特点**: 
  - 提供丰富的API接口
  - 支持分页获取大量数据
  - 数据更新频率高
  - 包含详细的技术指标和财务数据

### 2.2 通达信 (TDX)
- **接口地址**: http://excalc.icfqs.com:7616/TQLEX
- **数据类型**: 
  - 竞价抢筹数据(早盘/尾盘)
- **接口特点**: 
  - 需要Token认证
  - 提供专业的股票分析数据
  - 数据实时性强

## 3. 核心数据接口

### 3.1 股票实时行情接口
- **文件**: `instock/core/crawling/stock_hist_em.py`
- **函数**: `stock_zh_a_spot_em()`
- **数据源**: 东方财富网
- **主要字段**: 
  - 代码、名称、最新价、涨跌幅、涨跌额
  - 成交量、成交额、振幅、换手率、量比
  - 开盘价、最高价、最低价、昨收价
  - 市盈率、市净率、每股收益、每股净资产
  - 总市值、流通市值等财务指标

### 3.2 股票历史K线数据接口
- **文件**: `instock/core/crawling/stock_hist_em.py`
- **函数**: `stock_zh_a_hist()`
- **数据源**: 东方财富网
- **支持周期**: 日线、周线、月线
- **复权类型**: 前复权、后复权、不复权
- **主要字段**: 日期、开盘价、收盘价、最高价、最低价、成交量、成交额、涨跌幅等

### 3.3 ETF基金数据接口
- **文件**: `instock/core/crawling/fund_etf_em.py`
- **函数**: `fund_etf_spot_em()`
- **数据源**: 东方财富网
- **主要字段**: 代码、名称、最新价、涨跌幅、成交量、成交额、开盘价、最高价、最低价、昨收价、换手率、总市值、流通市值

### 3.4 股票资金流向接口
- **文件**: `instock/core/crawling/stock_fund_em.py`
- **函数**: `stock_individual_fund_flow_rank()`
- **数据源**: 东方财富网
- **时间维度**: 今日、3日、5日、10日
- **主要字段**: 
  - 主力净流入(净额、净占比)
  - 超大单净流入(净额、净占比)
  - 大单净流入(净额、净占比)
  - 中单净流入(净额、净占比)
  - 小单净流入(净额、净占比)

### 3.5 行业/概念资金流向接口
- **文件**: `instock/core/crawling/stock_fund_em.py`
- **函数**: `stock_sector_fund_flow_rank()`
- **数据源**: 东方财富网
- **分类维度**: 行业资金流、概念资金流、地域资金流
- **时间维度**: 今日、5日、10日

### 3.6 竞价抢筹数据接口
- **文件**: `instock/core/crawling/stock_chip_race.py`
- **函数**: 
  - `stock_chip_race_open()` (早盘抢筹)
  - `stock_chip_race_end()` (尾盘抢筹)
- **数据源**: 通达信
- **主要字段**: 
  - 代码、名称、最新价、涨跌幅
  - 昨收价、今开价
  - 开盘金额/收盘金额
  - 抢筹幅度、抢筹委托金额、抢筹成交金额
  - 抢筹占比

### 3.7 龙虎榜数据接口
- **文件**: `instock/core/crawling/stock_lhb_em.py`
- **数据源**: 东方财富网
- **主要功能**: 
  - 龙虎榜个股统计
  - 机构席位追踪
  - 营业部排行
  - 交易员统计

### 3.8 大宗交易数据接口
- **文件**: `instock/core/crawling/stock_dzjy_em.py`
- **数据源**: 东方财富网
- **主要功能**: 
  - 大宗交易市场统计
  - 大宗交易每日明细
  - 大宗交易活跃营业部统计
  - 大宗交易营业部排行

## 4. 技术实现细节

### 4.1 请求库
- 使用Python的`requests`库进行HTTP请求
- 支持GET和POST请求方式

### 4.2 代理管理
- 通过`instock/core/singleton_proxy.py`中的`proxys`单例类管理代理
- 在请求时通过`proxies = proxys().get_proxies()`获取代理配置

### 4.3 数据处理
- 使用`pandas`库进行数据处理和分析
- 数据类型转换确保数值计算准确性
- 支持分页获取大量数据

### 4.4 缓存机制
- 使用`@lru_cache()`装饰器对部分函数结果进行缓存
- 提高重复请求的响应速度

## 5. 数据更新机制

### 5.1 定时任务
- 通过`instock/job/`目录下的各类定时任务脚本实现数据自动更新
- 包括每日基本数据、指标数据、策略数据等的自动计算和存储

### 5.2 更新频率
- 实时行情数据: 每个交易日开盘期间持续更新
- 历史数据: 每日收盘后更新
- 资金流向数据: 每日更新
- 策略数据: 每日计算更新

## 6. 注意事项

1. 使用第三方数据接口时需遵守相关网站的使用条款
2. 注意控制请求频率，避免对服务器造成过大压力
3. 做好异常处理和数据缓存机制，提高系统稳定性
4. 定期检查接口可用性，及时调整数据源