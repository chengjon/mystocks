@router.get("/{symbol}/signals", response_model=Dict)
async def get_trading_signals(symbol: str, period: str = Query("daily", description="æ•°æ®å‘¨æœŸ")):
    """
    è·å–äº¤æ˜“ä¿¡å·

    åŸºäºæŠ€æœ¯æŒ‡æ ‡ç”Ÿæˆä¹°å…¥/å–å‡º/æŒæœ‰ä¿¡å·

    ä¿¡å·ç±»å‹:
    - macd_golden_cross: MACDé‡‘å‰ (ä¹°å…¥ä¿¡å·)
    - macd_death_cross: MACDæ­»å‰ (å–å‡ºä¿¡å·)
    - rsi_oversold: RSIè¶…å– (ä¹°å…¥ä¿¡å·)
    - rsi_overbought: RSIè¶…ä¹° (å–å‡ºä¿¡å·)

    **éªŒè¯**: P0æ”¹è¿› Task 2 - ä½¿ç”¨StockSymbolModeléªŒè¯è‚¡ç¥¨ä»£ç 

    ç¤ºä¾‹:
    - GET /api/technical/600519/signals
    """
    print(f"\n{'='*60}")
    print(f"ğŸš€ SIGNALS ENDPOINT CALLED: symbol={symbol}, period={period}")
    print(f"{'='*60}\n")
    
    try:
        # Step 1: Validate symbol
        print("ğŸ“ Step 1: Validating symbol...")
        try:
            validated_symbol = StockSymbolModel(symbol=symbol)
            print(f"âœ“ Symbol validated: {validated_symbol.symbol}")
        except ValidationError as ve:
            print(f"âŒ Symbol validation failed: {ve}")
            error_details = [{"field": str(err["loc"][0]), "message": err["msg"]} for err in ve.errors()]
            return create_error_response(
                error_code="VALIDATION_ERROR", message="è‚¡ç¥¨ä»£ç éªŒè¯å¤±è´¥", details=error_details
            )

        # Step 2: Get data source
        print("ğŸ“ Step 2: Getting data source from factory...")
        try:
            data_source_factory = DataSourceFactory()
            technical_analysis_adapter = await data_source_factory.get_data_source("technical_analysis")
            print(f"âœ“ Got adapter: {type(technical_analysis_adapter)}")
        except Exception as e:
            print(f"âŒ Failed to get data source: {e}")
            import traceback
            traceback.print_exc()
            raise HTTPException(status_code=500, detail=f"è·å–æ•°æ®æºå¤±è´¥: {str(e)}")

        # Step 3: Call get_data
        print("ğŸ“ Step 3: Calling get_data...")
        params = {"symbol": validated_symbol.symbol, "period": period}
        try:
            result = await technical_analysis_adapter.get_data("signals", params)
            print(f"âœ“ Got result: type={type(result)}, keys={result.keys()}")
            print(f"  Result: {result}")
        except Exception as e:
            print(f"âŒ get_data failed: {e}")
            import traceback
            traceback.print_exc()
            raise HTTPException(status_code=500, detail=f"è·å–æ•°æ®å¤±è´¥: {str(e)}")

        # Step 4: Check result
        print("ğŸ“ Step 4: Checking result...")
        if "error" in result:
            print(f"âŒ Result contains error: {result['error']}")
            raise HTTPException(
                status_code=500,
                detail=create_error_response(ErrorCodes.EXTERNAL_SERVICE_ERROR, result["error"]).model_dump(),
            )

        signals_data = result.get("data", {})
        print(f"âœ“ Got signals_data: type={type(signals_data)}, data={signals_data}")

        # Step 5: Create response
        print("ğŸ“ Step 5: Creating response...")
        response_data = {"symbol": validated_symbol.symbol, "signals": signals_data, "period": period}
        print(f"  Response data: {response_data}")

        # Step 6: Test JSON serialization
        print("ğŸ“ Step 6: Testing JSON serialization...")
        import json
        try:
            json_str = json.dumps(response_data, default=str)
            print(f"âœ“ JSON serialization successful: {len(json_str)} chars")
        except Exception as e:
            print(f"âŒ JSON serialization failed: {e}")
            import traceback
            traceback.print_exc()
            raise HTTPException(status_code=500, detail=f"JSONåºåˆ—åŒ–å¤±è´¥: {str(e)}")

        # Step 7: Return response
        print("ğŸ“ Step 7: Returning response...")
        result = create_success_response(
            data=response_data,
            message=f"è·å–{validated_symbol.symbol}äº¤æ˜“ä¿¡å·æˆåŠŸ",
        )
        print(f"âœ“ Response created: {type(result)}")
        print(f"{'='*60}")
        print("âœ… SIGNALS ENDPOINT SUCCESS")
        print(f"{'='*60}\n")
        return result

    except HTTPException:
        print(f"âŒ HTTPException raised, re-raising...")
        print(f"{'='*60}\n")
        raise
    except Exception as e:
        print(f"\n{'='*60}")
        print(f"âŒ UNEXPECTED ERROR: {e}")
        import traceback
        traceback.print_exc()
        print(f"{'='*60}\n")
        raise HTTPException(
            status_code=500,
            detail=create_error_response(ErrorCodes.INTERNAL_SERVER_ERROR, f"è·å–äº¤æ˜“ä¿¡å·å¤±è´¥: {str(e)}").model_dump(),
        )
