<template>
  <div class="tdxpy-demo">

    <div class="page-header">
      <h1 class="page-title">TDPXY DEMO</h1>
      <p class="page-subtitle">PYTONGDAXIN | REAL-TIME DATA | HISTORICAL DATA</p>
    </div>

    <div class="function-nav">
      <el-button
        v-for="tab in tabs"
        :key="tab.key"
        type="activeTab === tab.key ? 'solid' : 'outline'"
        @click="activeTab = tab.key"
      >
        {{ tab.icon }} {{ tab.label }}
      </el-button>
    </div>

    <el-card v-show="activeTab === 'overview'" class="demo-card">
      <template #header>
        <div class="card-header">
          <span>PROJECT OVERVIEW</span>
          <el-tag type="success">MIGRATED</el-tag>
        </div>
      </template>

      <div class="content-section">
        <h3>INTRODUCTION</h3>
        <p>pytdx is a pure Python implementation of Tongdaxin network protocol interface library. It provides a complete Python API for obtaining real-time and historical market data by reverse engineering Tongdaxin's network protocol, without requiring Tongdaxin client installation.</p>

        <h3 style="margin-top: 30px;">CORE FEATURES</h3>
        <div class="features-grid">
          <el-card :hoverable="true">
            <h4>MARKET DATA API</h4>
            <ul>
              <li>Real-time Quotes (Level-1)</li>
              <li>Historical K-line Data (Daily/Weekly/Monthly/Minute)</li>
              <li>Intraday Data (Tick Level)</li>
              <li>Order Book Data (5-level Bid/Ask)</li>
              <li>Transaction History</li>
            </ul>
          </el-card>

          <el-card :hoverable="true">
            <h4>BASIC DATA API</h4>
            <ul>
              <li>Stock List Query (A-Shares/Indices/Sectors)</li>
              <li>Financial Data Query</li>
              <li>Company Information</li>
              <li>Ex-dividend Data</li>
              <li>Sector Components</li>
            </ul>
          </el-card>

          <el-card :hoverable="true">
            <h4>EXTENDED API</h4>
            <ul>
              <li>Level-2 10-level Quotes (requires permission)</li>
              <li>Tick-by-tick Order Data</li>
              <li>Main Force Capital Flow</li>
              <li>Dragon Tiger List Data</li>
              <li>Large Order Tracking</li>
            </ul>
          </el-card>

          <el-card :hoverable="true">
            <h4>TOOLS</h4>
            <ul>
              <li>Cross-platform (Windows/Mac/Linux)</li>
              <li>Auto Server Selection & Load Balancing</li>
              <li>Data Caching Mechanism</li>
              <li>Concurrent Request Support</li>
              <li>Error Retry Mechanism</li>
            </ul>
          </el-card>
        </div>

        <h3 style="margin-top: 30px;">PROJECT ADVANTAGES</h3>
        <el-descriptions :column="2" border style="margin-top: 15px;" class="descriptions">
          <el-descriptions-item label="PURE PYTHON">
            No Tongdaxin client required, cross-platform support
          </el-descriptions-item>
          <el-descriptions-item label="FREE">
            Completely free, no data interface purchase required
          </el-descriptions-item>
          <el-descriptions-item label="REAL-TIME DATA">
            Direct connection to Tongdaxin servers
          </el-descriptions-item>
          <el-descriptions-item label="HISTORICAL DATA">
            Complete historical K-line data support</el-descriptions-item>
        </el-descriptions>

        <h3 style="margin-top: 30px;">LIBRARY REPOSITORY</h3>
        <el-alert
          type="info"
          :closable="false"
          style="margin-top: 20px;"
        >
          <template #title>
            <div style="font-weight: bold;">ğŸ“š é¡¹ç›®èµ„æº</div>
          </template>
          <ul style="margin-top: 10px;">
            <li>GitHub: <el-link href="https://github.com/rainx/pytdx" target="_blank" type="primary">https://github.com/rainx/pytdx</el-link></li>
            <li>PyPI: <el-link href="https://pypi.org/project/pytdx/" target="_blank" type="primary">https://pypi.org/project/pytdx/</el-link></li>
            <li>Documentation: <el-link href="https://pytdx.readthedocs.io/" target="_blank" type="primary">https://pytdx.readthedocs.io/</el-link></li>
            <li>æ–‡æ¡£: å®Œæ•´çš„ API æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹</li>
            <li>ç¤¾åŒº: æ´»è·ƒçš„ Issue è®¨è®ºå’Œé—®é¢˜è§£ç­”</li>
            <li>æ›´æ–°: æŒç»­æ›´æ–°ä»¥æ”¯æŒæœ€æ–°çš„é€šè¾¾ä¿¡åè®®</li>
          </ul>
        </el-alert>
      </div>
    </el-card>

    <!-- 2. å®‰è£…å’Œé…ç½® -->
    <el-card v-show="activeTab === 'install'" class="demo-card">
      <template #header>
        <div class="card-header">
          <span>âš™ï¸ å®‰è£…å’Œé…ç½®</span>
          <el-tag type="success">å·²é›†æˆ</el-tag>
        </div>
      </template>

      <div class="content-section">
        <h3>ğŸ“¦ å®‰è£…æ–¹å¼</h3>
        <p>pytdx å¯ä»¥é€šè¿‡ pip ç›´æ¥å®‰è£…:</p>

        <pre v-pre class="code-block"># å®‰è£… pytdx
pip install pytdx

# æˆ–è€…ä»æºç å®‰è£…
git clone https://github.com/rainx/pytdx.git
cd pytdx
python setup.py install</pre>

        <h3 style="margin-top: 30px;">ğŸ”§ åŸºç¡€é…ç½®</h3>
        <p>pytdx æä¾›äº†ä¸¤ç§ä¸»è¦çš„ API ç±»å‹:</p>

        <el-tabs type="border-card" style="margin-top: 20px;">
          <el-tab-pane label="æ ‡å‡†è¡Œæƒ… API">
            <div class="tab-content">
              <h4>ğŸ“Š TdxHq_API - æ ‡å‡†è¡Œæƒ…æ¥å£</h4>
              <p>ç”¨äºè·å–åŸºç¡€è¡Œæƒ…æ•°æ®,å¦‚Kçº¿ã€å®æ—¶ä»·æ ¼ç­‰:</p>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API

# åˆ›å»º API å¯¹è±¡
api = TdxHq_API()

# è¿æ¥æœåŠ¡å™¨
if api.connect('119.147.212.81', 7709):
    print("è¿æ¥æˆåŠŸ!")

    # åœ¨è¿™é‡Œæ‰§è¡Œæ•°æ®æŸ¥è¯¢...

    # æ–­å¼€è¿æ¥
    api.disconnect()
else:
    print("è¿æ¥å¤±è´¥")</pre>

              <h4 style="margin-top: 20px;">ğŸŒ å¯ç”¨æœåŠ¡å™¨åˆ—è¡¨</h4>
              <el-table :data="standardServers" stripe size="small" style="margin-top: 10px;">
                <el-table-column prop="ip" label="IPåœ°å€" width="150" />
                <el-table-column prop="port" label="ç«¯å£" width="80" />
                <el-table-column prop="location" label="ä½ç½®" />
              </el-table>
            </div>
          </el-tab-pane>

          <el-tab-pane label="æ‰©å±•è¡Œæƒ… API">
            <div class="tab-content">
              <h4>ğŸ”Œ TdxExHq_API - æ‰©å±•è¡Œæƒ…æ¥å£</h4>
              <p>æä¾›æ›´è¯¦ç»†çš„è¡Œæƒ…æ•°æ®,åŒ…æ‹¬ Level-2ã€è´¢åŠ¡æ•°æ®ç­‰:</p>

              <pre v-pre class="code-block">from pytdx.exhq import TdxExHq_API

# åˆ›å»ºæ‰©å±• API å¯¹è±¡
api = TdxExHq_API()

# è¿æ¥æœåŠ¡å™¨ (æ‰©å±•è¡Œæƒ…æœåŠ¡å™¨)
if api.connect('106.14.95.149', 7727):
    print("è¿æ¥æˆåŠŸ!")

    # æ‰§è¡Œæ‰©å±•æ•°æ®æŸ¥è¯¢...

    api.disconnect()
else:
    print("è¿æ¥å¤±è´¥")</pre>

              <h4 style="margin-top: 20px;">ğŸŒ æ‰©å±•æœåŠ¡å™¨åˆ—è¡¨</h4>
              <el-table :data="extendedServers" stripe size="small" style="margin-top: 10px;">
                <el-table-column prop="ip" label="IPåœ°å€" width="150" />
                <el-table-column prop="port" label="ç«¯å£" width="80" />
                <el-table-column prop="location" label="ä½ç½®" />
              </el-table>
            </div>
          </el-tab-pane>

          <el-tab-pane label="è‡ªåŠ¨æœåŠ¡å™¨é€‰æ‹©">
            <div class="tab-content">
              <h4>ğŸ”„ BestIP - è‡ªåŠ¨é€‰æ‹©æœ€ä½³æœåŠ¡å™¨</h4>
              <p>pytdx æä¾›è‡ªåŠ¨é€‰æ‹©å»¶è¿Ÿæœ€ä½çš„æœåŠ¡å™¨åŠŸèƒ½:</p>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API
from pytdx.util.best_ip import select_best_ip

# è‡ªåŠ¨é€‰æ‹©æœ€ä½³æœåŠ¡å™¨
best_ip = select_best_ip()
print(f"æœ€ä½³æœåŠ¡å™¨: {best_ip['ip']}:{best_ip['port']}")

# è¿æ¥åˆ°æœ€ä½³æœåŠ¡å™¨
api = TdxHq_API()
if api.connect(best_ip['ip'], best_ip['port']):
    print("è¿æ¥æˆåŠŸ!")
    api.disconnect()</pre>

              <el-alert type="info" :closable="false" style="margin-top: 15px;">
                <p><strong>ğŸ’¡ å»ºè®®:</strong> åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è‡ªåŠ¨æœåŠ¡å™¨é€‰æ‹©åŠŸèƒ½,å¯ä»¥æé«˜è¿æ¥æˆåŠŸç‡å’Œæ•°æ®è·å–é€Ÿåº¦ã€‚</p>
              </el-alert>
            </div>
          </el-tab-pane>
        </el-tabs>

        <h3 style="margin-top: 30px;">ğŸ” with è¯­å¥ç®¡ç†è¿æ¥</h3>
        <p>æ¨èä½¿ç”¨ with è¯­å¥ç®¡ç†è¿æ¥,è‡ªåŠ¨å¤„ç†è¿æ¥å’Œæ–­å¼€:</p>

        <pre v-pre class="code-block">from pytdx.hq import TdxHq_API

# ä½¿ç”¨ with è¯­å¥
with TdxHq_API() as api:
    if api.connect('119.147.212.81', 7709):
        # æŸ¥è¯¢æ•°æ®
        data = api.get_security_quotes([(0, '000001')])
        print(data)
    # è‡ªåŠ¨æ–­å¼€è¿æ¥</pre>
      </div>
    </el-card>

    <!-- 3. API ä½¿ç”¨ç¤ºä¾‹ -->
    <el-card v-show="activeTab === 'api'" class="demo-card">
      <template #header>
        <div class="card-header">
          <span>ğŸ’» API ä½¿ç”¨ç¤ºä¾‹</span>
          <el-tag type="warning">æ–‡æ¡£</el-tag>
        </div>
      </template>

      <div class="content-section">
        <h3>ğŸ“Š å¸¸ç”¨ API ç¤ºä¾‹</h3>

        <el-collapse accordion style="margin-top: 20px;">
          <el-collapse-item title="1ï¸âƒ£ è·å–å®æ—¶è¡Œæƒ…" name="1">
            <div class="api-content">
              <h4>get_security_quotes() - è·å–å¤šåªè‚¡ç¥¨çš„å®æ—¶è¡Œæƒ…</h4>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API

api = TdxHq_API()
with api.connect('119.147.212.81', 7709):
    # æŸ¥è¯¢å¤šåªè‚¡ç¥¨ (å¸‚åœºä»£ç , è‚¡ç¥¨ä»£ç )
    # å¸‚åœºä»£ç : 0-æ·±åœ³, 1-ä¸Šæµ·
    quotes = api.get_security_quotes([
        (0, '000001'),  # å¹³å®‰é“¶è¡Œ
        (1, '600000'),  # æµ¦å‘é“¶è¡Œ
        (1, '000001')   # ä¸Šè¯æŒ‡æ•°
    ])

    for quote in quotes:
        print(f"è‚¡ç¥¨: {quote['code']}")
        print(f"  åç§°: {quote['name']}")
        print(f"  å½“å‰ä»·: {quote['price']}")
        print(f"  æ¶¨è·Œå¹…: {quote['percent']}%")
        print(f"  æˆäº¤é‡: {quote['vol']}")
        print(f"  æˆäº¤é¢: {quote['amount']}")</pre>

              <h4 style="margin-top: 15px;">è¿”å›å­—æ®µè¯´æ˜</h4>
              <el-table :data="quoteFields" stripe size="small" style="margin-top: 10px;">
                <el-table-column prop="field" label="å­—æ®µ" width="120" />
                <el-table-column prop="description" label="è¯´æ˜" />
              </el-table>
            </div>
          </el-collapse-item>

          <el-collapse-item title="2ï¸âƒ£ è·å–Kçº¿æ•°æ®" name="2">
            <div class="api-content">
              <h4>get_security_bars() - è·å–Kçº¿æ•°æ®</h4>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API

api = TdxHq_API()
with api.connect('119.147.212.81', 7709):
    # è·å–æ—¥Kçº¿æ•°æ®
    # å‚æ•°: (Kçº¿ç±»å‹, å¸‚åœºä»£ç , è‚¡ç¥¨ä»£ç , èµ·å§‹ä½ç½®, æ•°é‡)
    # Kçº¿ç±»å‹: 4-æ—¥çº¿, 5-å‘¨çº¿, 6-æœˆçº¿, 7-5åˆ†é’Ÿ, 8-15åˆ†é’Ÿ, 9-30åˆ†é’Ÿ, 10-60åˆ†é’Ÿ
    bars = api.get_security_bars(
        category=4,      # æ—¥Kçº¿
        market=0,        # æ·±åœ³å¸‚åœº
        code='000001',   # å¹³å®‰é“¶è¡Œ
        start=0,         # ä»æœ€æ–°æ•°æ®å¼€å§‹
        count=100        # è·å–100æ ¹Kçº¿
    )

    print(f"è·å–åˆ° {len(bars)} æ ¹Kçº¿")
    for bar in bars[:5]:  # æ˜¾ç¤ºæœ€æ–°5æ ¹
        print(f"{bar['datetime']} - "
              f"å¼€:{bar['open']} "
              f"é«˜:{bar['high']} "
              f"ä½:{bar['low']} "
              f"æ”¶:{bar['close']} "
              f"é‡:{bar['vol']}")</pre>

              <h4 style="margin-top: 15px;">Kçº¿ç±»å‹ä»£ç </h4>
              <el-table :data="klineTypes" stripe size="small" style="margin-top: 10px;">
                <el-table-column prop="code" label="ä»£ç " width="80" />
                <el-table-column prop="type" label="ç±»å‹" width="120" />
                <el-table-column prop="description" label="è¯´æ˜" />
              </el-table>
            </div>
          </el-collapse-item>

          <el-collapse-item title="3ï¸âƒ£ è·å–åˆ†æ—¶æ•°æ®" name="3">
            <div class="api-content">
              <h4>get_åˆ†æ—¶ data() - è·å–åˆ†æ—¶å›¾æ•°æ®</h4>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API

api = TdxHq_API()
with api.connect('119.147.212.81', 7709):
    # è·å–åˆ†æ—¶æ•°æ® (Tickçº§åˆ«)
    tick_data = api.get_history_transaction_data(
        market=0,
        code='000001',
        start=0,
        count=2000  # æœ€å¤š2000æ¡
    )

    print(f"è·å–åˆ° {len(tick_data)} æ¡Tickæ•°æ®")
    for tick in tick_data[:10]:  # æ˜¾ç¤ºå‰10æ¡
        print(f"{tick['time']} - "
              f"ä»·æ ¼:{tick['price']} "
              f"é‡:{tick['vol']} "
              f"æ–¹å‘:{'ä¹°' if tick['buyorsell'] == 0 else 'å–'}")</pre>
            </div>
          </el-collapse-item>

          <el-collapse-item title="4ï¸âƒ£ è·å–è‚¡ç¥¨åˆ—è¡¨" name="4">
            <div class="api-content">
              <h4>get_security_list() - è·å–å¸‚åœºè‚¡ç¥¨åˆ—è¡¨</h4>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API

api = TdxHq_API()
with api.connect('119.147.212.81', 7709):
    # è·å–æ·±åœ³Aè‚¡åˆ—è¡¨
    # å¸‚åœº: 0-æ·±åœ³, 1-ä¸Šæµ·
    # ç±»å‹: 0-è‚¡ç¥¨, 1-æŒ‡æ•°, 2-åŸºé‡‘
    sz_stocks = api.get_security_list(market=0, start=0)

    print(f"æ·±åœ³å¸‚åœºè‚¡ç¥¨æ•°é‡: {len(sz_stocks)}")
    for stock in sz_stocks[:10]:  # æ˜¾ç¤ºå‰10åª
        print(f"{stock['code']} - {stock['name']}")

    # è·å–ä¸Šæµ·Aè‚¡åˆ—è¡¨
    sh_stocks = api.get_security_list(market=1, start=0)
    print(f"\nä¸Šæµ·å¸‚åœºè‚¡ç¥¨æ•°é‡: {len(sh_stocks)}")

    # è·å–æŒ‡æ•°åˆ—è¡¨
    indices = api.get_security_list(market=1, start=0)
    print(f"\næŒ‡æ•°æ•°é‡: {len([s for s in indices if s['code'].startswith('000')])}")</pre>
            </div>
          </el-collapse-item>

          <el-collapse-item title="5ï¸âƒ£ è·å–è´¢åŠ¡æ•°æ®" name="5">
            <div class="api-content">
              <h4>get_finance_info() - è·å–è´¢åŠ¡æ•°æ®</h4>

              <pre v-pre class="code-block">from pytdx.exhq import TdxExHq_API

api = TdxExHq_API()
with api.connect('106.14.95.149', 7727):
    # è·å–è´¢åŠ¡æ•°æ® (éœ€è¦æ‰©å±•è¡Œæƒ… API)
    finance_data = api.get_finance_info(market=0, code='000001')

    print(f"è‚¡ç¥¨ä»£ç : {finance_data['code']}")
    print(f"æ¯è‚¡æ”¶ç›Š: {finance_data['liutongguben']}")
    print(f"æ¯è‚¡å‡€èµ„äº§: {finance_data['mgsy']}")
    print(f"å‡€èµ„äº§æ”¶ç›Šç‡: {finance_data['mgjzc']}")
    print(f"å¸‚ç›ˆç‡: {finance_data['pe']}")
    print(f"å¸‚å‡€ç‡: {finance_data['pb']}")</pre>
            </div>
          </el-collapse-item>

          <el-collapse-item title="6ï¸âƒ£ æ‰¹é‡è·å–æ•°æ®" name="6">
            <div class="api-content">
              <h4>æ‰¹é‡è·å–å¤šåªè‚¡ç¥¨çš„Kçº¿æ•°æ®</h4>

              <pre v-pre class="code-block">from pytdx.hq import TdxHq_API
import pandas as pd

def get_multiple_stocks_kline(codes, count=100):
    """
    æ‰¹é‡è·å–å¤šåªè‚¡ç¥¨çš„Kçº¿æ•°æ®

    Args:
        codes: è‚¡ç¥¨ä»£ç åˆ—è¡¨ [(market, code), ...]
        count: æ¯åªè‚¡ç¥¨è·å–çš„Kçº¿æ•°é‡

    Returns:
        dict: {code: DataFrame}
    """
    result = {}

    api = TdxHq_API()
    with api.connect('119.147.212.81', 7709):
        for market, code in codes:
            try:
                bars = api.get_security_bars(
                    category=4,  # æ—¥Kçº¿
                    market=market,
                    code=code,
                    start=0,
                    count=count
                )

                # è½¬æ¢ä¸º DataFrame
                df = pd.DataFrame(bars)
                df['datetime'] = pd.to_datetime(df['datetime'])
                df.set_index('datetime', inplace=True)

                result[code] = df
                print(f"å·²è·å– {code}: {len(df)} æ¡æ•°æ®")

            except Exception as e:
                print(f"è·å– {code} å¤±è´¥: {e}")

    return result

# ä½¿ç”¨ç¤ºä¾‹
stocks = [
    (0, '000001'),  # å¹³å®‰é“¶è¡Œ
    (1, '600000'),  # æµ¦å‘é“¶è¡Œ
    (1, '600036')   # æ‹›å•†é“¶è¡Œ
]

data = get_multiple_stocks_kline(stocks, count=200)

# æŸ¥çœ‹æ•°æ®
for code, df in data.items():
    print(f"\n{code} æœ€æ–°æ•°æ®:")
    print(df.tail())</pre>
            </div>
          </el-collapse-item>
        </el-collapse>
      </div>
    </el-card>

    <!-- 4. æ•°æ®å¯¼å‡º -->
    <el-card v-show="activeTab === 'export'" class="demo-card">
      <template #header>
        <div class="card-header">
          <span>ğŸ’¾ æ•°æ®å¯¼å‡º</span>
          <el-tag type="warning">æ–‡æ¡£</el-tag>
        </div>
      </template>

      <div class="content-section">
        <h3>ğŸ“¤ æ•°æ®å¯¼å‡ºåŠŸèƒ½</h3>
        <p>pytdx å¯ä»¥æ–¹ä¾¿åœ°å°†è·å–çš„æ•°æ®å¯¼å‡ºä¸ºå¤šç§æ ¼å¼:</p>

        <el-tabs type="border-card" style="margin-top: 20px;">
          <el-tab-pane label="å¯¼å‡ºåˆ° CSV">
            <pre v-pre class="code-block">from pytdx.hq import TdxHq_API
import pandas as pd

def export_to_csv(market, code, filename, count=1000):
    """å¯¼å‡ºKçº¿æ•°æ®åˆ°CSVæ–‡ä»¶"""

    api = TdxHq_API()
    with api.connect('119.147.212.81', 7709):
        # è·å–Kçº¿æ•°æ®
        bars = api.get_security_bars(
            category=4,
            market=market,
            code=code,
            start=0,
            count=count
        )

        # è½¬æ¢ä¸º DataFrame
        df = pd.DataFrame(bars)

        # å¯¼å‡ºåˆ° CSV
        df.to_csv(filename, index=False, encoding='utf-8-sig')
        print(f"å·²å¯¼å‡º {len(df)} æ¡æ•°æ®åˆ° {filename}")

# ä½¿ç”¨ç¤ºä¾‹
export_to_csv(0, '000001', '000001_daily.csv', count=500)</pre>
          </el-tab-pane>

          <el-tab-pane label="å¯¼å‡ºåˆ°æ•°æ®åº“">
            <pre v-pre class="code-block">from pytdx.hq import TdxHq_API
import pandas as pd
from sqlalchemy import create_engine

def export_to_database(market, code, table_name, count=1000):
    """å¯¼å‡ºKçº¿æ•°æ®åˆ°PostgreSQLæ•°æ®åº“"""

    # åˆ›å»ºæ•°æ®åº“è¿æ¥
    engine = create_engine(
        'postgresql://user:password@localhost:5432/stocks'
    )

    api = TdxHq_API()
    with api.connect('119.147.212.81', 7709):
        # è·å–Kçº¿æ•°æ®
        bars = api.get_security_bars(
            category=4,
            market=market,
            code=code,
            start=0,
            count=count
        )

        # è½¬æ¢ä¸º DataFrame
        df = pd.DataFrame(bars)
        df['code'] = code
        df['datetime'] = pd.to_datetime(df['datetime'])

        # å†™å…¥æ•°æ®åº“
        df.to_sql(
            table_name,
            engine,
            if_exists='append',
            index=False
        )

        print(f"å·²å¯¼å‡º {len(df)} æ¡æ•°æ®åˆ°æ•°æ®åº“è¡¨ {table_name}")

# ä½¿ç”¨ç¤ºä¾‹
export_to_database(0, '000001', 'stock_daily', count=500)</pre>
          </el-tab-pane>

          <el-tab-pane label="å®šæ—¶æ›´æ–°">
            <pre v-pre class="code-block">import schedule
import time
from pytdx.hq import TdxHq_API
import pandas as pd

def update_stock_data():
    """å®šæ—¶æ›´æ–°è‚¡ç¥¨æ•°æ®"""
    print(f"å¼€å§‹æ›´æ–°æ•°æ® - {time.strftime('%Y-%m-%d %H:%M:%S')}")

    # è‚¡ç¥¨åˆ—è¡¨
    stocks = [
        (0, '000001'),
        (1, '600000'),
        (1, '600036')
    ]

    api = TdxHq_API()
    with api.connect('119.147.212.81', 7709):
        for market, code in stocks:
            try:
                # è·å–æœ€æ–°100æ ¹Kçº¿
                bars = api.get_security_bars(
                    category=4,
                    market=market,
                    code=code,
                    start=0,
                    count=100
                )

                # ä¿å­˜åˆ°CSV
                df = pd.DataFrame(bars)
                filename = f"data/{code}_daily.csv"
                df.to_csv(filename, index=False)

                print(f"å·²æ›´æ–° {code}")

            except Exception as e:
                print(f"æ›´æ–° {code} å¤±è´¥: {e}")

# æ¯å¤©ä¸‹åˆ3ç‚¹15åˆ†æ›´æ–°
schedule.every().day.at("15:15").do(update_stock_data)

# æŒç»­è¿è¡Œ
while True:
    schedule.run_pending()
    time.sleep(60)</pre>
          </el-tab-pane>
        </el-tabs>
      </div>
    </el-card>

    <!-- 5. é›†æˆçŠ¶æ€ -->
    <el-card v-show="activeTab === 'status'" class="demo-card">
      <template #header>
        <div class="card-header">
          <span>âœ… é›†æˆçŠ¶æ€</span>
        </div>
      </template>

      <div class="content-section">
        <h3>ğŸ“¦ å·²é›†æˆåŠŸèƒ½</h3>
        <el-descriptions :column="1" border style="margin-top: 15px;">
          <el-descriptions-item label="pytdx åº“">
            <el-tag type="success">âœ… å·²å®‰è£…</el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="API æ–‡æ¡£">
            <el-tag type="success">âœ… å·²æ•´ç†</el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="ä½¿ç”¨ç¤ºä¾‹">
            <el-tag type="success">âœ… å·²æ”¶é›†</el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="åç«¯æ¥å£">
            <el-tag type="info">â³ å¾…å¼€å‘</el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="å®æ—¶æ•°æ®æœåŠ¡">
            <el-tag type="info">â³ è®¡åˆ’ä¸­</el-tag>
          </el-descriptions-item>
          <el-descriptions-item label="æ•°æ®ç¼“å­˜">
            <el-tag type="info">â³ è®¡åˆ’ä¸­</el-tag>
          </el-descriptions-item>
        </el-descriptions>

        <h3 style="margin-top: 30px;">ğŸ¯ åç»­é›†æˆè®¡åˆ’</h3>
        <el-timeline style="margin-top: 20px;">
          <el-timeline-item timestamp="Phase 1" placement="top">
            <el-card>
              <h4>åç«¯ API å¼€å‘</h4>
              <p>å°è£… pytdx åŠŸèƒ½ä¸º RESTful API,æä¾›æ ‡å‡†åŒ–æ•°æ®æ¥å£</p>
            </el-card>
          </el-timeline-item>
          <el-timeline-item timestamp="Phase 2" placement="top">
            <el-card>
              <h4>å®æ—¶æ•°æ®æœåŠ¡</h4>
              <p>å»ºç«‹ WebSocket æ¨é€æœåŠ¡,å®ç°å®æ—¶è¡Œæƒ…æ¨é€</p>
            </el-card>
          </el-timeline-item>
          <el-timeline-item timestamp="Phase 3" placement="top">
            <el-card>
              <h4>æ•°æ®ç¼“å­˜å±‚</h4>
              <p>å®ç° Redis ç¼“å­˜,æé«˜æ•°æ®è®¿é—®é€Ÿåº¦</p>
            </el-card>
          </el-timeline-item>
          <el-timeline-item timestamp="Phase 4" placement="top">
            <el-card>
              <h4>æ•°æ®å¯è§†åŒ–</h4>
              <p>åœ¨ Web ç•Œé¢ä¸­å±•ç¤ºå®æ—¶è¡Œæƒ…å’ŒKçº¿å›¾è¡¨</p>
            </el-card>
          </el-timeline-item>
        </el-timeline>

        <h3 style="margin-top: 30px;">ğŸ’¡ åº”ç”¨åœºæ™¯</h3>
        <el-row :gutter="20" style="margin-top: 20px;">
          <el-col :span="12">
            <el-card shadow="hover">
              <h4>ğŸ¯ å®æ—¶è¡Œæƒ…ç›‘æ§</h4>
              <p>ä½¿ç”¨ pytdx è·å–å®æ—¶è¡Œæƒ…æ•°æ®,ç»“åˆç­–ç•¥è¿›è¡Œç›‘æ§å’Œå‘Šè­¦ã€‚é€‚ç”¨äºçŸ­çº¿äº¤æ˜“å’Œæ—¥å†…ç­–ç•¥ã€‚</p>
            </el-card>
          </el-col>
          <el-col :span="12">
            <el-card shadow="hover">
              <h4>ğŸ“Š å†å²æ•°æ®å›æµ‹</h4>
              <p>è·å–å®Œæ•´çš„å†å²Kçº¿æ•°æ®,ç”¨äºç­–ç•¥å›æµ‹å’Œå‚æ•°ä¼˜åŒ–ã€‚æ”¯æŒå¤šå‘¨æœŸæ•°æ®åˆ†æã€‚</p>
            </el-card>
          </el-col>
        </el-row>

        <el-row :gutter="20" style="margin-top: 20px;">
          <el-col :span="12">
            <el-card shadow="hover">
              <h4>ğŸ’¾ æ•°æ®é‡‡é›†ç³»ç»Ÿ</h4>
              <p>å®šæ—¶é‡‡é›†å’Œæ›´æ–°è‚¡ç¥¨æ•°æ®,å»ºç«‹æœ¬åœ°æ•°æ®åº“ã€‚æ”¯æŒå…¨å¸‚åœºæ•°æ®é‡‡é›†å’Œå¢é‡æ›´æ–°ã€‚</p>
            </el-card>
          </el-col>
          <el-col :span="12">
            <el-card shadow="hover">
              <h4>ğŸ” é‡åŒ–åˆ†æ</h4>
              <p>ç»“åˆæŠ€æœ¯æŒ‡æ ‡å’Œå› å­åˆ†æ,æ„å»ºé‡åŒ–é€‰è‚¡ç³»ç»Ÿã€‚æ”¯æŒå¤šå› å­æ¨¡å‹å’Œæœºå™¨å­¦ä¹ ã€‚</p>
            </el-card>
          </el-col>
        </el-row>

        <el-alert
          type="warning"
          title="âš ï¸ ä½¿ç”¨æ³¨æ„äº‹é¡¹"
          :closable="false"
          style="margin-top: 20px;"
        >
          <ul style="margin-top: 10px;">
            <li><strong>é¢‘ç‡é™åˆ¶</strong>: é¿å…è¿‡äºé¢‘ç¹è¯·æ±‚,å»ºè®®é—´éš”è‡³å°‘1ç§’</li>
            <li><strong>æ•°æ®å»¶è¿Ÿ</strong>: é€šè¾¾ä¿¡å…è´¹æ•°æ®æœ‰3-5ç§’å»¶è¿Ÿ</li>
            <li><strong>æœåŠ¡å™¨ç¨³å®šæ€§</strong>: æœåŠ¡å™¨å¯èƒ½ä¸ç¨³å®š,éœ€è¦å®ç°é‡è¿æœºåˆ¶</li>
            <li><strong>æ•°æ®å‡†ç¡®æ€§</strong>: å»ºè®®ä¸å®˜æ–¹æ•°æ®æºè¿›è¡Œå¯¹æ¯”éªŒè¯</li>
            <li><strong>åˆè§„ä½¿ç”¨</strong>: ä»…ä¾›ä¸ªäººå­¦ä¹ ç ”ç©¶ä½¿ç”¨,å•†ä¸šç”¨é€”éœ€å’¨è¯¢é€šè¾¾ä¿¡</li>
          </ul>
        </el-alert>
      </div>
    </el-card>
  </div>
</template>

<script setup>
import { ref } from 'vue'

const activeTab = ref('overview')

const tabs = [
  { key: 'overview', label: 'é¡¹ç›®æ¦‚è§ˆ', icon: 'ğŸ“‹' },
  { key: 'install', label: 'å®‰è£…é…ç½®', icon: 'âš™ï¸' },
  { key: 'api', label: 'API ç¤ºä¾‹', icon: 'ğŸ’»' },
  { key: 'export', label: 'æ•°æ®å¯¼å‡º', icon: 'ğŸ’¾' },
  { key: 'status', label: 'é›†æˆçŠ¶æ€', icon: 'âœ…' }
]

const standardServers = [
  { ip: '119.147.212.81', port: '7709', location: 'æ·±åœ³ç”µä¿¡' },
  { ip: '114.80.63.12', port: '7709', location: 'ä¸Šæµ·ç”µä¿¡' },
  { ip: '60.12.136.250', port: '7709', location: 'æ­å·ç”µä¿¡' },
  { ip: '115.238.90.165', port: '7709', location: 'å—äº¬ç”µä¿¡' }
]

const extendedServers = [
  { ip: '106.14.95.149', port: '7727', location: 'ä¸Šæµ·' },
  { ip: '119.147.164.60', port: '7727', location: 'æ·±åœ³' },
  { ip: '47.103.48.45', port: '7727', location: 'æ­å·' }
]

const quoteFields = [
  { field: 'code', description: 'è‚¡ç¥¨ä»£ç ' },
  { field: 'name', description: 'è‚¡ç¥¨åç§°' },
  { field: 'price', description: 'å½“å‰ä»·æ ¼' },
  { field: 'open', description: 'å¼€ç›˜ä»·' },
  { field: 'high', description: 'æœ€é«˜ä»·' },
  { field: 'low', description: 'æœ€ä½ä»·' },
  { field: 'pre_close', description: 'æ˜¨æ”¶ä»·' },
  { field: 'percent', description: 'æ¶¨è·Œå¹… (%)' },
  { field: 'vol', description: 'æˆäº¤é‡' },
  { field: 'amount', description: 'æˆäº¤é¢' },
  { field: 'bid1-bid5', description: 'äº”æ¡£å§”ä¹°ä»·' },
  { field: 'ask1-ask5', description: 'äº”æ¡£å§”å–ä»·' }
]

const klineTypes = [
  { code: '4', type: 'æ—¥çº¿', description: 'æ¯æ—¥Kçº¿æ•°æ®' },
  { code: '5', type: 'å‘¨çº¿', description: 'æ¯å‘¨Kçº¿æ•°æ®' },
  { code: '6', type: 'æœˆçº¿', description: 'æ¯æœˆKçº¿æ•°æ®' },
  { code: '7', type: '5åˆ†é’Ÿ', description: '5åˆ†é’ŸKçº¿æ•°æ®' },
  { code: '8', type: '15åˆ†é’Ÿ', description: '15åˆ†é’ŸKçº¿æ•°æ®' },
  { code: '9', type: '30åˆ†é’Ÿ', description: '30åˆ†é’ŸKçº¿æ•°æ®' },
  { code: '10', type: '60åˆ†é’Ÿ', description: '60åˆ†é’ŸKçº¿æ•°æ®' },
  { code: '11', type: '1åˆ†é’Ÿ', description: '1åˆ†é’ŸKçº¿æ•°æ®' }
]
</script>

<style scoped>

.tdxpy-demo {
  padding: var(--spacing-6);
  max-width: 1400px;
  margin: 0 auto;
  min-height: 100vh;
  position: relative;
  background: var(--bg-primary);
}

.background-pattern {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  opacity: 0.04;
  background-image:
    repeating-linear-gradient(
      45deg,
      var(--accent-gold) 0px,
      var(--accent-gold) 1px,
      transparent 1px,
      transparent 10px
    ),
    repeating-linear-gradient(
      -45deg,
      var(--accent-gold) 0px,
      var(--accent-gold) 1px,
      transparent 1px,
      transparent 10px
    );
}

.page-header {
  text-align: center;
  margin-bottom: var(--spacing-8);
  position: relative;
  z-index: 1;

  .page-title {
    font-family: var(--font-display);
    font-size: var(--font-size-h2);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: var(--tracking-widest);
    color: var(--accent-gold);
    margin: 0 0 var(--spacing-2) 0;
  }

  .page-subtitle {
    font-family: var(--font-body);
    font-size: var(--font-size-small);
    color: var(--fg-muted);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin: 0;
  }
}

.demo-grid {
  display: flex;
  gap: var(--spacing-3);
  margin-bottom: var(--spacing-6);
  flex-wrap: wrap;
  position: relative;
  z-index: 1;
}

.demo-card {
  margin-bottom: var(--spacing-6);
  position: relative;
  z-index: 1;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-family: var(--font-display);
  font-size: var(--font-size-h4);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: var(--tracking-wider);
  color: var(--accent-gold);
}

.content-section {
  padding: var(--spacing-4) 0;
  line-height: 1.8;
}

.content-section h3 {
  font-family: var(--font-display);
  font-size: var(--font-size-h4);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: var(--tracking-wider);
  color: var(--accent-gold);
  margin-bottom: var(--spacing-4);
}

.content-section h4 {
  font-family: var(--font-display);
  font-size: var(--font-size-body);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: var(--tracking-wider);
  color: var(--fg-primary);
  margin-bottom: var(--spacing-3);
}

.content-section p {
  margin: var(--spacing-3) 0;
  color: var(--fg-primary);
}

.content-section ul {
  padding-left: var(--spacing-6);
  margin: var(--spacing-3) 0;
}

.content-section ul li {
  margin: var(--spacing-2) 0;
  color: var(--fg-primary);
}

.model-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--spacing-4);
  margin-top: var(--spacing-4);
}

.model-list ul {
  padding-left: var(--spacing-5);
  margin: var(--spacing-3) 0;
  list-style: disc;
}

.profiling-section :deep(.el-descriptions__label) {
  background: rgba(212, 175, 55, 0.1) !important;
  color: var(--fg-muted) !important;
  font-family: var(--font-display);
  font-size: var(--font-size-xs);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: var(--tracking-wider);
}

.profiling-section :deep(.el-descriptions__content) {
  background: transparent !important;
  color: var(--fg-primary) !important;
  font-family: var(--font-body);
}

.content-section p {
  color: #606266;
}

.content-section ul {
  padding-left: 25px;
  margin: 10px 0;
}

.content-section ul li {
  margin: 5px 0;
}

.code-block {
  background: #f5f7fa;
  border: 1px solid #e4e7ed;
  border-radius: 4px;
  padding: 15px;
  font-family: 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.6;
  overflow-x: auto;
  white-space: pre;
  color: #303133;
}

.tab-content,
.api-content {
  padding: 15px;
}

:deep(.el-card__body) {
  padding: 15px;
}

:deep(.el-collapse-item__content) {
  padding: 0;
}

:deep(.el-timeline-item__timestamp) {
  font-weight: bold;
  color: #409eff;
}
</style>
