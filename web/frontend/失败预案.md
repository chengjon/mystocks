# MyStocks Phase 3 - Bloomberg Terminal é£æ ¼æµ‹è¯•å¤±è´¥é¢„æ¡ˆ

## ğŸ“‹ ç›®å½•

1. [æ ·å¼åå·®å¤±è´¥](#æ ·å¼åå·®å¤±è´¥)
2. [è¿›ç¨‹å´©æºƒå¤±è´¥](#è¿›ç¨‹å´©æºƒå¤±è´¥)
3. [ECharts æ¸²æŸ“å¤±è´¥](#echarts-æ¸²æŸ“å¤±è´¥)
4. [Design Token æœªåŠ è½½](#design-token-æœªåŠ è½½)
5. [ç§»åŠ¨ç«¯ä»£ç æ®‹ç•™](#ç§»åŠ¨ç«¯ä»£ç æ®‹ç•™)
6. [ä¸­å›½è‚¡å¸‚é¢œè‰²é”™è¯¯](#ä¸­å›½è‚¡å¸‚é¢œè‰²é”™è¯¯)

---

## æ ·å¼åå·®å¤±è´¥

### ç—‡çŠ¶æè¿°

Playwright è§†è§‰å¯¹æ¯”æµ‹è¯•å¤±è´¥ï¼Œæç¤ºæˆªå›¾åƒç´ å·®å¼‚è¶…è¿‡é˜ˆå€¼ï¼ˆ0.1%ï¼‰

### å¯èƒ½åŸå› 

1. **æµè§ˆå™¨æ¸²æŸ“å·®å¼‚**: ä¸åŒæµè§ˆå™¨å¯¹ CSS çš„æ¸²æŸ“ç•¥æœ‰ä¸åŒ
2. **å­—ä½“åŠ è½½é—®é¢˜**: Inter å­—ä½“æœªåŠ è½½å®Œæˆï¼Œä½¿ç”¨äº†ç³»ç»Ÿå­—ä½“
3. **åŠ¨ç”»è¿‡æ¸¡**: é¡µé¢å…ƒç´ æœ‰åŠ¨ç”»æœªå®Œæˆï¼Œå¯¼è‡´æˆªå›¾ä¸ä¸€è‡´
4. **æ—¶é—´ç›¸å…³å…ƒç´ **: é¡µé¢åŒ…å«å®æ—¶æ—¶é—´ã€åŠ¨æ€æ•°æ®ç­‰

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æŸ¥çœ‹å¤±è´¥æˆªå›¾å¯¹æ¯”
open playwright-report/index.html
# æ‰¾åˆ°å¤±è´¥çš„æµ‹è¯•ç”¨ä¾‹ï¼ŒæŸ¥çœ‹ "Diff" å›¾åƒ

# 2. æ£€æŸ¥å·®å¼‚ç±»å‹
# - é¢œè‰²å·®å¼‚ï¼šæ ·å¼é—®é¢˜
# - å¸ƒå±€å·®å¼‚ï¼šæ¸²æŸ“é—®é¢˜
# - æ–‡æœ¬å·®å¼‚ï¼šå›½é™…åŒ–æˆ–æ•°æ®é—®é¢˜

# 3. åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨éªŒè¯
# æ‰“å¼€ http://localhost:8080
# æ£€æŸ¥é¡µé¢å¤–è§‚æ˜¯å¦ç¬¦åˆé¢„æœŸ

# 4. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
# æ‰“å¼€ DevTools > Console
# æŸ¥æ‰¾ CSS åŠ è½½é”™è¯¯ã€å­—ä½“åŠ è½½é”™è¯¯
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: æ›´æ–°åŸºå‡†æˆªå›¾ï¼ˆå¦‚æœæ ·å¼å˜æ›´ç¬¦åˆé¢„æœŸï¼‰

```bash
# ç¡®è®¤æ ·å¼å˜æ›´ç¬¦åˆ ArtDeco è§†è§‰è§„èŒƒå
npx playwright test --update-snapshots

# éªŒè¯æ›´æ–°åçš„åŸºå‡†æˆªå›¾
npm run test:artdeco:visual-legacy
```

#### æ–¹æ¡ˆ B: è°ƒæ•´æˆªå›¾é˜ˆå€¼

```bash
# ç¼–è¾‘ playwright.config.ts
export default defineConfig({
  expect: {
    // ä» 0.001 (0.1%) è°ƒæ•´ä¸º 0.01 (1%)
    threshold: 0.01,
  },
});
```

#### æ–¹æ¡ˆ C: ç­‰å¾…é¡µé¢ç¨³å®šåå†æˆªå›¾

```typescript
// åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­æ·»åŠ ç­‰å¾…
test('should match Bloomberg style', async ({ page }) => {
  await page.goto('/');

  // ç­‰å¾…å­—ä½“åŠ è½½
  await page.waitForLoadState('networkidle');
  await page.waitForTimeout(1000);

  // ç­‰å¾…ç‰¹å®šå…ƒç´ æ¸²æŸ“
  await page.waitForSelector('.page-title');
  await page.waitForSelector('.main-content');

  // ç„¶åå†æˆªå›¾
  await expect(page).toHaveScreenshot();
});
```

### é¢„é˜²æªæ–½

1. **ç»Ÿä¸€æµ‹è¯•ç¯å¢ƒ**: ä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿ
2. **ç¦ç”¨åŠ¨ç”»**: æµ‹è¯•æ—¶ç¦ç”¨ CSS åŠ¨ç”»å’Œè¿‡æ¸¡
3. **Mock æ•°æ®**: ä½¿ç”¨å›ºå®šæ•°æ®ï¼Œé¿å…æ—¶é—´å˜åŒ–
4. **CI ç¯å¢ƒ**: åœ¨ CI ä¸­ä½¿ç”¨æ— å¤´æµè§ˆå™¨ï¼ˆheadless: trueï¼‰é¿å… GUI å·®å¼‚

---

## è¿›ç¨‹å´©æºƒå¤±è´¥

### ç—‡çŠ¶æè¿°

PM2 è¿›ç¨‹çŠ¶æ€ä¸º `stopped` æˆ– `errored`ï¼Œåº”ç”¨æ— æ³•è®¿é—®

### å¯èƒ½åŸå› 

1. **æ„å»ºé”™è¯¯**: SCSS ç¼–è¯‘å¤±è´¥ã€TypeScript ç±»å‹é”™è¯¯
2. **ä¾èµ–ç¼ºå¤±**: node_modules ä¸å®Œæ•´
3. **ç«¯å£å ç”¨**: 8080 ç«¯å£è¢«å…¶ä»–è¿›ç¨‹å ç”¨
4. **å†…å­˜æº¢å‡º**: åº”ç”¨å†…å­˜ä½¿ç”¨è¶…è¿‡é™åˆ¶ï¼ˆ1GBï¼‰
5. **æœªæ•è·å¼‚å¸¸**: è¿è¡Œæ—¶é”™è¯¯å¯¼è‡´è¿›ç¨‹å´©æºƒ

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æ£€æŸ¥ PM2 è¿›ç¨‹çŠ¶æ€
pm2 list
pm2 show mystocks-frontend

# 2. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs mystocks-frontend --err --lines 100
cat logs/pm2-error.log | tail -50

# 3. æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8080

# 4. å°è¯•æ‰‹åŠ¨å¯åŠ¨ï¼ˆä¸ç”¨ PM2ï¼‰
cd dist && python3 -m http.server 8081
# è®¿é—® http://localhost:8081 éªŒè¯æ„å»ºäº§ç‰©æ˜¯å¦æ­£å¸¸

# 5. æ£€æŸ¥å†…å­˜ä½¿ç”¨
pm2 monit
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: é‡æ–°æ„å»ºé¡¹ç›®

```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules dist package-lock.json
npm install

# é‡æ–°æ„å»º
npm run build

# é‡å¯ PM2
./stop.sh && ./start.sh
```

#### æ–¹æ¡ˆ B: ä¿®å¤ç«¯å£å ç”¨

```bash
# æ‰¾åˆ°å ç”¨ç«¯å£çš„è¿›ç¨‹
PID=$(lsof -t -i:8080)
ps -p $PID

# ç»ˆæ­¢å ç”¨è¿›ç¨‹
kill -9 $PID

# é‡å¯ PM2
./start.sh
```

#### æ–¹æ¡ˆ C: å¢åŠ å†…å­˜é™åˆ¶

```javascript
// ç¼–è¾‘ ecosystem.config.js
module.exports = {
  apps: [{
    name: 'mystocks-frontend',
    // å¢åŠ å†…å­˜é™åˆ¶ä» 1G åˆ° 2G
    max_memory_restart: '2G',
    // æˆ–å®Œå…¨ç§»é™¤å†…å­˜é™åˆ¶
    // max_memory_restart: undefined,
  }]
};
```

#### æ–¹æ¡ˆ D: ä¿®å¤è¿è¡Œæ—¶é”™è¯¯

```bash
# æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯
pm2 logs mystocks-frontend --lines 200

# å¸¸è§é”™è¯¯å’Œä¿®å¤ï¼š

# 1. CSS å¯¼å…¥é”™è¯¯
# Error: Failed to resolve importer
# ä¿®å¤: ç¡®ä¿ theme-tokens.scss è·¯å¾„æ­£ç¡®

# 2. ECharts æœªå®šä¹‰
# Error: echarts is not defined
# ä¿®å¤: npm install echarts@^5.5.0

# 3. è·¯ç”±é”™è¯¯
# Error: Failed to load route
# ä¿®å¤: æ£€æŸ¥ router/index.js é…ç½®
```

### é¢„é˜²æªæ–½

1. **å¥åº·æ£€æŸ¥**: é…ç½® PM2 å¥åº·æ£€æŸ¥ï¼Œè‡ªåŠ¨é‡å¯å´©æºƒè¿›ç¨‹
2. **æ—¥å¿—ç›‘æ§**: å®šæœŸæ£€æŸ¥é”™è¯¯æ—¥å¿—ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
3. **èµ„æºé™åˆ¶**: åˆç†è®¾ç½®å†…å­˜å’Œ CPU é™åˆ¶
4. **é”™è¯¯å¤„ç†**: åº”ç”¨ä¸­æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†

```javascript
// ecosystem.config.js ä¸­é…ç½®
module.exports = {
  apps: [{
    name: 'mystocks-frontend',
    autorestart: true,
    max_restarts: 10,
    min_uptime: '10s',
    restart_delay: 4000,
    kill_timeout: 5000,
    watch: false,
  }]
};
```

---

## ECharts æ¸²æŸ“å¤±è´¥

### ç—‡çŠ¶æè¿°

å›¾è¡¨æ— æ³•æ˜¾ç¤ºï¼Œæˆ–æ˜¾ç¤ºä¸ºç©ºç™½å®¹å™¨ï¼Œæ§åˆ¶å°æœ‰ ECharts é”™è¯¯

### å¯èƒ½åŸå› 

1. **ECharts æœªåŠ è½½**: CDN æˆ–æ„å»ºæ—¶æœªæ­£ç¡®åŒ…å«
2. **å®¹å™¨å°ºå¯¸é—®é¢˜**: å›¾è¡¨å®¹å™¨é«˜åº¦æˆ–å®½åº¦ä¸º 0
3. **é…ç½®é”™è¯¯**: ECharts é…ç½®æœ‰è¯­æ³•é”™è¯¯
4. **æ•°æ®é—®é¢˜**: å›¾è¡¨æ•°æ®æ ¼å¼ä¸æ­£ç¡®
5. **ä¸»é¢˜æœªåº”ç”¨**: Bloomberg ä¸»é¢˜é…ç½®æœªç”Ÿæ•ˆ

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æ£€æŸ¥ ECharts æ˜¯å¦åŠ è½½
curl http://localhost:8080 | grep "echarts"

# æˆ–åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æ£€æŸ¥
window.echarts
# åº”è¿”å› ECharts å¯¹è±¡ï¼Œè€Œé undefined

# 2. æ£€æŸ¥å›¾è¡¨å®¹å™¨
# æ‰“å¼€ http://localhost:8080/market
# Console:
document.querySelector('.chart-container')
# åº”æ‰¾åˆ°å…ƒç´ 

# 3. æ£€æŸ¥å®¹å™¨å°ºå¯¸
# Console:
const container = document.querySelector('.chart-container');
getComputedStyle(container).width;
getComputedStyle(container).height;
# åº”æœ‰éé›¶å€¼

# 4. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯
# æ‰“å¼€ DevTools > Console
# æŸ¥æ‰¾ ECharts ç›¸å…³é”™è¯¯
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: é‡æ–°å®‰è£… ECharts

```bash
# å¸è½½æ—§ç‰ˆæœ¬
npm uninstall echarts

# å®‰è£…æŒ‡å®šç‰ˆæœ¬
npm install echarts@^5.5.0

# é‡æ–°æ„å»º
npm run build

# é‡å¯æœåŠ¡
./stop.sh && ./start.sh
```

#### æ–¹æ¡ˆ B: ä¿®å¤å®¹å™¨å°ºå¯¸

```vue
<!-- ChartContainer.vue -->
<template>
  <div ref="chartContainerRef" class="chart-container" :style="{ height: height }">
    <!-- ç¡®ä¿æœ‰æ˜ç¡®é«˜åº¦ -->
  </div>
</template>

<style scoped lang="scss">
.chart-container {
  min-height: 400px;  // æ·»åŠ æœ€å°é«˜åº¦
  width: 100%;
}
</style>
```

#### æ–¹æ¡ˆ C: ä¿®å¤ ECharts é…ç½®

```typescript
// ChartContainer.vue ä¸­ä¿®å¤é…ç½®
const getChartOption = (): EChartsOption => {
  const baseOption: EChartsOption = {
    backgroundColor: 'transparent',  // é€æ˜èƒŒæ™¯
    tooltip: {
      trigger: props.chartType === 'pie' ? 'item' : 'axis',
      backgroundColor: 'rgba(26, 26, 26, 0.95)',  // Bloomberg æ·±è‰²èƒŒæ™¯
      borderColor: '#D4AF37',  // Bloomberg é‡‘è‰²è¾¹æ¡†
      textStyle: {
        color: '#E5E5E5'  // é«˜å¯¹æ¯”åº¦æ–‡å­—
      }
    },
    // ... å…¶ä»–é…ç½®
  };

  return baseOption;
};
```

#### æ–¹æ¡ˆ D: å»¶è¿Ÿåˆå§‹åŒ–å›¾è¡¨

```typescript
// ç¡®ä¿å®¹å™¨å·²æ¸²æŸ“åå†åˆå§‹åŒ–
onMounted(async () => {
  if (!props.lazy) {
    await nextTick();  // ç­‰å¾… DOM æ›´æ–°
    await page.waitForTimeout(100);  // é¢å¤–ç­‰å¾…ç¡®ä¿å®¹å™¨æœ‰å°ºå¯¸
    initChart();
  }
});
```

### é¢„é˜²æªæ–½

1. **ç‰ˆæœ¬é”å®š**: åœ¨ package.json ä¸­é”å®š ECharts ç‰ˆæœ¬
2. **å°ºå¯¸æ£€æŸ¥**: åˆå§‹åŒ–å‰æ£€æŸ¥å®¹å™¨å°ºå¯¸
3. **é”™è¯¯å¤„ç†**: æ·»åŠ  try-catch æ•è·åˆå§‹åŒ–é”™è¯¯
4. **é™çº§æ–¹æ¡ˆ**: æä¾›é™æ€å›¾è¡¨ä½œä¸ºé™çº§é€‰é¡¹

---

## Design Token æœªåŠ è½½

### ç—‡çŠ¶æè¿°

é¡µé¢æ ·å¼ä¸ºé»˜è®¤å€¼ï¼Œæ²¡æœ‰åº”ç”¨ Bloomberg é‡‘è‰²ä¸»é¢˜ï¼Œæµ‹è¯•æç¤º CSS å˜é‡æœªå®šä¹‰

### å¯èƒ½åŸå› 

1. **theme-tokens.scss æœªå¯¼å…¥**: ç»„ä»¶ä¸­ç¼ºå°‘ @import è¯­å¥
2. **è·¯å¾„é”™è¯¯**: @import è·¯å¾„ä¸æ­£ç¡®
3. **æ„å»ºé…ç½®é”™è¯¯**: Vite æœªæ­£ç¡®å¤„ç† SCSS æ–‡ä»¶
4. **CSS åŠ è½½é¡ºåº**: theme-tokens.scss åœ¨å…¶ä»–æ ·å¼ä¹‹ååŠ è½½

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æ£€æŸ¥ theme-tokens.scss æ–‡ä»¶
ls -la src/styles/theme-tokens.scss

# 2. éªŒè¯æ–‡ä»¶å†…å®¹
head -20 src/styles/theme-tokens.scss
# åº”åŒ…å«: --color-accent: #D4AF37;

# 3. æ£€æŸ¥ç»„ä»¶å¯¼å…¥
grep -r "@import.*theme-tokens" src/views/
grep -r "@import.*theme-tokens" src/components/

# 4. åœ¨æµè§ˆå™¨ä¸­æ£€æŸ¥ CSS å˜é‡
# æ‰“å¼€ http://localhost:8080
# Console:
getComputedStyle(document.documentElement).getPropertyValue('--color-accent')
# åº”è¿”å›: #D4AF37
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: æ·»åŠ ç¼ºå¤±çš„ @import

```vue
<!-- åœ¨æ¯ä¸ªç»„ä»¶çš„ <style> æ ‡ç­¾é¡¶éƒ¨æ·»åŠ  -->
<style scoped lang="scss">
// Phase 3.3: Design Token Migration
@import '@/styles/theme-tokens.scss';

// åŸæœ‰æ ·å¼...
</style>
```

#### æ–¹æ¡ˆ B: ä¿®å¤è·¯å¾„åˆ«å

```javascript
// vite.config.js
export default defineConfig({
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src'),
      // ç¡®ä¿ @ åˆ«åæ­£ç¡®é…ç½®
    },
  },
});
```

#### æ–¹æ¡ˆ C: æ£€æŸ¥æ„å»ºäº§ç‰©

```bash
# 1. æ¸…ç†å¹¶é‡æ–°æ„å»º
rm -rf dist
npm run build

# 2. æ£€æŸ¥æ„å»ºäº§ç‰©ä¸­çš„ CSS
grep -r "color-accent" dist/assets/*.css

# 3. æ£€æŸ¥ CSS æ˜¯å¦åŒ…å« Design Token
grep "color-accent" dist/assets/index-*.css | head -5
```

### é¢„é˜²æªæ–½

1. **ESLint è§„åˆ™**: æ·»åŠ è§„åˆ™æ£€æŸ¥æ‰€æœ‰ Vue æ–‡ä»¶åŒ…å« @import
2. **æ„å»ºæ£€æŸ¥**: åœ¨æ„å»ºè„šæœ¬ä¸­éªŒè¯ Design Token å­˜åœ¨
3. **è‡ªåŠ¨åŒ–æµ‹è¯•**: ä½¿ç”¨ Playwright è‡ªåŠ¨æ£€æŸ¥ CSS å˜é‡

---

## ç§»åŠ¨ç«¯ä»£ç æ®‹ç•™

### ç—‡çŠ¶æè¿°

æµ‹è¯•å¤±è´¥ï¼Œæç¤ºå‘ç°ç§»åŠ¨ç«¯ @media æŸ¥è¯¢æˆ– el-col-xs ç»„ä»¶

### å¯èƒ½åŸå› 

1. **ä»£ç æœªæ¸…ç†**: æ—§çš„å“åº”å¼ä»£ç æœªåˆ é™¤
2. **Element Plus é»˜è®¤æ ·å¼**: ç»„ä»¶åº“è‡ªå¸¦çš„å“åº”å¼ç±»
3. **å…¨å±€æ ·å¼æ±¡æŸ“**: å…¨å±€ CSS åŒ…å«ç§»åŠ¨ç«¯åª’ä½“æŸ¥è¯¢
4. **ç»„ä»¶ç»§æ‰¿**: ç»„ä»¶ç»§æ‰¿äº†ç§»åŠ¨ç«¯æ ·å¼

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æœç´¢ç§»åŠ¨ç«¯åª’ä½“æŸ¥è¯¢
grep -r "@media.*max-width.*768" src/
grep -r "@media.*max-width.*375" src/

# 2. æœç´¢ Element Plus ç§»åŠ¨ç«¯ç»„ä»¶
grep -r "el-col-xs" src/
grep -r "el-col-sm" src/

# 3. æ£€æŸ¥å…¨å±€æ ·å¼
grep -r "@media" src/styles/

# 4. ä½¿ç”¨ Playwright æ£€æŸ¥
npm run test:mobile-cleanup
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: åˆ é™¤ç§»åŠ¨ç«¯åª’ä½“æŸ¥è¯¢

```scss
// åˆ é™¤ç±»ä¼¼çš„ä»£ç 
@media (max-width: 768px) {
  .container {
    padding: 8px;  // åˆ é™¤è¿™äº›
  }
}

// æ›¿æ¢ä¸ºæ¡Œé¢ä¸“ç”¨æ³¨é‡Š
// ============================================
//   DESIGN NOTE - è®¾è®¡è¯´æ˜
//   æœ¬é¡¹ç›®ä»…æ”¯æŒæ¡Œé¢ç«¯ï¼Œä¸åŒ…å«ç§»åŠ¨ç«¯å“åº”å¼ä»£ç 
// ============================================
```

#### æ–¹æ¡ˆ B: ç§»é™¤ Element Plus ç§»åŠ¨ç«¯ç±»

```vue
<!-- æ›¿æ¢ -->
<el-col :xs="24" :sm="12" :md="8">
  <!-- å†…å®¹ -->
</el-col>

<!-- ä¸º -->
<el-col :span="8">
  <!-- å†…å®¹ -->
</el-col>

<!-- æˆ–å®Œå…¨ä¸ä½¿ç”¨ el-colï¼Œä½¿ç”¨è‡ªå®šä¹‰å¸ƒå±€ -->
<div class="grid-item">
  <!-- å†…å®¹ -->
</div>
```

#### æ–¹æ¡ˆ C: é…ç½® Element Plus ç¦ç”¨å“åº”å¼

```javascript
// main.js æˆ– app.js
import ElementPlus from 'element-plus'

app.use(ElementPlus, {
  // ç¦ç”¨å“åº”å¼ç±»åå‰ç¼€ï¼ˆå¦‚æœ Element Plus æ”¯æŒï¼‰
  size: 'large',  // ç»Ÿä¸€ä½¿ç”¨å¤§å°ºå¯¸ï¼ˆæ¡Œé¢ï¼‰
  zIndex: 3000,
})
```

### é¢„é˜²æªæ–½

1. **Pre-commit Hook**: æ·»åŠ  Git Hook é˜»æ­¢æäº¤ç§»åŠ¨ç«¯ä»£ç 
2. **ESLint è§„åˆ™**: æ·»åŠ è§„åˆ™æ£€æµ‹ @media æŸ¥è¯¢
3. **ä»£ç å®¡æŸ¥**: äººå·¥å®¡æŸ¥æ‰€æœ‰æ–°å¢ä»£ç 

---

## ä¸­å›½è‚¡å¸‚é¢œè‰²é”™è¯¯

### ç—‡çŠ¶æè¿°

ä¸Šæ¶¨æ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œä¸‹è·Œæ˜¾ç¤ºä¸ºçº¢è‰²ï¼ˆè¥¿æ–¹é£æ ¼ï¼‰ï¼Œæˆ–é¢œè‰²æœªæ­£ç¡®åº”ç”¨

### å¯èƒ½åŸå› 

1. **é¢œè‰²å˜é‡é”™è¯¯**: --color-stock-down å’Œ --color-stock-up å®šä¹‰é”™è¯¯
2. **æ¡ä»¶åˆ¤æ–­é”™è¯¯**: æ­£è´Ÿåˆ¤æ–­é€»è¾‘é”™è¯¯
3. **CSS ç±»åé”™è¯¯**: positive/negative ç±»åº”ç”¨é”™è¯¯
4. **ç¬¬ä¸‰æ–¹ç»„ä»¶**: ç¬¬ä¸‰æ–¹å›¾è¡¨åº“ä½¿ç”¨é»˜è®¤é¢œè‰²

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æ£€æŸ¥ Design Token å®šä¹‰
grep "color-stock" src/styles/theme-tokens.scss

# 2. åœ¨æµè§ˆå™¨ä¸­éªŒè¯
# Console:
getComputedStyle(document.documentElement).getPropertyValue('--color-stock-down')
# åº”è¿”å›: #EB4436 (çº¢)

getComputedStyle(document.documentElement).getPropertyValue('--color-stock-up')
# åº”è¿”å›: #10B981 (ç»¿)

# 3. æ£€æŸ¥å®é™…åº”ç”¨
# æ‰“å¼€ http://localhost:8080/stocks
# æ‰¾åˆ°æ˜¾ç¤ºæ¶¨å¹…çš„å…ƒç´ 
# æ£€æŸ¥å…¶ computed color æ˜¯å¦ä¸ºçº¢è‰²
```

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: ä¿®æ­£ Design Token å®šä¹‰

```scss
// src/styles/theme-tokens.scss
:root {
  // ä¸­å›½è‚¡å¸‚é¢œè‰²: çº¢æ¶¨ç»¿è·Œ
  --color-stock-down: #EB4436;  // çº¢è‰² (ä¸Šæ¶¨)
  --color-stock-up: #10B981;    // ç»¿è‰² (ä¸‹è·Œ)

  // ç¡®ä¿ä¸æ˜¯è¥¿æ–¹é£æ ¼:
  // --color-stock-up: #EB4436;  // é”™è¯¯! (è¿™æ˜¯è¥¿æ–¹é£æ ¼)
  // --color-stock-down: #10B981; // é”™è¯¯!
}
```

#### æ–¹æ¡ˆ B: ä¿®æ­£æ¡ä»¶åˆ¤æ–­é€»è¾‘

```vue
<!-- Stocks.vue æˆ–ç±»ä¼¼ç»„ä»¶ -->
<template>
  <span :class="getChangeClass(row.change_pct)">
    {{ row.change_pct }}%
  </span>
</template>

<script setup lang="ts">
const getChangeClass = (value: number | string | null | undefined) => {
  if (value === null || value === undefined || value === '--') return ''

  const numValue = typeof value === 'string' ? parseFloat(value) : value

  // æ­£ç¡®çš„ä¸­å›½è‚¡å¸‚åˆ¤æ–­: çº¢æ¶¨ç»¿è·Œ
  return numValue > 0 ? 'positive' : numValue < 0 ? 'negative' : ''
}
</script>

<style scoped lang="scss">
.positive {
  color: var(--color-stock-down);  // çº¢è‰² (ä¸Šæ¶¨)
}

.negative {
  color: var(--color-stock-up);    // ç»¿è‰² (ä¸‹è·Œ)
}
</style>
```

#### æ–¹æ¡ˆ C: ECharts é…ç½®ä¿®æ­£

```typescript
// ECharts ä¸­å›½è‚¡å¸‚é¢œè‰²é…ç½®
const chartOption = {
  series: [{
    type: 'line',
    itemStyle: {
      color: (params) => {
        // ä¸Šæ¶¨ä¸ºçº¢è‰²
        return params.value >= 0 ? '#EB4436' : '#10B981'
      }
    },
    areaStyle: {
      color: (params) => {
        // é¢ç§¯å›¾é¢œè‰²
        return params.value >= 0 ? 'rgba(235, 68, 54, 0.3)' : 'rgba(16, 185, 129, 0.3)'
      }
    }
  }]
}
```

### é¢„é˜²æªæ–½

1. **è§†è§‰æµ‹è¯•**: æ·»åŠ æˆªå›¾æµ‹è¯•éªŒè¯è‚¡ç¥¨é¢œè‰²
2. **æ•°æ®æµ‹è¯•**: ä½¿ç”¨æµ‹è¯•æ•°æ®éªŒè¯æ­£è´Ÿæ˜¾ç¤º
3. **æ–‡æ¡£è¯´æ˜**: åœ¨ä»£ç æ³¨é‡Šä¸­è¯´æ˜"çº¢æ¶¨ç»¿è·Œ"

---

## é™„å½•ï¼šå¿«é€Ÿè¯Šæ–­å‘½ä»¤

### ä¸€é”®è¯Šæ–­è„šæœ¬

```bash
#!/bin/bash

echo "=== MyStocks Phase 3 æµ‹è¯•è¯Šæ–­ ==="

echo ""
echo "[1/6] æ£€æŸ¥ PM2 æœåŠ¡çŠ¶æ€"
pm2 list | grep mystocks-frontend

echo ""
echo "[2/6] æ£€æŸ¥ç«¯å£ç›‘å¬"
lsof -i :8080 || echo "ç«¯å£ 8080 æœªç›‘å¬"

echo ""
echo "[3/6] æ£€æŸ¥æ„å»ºäº§ç‰©"
ls -lh dist/index.html

echo ""
echo "[4/6] æ£€æŸ¥ Design Token"
curl -s http://localhost:8080 | grep -o "color-accent" | head -1

echo ""
echo "[5/6] æ£€æŸ¥ ECharts åŠ è½½"
curl -s http://localhost:8080 | grep -o "echarts" | head -1

echo ""
echo "[6/6] æ£€æŸ¥é”™è¯¯æ—¥å¿—"
tail -20 logs/pm2-error.log

echo ""
echo "=== è¯Šæ–­å®Œæˆ ==="
```

ä¿å­˜ä¸º `diagnose.sh`ï¼Œè¿è¡Œ `bash diagnose.sh` è¿›è¡Œå¿«é€Ÿè¯Šæ–­ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-01-10
**é€‚ç”¨åœºæ™¯**: MyStocks Phase 3 Bloomberg Terminal é£æ ¼ç»Ÿä¸€åŒ–æµ‹è¯•
