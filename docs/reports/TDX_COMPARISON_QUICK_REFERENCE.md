# TDX功能对比快速参考

**对比**: PyTDX vs MyStocks 当前实现
**生成时间**: 2026-01-02

---

## 📊 一图看懂差距

```
┌──────────────────────────────────────────────────────────────┐
│                    数据能力对比雷达图                        │
├──────────────────────────────────────────────────────────────┤
│                                                               │
│     实时行情   ████████████████████████████████ 100%        │
│     K线数据    ███████████████████████░░░░░░░░  60%        │
│     财务数据    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%  ⚠️   │
│     除权除息    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%  ⚠️   │
│     公司信息    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%  ⚠️   │
│     板块数据    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%  ⚠️   │
│     分时数据    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%  ⚠️   │
│     分笔成交    ░░░░░░░░░░░░░░░░░░░░░░░░░░░░   0%  ⚠️   │
│                                                               │
│     当前覆盖率: 30% → 目标: 95%                             │
└──────────────────────────────────────────────────────────────┘
```

---

## 🎯 核心差距一览

### ❌ 完全缺失的功能 (6大模块)

| 功能模块 | PyTDX支持 | MyStocks | 优先级 | 实施难度 |
|---------|----------|----------|--------|---------|
| 💰 **财务数据** | ✅ 15+指标 | ❌ 无 | 🔴 P1 | ⭐⭐ 中等 |
| 📈 **除权除息** | ✅ 完整历史 | ❌ 无 | 🔴 P1 | ⭐⭐ 中等 |
| 🏢 **公司信息** | ✅ 16大类 | ❌ 无 | 🟡 P2 | ⭐⭐⭐ 较高 |
| 📊 **板块数据** | ✅ 4种类型 | ❌ 无 | 🔴 P0 | ⭐ 简单 |
| ⏰ **分时数据** | ✅ 支持 | ❌ 无 | 🟡 P2 | ⭐⭐⭐ 较高 |
| 🔔 **分笔成交** | ✅ 支持 | ❌ 无 | 🟡 P2 | ⭐⭐⭐ 较高 |

### ⚠️ 部分支持的功能

| 功能 | PyTDX支持 | MyStocks | 差距说明 |
|------|----------|----------|----------|
| **K线周期** | ✅ 10种 | ⚠️ 6种 | 缺少周/月/季/年线 |
| **股票列表** | ✅ 完整 | ⚠️ 有限 | 功能较弱 |

---

## 🚀 快速实施路线图

### 阶段1: 低垂果实 (2-3小时)

**目标**: 快速提升数据覆盖率到50%

1. **扩展K线周期** (+4种)
   ```python
   # 只需修改 period_map
   '1w': 5,   # 周线
   '1M': 6,   # 月线
   '1q': 10,  # 季线
   '1y': 11   # 年线
   ```

2. **板块数据支持** (+4种)
   ```python
   # 复制 block_reader.py
   from pytdx.reader.block_reader import BlockReader
   ```

**预期收益**:
- ✅ 覆盖率: 30% → 50%
- ✅ 支持: 长期投资策略、板块轮动策略

---

### 阶段2: 核心功能 (5-6小时)

**目标**: 提升数据覆盖率到80%

3. **财务数据** (+15指标)
   ```python
   api.get_finance_info(market, code)
   # 返回: 总股本、每股收益、每股净资产等15+指标
   ```

4. **除权除息** (+历史记录)
   ```python
   api.get_xdxr_info(market, code)
   # 返回: 分红、送股、配股历史
   ```

**预期收益**:
- ✅ 覆盖率: 50% → 80%
- ✅ 支持: 基本面分析、复权计算

---

### 阶段3: 高级功能 (8-10小时)

**目标**: 达到95%+覆盖率

5. **公司信息** (+16类别)
6. **分时数据** (+实时/历史)
7. **分笔成交** (+tick级别)

**预期收益**:
- ✅ 覆盖率: 80% → 95%
- ✅ 支持: 日内交易、主力追踪

---

## 📦 需要复制的文件 (3个核心文件)

```bash
# 从 /opt/iflow/tdxpy/ 复制到 MyStocks

src/data_sources/tdx_block_reader.py
  └── pytdx/reader/block_reader.py (板块数据)

src/data_sources/tdx_dividend_reader.py
  └── pytdx/reader/gbbq_reader.py (除权除息)

src/data_sources/tdx_params.py
  └── pytdx/params.py (参数常量参考)
```

---

## 💾 数据库路由策略

```
┌───────────────────────────────────────────────────────────┐
│                  数据类型 → 数据库映射                      │
├───────────────────────────────────────────────────────────┤
│  数据分类              │  目标数据库                      │
│  ──────────────       │  ────────────                    │
│  实时行情             │  PostgreSQL                      │
│  日线/周线/月线       │  PostgreSQL + TimescaleDB        │
│  分钟K线 (1m/5m...)   │  TDengine                        │
│  分时数据             │  TDengine                        │
│  分笔成交 (tick)      │  TDengine                        │
│  财务数据             │  PostgreSQL                      │
│  除权除息             │  PostgreSQL                      │
│  公司信息             │  PostgreSQL (缓存)              │
│  板块数据             │  PostgreSQL                      │
└───────────────────────────────────────────────────────────┘
```

**核心原则**:
- **高频数据** → TDengine (极致压缩)
- **低频数据** → PostgreSQL (ACID保证)
- **自动路由** → `DataStorageStrategy`

---

## ✅ 实施检查清单

### 第1周: K线周期 + 板块数据
- [ ] 修改 `src/adapters/tdx_adapter.py` 的 `period_map`
- [ ] 复制 `block_reader.py` 并适配
- [ ] 更新 `config/table_config.yaml`
- [ ] 测试新周期和板块数据

### 第2周: 财务 + 除权除息
- [ ] 实现 `get_financial_info()`
- [ ] 实现 `get_dividend_info()`
- [ ] 创建PostgreSQL表
- [ ] 测试财务和除权数据

### 第3-4周: 高级功能
- [ ] 实现公司信息16大类
- [ ] 实现分时数据
- [ ] 实现分笔成交
- [ ] 全面测试和优化

---

## 📈 预期最终效果

```
当前状态 (30%覆盖):
  ✅ 实时行情 + 6种K线周期 + 本地文件

目标状态 (95%覆盖):
  ✅ 实时行情 + 10种K线周期
  ✅ 财务数据 (15+指标)
  ✅ 除权除息 (全历史)
  ✅ 公司信息 (16大类)
  ✅ 板块数据 (4种类型)
  ✅ 分时数据 (实时+历史)
  ✅ 分笔成交 (tick级别)
  ✅ 本地文件 (.day/.lc5/.lc1)

核心指标提升:
  数据类型: 11种 → 30+种  (+173%)
  K线周期: 6种 → 10种    (+67%)
  覆盖率:   30% → 95%    (+217%)
```

---

## 📚 相关文档

- **完整实施计划**: `docs/reports/TDX_ENHANCEMENT_PLAN.md`
- **当前数据清单**: `docs/reports/TDX_DATA_INVENTORY.md`
- **PyTDX参考**: `/opt/iflow/tdxpy/data_catalog.md`
- **快速参考**: `/opt/iflow/tdxpy/data_quick_reference.md`

---

**文档维护**: MyStocks项目组
**最后更新**: 2026-01-02
