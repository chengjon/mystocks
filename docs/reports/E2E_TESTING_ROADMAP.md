# E2Eæµ‹è¯•è·¯çº¿å›¾ - PM2 + Playwrightå…¨è¦†ç›–æµ‹è¯•

**åˆ›å»ºæ—¶é—´**: 2026-01-08
**æµ‹è¯•èŒƒå›´**: 28ä¸ªä¸»è¦é¡µé¢
**æµ‹è¯•å·¥å…·**: PM2 + Playwright + Python

---

## æµ‹è¯•èŒƒå›´åˆ†ç±»

### âœ… å·²å®Œæˆæµ‹è¯• (1ä¸ªé¡µé¢)
- [x] PortfolioManagement.vue - æŠ•èµ„ç»„åˆç®¡ç†ï¼ˆå¥åº·åº¦é›·è¾¾å›¾ï¼‰

### ğŸ“‹ å¾…æµ‹è¯•é¡µé¢ (27ä¸ªé¡µé¢)

#### MainLayouté¡µé¢ (16ä¸ª)
1. Dashboard.vue - ä»ªè¡¨ç›˜
2. Analysis.vue - æ•°æ®åˆ†æ
3. IndustryConceptAnalysis.vue - è¡Œä¸šæ¦‚å¿µåˆ†æ
4. Stocks.vue - è‚¡ç¥¨ç®¡ç†
5. StockDetail.vue - è‚¡ç¥¨è¯¦æƒ…
6. TechnicalAnalysis.vue - æŠ€æœ¯åˆ†æ
7. IndicatorLibrary.vue - æŒ‡æ ‡åº“
8. TradeManagement.vue - äº¤æ˜“ç®¡ç†
9. TaskManagement.vue - ä»»åŠ¡ç®¡ç†
10. Settings.vue - ç³»ç»Ÿè®¾ç½®
11. OpenStockDemo.vue - OpenStockåŠŸèƒ½æ¼”ç¤º
12. PyprofilingDemo.vue - PyProfilingåŠŸèƒ½æ¼”ç¤º
13. FreqtradeDemo.vue - FreqtradeåŠŸèƒ½æ¼”ç¤º
14. StockAnalysisDemo.vue - Stock-AnalysisåŠŸèƒ½æ¼”ç¤º
15. TdxpyDemo.vue - pytdxåŠŸèƒ½æ¼”ç¤º
16. SmartDataSourceTest.vue - æ™ºèƒ½æ•°æ®æºæµ‹è¯•

#### MarketLayouté¡µé¢ (3ä¸ª)
17. Market.vue - å¸‚åœºè¡Œæƒ…
18. TdxMarket.vue - TDXè¡Œæƒ…
19. RealTimeMonitor.vue - å®æ—¶ç›‘æ§

#### DataLayouté¡µé¢ (5ä¸ª)
20. FundFlowPanel.vue - èµ„é‡‘æµå‘
21. ETFDataTable.vue - ETFè¡Œæƒ…
22. ChipRaceTable.vue - ç«ä»·æŠ¢ç­¹
23. LongHuBangTable.vue - é¾™è™æ¦œ
24. WencaiPanelV2.vue - é—®è´¢ç­›é€‰

#### RiskLayouté¡µé¢ (2ä¸ª)
25. RiskMonitor.vue - é£é™©ç›‘æ§
26. AnnouncementMonitor.vue - å…¬å‘Šç›‘æ§

#### StrategyLayouté¡µé¢ (2ä¸ª)
27. StrategyManagement.vue - ç­–ç•¥ç®¡ç†
28. BacktestAnalysis.vue - å›æµ‹åˆ†æ

---

## æµ‹è¯•ä¼˜å…ˆçº§

### P0 - æ ¸å¿ƒä¸šåŠ¡é¡µé¢ (é«˜ä¼˜å…ˆçº§)
è¿™äº›é¡µé¢æ˜¯ç³»ç»Ÿæ ¸å¿ƒåŠŸèƒ½ï¼Œéœ€è¦ä¼˜å…ˆæµ‹è¯•ï¼š

1. Dashboard.vue - ç”¨æˆ·å…¥å£ï¼Œä»ªè¡¨ç›˜
2. Market.vue - å¸‚åœºè¡Œæƒ…ï¼Œæ ¸å¿ƒåŠŸèƒ½
3. Stocks.vue - è‚¡ç¥¨ç®¡ç†ï¼Œæ ¸å¿ƒåŠŸèƒ½
4. StockDetail.vue - è‚¡ç¥¨è¯¦æƒ…ï¼Œæ ¸å¿ƒåŠŸèƒ½
5. RealTimeMonitor.vue - å®æ—¶ç›‘æ§ï¼Œæ ¸å¿ƒåŠŸèƒ½
6. RiskMonitor.vue - é£é™©ç›‘æ§ï¼Œæ ¸å¿ƒåŠŸèƒ½

### P1 - é‡è¦åŠŸèƒ½é¡µé¢ (ä¸­ä¼˜å…ˆçº§)
7. Analysis.vue - æ•°æ®åˆ†æ
8. TechnicalAnalysis.vue - æŠ€æœ¯åˆ†æ
9. IndustryConceptAnalysis.vue - è¡Œä¸šæ¦‚å¿µåˆ†æ
10. StrategyManagement.vue - ç­–ç•¥ç®¡ç†
11. BacktestAnalysis.vue - å›æµ‹åˆ†æ
12. TradeManagement.vue - äº¤æ˜“ç®¡ç†
13. TaskManagement.vue - ä»»åŠ¡ç®¡ç†
14. Settings.vue - ç³»ç»Ÿè®¾ç½®

### P2 - è¾…åŠ©åŠŸèƒ½é¡µé¢ (ä½ä¼˜å…ˆçº§)
15-28. Demoé¡µé¢å’Œå¸‚åœºæ•°æ®å­é¡µé¢

---

## æµ‹è¯•æ£€æŸ¥æ¸…å•

æ¯ä¸ªé¡µé¢çš„æµ‹è¯•åŒ…æ‹¬ï¼š

### åŸºç¡€æ£€æŸ¥ (å¿…åš)
- [ ] é¡µé¢å¯è®¿é—®æ€§ (URLå¯¼èˆªæˆåŠŸ)
- [ ] é¡µé¢æ ‡é¢˜å’Œå…ƒä¿¡æ¯
- [ ] å…³é”®å…ƒç´ å¯è§æ€§ (å¡ç‰‡ã€è¡¨æ ¼ã€æŒ‰é’®ç­‰)
- [ ] æ— JavaScripté”™è¯¯
- [ ] æ— ç½‘ç»œè¯·æ±‚å¤±è´¥ (4xx/5xx)

### åŠŸèƒ½æ£€æŸ¥ (æ ¹æ®é¡µé¢ç‰¹æ€§)
- [ ] è¡¨æ ¼æ•°æ®åŠ è½½
- [ ] å›¾è¡¨æ¸²æŸ“
- [ ] è¡¨å•äº¤äº’
- [ ] æŒ‰é’®å“åº”
- [ ] å¼¹çª—/å¯¹è¯æ¡†
- [ ] åˆ†é¡µ/æ’åº/ç­›é€‰

### ç”¨æˆ·ä½“éªŒæ£€æŸ¥
- [ ] é¡µé¢åŠ è½½é€Ÿåº¦ (< 3ç§’)
- [ ] å“åº”å¼å¸ƒå±€ (æ¡Œé¢ç«¯)
- [ ] æ–‡å­—å¯è¯»æ€§
- [ ] é¢œè‰²å¯¹æ¯”åº¦
- [ ] äº¤äº’åé¦ˆ (hover, activeçŠ¶æ€)

---

## PM2é…ç½®ç­–ç•¥

### æµ‹è¯•æœåŠ¡å‘½åè§„åˆ™
- `playwright-test-{page}` - å•é¡µé¢æµ‹è¯•
- `playwright-test-{layout}` - å¸ƒå±€çº§åˆ«æµ‹è¯•
- `playwright-test-all` - å…¨é‡å›å½’æµ‹è¯•

### æ—¥å¿—æ–‡ä»¶ä½ç½®
- æ ‡å‡†è¾“å‡º: `/var/log/pm2/playwright-{name}-out.log`
- é”™è¯¯è¾“å‡º: `/var/log/pm2/playwright-{name}-error.log`
- æµ‹è¯•æŠ¥å‘Š: `/tmp/{name}_report.json`
- æˆªå›¾è¯æ®: `/tmp/{name}_screenshot_{num}.png`

---

## æ‰§è¡Œè®¡åˆ’

### Phase 1: P0æ ¸å¿ƒé¡µé¢æµ‹è¯• (ä¼˜å…ˆ)
**æ—¶é—´ä¼°è®¡**: 6ä¸ªé¡µé¢ Ã— 30åˆ†é’Ÿ = 3å°æ—¶

**ç›®æ ‡**:
- ç¡®ä¿æ ¸å¿ƒåŠŸèƒ½å¯ç”¨
- å‘ç°å¹¶ä¿®å¤é˜»å¡æ€§é—®é¢˜
- å»ºç«‹æµ‹è¯•è„šæœ¬æ¨¡æ¿

### Phase 2: P1é‡è¦åŠŸèƒ½æµ‹è¯•
**æ—¶é—´ä¼°è®¡**: 8ä¸ªé¡µé¢ Ã— 20åˆ†é’Ÿ = 2.5å°æ—¶

**ç›®æ ‡**:
- è¦†ç›–ä¸»è¦ä¸šåŠ¡æµç¨‹
- éªŒè¯è·¨é¡µé¢å¯¼èˆª
- æµ‹è¯•æ•°æ®æµè½¬

### Phase 3: P2è¾…åŠ©åŠŸèƒ½æµ‹è¯•
**æ—¶é—´ä¼°è®¡**: 13ä¸ªé¡µé¢ Ã— 10åˆ†é’Ÿ = 2å°æ—¶

**ç›®æ ‡**:
- å…¨è¦†ç›–éªŒè¯
- æ”¶é›†UXé—®é¢˜
- å®Œå–„æµ‹è¯•æŠ¥å‘Š

---

## æµ‹è¯•è„šæœ¬æ¨¡æ¿

æ¯ä¸ªæµ‹è¯•è„šæœ¬åŒ…å«ï¼š

```python
import asyncio
from playwright.async_api import async_playwright
import json
from datetime import datetime

async def test_page():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        page = await browser.new_page()

        try:
            # 1. å¯¼èˆªåˆ°é¡µé¢
            await page.goto('http://localhost:3020/#/page-url')
            await page.wait_for_timeout(2000)

            # 2. åŸºç¡€æ£€æŸ¥
            title = await page.title()
            print(f"âœ… é¡µé¢æ ‡é¢˜: {title}")

            # 3. å…³é”®å…ƒç´ æ£€æŸ¥
            element = await page.query_selector('.key-selector')
            if element:
                is_visible = await element.is_visible()
                print(f"âœ… å…³é”®å…ƒç´ : {'å¯è§' if is_visible else 'ä¸å¯è§'}")

            # 4. åŠŸèƒ½æµ‹è¯• (æ ¹æ®é¡µé¢ç‰¹æ€§)
            # ...

            # 5. æˆªå›¾ä¿å­˜
            await page.screenshot(path=f'/tmp/page_screenshot.png')

            # 6. ç”ŸæˆæŠ¥å‘Š
            report = {
                'timestamp': datetime.now().isoformat(),
                'page': 'PageName',
                'status': 'passed',
                'checks': [...]
            }

            with open('/tmp/page_report.json', 'w') as f:
                json.dump(report, f, indent=2, ensure_ascii=False)

        except Exception as e:
            print(f"âŒ æµ‹è¯•å¤±è´¥: {str(e)}")
            # ä¿å­˜é”™è¯¯æˆªå›¾
            await page.screenshot(path=f'/tmp/page_error.png')

        finally:
            await browser.close()

if __name__ == '__main__':
    asyncio.run(test_page())
```

---

## é—®é¢˜è®°å½•å’Œä¿®å¤

### å‘ç°é—®é¢˜æ ¼å¼
- **é¡µé¢**: PageName.vue
- **é—®é¢˜**: é—®é¢˜æè¿°
- **ä¸¥é‡çº§åˆ«**: Critical/High/Medium/Low
- **å¤ç°æ­¥éª¤**: 1, 2, 3...
- **é¢„æœŸç»“æœ**: åº”è¯¥å¦‚ä½•
- **å®é™…ç»“æœ**: å®é™…å¦‚ä½•
- **ä¿®å¤æ–¹æ¡ˆ**: å¦‚ä½•ä¿®å¤
- **çŠ¶æ€**: Open/Fixed/Verified

### é—®é¢˜è·Ÿè¸ª
- æ‰€æœ‰é—®é¢˜è®°å½•åˆ° `/docs/reports/E2E_TEST_ISSUES.md`
- æ¯ä¸ªé—®é¢˜åŒ…å«ä¿®å¤å‰åå¯¹æ¯”
- ä¿®å¤åé‡æ–°æµ‹è¯•éªŒè¯

---

## æˆåŠŸæ ‡å‡†

### æµ‹è¯•å®Œæˆæ ‡å‡†
- [ ] æ‰€æœ‰28ä¸ªé¡µé¢è‡³å°‘æµ‹è¯•1æ¬¡
- [ ] P0é¡µé¢100%é€šè¿‡ç‡
- [ ] P1é¡µé¢ > 90%é€šè¿‡ç‡
- [ ] P2é¡µé¢ > 80%é€šè¿‡ç‡
- [ ] æ‰€æœ‰Critical/Highçº§åˆ«é—®é¢˜å·²ä¿®å¤

### è´¨é‡æ ‡å‡†
- [ ] æ— JavaScripté”™è¯¯
- [ ] æ— ç½‘ç»œè¯·æ±‚å¤±è´¥
- [ ] é¡µé¢åŠ è½½æ—¶é—´ < 3ç§’
- [ ] æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å¯ç”¨
- [ ] ç”¨æˆ·ä½“éªŒæµç•…

---

## æœ€ç»ˆäº¤ä»˜ç‰©

1. **æµ‹è¯•è„šæœ¬**: 28ä¸ªPlaywrightæµ‹è¯•è„šæœ¬
2. **PM2é…ç½®**: å®Œæ•´çš„æµ‹è¯•æœåŠ¡é…ç½®
3. **æµ‹è¯•æŠ¥å‘Š**: æ¯ä¸ªé¡µé¢çš„è¯¦ç»†æµ‹è¯•æŠ¥å‘Š
4. **é—®é¢˜æ¸…å•**: å‘ç°çš„æ‰€æœ‰é—®é¢˜å’Œä¿®å¤è®°å½•
5. **å®ŒæˆæŠ¥å‘Š**: æ€»ç»“æ€§æŠ¥å‘Šå’Œæ”¹è¿›å»ºè®®

---

**ä¸‹ä¸€æ­¥**: å¼€å§‹Phase 1 - P0æ ¸å¿ƒé¡µé¢æµ‹è¯•
