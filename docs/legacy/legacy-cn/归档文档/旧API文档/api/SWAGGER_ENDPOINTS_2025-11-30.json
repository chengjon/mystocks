[
  {
    "method": "POST",
    "path": "/fetch",
    "function": "fetch_announcements",
    "docstring": "从数据源获取并保存公告\n\nArgs:\nsymbol: 股票代码（可选）\nstart_date: 开始日期\nend_date: 结束日期\ncategory: 公告类别\n\nReturns:\nDict: 获取结果",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/list",
    "function": "get_announcements",
    "docstring": "查询公告列表\n\nArgs:\nstock_code: 股票代码\nstart_date: 开始日期\nend_date: 结束日期\nannouncement_type: 公告类型\nmin_importance: 最小重要性级别\npage: 页码\npage_size: 每页数量\n\nReturns:\nDict: 公告列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/today",
    "function": "get_today_announcements",
    "docstring": "获取今日公告\n\nArgs:\nmin_importance: 最小重要性级别\n\nReturns:\nDict: 今日公告列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/important",
    "function": "get_important_announcements",
    "docstring": "获取重要公告\n\nArgs:\ndays: 查询天数（默认7天）\nmin_importance: 最小重要性级别（默认3）\n\nReturns:\nDict: 重要公告列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/stock/{stock_code}",
    "function": "get_stock_announcements",
    "docstring": "获取指定股票的公告\n\nArgs:\nstock_code: 股票代码\ndays: 查询天数\n\nReturns:\nDict: 股票公告列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "POST",
    "path": "/monitor/evaluate",
    "function": "evaluate_monitor_rules",
    "docstring": "评估所有监控规则\n\n检查是否有新公告触发监控规则\n\nReturns:\nDict: 评估结果",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/stats",
    "function": "get_announcement_stats",
    "docstring": "获取公告统计信息\n\nReturns:\nAnnouncementStatsResponse: 统计信息",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/types",
    "function": "get_announcement_types",
    "docstring": "获取支持的公告类型\n\nReturns:\nDict: 公告类型列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/monitor-rules",
    "function": "get_monitor_rules",
    "docstring": "获取监控规则列表\n\nReturns:\nList: 监控规则列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "POST",
    "path": "/monitor-rules",
    "function": "create_monitor_rule",
    "docstring": "创建监控规则\n\nArgs:\nrule: 监控规则创建请求\n\nReturns:\nAnnouncementMonitorRuleResponse: 创建的规则",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "PUT",
    "path": "/monitor-rules/{rule_id}",
    "function": "update_monitor_rule",
    "docstring": "更新监控规则\n\nArgs:\nrule_id: 规则ID\nupdates: 更新内容\n\nReturns:\nAnnouncementMonitorRuleResponse: 更新后的规则",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "DELETE",
    "path": "/monitor-rules/{rule_id}",
    "function": "delete_monitor_rule",
    "docstring": "删除监控规则\n\nArgs:\nrule_id: 规则ID\n\nReturns:\nDict: 操作结果",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "GET",
    "path": "/triggered-records",
    "function": "get_triggered_records",
    "docstring": "获取触发记录列表\n\nArgs:\nrule_id: 规则ID\nstock_code: 股票代码\npage: 页码\npage_size: 每页数量\n\nReturns:\nDict: 触发记录列表",
    "file": "announcement.py",
    "module": "announcement"
  },
  {
    "method": "POST",
    "path": "/login",
    "function": "login_for_access_token",
    "docstring": "用户登录获取访问令牌\n支持 OAuth2 标准的 form data 格式",
    "file": "auth.py",
    "module": "auth"
  },
  {
    "method": "POST",
    "path": "/logout",
    "function": "logout",
    "docstring": "用户登出",
    "file": "auth.py",
    "module": "auth"
  },
  {
    "method": "GET",
    "path": "/me",
    "function": "read_users_me",
    "docstring": "获取当前用户信息",
    "file": "auth.py",
    "module": "auth"
  },
  {
    "method": "POST",
    "path": "/refresh",
    "function": "refresh_token",
    "docstring": "刷新访问令牌",
    "file": "auth.py",
    "module": "auth"
  },
  {
    "method": "GET",
    "path": "/users",
    "function": "get_users",
    "docstring": "获取用户列表（仅管理员）",
    "file": "auth.py",
    "module": "auth"
  },
  {
    "method": "WEBSOCKET",
    "path": "/backtest/{backtest_id}",
    "function": "websocket_backtest_progress",
    "docstring": "WebSocket endpoint for backtest progress updates\n\n订阅指定回测任务的进度更新",
    "file": "backtest_ws.py",
    "module": "backtest_ws"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_websocket_status",
    "docstring": "获取 WebSocket 连接状态\n\nReturns:\n当前活跃连接数",
    "file": "backtest_ws.py",
    "module": "backtest_ws"
  },
  {
    "method": "POST",
    "path": "/backup/tdengine/full",
    "function": "backup_tdengine_full",
    "docstring": "try:\nmetadata = backup_manager.backup_tdengine_full()\n\nreturn {\n\"success\": metadata.status == \"success\",\n\"backup_id\": metadata.backup_id,\n\"backup_type\": metadata.backup_type,\n\"database\": metadata.database,\n\"start_time\": metadata.start_time,\n\"end_time\": metadata.end_time,\n\"duration_seconds\": metadata.duration_seconds,\n\"tables_backed_up\": metadata.tables_backed_up,\n\"total_rows\": metadata.total_rows,\n\"backup_size_mb\": metadata.backup_size_bytes / 1024 / 1024,\n\"compression_ratio\": metadata.compression_ratio,\n\"status\": metadata.status,\n\"error_message\": metadata.error_message,\n}\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"Backup failed: {str(e)}\")\n\n\n@router.post(\"/backup/tdengine/incremental\")\nasync def backup_tdengine_incremental(\nsince_backup_id: str = Query(..., description=\"上次备份的 ID\")\n):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/backup/tdengine/incremental",
    "function": "backup_tdengine_incremental",
    "docstring": "try:\nmetadata = backup_manager.backup_tdengine_incremental(since_backup_id)\n\nreturn {\n\"success\": metadata.status == \"success\",\n\"backup_id\": metadata.backup_id,\n\"backup_type\": metadata.backup_type,\n\"since_backup_id\": since_backup_id,\n\"total_rows\": metadata.total_rows,\n\"backup_size_mb\": metadata.backup_size_bytes / 1024 / 1024,\n\"status\": metadata.status,\n\"error_message\": metadata.error_message,\n}\nexcept Exception as e:\nraise HTTPException(\nstatus_code=500, detail=f\"Incremental backup failed: {str(e)}\"\n)\n\n\n@router.post(\"/backup/postgresql/full\")\nasync def backup_postgresql_full():",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/backup/postgresql/full",
    "function": "backup_postgresql_full",
    "docstring": "try:\nmetadata = backup_manager.backup_postgresql_full()\n\nreturn {\n\"success\": metadata.status == \"success\",\n\"backup_id\": metadata.backup_id,\n\"backup_type\": metadata.backup_type,\n\"database\": metadata.database,\n\"start_time\": metadata.start_time,\n\"end_time\": metadata.end_time,\n\"duration_seconds\": metadata.duration_seconds,\n\"tables_backed_up\": len(metadata.tables_backed_up),\n\"total_rows\": metadata.total_rows,\n\"backup_size_mb\": metadata.backup_size_bytes / 1024 / 1024,\n\"compression_ratio\": metadata.compression_ratio,\n\"status\": metadata.status,\n\"error_message\": metadata.error_message,\n}\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"Backup failed: {str(e)}\")\n\n\n@router.get(\"/backups\")\nasync def list_backups(\ndatabase: Optional[str] = Query(\nNone, description=\"数据库类型 (tdengine/postgresql)\"\n),\nbackup_type: Optional[str] = Query(None, description=\"备份类型 (full/incremental)\"),\nstatus: Optional[str] = Query(None, description=\"备份状态 (success/failed)\"),\n):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "GET",
    "path": "/backups",
    "function": "list_backups",
    "docstring": "try:\nall_backups = backup_manager.get_backup_list()\n\n# 过滤\nfiltered_backups = [b for b in all_backups]\n\nif database:\nfiltered_backups = [b for b in filtered_backups if b.database == database]\nif backup_type:\nfiltered_backups = [\nb for b in filtered_backups if b.backup_type == backup_type\n]\nif status:\nfiltered_backups = [b for b in filtered_backups if b.status == status]\n\nreturn {\n\"total\": len(filtered_backups),\n\"backups\": [\n{\n\"backup_id\": b.backup_id,\n\"backup_type\": b.backup_type,\n\"database\": b.database,\n\"start_time\": b.start_time,\n\"end_time\": b.end_time,\n\"duration_seconds\": b.duration_seconds,\n\"total_rows\": b.total_rows,\n\"backup_size_mb\": b.backup_size_bytes / 1024 / 1024,\n\"compression_ratio\": b.compression_ratio,\n\"status\": b.status,\n}\nfor b in filtered_backups\n],\n}\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"Failed to list backups: {str(e)}\")\n\n\n# ==================== 恢复端点 ====================\n\n\n@router.post(\"/recovery/tdengine/full\")\nasync def restore_tdengine_full(\nbackup_id: str = Query(..., description=\"备份 ID\"),\ntarget_tables: Optional[List[str]] = Query(None, description=\"指定要恢复的表\"),\ndry_run: bool = Query(False, description=\"测试运行\"),\n):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/recovery/tdengine/full",
    "function": "restore_tdengine_full",
    "docstring": "try:\nsuccess, message = recovery_manager.restore_tdengine_from_full_backup(\nbackup_id,\ntarget_tables=target_tables,\ndry_run=dry_run,\n)\n\nif success:\nreturn {\n\"success\": True,\n\"backup_id\": backup_id,\n\"message\": message,\n\"dry_run\": dry_run,\n}\nelse:\nraise HTTPException(status_code=500, detail=message)\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"Recovery failed: {str(e)}\")\n\n\n@router.post(\"/recovery/tdengine/pitr\")\nasync def restore_tdengine_pitr(\ntarget_time: str = Query(..., description=\"目标恢复时间 (ISO 8601)\"),\ntarget_tables: Optional[List[str]] = Query(None, description=\"指定要恢复的表\"),\n):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/recovery/tdengine/pitr",
    "function": "restore_tdengine_pitr",
    "docstring": "try:\ntarget_dt = datetime.fromisoformat(target_time)\n\nsuccess, message = recovery_manager.restore_tdengine_point_in_time(\ntarget_dt,\ntarget_tables=target_tables,\n)\n\nif success:\nreturn {\n\"success\": True,\n\"target_time\": target_time,\n\"message\": message,\n}\nelse:\nraise HTTPException(status_code=500, detail=message)\n\nexcept ValueError as e:\nraise HTTPException(\nstatus_code=400, detail=f\"Invalid target_time format: {str(e)}\"\n)\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"PITR recovery failed: {str(e)}\")\n\n\n@router.post(\"/recovery/postgresql/full\")\nasync def restore_postgresql_full(\nbackup_id: str = Query(..., description=\"备份 ID\"),\ntarget_tables: Optional[List[str]] = Query(None, description=\"指定要恢复的表\"),\ndry_run: bool = Query(False, description=\"测试运行\"),\n):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/recovery/postgresql/full",
    "function": "restore_postgresql_full",
    "docstring": "try:\nsuccess, message = recovery_manager.restore_postgresql_from_full_backup(\nbackup_id,\ntarget_tables=target_tables,\ndry_run=dry_run,\n)\n\nif success:\nreturn {\n\"success\": True,\n\"backup_id\": backup_id,\n\"message\": message,\n\"dry_run\": dry_run,\n}\nelse:\nraise HTTPException(status_code=500, detail=message)\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"Recovery failed: {str(e)}\")\n\n\n@router.get(\"/recovery/objectives\")\nasync def get_recovery_objectives():",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "GET",
    "path": "/recovery/objectives",
    "function": "get_recovery_objectives",
    "docstring": "return recovery_manager.get_recovery_time_objective()\n\n\n# ==================== 调度端点 ====================\n\n\n@router.post(\"/scheduler/start\")\nasync def start_scheduler():",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/scheduler/start",
    "function": "start_scheduler",
    "docstring": "try:\nbackup_scheduler.start()\nreturn {\"success\": True, \"message\": \"Backup scheduler started\"}\nexcept Exception as e:\nraise HTTPException(\nstatus_code=500, detail=f\"Failed to start scheduler: {str(e)}\"\n)\n\n\n@router.post(\"/scheduler/stop\")\nasync def stop_scheduler():",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/scheduler/stop",
    "function": "stop_scheduler",
    "docstring": "try:\nbackup_scheduler.stop()\nreturn {\"success\": True, \"message\": \"Backup scheduler stopped\"}\nexcept Exception as e:\nraise HTTPException(\nstatus_code=500, detail=f\"Failed to stop scheduler: {str(e)}\"\n)\n\n\n@router.get(\"/scheduler/jobs\")\nasync def get_scheduled_jobs():",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "GET",
    "path": "/scheduler/jobs",
    "function": "get_scheduled_jobs",
    "docstring": "try:\njobs = backup_scheduler.get_scheduled_jobs()\nreturn {\n\"total_jobs\": len(jobs),\n\"jobs\": jobs,\n}\nexcept Exception as e:\nraise HTTPException(\nstatus_code=500, detail=f\"Failed to get scheduled jobs: {str(e)}\"\n)\n\n\n# ==================== 完整性检查端点 ====================\n\n\n@router.get(\"/integrity/verify/{backup_id}\")\nasync def verify_backup_integrity(backup_id: str):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "GET",
    "path": "/integrity/verify/{backup_id}",
    "function": "verify_backup_integrity",
    "docstring": "try:\n# 加载元数据\nmetadata = backup_manager._load_metadata(backup_id)\n\nif not metadata:\nraise HTTPException(\nstatus_code=404, detail=f\"Backup not found: {backup_id}\"\n)\n\n# 验证恢复后的数据完整性\nif metadata[\"database\"] == \"tdengine\":\nis_valid, details = integrity_checker.verify_tdengine_recovery(\nmetadata,\nmetadata[\"total_rows\"],\n)\nelif metadata[\"database\"] == \"postgresql\":\nis_valid, details = integrity_checker.verify_postgresql_recovery(\nmetadata,\nmetadata[\"total_rows\"],\n)\nelse:\nraise HTTPException(\nstatus_code=400, detail=f\"Unknown database: {metadata['database']}\"\n)\n\n# 生成报告\nreport_file = integrity_checker.generate_integrity_report(\nbackup_id,\n{\"is_valid\": is_valid, **details},\n)\n\nreturn {\n\"backup_id\": backup_id,\n\"is_valid\": is_valid,\n\"details\": details,\n\"report_file\": str(report_file),\n}\n\nexcept HTTPException:\nraise\nexcept Exception as e:\nraise HTTPException(\nstatus_code=500, detail=f\"Integrity verification failed: {str(e)}\"\n)\n\n\n@router.post(\"/cleanup/old-backups\")\nasync def cleanup_old_backups(retention_days: int = Query(30, description=\"保留天数\")):",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "POST",
    "path": "/cleanup/old-backups",
    "function": "cleanup_old_backups",
    "docstring": "",
    "file": "backup_recovery.py",
    "module": "backup_recovery"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_cache_status",
    "docstring": "获取缓存统计信息\n\nReturns:\n缓存统计信息，包含:\n- hit_rate: 缓存命中率\n- cache_hits: 命中次数\n- cache_misses: 未命中次数\n- total_reads: 总读取次数\n- total_writes: 总写入次数\n- timestamp: 统计时间戳\n\nExamples:\nGET /api/cache/status\nResponse:\n{\n\"success\": true,\n\"timestamp\": \"2025-11-06T12:34:56.789Z\",\n\"data\": {\n\"total_reads\": 1000,\n\"total_writes\": 500,\n\"cache_hits\": 850,\n\"cache_misses\": 150,\n\"hit_rate\": 0.85,\n\"hit_rate_percent\": \"85.0%\",\n...\n}\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/{symbol}/{data_type}",
    "function": "get_cached_data",
    "docstring": "读取特定的缓存数据\n\nArgs:\nsymbol: 股票代码 (e.g., \"000001\")\ndata_type: 数据类型 (e.g., \"fund_flow\", \"etf\", \"chip_race\")\ntimeframe: 时间维度 (可选，e.g., \"1d\", \"3d\")\n\nReturns:\n缓存数据（如果存在），或错误信息\n\nExamples:\nGET /api/cache/000001/fund_flow\nGET /api/cache/000001/etf?timeframe=1d\n\nResponse (缓存命中):\n{\n\"success\": true,\n\"source\": \"cache\",\n\"timestamp\": \"2025-11-06T...\",\n\"data\": {\n\"main_net_inflow\": 10000,\n...\n}\n}\n\nResponse (缓存未命中):\n{\n\"success\": false,\n\"message\": \"缓存未找到\",\n\"data\": null\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "POST",
    "path": "/{symbol}/{data_type}",
    "function": "write_cache_data",
    "docstring": "写入或更新缓存数据\n\nArgs:\nsymbol: 股票代码\ndata_type: 数据类型\ndata: 要缓存的数据对象\ntimeframe: 时间维度 (可选)\nttl_days: 缓存生存时间 (天数，默认7天)\n\nReturns:\n写入结果\n\nExamples:\nPOST /api/cache/000001/fund_flow\nBody:\n{\n\"data\": {\n\"main_net_inflow\": 10000,\n\"rate\": 0.5\n},\n\"timeframe\": \"1d\",\n\"ttl_days\": 1\n}\n\nResponse:\n{\n\"success\": true,\n\"message\": \"缓存写入成功\",\n\"symbol\": \"000001\",\n\"data_type\": \"fund_flow\",\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "DELETE",
    "path": "/{symbol}",
    "function": "invalidate_symbol_cache",
    "docstring": "清除特定符号的缓存\n\nArgs:\nsymbol: 股票代码\n\nReturns:\n清除结果\n\nExamples:\nDELETE /api/cache/000001\n\nResponse:\n{\n\"success\": true,\n\"message\": \"缓存已清除\",\n\"symbol\": \"000001\",\n\"deleted_count\": 3,\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "DELETE",
    "path": "",
    "function": "clear_all_cache",
    "docstring": "清除所有缓存 (需要确认)\n\nArgs:\nconfirm: 确认标志，必须为True才能执行清除\n\nReturns:\n清除结果\n\nExamples:\nDELETE /api/cache?confirm=true\n\nResponse:\n{\n\"success\": true,\n\"message\": \"所有缓存已清除\",\n\"deleted_count\": 100,\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/{symbol}/{data_type}/fresh",
    "function": "check_cache_freshness",
    "docstring": "检查缓存是否新鲜（有效且未过期）\n\nArgs:\nsymbol: 股票代码\ndata_type: 数据类型\nmax_age_days: 最大缓存年龄（天）\n\nReturns:\n缓存新鲜度检查结果\n\nExamples:\nGET /api/cache/000001/fund_flow/fresh\n\nResponse:\n{\n\"success\": true,\n\"symbol\": \"000001\",\n\"data_type\": \"fund_flow\",\n\"is_fresh\": true,\n\"max_age_days\": 7,\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "POST",
    "path": "/evict/manual",
    "function": "manual_cache_eviction",
    "docstring": "手动触发缓存淘汰任务\n\nReturns:\n淘汰结果，包含:\n- success: 操作成功标志\n- message: 操作消息\n- deleted_count: 删除的缓存条数\n- timestamp: 操作时间戳\n\nExamples:\nPOST /api/cache/evict/manual\n\nResponse:\n{\n\"success\": true,\n\"message\": \"缓存淘汰成功\",\n\"deleted_count\": 150,\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/eviction/stats",
    "function": "get_eviction_statistics",
    "docstring": "获取缓存淘汰策略统计信息\n\nReturns:\n淘汰策略统计，包含:\n- ttl_days: TTL天数\n- frequency_tracking: 访问频率追踪统计\n- hot_data: 热点数据列表\n- cache_stats: 缓存统计\n- timestamp: 统计时间戳\n\nExamples:\nGET /api/cache/eviction/stats\n\nResponse:\n{\n\"success\": true,\n\"data\": {\n\"ttl_days\": 7,\n\"frequency_tracking\": {\n\"total_tracked\": 100,\n\"total_accesses\": 5000,\n\"average_frequency\": 50.0\n},\n\"hot_data\": [\n{\n\"cache_key\": \"000001:fund_flow:1d\",\n\"access_count\": 500,\n\"last_access\": \"2025-11-06T...\"\n}\n],\n\"cache_stats\": {\n\"hit_rate\": 0.85,\n\"cache_hits\": 850,\n\"cache_misses\": 150\n}\n},\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "POST",
    "path": "/prewarming/trigger",
    "function": "trigger_cache_prewarming",
    "docstring": "触发缓存预热任务\n\nReturns:\n预热结果，包含:\n- success: 操作成功标志\n- prewarmed_count: 预热的缓存条数\n- failed_count: 失败的缓存条数\n- elapsed_seconds: 预热耗时\n\nExamples:\nPOST /api/cache/prewarming/trigger\n\nResponse:\n{\n\"success\": true,\n\"message\": \"缓存预热成功\",\n\"prewarmed_count\": 20,\n\"failed_count\": 0,\n\"elapsed_seconds\": 2.5,\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/prewarming/status",
    "function": "get_prewarming_status",
    "docstring": "获取缓存预热状态\n\nReturns:\n预热状态信息，包含:\n- last_prewarming: 最后预热时间\n- prewarmed_keys_count: 已预热的缓存键数\n\nExamples:\nGET /api/cache/prewarming/status\n\nResponse:\n{\n\"success\": true,\n\"data\": {\n\"last_prewarming\": \"2025-11-06T12:00:00.000000\",\n\"prewarmed_keys_count\": 20\n},\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/monitoring/metrics",
    "function": "get_cache_monitoring_metrics",
    "docstring": "获取缓存监控指标\n\nReturns:\n缓存性能指标，包含:\n- hit_rate: 命中率\n- hit_count: 命中次数\n- miss_count: 未命中次数\n- average_latency_ms: 平均延迟（毫秒）\n- health_status: 健康状态\n\nExamples:\nGET /api/cache/monitoring/metrics\n\nResponse:\n{\n\"success\": true,\n\"data\": {\n\"hit_count\": 850,\n\"miss_count\": 150,\n\"hit_rate\": 85.0,\n\"average_latency_ms\": 2.5,\n\"health_status\": \"healthy\"\n},\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/monitoring/health",
    "function": "get_cache_health_status",
    "docstring": "获取缓存系统健康状态\n\nReturns:\n缓存系统健康状态，包含:\n- status: 健康状态 (healthy/warning/critical)\n- hit_rate: 命中率\n- metrics: 详细指标\n\nExamples:\nGET /api/cache/monitoring/health\n\nResponse:\n{\n\"success\": true,\n\"status\": \"healthy\",\n\"hit_rate\": 85.0,\n\"message\": \"缓存系统运行正常，命中率 85.0%\",\n\"timestamp\": \"2025-11-06T...\"\n}",
    "file": "cache.py",
    "module": "cache"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "",
    "file": "dashboard.py",
    "module": "dashboard"
  },
  {
    "method": "GET",
    "path": "/stocks/basic",
    "function": "get_stocks_basic",
    "docstring": "获取股票基本信息列表 - 支持行业/概念筛选、行情排序和分页",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/industries",
    "function": "get_stocks_industries",
    "docstring": "获取所有行业分类列表（用于股票列表筛选）",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/concepts",
    "function": "get_stocks_concepts",
    "docstring": "获取所有概念分类列表（用于股票列表筛选）",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/daily",
    "function": "get_daily_kline",
    "docstring": "获取股票日线数据",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/markets/overview",
    "function": "get_market_overview",
    "docstring": "获取市场概览数据",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/search",
    "function": "search_stocks",
    "docstring": "股票搜索接口",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/kline",
    "function": "get_kline",
    "docstring": "获取股票K线数据（stocks/daily的别名）",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/kline",
    "function": "get_kline_data",
    "docstring": "获取股票K线数据（标准化接口，符合cmd5规范）",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/financial",
    "function": "get_financial_data",
    "docstring": "获取股票财务数据\n\n**报表类型**:\n- balance: 资产负债表\n- income: 利润表\n- cashflow: 现金流量表\n\n**数据源**: AkShare财务数据",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/markets/price-distribution",
    "function": "get_price_distribution",
    "docstring": "获取全市场涨跌分布统计\n返回上涨>5%、上涨0-5%、平盘、下跌0-5%、下跌>5%的股票数量",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/markets/hot-industries",
    "function": "get_hot_industries",
    "docstring": "获取热门行业TOP5表现数据",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/markets/hot-concepts",
    "function": "get_hot_concepts",
    "docstring": "获取热门概念TOP5表现数据",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/intraday",
    "function": "get_intraday_data",
    "docstring": "获取股票分时数据（用于分时图显示）",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/{symbol}/detail",
    "function": "get_stock_detail",
    "docstring": "获取股票详细信息（包含行业概念标签）",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/stocks/{symbol}/trading-summary",
    "function": "get_trading_summary",
    "docstring": "获取股票历史交易摘要统计",
    "file": "data.py",
    "module": "data"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "check_system_health",
    "docstring": "系统健康检查API端点\n\n返回系统各个组件的健康状态",
    "file": "health.py",
    "module": "health"
  },
  {
    "method": "GET",
    "path": "/health/detailed",
    "function": "detailed_health_check",
    "docstring": "详细健康检查\n\n返回系统各个组件的详细健康状态",
    "file": "health.py",
    "module": "health"
  },
  {
    "method": "GET",
    "path": "/reports/health/{timestamp}",
    "function": "get_health_report",
    "docstring": "获取健康检查报告\n\n参数:\n- timestamp: 报告时间戳",
    "file": "health.py",
    "module": "health"
  },
  {
    "method": "GET",
    "path": "/registry",
    "function": "get_indicator_registry_endpoint",
    "docstring": "获取指标注册表\n\n返回所有可用的技术指标及其元数据",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "GET",
    "path": "/registry/{category}",
    "function": "get_indicators_by_category",
    "docstring": "获取指定分类的指标\n\n- **category**: 指标分类 (trend, momentum, volatility, volume, candlestick)",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "POST",
    "path": "/calculate",
    "function": "calculate_indicators",
    "docstring": "计算技术指标\n\n根据股票代码、日期范围和指标列表,计算技术指标值\n\n**请求示例**:\n```json\n{\n\"symbol\": \"600519.SH\",\n\"start_date\": \"2024-01-01\",\n\"end_date\": \"2024-12-31\",\n\"indicators\": [\n{\"abbreviation\": \"SMA\", \"parameters\": {\"timeperiod\": 20}},\n{\"abbreviation\": \"RSI\", \"parameters\": {\"timeperiod\": 14}}\n],\n\"use_cache\": true\n}\n```",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "POST",
    "path": "/configs",
    "function": "create_indicator_config",
    "docstring": "创建指标配置\n\n保存用户的常用指标组合配置,方便下次快速加载\n\n**请求示例**:\n```json\n{\n\"name\": \"我的常用配置\",\n\"indicators\": [\n{\"abbreviation\": \"SMA\", \"parameters\": {\"timeperiod\": 20}},\n{\"abbreviation\": \"RSI\", \"parameters\": {\"timeperiod\": 14}}\n]\n}\n```",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "GET",
    "path": "/configs",
    "function": "list_indicator_configs",
    "docstring": "获取用户的指标配置列表\n\n返回当前用户的所有已保存指标配置",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "GET",
    "path": "/configs/{config_id}",
    "function": "get_indicator_config",
    "docstring": "获取指定的指标配置详情\n\n- **config_id**: 配置ID",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "PUT",
    "path": "/configs/{config_id}",
    "function": "update_indicator_config",
    "docstring": "更新指标配置\n\n可以更新配置名称和/或指标列表\n\n- **config_id**: 配置ID",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "DELETE",
    "path": "/configs/{config_id}",
    "function": "delete_indicator_config",
    "docstring": "删除指标配置\n\n- **config_id**: 配置ID",
    "file": "indicators.py",
    "module": "indicators"
  },
  {
    "method": "GET",
    "path": "/industry/list",
    "function": "get_industry_list",
    "docstring": "获取所有行业分类列表\n\nReturns:\nIndustryListResponse: 行业列表",
    "file": "industry_concept_analysis.py",
    "module": "industry_concept_analysis"
  },
  {
    "method": "GET",
    "path": "/concept/list",
    "function": "get_concept_list",
    "docstring": "获取所有概念分类列表\n\nReturns:\nConceptListResponse: 概念列表",
    "file": "industry_concept_analysis.py",
    "module": "industry_concept_analysis"
  },
  {
    "method": "GET",
    "path": "/industry/stocks",
    "function": "get_industry_stocks",
    "docstring": "获取指定行业的成分股列表\n\nArgs:\nindustry_code: 行业代码\nlimit: 限制返回数量\n\nReturns:\nStockListResponse: 成分股列表",
    "file": "industry_concept_analysis.py",
    "module": "industry_concept_analysis"
  },
  {
    "method": "GET",
    "path": "/concept/stocks",
    "function": "get_concept_stocks",
    "docstring": "获取指定概念的成分股列表\n\nArgs:\nconcept_code: 概念代码\nlimit: 限制返回数量\n\nReturns:\nStockListResponse: 成分股列表",
    "file": "industry_concept_analysis.py",
    "module": "industry_concept_analysis"
  },
  {
    "method": "GET",
    "path": "/industry/performance",
    "function": "get_industry_performance",
    "docstring": "获取行业整体表现数据\n\nArgs:\nindustry_code: 行业代码\n\nReturns:\nIndustryPerformanceResponse: 行业表现数据",
    "file": "industry_concept_analysis.py",
    "module": "industry_concept_analysis"
  },
  {
    "method": "GET",
    "path": "/fund-flow",
    "function": "get_fund_flow",
    "docstring": "查询个股资金流向历史数据（带缓存优化）\n\n**参数说明:**\n- symbol: 股票代码 (如: 600519.SH)\n- timeframe: 1=今日, 3=3日, 5=5日, 10=10日\n- start_date/end_date: 时间范围筛选\n\n**缓存策略:** 5分钟TTL（减少数据库压力）\n**返回:** 资金流向列表",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/etf/list",
    "function": "get_etf_list",
    "docstring": "查询ETF实时行情数据（带缓存优化）\n\n**查询方式:**\n- 指定symbol: 返回单个ETF数据\n- 指定keyword: 模糊搜索名称/代码\n- 不指定条件: 返回全市场ETF(按涨跌幅排序)\n\n**缓存策略:** 1分钟TTL（平衡实时性和性能）\n**返回:** ETF数据列表",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "POST",
    "path": "/etf/refresh",
    "function": "refresh_etf_data",
    "docstring": "刷新全市场ETF实时数据\n\n**数据源:** 东方财富网 (via akshare)\n**更新频率:** 建议每5分钟调用一次",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/chip-race",
    "function": "get_chip_race",
    "docstring": "查询竞价抢筹数据（带缓存优化）\n\n**类型说明:**\n- open: 早盘抢筹(集合竞价)\n- end: 尾盘抢筹(收盘竞价)\n\n**缓存策略:** 5分钟TTL\n**返回:** 按抢筹金额倒序排列",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/lhb",
    "function": "get_lhb_detail",
    "docstring": "查询龙虎榜详细数据（带缓存优化）\n\n**筛选条件:**\n- symbol: 查询指定股票的历史龙虎榜记录\n- start_date/end_date: 时间范围\n- min_net_amount: 净买入额下限(元)\n\n**缓存策略:** 24小时TTL（龙虎榜数据每日更新）\n**返回:** 按日期倒序排列",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "POST",
    "path": "/lhb/refresh",
    "function": "refresh_lhb_detail",
    "docstring": "刷新指定日期的龙虎榜数据\n\n**数据源:** 东方财富网 (via akshare)\n**更新时机:** 每日20:00之后\n**说明:** 龙虎榜数据次日公布",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/quotes",
    "function": "get_market_quotes",
    "docstring": "获取实时市场行情数据（带缓存优化）\n\n**参数**:\n- symbols: 股票代码列表（可选）。不指定则返回热门股票行情\n\n**缓存策略:** 10秒TTL（实时行情需要较高频率更新）\n**数据源**: TDX实时行情 或 Mock数据\n**返回**: 实时行情列表",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/stocks",
    "function": "get_stock_list",
    "docstring": "获取股票基本信息列表\n\n**查询条件**:\n- search: 关键词搜索（代码或名称）\n- exchange: 按交易所筛选（SSE上交所/SZSE深交所）\n- security_type: 按证券类型筛选\n- limit: 返回数量限制\n\n**数据源**: PostgreSQL stock_info表 或 Mock数据\n**返回**: 股票列表",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/kline",
    "function": "get_kline_data",
    "docstring": "获取股票K线（蜡烛图）历史数据\n\n**参数说明**:\n- stock_code: 股票代码，支持 \"600519\" 或 \"600519.SH\" 格式\n- period:\n- \"daily\" (日K线)\n- \"weekly\" (周K线)\n- \"monthly\" (月K线)\n- adjust:\n- \"qfq\" (前复权，推荐)\n- \"hfq\" (后复权)\n- \"\" (不复权)\n- start_date/end_date: 日期范围（可选，默认最近60个交易日）\n\n**数据源**: AKShare stock_zh_a_hist()\n**返回**: K线数据数组，包含OHLCV及技术指标",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/heatmap",
    "function": "get_market_heatmap",
    "docstring": "获取市场热力图数据，用于可视化展示各股票的涨跌情况\n\n**参数说明:**\n- market: 市场类型\n- \"cn\" - 中国A股市场\n- \"hk\" - 香港股市\n- limit: 返回的股票数量 (10-200)\n\n**数据源:** AKShare 或 Mock数据\n**返回:** 股票列表，包含代码、名称、涨跌幅、价格、成交量、市值等",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "",
    "file": "market.py",
    "module": "market"
  },
  {
    "method": "GET",
    "path": "/fund-flow",
    "function": "get_fund_flow",
    "docstring": "查询个股资金流向历史数据\n\nArgs:\nsymbol: 股票代码 (如: 600519)\ntimeframe: 1=今日, 3=3日, 5=5日, 10=10日\nstart_date/end_date: 时间范围筛选",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/fund-flow/refresh",
    "function": "refresh_fund_flow",
    "docstring": "从东方财富刷新资金流向数据\n\n不传symbol则刷新全市场数据（约4000+只股票）",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "GET",
    "path": "/etf/list",
    "function": "get_etf_list",
    "docstring": "查询ETF实时行情数据\n\n支持按代码精确查询或按关键词模糊搜索",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/etf/refresh",
    "function": "refresh_etf_spot",
    "docstring": "从东方财富刷新全市场ETF数据",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "GET",
    "path": "/lhb",
    "function": "get_lhb_detail",
    "docstring": "查询龙虎榜详细数据\n\n支持按股票代码、日期范围、净买入额筛选",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/lhb/refresh",
    "function": "refresh_lhb_detail",
    "docstring": "从东方财富刷新指定日期的龙虎榜数据",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "GET",
    "path": "/sector/fund-flow",
    "function": "get_sector_fund_flow",
    "docstring": "查询行业/概念板块资金流向\n\nArgs:\nsector_type: 行业、概念或地域板块\ntimeframe: 今日、3日、5日或10日",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/sector/fund-flow/refresh",
    "function": "refresh_sector_fund_flow",
    "docstring": "从东方财富刷新行业/概念资金流向数据",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "GET",
    "path": "/dividend",
    "function": "get_stock_dividend",
    "docstring": "查询股票分红配送历史记录\n\nArgs:\nsymbol: 股票代码 (如: 600519)",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/dividend/refresh",
    "function": "refresh_stock_dividend",
    "docstring": "从东方财富刷新股票分红配送数据",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "GET",
    "path": "/blocktrade",
    "function": "get_stock_blocktrade",
    "docstring": "查询股票大宗交易记录\n\nArgs:\nsymbol: 股票代码 (可选)\nstart_date/end_date: 日期范围 (可选)",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/blocktrade/refresh",
    "function": "refresh_stock_blocktrade",
    "docstring": "从东方财富刷新大宗交易数据",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "POST",
    "path": "/refresh-all",
    "function": "refresh_all_market_data",
    "docstring": "一键刷新所有市场数据（用于定时任务）\n\n包括：\n- 全市场资金流向（今日）\n- 全市场ETF数据\n- 行业资金流向\n- 概念资金流向\n- 当日龙虎榜\n- 当日大宗交易",
    "file": "market_v2.py",
    "module": "market_v2"
  },
  {
    "method": "GET",
    "path": "/metrics",
    "function": "metrics",
    "docstring": "Prometheus metrics端点\n\n返回Prometheus格式的监控指标",
    "file": "metrics.py",
    "module": "metrics"
  },
  {
    "method": "POST",
    "path": "/tdx/data",
    "function": "get_tdx_data",
    "docstring": "获取通达信股票数据\n\n- **stock_code**: 股票代码（如：000001）\n- **market**: 市场代码（sh/sz）",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "GET",
    "path": "/tdx/stocks/{market}",
    "function": "list_tdx_stocks",
    "docstring": "列出可用的股票代码\n\n- **market**: 市场代码（sh/sz）",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "POST",
    "path": "/features/generate",
    "function": "generate_features",
    "docstring": "生成特征数据\n\n- **stock_code**: 股票代码\n- **market**: 市场代码\n- **step**: 滚动窗口大小（默认10）\n- **include_indicators**: 是否包含技术指标（默认True）",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "POST",
    "path": "/models/train",
    "function": "train_model",
    "docstring": "训练预测模型\n\n- **stock_code**: 股票代码\n- **market**: 市场代码\n- **step**: 滚动窗口大小\n- **test_size**: 测试集比例（0.1-0.5）\n- **model_name**: 模型名称\n- **model_params**: 模型参数（可选）",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "POST",
    "path": "/models/predict",
    "function": "predict_with_model",
    "docstring": "使用模型进行预测\n\n- **model_name**: 模型名称\n- **stock_code**: 股票代码\n- **market**: 市场代码\n- **days**: 预测天数（1-30）",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "GET",
    "path": "/models",
    "function": "list_models",
    "docstring": "try:\nml_service = MLPredictionService(model_dir=MODEL_DIR)\nmodels = ml_service.list_saved_models()\n\nreturn ModelListResponse(\ntotal=len(models), models=[ModelInfo(**model) for model in models]\n)\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/models/{model_name}\", response_model=ModelDetailResponse)\nasync def get_model_detail(\nmodel_name: str, current_user: User = Depends(get_current_user)\n):",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "GET",
    "path": "/models/{model_name}",
    "function": "get_model_detail",
    "docstring": "try:\nml_service = MLPredictionService(model_dir=MODEL_DIR)\nloaded = ml_service.load_model(model_name)\n\nif not loaded:\nraise HTTPException(status_code=404, detail=f\"模型不存在: {model_name}\")\n\n# 获取特征重要性\ntry:\nfeature_importance = ml_service.get_feature_importance(top_k=20)\nexcept Exception:\nfeature_importance = None\n\nreturn ModelDetailResponse(\nname=model_name,\nmetadata=ml_service.model_metadata,\ntraining_history=ml_service.training_history,\nfeature_importance=feature_importance,\n)\n\nexcept HTTPException:\nraise\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=str(e))\n\n\n# ==================== 超参数搜索 ====================\n\n\n@router.post(\n\"/models/hyperparameter-search\", response_model=HyperparameterSearchResponse\n)\nasync def hyperparameter_search(\nrequest: HyperparameterSearchRequest, current_user: User = Depends(get_current_user)\n):",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "POST",
    "path": "/models/evaluate",
    "function": "evaluate_model",
    "docstring": "评估模型性能\n\n- **model_name**: 模型名称\n- **stock_code**: 股票代码\n- **market**: 市场代码",
    "file": "ml.py",
    "module": "ml"
  },
  {
    "method": "GET",
    "path": "/alert-rules",
    "function": "get_alert_rules",
    "docstring": "获取告警规则列表\n\n参数:\n- rule_type: 规则类型 (可选)\n- is_active: 是否启用 (可选)",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/alert-rules",
    "function": "create_alert_rule",
    "docstring": "创建告警规则\n\n示例:\n```json\n{\n\"rule_name\": \"茅台涨停监控\",\n\"rule_type\": \"limit_up\",\n\"symbol\": \"600519\",\n\"stock_name\": \"贵州茅台\",\n\"parameters\": {\"include_st\": false},\n\"notification_config\": {\"channels\": [\"ui\", \"sound\"], \"level\": \"warning\"},\n\"priority\": 5,\n\"is_active\": true\n}\n```",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "PUT",
    "path": "/alert-rules/{rule_id}",
    "function": "update_alert_rule",
    "docstring": "更新告警规则\n\n参数:\n- rule_id: 规则ID\n- updates: 要更新的字段",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "DELETE",
    "path": "/alert-rules/{rule_id}",
    "function": "delete_alert_rule",
    "docstring": "删除告警规则\n\n参数:\n- rule_id: 规则ID",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/alerts",
    "function": "get_alert_records",
    "docstring": "查询告警记录\n\n参数:\n- symbol: 股票代码 (可选)\n- alert_type: 告警类型 (可选)\n- alert_level: 告警级别 (可选)\n- is_read: 是否已读 (可选)\n- start_date: 开始日期 (可选)\n- end_date: 结束日期 (可选)\n- limit: 返回数量限制\n- offset: 偏移量\n\n示例:\n- GET /api/monitoring/alerts?is_read=false&limit=50\n- GET /api/monitoring/alerts?symbol=600519&alert_type=limit_up\n- GET /api/monitoring/alerts?alert_level=critical",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/alerts/{alert_id}/mark-read",
    "function": "mark_alert_read",
    "docstring": "标记告警为已读\n\n参数:\n- alert_id: 告警记录ID",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/alerts/mark-all-read",
    "function": "mark_all_alerts_read",
    "docstring": "try:\n# TODO: 实现批量标记功能\nreturn {\"success\": True, \"message\": \"功能开发中\"}\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=str(e))\n\n\n# ============================================================================\n# 实时监控数据\n# ============================================================================\n\n\n@router.get(\"/realtime/{symbol}\", response_model=RealtimeMonitoringResponse)\nasync def get_realtime_monitoring(symbol: str):",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/realtime/{symbol}",
    "function": "get_realtime_monitoring",
    "docstring": "获取单只股票的最新实时监控数据\n\n参数:\n- symbol: 股票代码\n\n示例:\n- GET /api/monitoring/realtime/600519",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/realtime",
    "function": "get_realtime_monitoring_list",
    "docstring": "获取实时监控数据列表\n\n参数:\n- symbols: 股票代码列表，逗号分隔 (可选，如: \"600519,000001\")\n- limit: 返回数量限制\n- is_limit_up: 仅返回涨停股票 (可选)\n- is_limit_down: 仅返回跌停股票 (可选)\n\n示例:\n- GET /api/monitoring/realtime?limit=20\n- GET /api/monitoring/realtime?is_limit_up=true\n- GET /api/monitoring/realtime?symbols=600519,000001,600000",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/realtime/fetch",
    "function": "fetch_realtime_data",
    "docstring": "手动触发获取实时数据\n\n参数:\n- symbols: 股票代码列表 (可选，不提供则获取全市场)\n\n示例:\n```json\n{\n\"symbols\": [\"600519\", \"000001\", \"600000\"]\n}\n```",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/dragon-tiger",
    "function": "get_dragon_tiger_list",
    "docstring": "获取龙虎榜数据\n\n参数:\n- trade_date: 交易日期 (可选，默认今天)\n- symbol: 股票代码 (可选)\n- min_net_amount: 最小净买入额 (可选)\n- limit: 返回数量限制\n\n示例:\n- GET /api/monitoring/dragon-tiger\n- GET /api/monitoring/dragon-tiger?trade_date=2025-10-23\n- GET /api/monitoring/dragon-tiger?symbol=600519",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/dragon-tiger/fetch",
    "function": "fetch_dragon_tiger_data",
    "docstring": "手动触发获取龙虎榜数据\n\n参数:\n- trade_date: 交易日期 (可选，默认今天)",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/summary",
    "function": "get_monitoring_summary",
    "docstring": "获取监控系统摘要\n\n返回:\n- 总监控股票数\n- 涨停/跌停数量\n- 大涨/大跌数量\n- 平均涨跌幅\n- 总成交额\n- 活跃告警数\n- 未读告警数",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/stats/today",
    "function": "get_today_statistics",
    "docstring": "try:\nsession = monitoring_service.get_session()\ntry:\n# 使用视图查询\nfrom sqlalchemy import text\n\n# 今日告警摘要\nalerts_summary = session.execute(\ntext(\"SELECT * FROM v_today_alerts_summary\")\n).fetchall()\n\n# 活跃规则\nactive_rules = session.execute(\ntext(\"SELECT * FROM v_active_alert_rules LIMIT 10\")\n).fetchall()\n\n# 实时监控摘要\nrealtime_summary = session.execute(\ntext(\"SELECT * FROM v_realtime_summary\")\n).fetchone()\n\nreturn {\n\"success\": True,\n\"data\": {\n\"alerts_summary\": [dict(row._mapping) for row in alerts_summary],\n\"active_rules\": [dict(row._mapping) for row in active_rules],\n\"realtime_summary\": (\ndict(realtime_summary._mapping) if realtime_summary else {}\n),\n},\n}\nfinally:\nsession.close()\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=str(e))\n\n\n# ============================================================================\n# 监控控制\n# ============================================================================\n\n\nclass MonitoringControlRequest(BaseModel):",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/control/start",
    "function": "start_monitoring",
    "docstring": "启动监控\n\n参数:\n- symbols: 要监控的股票代码列表 (可选，不提供则监控全市场)\n- interval: 更新间隔(秒)，默认60秒",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "POST",
    "path": "/control/stop",
    "function": "stop_monitoring",
    "docstring": "try:\nmonitoring_service.stop_monitoring()\nreturn {\"success\": True, \"message\": \"监控已停止\"}\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/control/status\")\nasync def get_monitoring_status():",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/control/status",
    "function": "get_monitoring_status",
    "docstring": "",
    "file": "monitoring.py",
    "module": "monitoring"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "get_all_data_sources_health",
    "docstring": "获取所有数据源的健康状态\n\nReturns:\nList[DataSourceHealthResponse]: 所有数据源的健康状态",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "GET",
    "path": "/health/{source_type}",
    "function": "get_data_source_health",
    "docstring": "获取指定数据源的健康状态\n\nArgs:\nsource_type: 数据源类型 (eastmoney, cninfo, akshare, wencai)\n\nReturns:\nDict: 健康状态详情",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "GET",
    "path": "/realtime-quote",
    "function": "fetch_realtime_quote",
    "docstring": "获取实时行情（支持多数据源）\n\nArgs:\nsymbols: 股票代码列表（逗号分隔）\nsource: 指定数据源\n\nReturns:\nDict: 实时行情数据",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "GET",
    "path": "/fund-flow",
    "function": "fetch_fund_flow",
    "docstring": "获取资金流向（支持多数据源）\n\nArgs:\nsymbol: 股票代码\ntimeframe: 时间范围\nsource: 指定数据源\n\nReturns:\nDict: 资金流向数据",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "GET",
    "path": "/dragon-tiger",
    "function": "fetch_dragon_tiger",
    "docstring": "获取龙虎榜（支持多数据源）\n\nArgs:\ndate_str: 日期\nsource: 指定数据源\n\nReturns:\nDict: 龙虎榜数据",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "POST",
    "path": "/refresh-health",
    "function": "refresh_data_source_health",
    "docstring": "刷新所有数据源的健康状态\n\nReturns:\nDict: 刷新结果",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "POST",
    "path": "/clear-cache",
    "function": "clear_cache",
    "docstring": "清空数据缓存\n\nReturns:\nDict: 操作结果",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "GET",
    "path": "/supported-categories",
    "function": "get_supported_categories",
    "docstring": "获取所有支持的数据类别及其对应的数据源\n\nReturns:\nDict: 数据类别映射",
    "file": "multi_source.py",
    "module": "multi_source"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_email_service_status",
    "docstring": "获取邮件服务状态",
    "file": "notification.py",
    "module": "notification"
  },
  {
    "method": "POST",
    "path": "/email/send",
    "function": "send_email",
    "docstring": "发送邮件（需要管理员权限）",
    "file": "notification.py",
    "module": "notification"
  },
  {
    "method": "POST",
    "path": "/email/welcome",
    "function": "send_welcome_email",
    "docstring": "发送欢迎邮件",
    "file": "notification.py",
    "module": "notification"
  },
  {
    "method": "POST",
    "path": "/email/newsletter",
    "function": "send_daily_newsletter",
    "docstring": "发送每日新闻简报",
    "file": "notification.py",
    "module": "notification"
  },
  {
    "method": "POST",
    "path": "/email/price-alert",
    "function": "send_price_alert",
    "docstring": "发送价格提醒邮件",
    "file": "notification.py",
    "module": "notification"
  },
  {
    "method": "POST",
    "path": "/test-email",
    "function": "send_test_email",
    "docstring": "发送测试邮件到当前用户邮箱",
    "file": "notification.py",
    "module": "notification"
  },
  {
    "method": "GET",
    "path": "/metrics",
    "function": "metrics",
    "docstring": "Prometheus 指标端点\n\n提供所有监控指标的 Prometheus 格式输出，\n包括 API、WebSocket、缓存、数据库、系统资源和业务指标。\n\nReturns:\nPrometheus 格式的指标文本",
    "file": "prometheus_exporter.py",
    "module": "prometheus_exporter"
  },
  {
    "method": "GET",
    "path": "/metrics/health",
    "function": "metrics_health",
    "docstring": "Prometheus 健康检查端点\n\n快速检查指标收集器是否正常工作\n\nReturns:\nJSON: {\n\"status\": \"healthy|unhealthy\",\n\"metrics_available\": 40+,\n\"last_update\": \"timestamp\"\n}",
    "file": "prometheus_exporter.py",
    "module": "prometheus_exporter"
  },
  {
    "method": "GET",
    "path": "/metrics/list",
    "function": "metrics_list",
    "docstring": "列出所有可用的指标\n\nReturns:\nJSON: {\n\"total\": 40+,\n\"metrics\": [\n{\n\"name\": \"mystocks_http_requests_total\",\n\"type\": \"counter\",\n\"help\": \"Total HTTP requests\",\n\"labels\": [\"method\", \"endpoint\", \"status\"]\n},\n...\n]\n}",
    "file": "prometheus_exporter.py",
    "module": "prometheus_exporter"
  },
  {
    "method": "GET",
    "path": "/var-cvar",
    "function": "calculate_var_cvar",
    "docstring": "计算VaR和CVaR\n\nArgs:\nentity_type: 实体类型 ('backtest', 'portfolio', 'strategy')\nentity_id: 实体ID\nconfidence_level: 置信水平 (0.90, 0.95, 0.99)\n\nReturns:\n{\n\"var_95_hist\": -0.0289,\n\"var_95_param\": -0.0309,\n\"var_99_hist\": -0.0385,\n\"cvar_95\": -0.0360,\n\"cvar_99\": -0.0432\n}",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "GET",
    "path": "/beta",
    "function": "calculate_beta",
    "docstring": "计算Beta系数\n\nArgs:\nentity_type: 实体类型\nentity_id: 实体ID\nmarket_index: 市场指数代码\n\nReturns:\n{\n\"beta\": 1.23,\n\"correlation\": 0.85\n}",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "GET",
    "path": "/dashboard",
    "function": "get_risk_dashboard",
    "docstring": "获取风险仪表盘数据\n\nReturns:\n{\n\"metrics\": {...},\n\"active_alerts\": [...],\n\"risk_history\": [...]\n}",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "GET",
    "path": "/metrics/history",
    "function": "get_risk_metrics_history",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\n# 获取风险指标数据\nmetrics_df = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"risk_metrics\",\nfilters={\"entity_type\": entity_type, \"entity_id\": entity_id},\n)\n\nif metrics_df is None or len(metrics_df) == 0:\nreturn []\n\n# 日期过滤\nmetrics_df = metrics_df[\n(metrics_df[\"metric_date\"] >= pd.Timestamp(start_date))\n& (metrics_df[\"metric_date\"] <= pd.Timestamp(end_date))\n]\n\nreturn [\n{\n\"date\": (\nmetric[\"metric_date\"].isoformat()\nif hasattr(metric[\"metric_date\"], \"isoformat\")\nelse str(metric[\"metric_date\"])\n),\n\"var_95_hist\": metric.get(\"var_95_hist\"),\n\"var_95_param\": metric.get(\"var_95_param\"),\n\"cvar_95\": metric.get(\"cvar_95\"),\n\"beta\": metric.get(\"beta\"),\n}\nfor metric in metrics_df.sort_values(\"metric_date\").to_dict(\"records\")\n]\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"获取历史数据失败: {str(e)}\")\n\n\n# ============ 风险预警管理 ============\n\n\n@router.get(\"/alerts\")\nasync def list_risk_alerts(is_active: Optional[bool] = None) -> List[Dict[str, Any]]:",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "GET",
    "path": "/alerts",
    "function": "list_risk_alerts",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\nfilters = {}\nif is_active is not None:\nfilters[\"is_active\"] = is_active\n\nalerts_df = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"risk_alerts\",\nfilters=filters,\n)\n\nreturn alerts_df.to_dict(\"records\") if alerts_df is not None else []\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"获取预警列表失败: {str(e)}\")\n\n\n@router.post(\"/alerts\")\nasync def create_risk_alert(alert_data: Dict[str, Any]) -> Dict[str, Any]:",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "POST",
    "path": "/alerts",
    "function": "create_risk_alert",
    "docstring": "operation_start = datetime.now()\n\ntry:\nmanager = MyStocksUnifiedManager()\n\n# 添加时间戳\nalert_data[\"created_at\"] = datetime.now()\nalert_data[\"is_active\"] = alert_data.get(\"is_active\", True)\n\nalert_df = pd.DataFrame([alert_data])\n\nresult = manager.save_data_by_classification(\ndata=alert_df,\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"risk_alerts\",\n)\n\n# 记录操作\noperation_time = (datetime.now() - operation_start).total_seconds() * 1000\nget_monitoring_db().log_operation(\noperation_type=\"INSERT\",\ntable_name=\"risk_alerts\",\noperation_name=\"create_risk_alert\",\nrows_affected=1,\noperation_time_ms=operation_time,\nsuccess=result,\n)\n\nif result:\nreturn {\"message\": \"预警规则已创建\", \"data\": alert_data}\nelse:\nraise HTTPException(status_code=500, detail=\"创建预警规则失败\")\n\nexcept Exception as e:\noperation_time = (datetime.now() - operation_start).total_seconds() * 1000\nget_monitoring_db().log_operation(\noperation_type=\"INSERT\",\ntable_name=\"risk_alerts\",\noperation_name=\"create_risk_alert\",\nrows_affected=0,\noperation_time_ms=operation_time,\nsuccess=False,\nerror_message=str(e),\n)\nraise HTTPException(status_code=500, detail=f\"创建预警规则失败: {str(e)}\")\n\n\n@router.put(\"/alerts/{alert_id}\")\nasync def update_risk_alert(\nalert_id: int, alert_update: Dict[str, Any]\n) -> Dict[str, str]:",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "PUT",
    "path": "/alerts/{alert_id}",
    "function": "update_risk_alert",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\nalert_update[\"id\"] = alert_id\n\nalert_df = pd.DataFrame([alert_update])\n\nresult = manager.save_data_by_classification(\ndata=alert_df,\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"risk_alerts\",\nupsert=True,\n)\n\nif result:\nreturn {\"message\": \"预警规则已更新\"}\nelse:\nraise HTTPException(status_code=500, detail=\"更新预警规则失败\")\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"更新预警规则失败: {str(e)}\")\n\n\n@router.delete(\"/alerts/{alert_id}\")\nasync def delete_risk_alert(alert_id: int) -> Dict[str, str]:",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "DELETE",
    "path": "/alerts/{alert_id}",
    "function": "delete_risk_alert",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\n# 软删除：更新is_active为False\nalert_df = pd.DataFrame([{\"id\": alert_id, \"is_active\": False}])\n\nresult = manager.save_data_by_classification(\ndata=alert_df,\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"risk_alerts\",\nupsert=True,\n)\n\nif result:\nreturn {\"message\": \"预警规则已禁用\"}\nelse:\nraise HTTPException(status_code=500, detail=\"删除预警规则失败\")\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"删除预警规则失败: {str(e)}\")\n\n\n# ============ 通知管理 ============\n\n\n@router.post(\"/notifications/test\")\nasync def test_notification(\nnotification_type: str, config_data: Dict[str, Any]\n) -> Dict[str, Any]:",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "POST",
    "path": "/notifications/test",
    "function": "test_notification",
    "docstring": "",
    "file": "risk_management.py",
    "module": "risk_management"
  },
  {
    "method": "GET",
    "path": "/training",
    "function": "sse_training_stream",
    "docstring": "SSE endpoint for model training progress updates\n\n**Event Types:**\n- `connected`: Initial connection confirmation\n- `training_progress`: Training progress update\n- `ping`: Keepalive heartbeat (every 30s)\n\n**Event Data Structure:**\n```json\n{\n\"event\": \"training_progress\",\n\"data\": {\n\"task_id\": \"training-uuid\",\n\"progress\": 45.5,\n\"status\": \"running\",\n\"message\": \"Training epoch 10/100\",\n\"metrics\": {\n\"loss\": 0.023,\n\"accuracy\": 0.95\n}\n},\n\"timestamp\": \"2025-10-24T14:30:00Z\"\n}\n```\n\n**Example (JavaScript):**\n```javascript\nconst eventSource = new EventSource('/api/v1/sse/training');\n\neventSource.addEventListener('training_progress', (event) => {\nconst data = JSON.parse(event.data);\nupdateProgressBar(data.data.progress);\nupdateMetrics(data.data.metrics);\n});\n\neventSource.addEventListener('error', () => {\nconsole.error('SSE connection error');\neventSource.close();\n});\n```",
    "file": "sse_endpoints.py",
    "module": "sse_endpoints"
  },
  {
    "method": "GET",
    "path": "/backtest",
    "function": "sse_backtest_stream",
    "docstring": "SSE endpoint for backtest execution progress updates\n\n**Event Types:**\n- `connected`: Initial connection confirmation\n- `backtest_progress`: Backtest progress update\n- `ping`: Keepalive heartbeat (every 30s)\n\n**Event Data Structure:**\n```json\n{\n\"event\": \"backtest_progress\",\n\"data\": {\n\"backtest_id\": \"backtest-uuid\",\n\"progress\": 67.8,\n\"status\": \"running\",\n\"message\": \"Simulating 2024-06-15\",\n\"current_date\": \"2024-06-15\",\n\"results\": {\n\"total_return\": 0.15,\n\"sharpe_ratio\": 1.8,\n\"max_drawdown\": -0.08\n}\n},\n\"timestamp\": \"2025-10-24T14:30:00Z\"\n}\n```\n\n**Example (JavaScript):**\n```javascript\nconst eventSource = new EventSource('/api/v1/sse/backtest');\n\neventSource.addEventListener('backtest_progress', (event) => {\nconst data = JSON.parse(event.data);\nupdateBacktestProgress(data.data.progress);\nupdateCurrentDate(data.data.current_date);\nif (data.data.results) {\nupdateResultsChart(data.data.results);\n}\n});\n```",
    "file": "sse_endpoints.py",
    "module": "sse_endpoints"
  },
  {
    "method": "GET",
    "path": "/alerts",
    "function": "sse_alerts_stream",
    "docstring": "SSE endpoint for risk alert notifications\n\n**Event Types:**\n- `connected`: Initial connection confirmation\n- `risk_alert`: Risk alert notification\n- `ping`: Keepalive heartbeat (every 30s)\n\n**Event Data Structure:**\n```json\n{\n\"event\": \"risk_alert\",\n\"data\": {\n\"alert_type\": \"var_exceeded\",\n\"severity\": \"high\",\n\"message\": \"VaR exceeded threshold\",\n\"metric_name\": \"var_95\",\n\"metric_value\": 0.06,\n\"threshold\": 0.05,\n\"entity_type\": \"portfolio\",\n\"entity_id\": \"portfolio-123\"\n},\n\"timestamp\": \"2025-10-24T14:30:00Z\"\n}\n```\n\n**Severity Levels:**\n- `low`: Informational alerts\n- `medium`: Warning alerts\n- `high`: Important alerts requiring attention\n- `critical`: Critical alerts requiring immediate action\n\n**Example (JavaScript):**\n```javascript\nconst eventSource = new EventSource('/api/v1/sse/alerts');\n\neventSource.addEventListener('risk_alert', (event) => {\nconst data = JSON.parse(event.data);\nshowNotification({\ntitle: data.data.message,\nseverity: data.data.severity,\ndetails: `${data.data.metric_name}: ${data.data.metric_value}`\n});\n});\n```",
    "file": "sse_endpoints.py",
    "module": "sse_endpoints"
  },
  {
    "method": "GET",
    "path": "/dashboard",
    "function": "sse_dashboard_stream",
    "docstring": "SSE endpoint for real-time dashboard updates\n\n**Event Types:**\n- `connected`: Initial connection confirmation\n- `dashboard_update`: Dashboard data update\n- `ping`: Keepalive heartbeat (every 30s)\n\n**Event Data Structure:**\n```json\n{\n\"event\": \"dashboard_update\",\n\"data\": {\n\"update_type\": \"metrics\",\n\"data\": {\n\"total_value\": 1500000.0,\n\"daily_return\": 0.025,\n\"positions_count\": 15\n}\n},\n\"timestamp\": \"2025-10-24T14:30:00Z\"\n}\n```\n\n**Update Types:**\n- `metrics`: Portfolio metrics update\n- `positions`: Positions update\n- `orders`: Orders update\n- `market`: Market data update\n\n**Example (JavaScript):**\n```javascript\nconst eventSource = new EventSource('/api/v1/sse/dashboard');\n\neventSource.addEventListener('dashboard_update', (event) => {\nconst data = JSON.parse(event.data);\n\nswitch (data.data.update_type) {\ncase 'metrics':\nupdatePortfolioMetrics(data.data.data);\nbreak;\ncase 'positions':\nupdatePositionsTable(data.data.data);\nbreak;\ncase 'orders':\nupdateOrdersTable(data.data.data);\nbreak;\n}\n});\n```",
    "file": "sse_endpoints.py",
    "module": "sse_endpoints"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "sse_status",
    "docstring": "Get SSE server status\n\nReturns:\nConnection statistics for all channels",
    "file": "sse_endpoints.py",
    "module": "sse_endpoints"
  },
  {
    "method": "GET",
    "path": "/search",
    "function": "search_stocks",
    "docstring": "搜索股票\n\n支持：\n- A 股：股票代码或名称\n- H 股（港股）：股票代码或名称",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "GET",
    "path": "/quote/{symbol}",
    "function": "get_stock_quote",
    "docstring": "获取股票实时报价\n\nArgs:\nsymbol: 股票代码\nmarket: 市场类型（cn=A股, hk=港股）",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "GET",
    "path": "/profile/{symbol}",
    "function": "get_company_profile",
    "docstring": "获取公司基本信息\n\nArgs:\nsymbol: 股票代码\nmarket: 市场类型",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "GET",
    "path": "/news/{symbol}",
    "function": "get_stock_news",
    "docstring": "获取股票新闻\n\nArgs:\nsymbol: 股票代码\nmarket: 市场类型（cn=A股, hk=港股）\ndays: 获取最近几天的新闻",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "GET",
    "path": "/news/market/{category}",
    "function": "get_market_news",
    "docstring": "获取市场新闻\n\nArgs:\ncategory: 新闻类别\nmarket: 市场类型（cn=A股, hk=港股）",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "GET",
    "path": "/recommendation/{symbol}",
    "function": "get_recommendation_trends",
    "docstring": "获取分析师推荐趋势\n\nArgs:\nsymbol: 股票代码",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "POST",
    "path": "/cache/clear",
    "function": "clear_search_cache",
    "docstring": "清除搜索缓存",
    "file": "stock_search.py",
    "module": "stock_search"
  },
  {
    "method": "GET",
    "path": "/definitions",
    "function": "get_strategy_definitions",
    "docstring": "获取所有策略定义\n\nReturns:\n所有可用策略的定义列表",
    "file": "strategy.py",
    "module": "strategy"
  },
  {
    "method": "POST",
    "path": "/run/single",
    "function": "run_strategy_single",
    "docstring": "对单只股票运行策略\n\nArgs:\nstrategy_code: 策略代码 (如: volume_surge)\nsymbol: 股票代码 (如: 600519)\nstock_name: 股票名称 (可选)\ncheck_date: 检查日期 (可选，默认今天)\n\nReturns:\n策略执行结果",
    "file": "strategy.py",
    "module": "strategy"
  },
  {
    "method": "POST",
    "path": "/run/batch",
    "function": "run_strategy_batch",
    "docstring": "批量运行策略\n\nArgs:\nstrategy_code: 策略代码\nsymbols: 股票代码列表，逗号分隔 (如: 600519,000001)\nmarket: 市场类型 (A=全部, SH=上证, SZ=深证, CYB=创业板, KCB=科创板)\nlimit: 限制处理数量\ncheck_date: 检查日期 (可选)\n\nReturns:\n批量执行结果统计",
    "file": "strategy.py",
    "module": "strategy"
  },
  {
    "method": "GET",
    "path": "/results",
    "function": "query_strategy_results",
    "docstring": "查询策略结果\n\nArgs:\nstrategy_code: 策略代码 (可选)\nsymbol: 股票代码 (可选)\ncheck_date: 检查日期 (可选)\nmatch_result: 是否匹配 (可选)\nlimit: 返回数量 (默认100)\noffset: 偏移量 (默认0)\n\nReturns:\n策略结果列表",
    "file": "strategy.py",
    "module": "strategy"
  },
  {
    "method": "GET",
    "path": "/matched-stocks",
    "function": "get_matched_stocks",
    "docstring": "获取匹配指定策略的股票列表\n\nArgs:\nstrategy_code: 策略代码\ncheck_date: 检查日期 (可选，默认最新)\nlimit: 返回数量 (默认100)\n\nReturns:\n匹配的股票列表",
    "file": "strategy.py",
    "module": "strategy"
  },
  {
    "method": "GET",
    "path": "/stats/summary",
    "function": "get_strategy_summary",
    "docstring": "获取策略统计摘要\n\nArgs:\ncheck_date: 检查日期 (可选，默认今天)\n\nReturns:\n各策略的匹配数量统计",
    "file": "strategy.py",
    "module": "strategy"
  },
  {
    "method": "GET",
    "path": "/strategies",
    "function": "list_strategies",
    "docstring": "获取策略列表\n\nArgs:\nstatus: 过滤状态 ('draft', 'active', 'archived')\npage: 页码\npage_size: 每页数量\n\nReturns:\n{\n\"items\": [...],\n\"total\": 100,\n\"page\": 1,\n\"page_size\": 20\n}\n\n支持Mock数据模式切换",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "POST",
    "path": "/strategies",
    "function": "create_strategy",
    "docstring": "创建新策略\n\nArgs:\nstrategy_data: 策略创建数据\n\nReturns:\n创建的策略对象\n\n支持Mock数据模式切换",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/strategies/{strategy_id}",
    "function": "get_strategy",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\nstrategies = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"strategies\",\nfilters={\"id\": strategy_id},\n)\n\nif strategies is None or len(strategies) == 0:\nraise HTTPException(status_code=404, detail=\"策略不存在\")\n\nreturn strategies.iloc[0].to_dict()\n\nexcept HTTPException:\nraise\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"获取策略失败: {str(e)}\")\n\n\n@router.put(\"/strategies/{strategy_id}\")\nasync def update_strategy(\nstrategy_id: int, strategy_update: Dict[str, Any]\n) -> Dict[str, Any]:",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "PUT",
    "path": "/strategies/{strategy_id}",
    "function": "update_strategy",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\n# 先获取现有策略\nstrategies = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"strategies\",\nfilters={\"id\": strategy_id},\n)\n\nif strategies is None or len(strategies) == 0:\nraise HTTPException(status_code=404, detail=\"策略不存在\")\n\n# 更新数据\nstrategy_update[\"updated_at\"] = datetime.now()\nstrategy_update[\"id\"] = strategy_id\n\nimport pandas as pd\n\nupdated_df = pd.DataFrame([strategy_update])\n\nresult = manager.save_data_by_classification(\ndata=updated_df,\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"strategies\",\nupsert=True,\n)\n\nif result:\nreturn {\"message\": \"策略更新成功\"}\nelse:\nraise HTTPException(status_code=500, detail=\"策略更新失败\")\n\nexcept HTTPException:\nraise\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"更新策略失败: {str(e)}\")\n\n\n@router.delete(\"/strategies/{strategy_id}\")\nasync def delete_strategy(strategy_id: int) -> Dict[str, str]:",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "DELETE",
    "path": "/strategies/{strategy_id}",
    "function": "delete_strategy",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\n# 注意：实际实现中应该使用软删除（更新status为archived）\n# 而不是真正删除数据\nimport pandas as pd\n\ndelete_data = pd.DataFrame(\n[{\"id\": strategy_id, \"status\": \"archived\", \"updated_at\": datetime.now()}]\n)\n\nresult = manager.save_data_by_classification(\ndata=delete_data,\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"strategies\",\nupsert=True,\n)\n\nif result:\nreturn {\"message\": \"策略已归档\"}\nelse:\nraise HTTPException(status_code=500, detail=\"策略删除失败\")\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"删除策略失败: {str(e)}\")\n\n\n# ============ 模型训练 ============\n\n\n@router.post(\"/models/train\")\nasync def train_model(\nconfig: Dict[str, Any], background_tasks: BackgroundTasks\n) -> Dict[str, Any]:",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "POST",
    "path": "/models/train",
    "function": "train_model",
    "docstring": "启动模型训练任务\n\nArgs:\nconfig: 训练配置\n\nReturns:\n{\"task_id\": \"task_xxx\", \"model_id\": 123}",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/models/training/{task_id}/status",
    "function": "get_training_status",
    "docstring": "查询训练状态\n\nReturns:\n{\n\"status\": \"training\" | \"completed\" | \"failed\",\n\"progress\": 75,\n\"metrics\": {...}\n}",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/models",
    "function": "list_models",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\nfilters = {}\nif model_type:\nfilters[\"model_type\"] = model_type\nif status:\nfilters[\"status\"] = status\n\nmodels = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"models\",\nfilters=filters,\n)\n\nreturn models.to_dict(\"records\") if models is not None else []\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"获取模型列表失败: {str(e)}\")\n\n\n# ============ 回测执行 ============\n\n\n@router.post(\"/backtest/run\")\nasync def run_backtest(\nconfig: Dict[str, Any], background_tasks: BackgroundTasks\n) -> Dict[str, int]:",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "POST",
    "path": "/backtest/run",
    "function": "run_backtest",
    "docstring": "执行回测\n\nArgs:\nconfig: 回测配置\n\nReturns:\n{\"backtest_id\": 123}",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/backtest/results",
    "function": "list_backtest_results",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\nfilters = {}\nif strategy_id:\nfilters[\"strategy_id\"] = strategy_id\n\nbacktests = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"backtests\",\nfilters=filters,\n)\n\ntotal = len(backtests) if backtests is not None else 0\nstart = (page - 1) * page_size\nend = start + page_size\nitems = (\nbacktests.iloc[start:end].to_dict(\"records\")\nif backtests is not None\nelse []\n)\n\nreturn {\"items\": items, \"total\": total, \"page\": page, \"page_size\": page_size}\n\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"获取回测结果失败: {str(e)}\")\n\n\n@router.get(\"/backtest/results/{backtest_id}\")\nasync def get_backtest_result(backtest_id: int) -> Dict[str, Any]:",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/backtest/results/{backtest_id}",
    "function": "get_backtest_result",
    "docstring": "try:\nmanager = MyStocksUnifiedManager()\n\nbacktests = manager.load_data_by_classification(\nclassification=DataClassification.MODEL_OUTPUT,\ntable_name=\"backtests\",\nfilters={\"id\": backtest_id},\n)\n\nif backtests is None or len(backtests) == 0:\nraise HTTPException(status_code=404, detail=\"回测不存在\")\n\nreturn backtests.iloc[0].to_dict()\n\nexcept HTTPException:\nraise\nexcept Exception as e:\nraise HTTPException(status_code=500, detail=f\"获取回测结果失败: {str(e)}\")\n\n\n@router.get(\"/backtest/results/{backtest_id}/chart-data\")\nasync def get_backtest_chart_data(backtest_id: int) -> Dict[str, List]:",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/backtest/results/{backtest_id}/chart-data",
    "function": "get_backtest_chart_data",
    "docstring": "",
    "file": "strategy_management.py",
    "module": "strategy_management"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "system_health",
    "docstring": "系统健康检查端点 (双数据库架构: TDengine + PostgreSQL)\n\n返回:\n- 数据库连接状态\n- 系统运行时间\n- 服务状态",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/adapters/health",
    "function": "get_adapters_health",
    "docstring": "🚀 适配器健康检查端点（新增）\n\n检查所有数据适配器的健康状态：\n- akshare: AkShare适配器\n- tdx: 通达信适配器\n- financial: 财务数据适配器\n\n返回:\n- 每个适配器的健康状态\n- 最后检查时间\n- 错误信息（如果有）\n\n用于监控和自动降级",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/datasources",
    "function": "get_datasources",
    "docstring": "获取已配置的数据源列表\n\n返回所有可用的数据源配置信息",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "POST",
    "path": "/test-connection",
    "function": "test_database_connection",
    "docstring": "测试数据库连接 (双数据库架构)\n\n支持的数据库类型:\n- postgresql: PostgreSQL (主数据库)\n- tdengine: TDengine (时序数据库)",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/logs",
    "function": "get_system_logs",
    "docstring": "获取系统运行日志\n\n参数:\n- filter_errors: 是否只显示有问题的日志 (WARNING/ERROR/CRITICAL)\n- limit: 返回条数限制 (1-1000)\n- offset: 偏移量，用于分页\n- level: 日志级别筛选\n- category: 日志分类筛选\n\n返回:\n- 系统运行日志列表，包含时间戳、级别、分类、操作、消息等信息\n\n示例:\n- GET /api/system/logs - 获取所有日志\n- GET /api/system/logs?filter_errors=true - 只获取有问题的日志\n- GET /api/system/logs?level=ERROR - 只获取ERROR级别日志\n- GET /api/system/logs?category=database - 只获取数据库相关日志",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/logs/summary",
    "function": "get_logs_summary",
    "docstring": "获取日志统计摘要\n\n返回:\n- 总日志数\n- 各级别日志数量\n- 各分类日志数量\n- 最近错误数",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/architecture",
    "function": "get_system_architecture",
    "docstring": "获取系统架构信息 (Week 3简化后 - 双数据库架构)\n\n返回完整的系统架构信息，包括:\n- 数据库架构 (TDengine + PostgreSQL)\n- 数据分类路由策略\n- 架构简化指标\n- 技术栈信息\n- MySQL/Redis移除详情\n\n用于架构可视化页面展示",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/database/health",
    "function": "database_health",
    "docstring": "数据库健康检查 (US2 - 双数据库架构)\n\n检查TDengine和PostgreSQL的连接状态和基本健康指标\n\nReturns:\n{\n\"success\": true,\n\"message\": \"数据库健康检查完成\",\n\"data\": {\n\"tdengine\": {...},\n\"postgresql\": {...},\n\"summary\": {...}\n}\n}",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "GET",
    "path": "/database/stats",
    "function": "database_stats",
    "docstring": "数据库统计信息 (US2 - 双数据库架构)\n\nReturns:\n{\n\"success\": true,\n\"message\": \"数据库统计信息获取成功\",\n\"data\": {\n\"architecture\": \"dual-database\",\n\"total_classifications\": 34,\n\"routing\": {...},\n\"features\": {...}\n}\n}",
    "file": "system.py",
    "module": "system"
  },
  {
    "method": "POST",
    "path": "/register",
    "function": "register_task",
    "docstring": "if use_mock:\n# Mock数据响应\nimport random\ntask_id = f\"task_{random.randint(1000, 9999)}\"\nreturn TaskResponse(\nsuccess=True,\nmessage=\"任务注册成功\",\ndata={\"task_id\": task_id, \"status\": \"registered\"}\n)\n\ntry:\nresponse = task_manager.register_task(task_config)\nif not response.success:\nraise HTTPException(status_code=400, detail=response.message)\nreturn response\nexcept Exception as e:\nlogger.error(\"Failed to register task\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.delete(\"/{task_id}\", response_model=TaskResponse)\nasync def unregister_task(task_id: str):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "DELETE",
    "path": "/{task_id}",
    "function": "unregister_task",
    "docstring": "try:\nresponse = task_manager.unregister_task(task_id)\nif not response.success:\nraise HTTPException(status_code=404, detail=response.message)\nreturn response\nexcept Exception as e:\nlogger.error(\"Failed to unregister task\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/\", response_model=List[TaskConfig])\nasync def list_tasks(\ntask_type: Optional[TaskType] = None,\ntags: Optional[str] = Query(None, description=\"Comma-separated tags\"),\n):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/",
    "function": "list_tasks",
    "docstring": "if use_mock:\n# Mock数据：返回模拟任务列表\nfrom app.models.task import TaskConfig, TaskType\nimport random\n\nmock_tasks = []\nfor i in range(5):\ntask = TaskConfig(\ntask_id=f\"task_{i+1000}\",\nname=f\"模拟任务_{i+1}\",\ndescription=f\"这是一个模拟任务_{i+1}\",\ntask_type=TaskType.DATA_PROCESSING,\nconfig={\"param1\": f\"value{i+1}\"},\ntags=[f\"tag{i+1}\", \"mock\"],\nenabled=True,\ncreated_at=datetime.now() - timedelta(days=i)\n)\nmock_tasks.append(task)\nreturn mock_tasks\n\ntry:\ntag_list = tags.split(\",\") if tags else None\ntasks = task_manager.list_tasks(task_type=task_type, tags=tag_list)\nreturn tasks\nexcept Exception as e:\nlogger.error(\"Failed to list tasks\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/{task_id}\", response_model=TaskConfig)\nasync def get_task(task_id: str):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/{task_id}",
    "function": "get_task",
    "docstring": "if use_mock:\n# Mock数据：返回模拟任务详情\nfrom app.models.task import TaskConfig, TaskType\n\ntask = TaskConfig(\ntask_id=task_id,\nname=f\"模拟任务_{task_id}\",\ndescription=f\"任务{task_id}的详细描述\",\ntask_type=TaskType.DATA_PROCESSING,\nconfig={\"param1\": \"mock_value\", \"batch_size\": 100},\ntags=[\"mock\", \"demo\"],\nenabled=True,\ncreated_at=datetime.now() - timedelta(days=1)\n)\nreturn task\n\ntry:\ntask = task_manager.get_task(task_id)\nif not task:\nraise HTTPException(status_code=404, detail=f\"Task {task_id} not found\")\nreturn task\nexcept HTTPException:\nraise\nexcept Exception as e:\nlogger.error(\"Failed to get task\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.post(\"/{task_id}/start\", response_model=TaskResponse)\nasync def start_task(task_id: str, params: Optional[Dict[str, Any]] = Body(None)):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "POST",
    "path": "/{task_id}/start",
    "function": "start_task",
    "docstring": "try:\nresponse = await task_manager.start_task(task_id, params)\nif not response.success:\nraise HTTPException(status_code=400, detail=response.message)\nreturn response\nexcept HTTPException:\nraise\nexcept Exception as e:\nlogger.error(\"Failed to start task\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.post(\"/{task_id}/stop\", response_model=TaskResponse)\nasync def stop_task(task_id: str):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "POST",
    "path": "/{task_id}/stop",
    "function": "stop_task",
    "docstring": "try:\nresponse = task_manager.stop_task(task_id)\nif not response.success:\nraise HTTPException(status_code=400, detail=response.message)\nreturn response\nexcept HTTPException:\nraise\nexcept Exception as e:\nlogger.error(\"Failed to stop task\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/executions/\", response_model=List[TaskExecution])\nasync def list_task_executions(\ntask_id: Optional[str] = None,\nlimit: int = Query(50, ge=1, le=1000),\n):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/executions/",
    "function": "list_task_executions",
    "docstring": "if use_mock:\n# Mock数据：返回模拟执行历史\nfrom app.models.task import TaskExecution, TaskStatus\n\nexecutions = []\nfor i in range(min(limit, 10)):\nexecution = TaskExecution(\nexecution_id=f\"exec_{i+1000}\",\ntask_id=task_id or f\"task_{i%3+1000}\",\nstatus=TaskStatus.COMPLETED if i % 4 != 0 else TaskStatus.FAILED,\nstart_time=datetime.now() - timedelta(hours=i+1),\nend_time=datetime.now() - timedelta(hours=i) + timedelta(minutes=30),\nresult={\"processed\": i*100, \"success_rate\": 95.0 + i},\nerror_message=None if i % 4 != 0 else \"模拟错误信息\"\n)\nexecutions.append(execution)\nreturn executions\n\ntry:\nexecutions = task_manager.list_executions(task_id=task_id, limit=limit)\nreturn executions\nexcept Exception as e:\nlogger.error(\"Failed to list task executions\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/executions/{execution_id}\", response_model=TaskExecution)\nasync def get_execution(execution_id: str):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/executions/{execution_id}",
    "function": "get_execution",
    "docstring": "try:\nexecution = task_manager.get_execution(execution_id)\nif not execution:\nraise HTTPException(\nstatus_code=404, detail=f\"Execution {execution_id} not found\"\n)\nreturn execution\nexcept HTTPException:\nraise\nexcept Exception as e:\nlogger.error(\"Failed to get execution\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/statistics/\", response_model=Dict[str, TaskStatistics])\nasync def get_task_statistics():",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/statistics/",
    "function": "get_task_statistics",
    "docstring": "if use_mock:\n# Mock数据：返回模拟统计信息\nfrom app.models.task import TaskStatistics, TaskStatus\nimport random\n\nstats = {\n\"total_tasks\": TaskStatistics(\ncount=25,\nsuccess_count=20,\nfailed_count=3,\nrunning_count=2,\navg_execution_time=45.5,\nsuccess_rate=80.0\n),\n\"data_processing\": TaskStatistics(\ncount=15,\nsuccess_count=12,\nfailed_count=2,\nrunning_count=1,\navg_execution_time=30.2,\nsuccess_rate=80.0\n),\n\"backtest\": TaskStatistics(\ncount=8,\nsuccess_count=6,\nfailed_count=1,\nrunning_count=1,\navg_execution_time=120.8,\nsuccess_rate=75.0\n),\n\"alert\": TaskStatistics(\ncount=2,\nsuccess_count=2,\nfailed_count=0,\nrunning_count=0,\navg_execution_time=5.3,\nsuccess_rate=100.0\n)\n}\nreturn stats\n\ntry:\nstats = task_manager.get_statistics()\nreturn stats\nexcept Exception as e:\nlogger.error(\"Failed to get task statistics\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.post(\"/import\", response_model=TaskResponse)\nasync def import_config(config_path: str = Body(..., embed=True)):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "POST",
    "path": "/import",
    "function": "import_config",
    "docstring": "try:\nresponse = task_manager.import_config(config_path)\nif not response.success:\nraise HTTPException(status_code=400, detail=response.message)\nreturn response\nexcept HTTPException:\nraise\nexcept Exception as e:\nlogger.error(\"Failed to import config\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.post(\"/export\")\nasync def export_config(output_path: str = Body(..., embed=True)):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "POST",
    "path": "/export",
    "function": "export_config",
    "docstring": "try:\ntask_manager.export_config(output_path)\nreturn {\n\"success\": True,\n\"message\": \"Configuration exported successfully\",\n\"path\": output_path,\n}\nexcept Exception as e:\nlogger.error(\"Failed to export config\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.delete(\"/executions/cleanup\")\nasync def cleanup_executions(days: int = Query(7, ge=1, le=90)):",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "DELETE",
    "path": "/executions/cleanup",
    "function": "cleanup_executions",
    "docstring": "try:\ncount = task_manager.cleanup_old_executions(days=days)\nreturn {\n\"success\": True,\n\"message\": f\"Cleaned up {count} old execution records\",\n\"count\": count,\n}\nexcept Exception as e:\nlogger.error(\"Failed to cleanup executions\", error=str(e))\nraise HTTPException(status_code=500, detail=str(e))\n\n\n@router.get(\"/health\")\nasync def tasks_health():",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "tasks_health",
    "docstring": "",
    "file": "tasks.py",
    "module": "tasks"
  },
  {
    "method": "GET",
    "path": "/{symbol}/indicators",
    "function": "get_all_indicators",
    "docstring": "获取股票的所有技术指标\n\n参数:\n- symbol: 股票代码 (如: 600519)\n- period: 数据周期 (daily, weekly, monthly)\n- start_date: 开始日期 (可选)\n- end_date: 结束日期 (可选)\n\n返回:\n- 包含趋势、动量、波动性、成交量指标的综合数据\n\n示例:\n- GET /api/technical/600519/indicators\n- GET /api/technical/600519/indicators?period=weekly\n- GET /api/technical/600519/indicators?start_date=2024-01-01&end_date=2025-10-23",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/{symbol}/trend",
    "function": "get_trend_indicators",
    "docstring": "获取趋势指标\n\n包括:\n- MA (移动平均线): 5, 10, 20, 30, 60, 120, 250日\n- EMA (指数移动平均线): 12, 26, 50日\n- MACD (指数平滑异同移动平均线)\n- DMI (动向指标): ADX, +DI, -DI\n- SAR (抛物线转向指标)\n\n示例:\n- GET /api/technical/600519/trend",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/{symbol}/momentum",
    "function": "get_momentum_indicators",
    "docstring": "获取动量指标\n\n包括:\n- RSI (相对强弱指标): 6, 12, 24日\n- KDJ (随机指标): K, D, J\n- CCI (顺势指标)\n- WR (威廉指标)\n- ROC (变动率指标)\n\n示例:\n- GET /api/technical/600519/momentum",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/{symbol}/volatility",
    "function": "get_volatility_indicators",
    "docstring": "获取波动性指标\n\n包括:\n- Bollinger Bands (布林带): upper, middle, lower, width\n- ATR (平均真实波幅)\n- Keltner Channel (肯特纳通道)\n- Standard Deviation (标准差)\n\n示例:\n- GET /api/technical/600519/volatility",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/{symbol}/volume",
    "function": "get_volume_indicators",
    "docstring": "获取成交量指标\n\n包括:\n- OBV (能量潮指标)\n- VWAP (成交量加权平均价)\n- Volume MA (成交量均线): 5, 10日\n- Volume Ratio (量比)\n\n示例:\n- GET /api/technical/600519/volume",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/{symbol}/signals",
    "function": "get_trading_signals",
    "docstring": "获取交易信号\n\n基于技术指标生成买入/卖出/持有信号\n\n信号类型:\n- macd_golden_cross: MACD金叉 (买入信号)\n- macd_death_cross: MACD死叉 (卖出信号)\n- rsi_oversold: RSI超卖 (买入信号)\n- rsi_overbought: RSI超买 (卖出信号)\n\n示例:\n- GET /api/technical/600519/signals",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/{symbol}/history",
    "function": "get_stock_history",
    "docstring": "获取股票历史行情数据\n\n用于前端绘制 K 线图和指标图表\n\n参数:\n- symbol: 股票代码\n- period: 周期 (daily, weekly, monthly)\n- start_date: 开始日期 (可选)\n- end_date: 结束日期 (可选)\n- limit: 返回数据点数量 (默认100，最多1000)\n\n返回:\n- OHLCV 数据及基础指标\n\n示例:\n- GET /api/technical/600519/history?limit=200\n- GET /api/technical/600519/history?start_date=2024-01-01",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "POST",
    "path": "/batch/indicators",
    "function": "get_batch_indicators",
    "docstring": "批量获取多只股票的技术指标\n\n参数:\n- symbols: 股票代码列表 (最多20只)\n\n示例:\n- POST /api/technical/batch/indicators?symbols=600519&symbols=000001&symbols=600000",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "GET",
    "path": "/patterns/{symbol}",
    "function": "detect_patterns",
    "docstring": "检测技术形态 (预留功能)\n\n将实现:\n- 头肩顶/底\n- 双顶/底\n- 三角形整理\n- 矩形整理\n- 旗形、楔形\n等常见形态\n\n示例:\n- GET /api/technical/patterns/600519",
    "file": "technical_analysis.py",
    "module": "technical_analysis"
  },
  {
    "method": "POST",
    "path": "/chart/config",
    "function": "get_chart_config",
    "docstring": "获取 TradingView 图表配置\n\n返回用于前端嵌入的图表配置",
    "file": "tradingview.py",
    "module": "tradingview"
  },
  {
    "method": "POST",
    "path": "/mini-chart/config",
    "function": "get_mini_chart_config",
    "docstring": "获取 TradingView 迷你图表配置",
    "file": "tradingview.py",
    "module": "tradingview"
  },
  {
    "method": "POST",
    "path": "/ticker-tape/config",
    "function": "get_ticker_tape_config",
    "docstring": "获取 TradingView Ticker Tape 配置",
    "file": "tradingview.py",
    "module": "tradingview"
  },
  {
    "method": "GET",
    "path": "/market-overview/config",
    "function": "get_market_overview_config",
    "docstring": "获取 TradingView 市场概览配置",
    "file": "tradingview.py",
    "module": "tradingview"
  },
  {
    "method": "GET",
    "path": "/screener/config",
    "function": "get_screener_config",
    "docstring": "获取 TradingView 股票筛选器配置",
    "file": "tradingview.py",
    "module": "tradingview"
  },
  {
    "method": "GET",
    "path": "/symbol/convert",
    "function": "convert_symbol",
    "docstring": "将股票代码转换为 TradingView 格式",
    "file": "tradingview.py",
    "module": "tradingview"
  },
  {
    "method": "GET",
    "path": "/",
    "function": "get_my_watchlist",
    "docstring": "获取当前用户的自选股列表",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/symbols",
    "function": "get_my_watchlist_symbols",
    "docstring": "获取当前用户的自选股代码列表",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "POST",
    "path": "/add",
    "function": "add_to_watchlist",
    "docstring": "添加股票到自选股列表\n支持通过 group_id 或 group_name 指定分组\n如果提供 group_name 且分组不存在，会自动创建",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "DELETE",
    "path": "/remove/{symbol}",
    "function": "remove_from_watchlist",
    "docstring": "从自选股列表中删除股票",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/check/{symbol}",
    "function": "check_in_watchlist",
    "docstring": "检查股票是否在自选股列表中",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "PUT",
    "path": "/notes/{symbol}",
    "function": "update_watchlist_notes",
    "docstring": "更新自选股备注",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/count",
    "function": "get_watchlist_count",
    "docstring": "获取自选股数量",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "DELETE",
    "path": "/clear",
    "function": "clear_watchlist",
    "docstring": "清空当前用户的自选股列表",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/groups",
    "function": "get_user_groups",
    "docstring": "获取当前用户的所有自选股分组",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "POST",
    "path": "/groups",
    "function": "create_group",
    "docstring": "创建新的自选股分组",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "PUT",
    "path": "/groups/{group_id}",
    "function": "update_group",
    "docstring": "修改分组名称",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "DELETE",
    "path": "/groups/{group_id}",
    "function": "delete_group",
    "docstring": "删除分组（会同时删除该分组下的所有自选股）",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/group/{group_id}",
    "function": "get_watchlist_by_group",
    "docstring": "获取指定分组的自选股列表",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "PUT",
    "path": "/move",
    "function": "move_stock_to_group",
    "docstring": "将股票从一个分组移动到另一个分组",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/with-groups",
    "function": "get_watchlist_with_groups",
    "docstring": "获取所有分组及其包含的自选股（分组视图）",
    "file": "watchlist.py",
    "module": "watchlist"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "健康检查\n\n检查服务是否正常运行\n\nReturns:\n健康状态",
    "file": "wencai.py",
    "module": "wencai"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "return {\"status\": \"ok\", \"service\": \"trade\"}\n\n\n@router.get(\"/portfolio\")\nasync def get_portfolio():",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/portfolio",
    "function": "get_portfolio",
    "docstring": "获取投资组合概览\n\nReturns:\nDict: 投资组合信息 (总资产、可用资金、持仓市值、盈亏)",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/positions",
    "function": "get_positions",
    "docstring": "获取持仓列表\n\nReturns:\nDict: 持仓数据列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/trades",
    "function": "get_trades",
    "docstring": "获取交易记录列表\n\nArgs:\ntrade_type: 交易类型 (buy/sell)\nsymbol: 股票代码\nstart_date: 开始日期\nend_date: 结束日期\npage: 页码\npage_size: 每页数量\n\nReturns:\nDict: 交易记录列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/statistics",
    "function": "get_statistics",
    "docstring": "获取交易统计数据\n\nReturns:\nDict: 统计数据 (总交易次数、买卖次数、盈亏等)",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/execute",
    "function": "execute_trade",
    "docstring": "执行买卖交易\n\nArgs:\ntrade_data: 交易信息 (type, symbol, quantity, price, remark)\n\nReturns:\nDict: 交易执行结果",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "return {\"status\": \"ok\", \"service\": \"monitoring\"}\n\n\n@router.get(\"/status\")\nasync def get_status():",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_status",
    "docstring": "return {\"status\": \"active\", \"endpoint\": \"monitoring\"}\n\n\n@router.post(\"/analyze\")\nasync def analyze_data(data: dict):",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/analyze",
    "function": "analyze_data",
    "docstring": "",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "return {\"status\": \"ok\", \"service\": \"technical\"}\n\n\n@router.get(\"/status\")\nasync def get_status():",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_status",
    "docstring": "return {\"status\": \"active\", \"endpoint\": \"technical\"}\n\n\n@router.post(\"/analyze\")\nasync def analyze_data(data: dict):",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/analyze",
    "function": "analyze_data",
    "docstring": "",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/postgresql/stats",
    "function": "get_postgresql_pool_stats",
    "docstring": "获取PostgreSQL连接池统计信息\n\nReturns:\n- pool_size: 当前连接池大小\n- checked_in: 空闲连接数\n- checked_out: 活跃连接数\n- overflow: 溢出连接数\n- pool_status: 连接池状态描述\n- timestamp: 查询时间戳",
    "file": "pool_monitoring.py",
    "module": "pool_monitoring"
  },
  {
    "method": "GET",
    "path": "/tdengine/stats",
    "function": "get_tdengine_pool_stats",
    "docstring": "获取TDengine连接池统计信息\n\nReturns:\n- total_created: 总创建连接数\n- total_closed: 总关闭连接数\n- active_connections: 当前活跃连接数\n- idle_connections: 当前空闲连接数\n- connection_requests: 总连接请求数\n- connection_timeouts: 连接超时次数\n- connection_errors: 连接错误次数\n- pool_size: 当前连接池大小\n- timestamp: 查询时间戳",
    "file": "pool_monitoring.py",
    "module": "pool_monitoring"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "connection_pools_health_check",
    "docstring": "检查所有连接池的健康状态\n\nReturns:\n- postgresql: PostgreSQL连接池健康状态\n- tdengine: TDengine连接池健康状态\n- overall_status: 总体健康状态\n- timestamp: 检查时间戳",
    "file": "pool_monitoring.py",
    "module": "pool_monitoring"
  },
  {
    "method": "GET",
    "path": "/alerts",
    "function": "check_connection_pool_alerts",
    "docstring": "检测连接池是否存在需要告警的情况\n\n告警条件:\n- 连接池使用率 > 80%\n- 连接错误率 > 5%\n- 连接超时率 > 2%\n\nReturns:\n- has_alerts: 是否存在告警\n- alerts: 告警列表\n- timestamp: 检查时间戳",
    "file": "pool_monitoring.py",
    "module": "pool_monitoring"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "return {\"status\": \"ok\", \"service\": \"announcement\"}\n\n\n@router.get(\"/status\")\nasync def get_status():",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_status",
    "docstring": "return {\"status\": \"active\", \"endpoint\": \"announcement\"}\n\n\n@router.post(\"/analyze\")\nasync def analyze_data(data: dict):",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/analyze",
    "function": "analyze_data",
    "docstring": "# TODO: 实现AI分析逻辑\nreturn {\"result\": \"分析完成\", \"endpoint\": \"announcement\"}\n\n\nif HAS_ANNOUNCEMENT_SERVICE:\n\n@router.post(\"/fetch\")\nasync def fetch_announcements(\nsymbol: Optional[str] = Query(None, description=\"股票代码\"),\nstart_date: Optional[date] = Query(None, description=\"开始日期\"),\nend_date: Optional[date] = Query(None, description=\"结束日期\"),\ncategory: Optional[str] = Query(\"all\", description=\"公告类别\"),\n):",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/fetch",
    "function": "fetch_announcements",
    "docstring": "从数据源获取并保存公告\n\nArgs:\nsymbol: 股票代码（可选）\nstart_date: 开始日期\nend_date: 结束日期\ncategory: 公告类别\n\nReturns:\nDict: 获取结果",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/list",
    "function": "get_announcements",
    "docstring": "查询公告列表\n\nArgs:\nstock_code: 股票代码\nstart_date: 开始日期\nend_date: 结束日期\nannouncement_type: 公告类型\nmin_importance: 最小重要性级别\npage: 页码\npage_size: 每页数量\n\nReturns:\nDict: 公告列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/today",
    "function": "get_today_announcements",
    "docstring": "获取今日公告\n\nArgs:\nmin_importance: 最小重要性级别\n\nReturns:\nDict: 今日公告列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/important",
    "function": "get_important_announcements",
    "docstring": "获取重要公告\n\nArgs:\ndays: 查询天数（默认7天）\nmin_importance: 最小重要性级别（默认3）\n\nReturns:\nDict: 重要公告列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/stats",
    "function": "get_announcement_stats",
    "docstring": "获取公告统计信息\n\nReturns:\nDict: 统计信息",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/monitor-rules",
    "function": "get_monitor_rules",
    "docstring": "获取监控规则列表\n\nReturns:\nList: 监控规则列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/monitor-rules",
    "function": "create_monitor_rule",
    "docstring": "创建监控规则\n\nArgs:\nrule_data: 监控规则创建请求\n\nReturns:\nDict: 创建的规则",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "PUT",
    "path": "/monitor-rules/{rule_id}",
    "function": "update_monitor_rule",
    "docstring": "更新监控规则\n\nArgs:\nrule_id: 规则ID\nupdates: 更新内容\n\nReturns:\nDict: 更新后的规则",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "DELETE",
    "path": "/monitor-rules/{rule_id}",
    "function": "delete_monitor_rule",
    "docstring": "删除监控规则\n\nArgs:\nrule_id: 规则ID\n\nReturns:\nDict: 操作结果",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/triggered-records",
    "function": "get_triggered_records",
    "docstring": "获取触发记录列表\n\nArgs:\nrule_id: 规则ID\nstock_code: 股票代码\npage: 页码\npage_size: 每页数量\n\nReturns:\nDict: 触发记录列表",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/monitor/evaluate",
    "function": "evaluate_monitor_rules",
    "docstring": "评估所有监控规则\n\n检查是否有新公告触发监控规则\n\nReturns:\nDict: 评估结果",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/health",
    "function": "health_check",
    "docstring": "return {\"status\": \"ok\", \"service\": \"multi_source\"}\n\n\n@router.get(\"/status\")\nasync def get_status():",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "GET",
    "path": "/status",
    "function": "get_status",
    "docstring": "return {\"status\": \"active\", \"endpoint\": \"multi_source\"}\n\n\n@router.post(\"/analyze\")\nasync def analyze_data(data: dict):",
    "file": "routes.py",
    "module": "routes"
  },
  {
    "method": "POST",
    "path": "/analyze",
    "function": "analyze_data",
    "docstring": "",
    "file": "routes.py",
    "module": "routes"
  }
]
