src/__init__.py:1:1: D104 Missing docstring in public package
src/adapters/__init__.py:1:1: D400 First line should end with a period
"""MyStocks package modules"""
^
src/adapters/akshare_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：AkShare数据源适配器，提供A股行情和基本面数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/akshare_adapter.py:1:1: D400 First line should end with a period
"""
# 功能：AkShare数据源适配器，提供A股行情和基本面数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/akshare_adapter.py:27:1: E402 module level import not at top of file
from src.utils.error_handler import retry_on_failure
^
src/adapters/akshare_adapter.py:28:1: E402 module level import not at top of file
from src.interfaces.data_source import IDataSource
^
src/adapters/akshare_adapter.py:29:1: E402 module level import not at top of file
from src.utils.date_utils import normalize_date
^
src/adapters/akshare_adapter.py:30:1: E402 module level import not at top of file
from src.utils.symbol_utils import (
^
src/adapters/akshare_adapter.py:34:1: E402 module level import not at top of file
from src.utils.column_mapper import ColumnMapper
^
src/adapters/akshare_adapter.py:37:1: E402 module level import not at top of file
import logging
^
src/adapters/akshare_adapter.py:38:1: F811 redefinition of unused 'Optional' from line 13
from typing import Optional
^
src/adapters/akshare_adapter.py:38:1: E402 module level import not at top of file
from typing import Optional
^
src/adapters/akshare_adapter.py:55:1: D400 First line should end with a period
    """Akshare数据源实现

    属性:
        api_timeout (int): API请求超时时间(秒)
        max_retries (int): 最大重试次数
    """
^
src/adapters/akshare_adapter.py:63:80: E501 line too long (80 > 79 characters)
        self, api_timeout: int = REQUEST_TIMEOUT, max_retries: int = MAX_RETRIES
                                                                               ^
src/adapters/akshare_adapter.py:65:1: D400 First line should end with a period
        """初始化Akshare数据源

        Args:
            api_timeout: API请求超时时间(秒)
            max_retries: 最大重试次数
        """
^
src/adapters/akshare_adapter.py:78:1: D400 First line should end with a period
        """API调用重试装饰器 - 使用统一错误处理"""
^
src/adapters/akshare_adapter.py:98:1: D400 First line should end with a period
        """获取股票日线数据-Akshare实现"""
^
src/adapters/akshare_adapter.py:109:80: E501 line too long (93 > 79 characters)
                    f"Akshare尝试获取股票日线数据: 代码={stock_code}, 开始日期={start_date}, 结束日期={end_date}"
                                                                               ^
src/adapters/akshare_adapter.py:132:80: E501 line too long (114 > 79 characters)
                        f"主要API调用成功，参数: symbol={stock_code}, start_date={start_date_fmt}, end_date={end_date_fmt}"
                                                                               ^
src/adapters/akshare_adapter.py:151:80: E501 line too long (86 > 79 characters)
                                    "date": [normalize_date(datetime.datetime.now())],
                                                                               ^
src/adapters/akshare_adapter.py:185:1: D205 1 blank line required between summary line and description
        """获取指数日线数据-Akshare实现
        使用优先级：
        1. 新浪接口(stock_zh_index_daily)
        2. 东方财富接口(stock_zh_index_daily_em)
        3. 通用接口(index_zh_a_hist)
        """
^
src/adapters/akshare_adapter.py:185:1: D400 First line should end with a period
        """获取指数日线数据-Akshare实现
        使用优先级：
        1. 新浪接口(stock_zh_index_daily)
        2. 东方财富接口(stock_zh_index_daily_em)
        3. 通用接口(index_zh_a_hist)
        """
^
src/adapters/akshare_adapter.py:211:80: E501 line too long (80 > 79 characters)
                        df["date"] >= pd.to_datetime(normalize_date(start_date))
                                                                               ^
src/adapters/akshare_adapter.py:212:80: E501 line too long (80 > 79 characters)
                    ) & (df["date"] <= pd.to_datetime(normalize_date(end_date)))
                                                                               ^
src/adapters/akshare_adapter.py:230:80: E501 line too long (80 > 79 characters)
                        df["date"] >= pd.to_datetime(normalize_date(start_date))
                                                                               ^
src/adapters/akshare_adapter.py:231:80: E501 line too long (80 > 79 characters)
                    ) & (df["date"] <= pd.to_datetime(normalize_date(end_date)))
                                                                               ^
src/adapters/akshare_adapter.py:272:1: D400 First line should end with a period
        """处理指数数据统一格式"""
^
src/adapters/akshare_adapter.py:277:1: D400 First line should end with a period
        """获取股票基本信息-Akshare实现"""
^
src/adapters/akshare_adapter.py:301:1: D400 First line should end with a period
        """获取指数成分股-Akshare实现"""
^
src/adapters/akshare_adapter.py:324:1: D400 First line should end with a period
        """获取实时数据-Akshare实现"""
^
src/adapters/akshare_adapter.py:346:80: E501 line too long (82 > 79 characters)
    def get_market_calendar(self, start_date: str, end_date: str) -> pd.DataFrame:
                                                                               ^
src/adapters/akshare_adapter.py:347:1: D400 First line should end with a period
        """获取交易日历-Akshare实现"""
^
src/adapters/akshare_adapter.py:361:80: E501 line too long (84 > 79 characters)
            mask = (df["trade_date"] >= start_date) & (df["trade_date"] <= end_date)
                                                                               ^
src/adapters/akshare_adapter.py:369:80: E501 line too long (86 > 79 characters)
    def get_financial_data(self, symbol: str, period: str = "annual") -> pd.DataFrame:
                                                                               ^
src/adapters/akshare_adapter.py:370:1: D400 First line should end with a period
        """获取财务数据-Akshare实现"""
^
src/adapters/akshare_adapter.py:388:1: D400 First line should end with a period
        """获取新闻数据-Akshare实现"""
^
src/adapters/akshare_adapter.py:414:1: D400 First line should end with a period
        """获取同花顺行业一览表数据-Akshare实现

        该接口获取同花顺网站的行业板块数据，包含行业名称、最新价、涨跌幅、
        涨跌额、成交量、成交额、领涨股等信息。

        Returns:
            pd.DataFrame: 同花顺行业一览表数据
                - 行业: 行业名称
                - 最新价: 行业指数最新价格
                - 涨跌幅: 涨跌幅百分比
                - 涨跌额: 涨跌绝对值
                - 成交量: 成交量
                - 成交额: 成交金额
                - 领涨股: 该行业领涨股票
                - 涨跌家数: 上涨/下跌股票家数

        示例用法:
            >>> adapter = AkshareDataSource()
            >>> industry_data = adapter.get_ths_industry_summary()
            >>> logger.info(str(industry_data.head()))
        """
^
src/adapters/akshare_adapter.py:472:1: D400 First line should end with a period
        """获取同花顺指定行业的成分股数据-Akshare实现

        该接口获取同花顺指定行业下的所有成分股信息。
        注意：由于akshare的接口限制，此方法将使用东方财富的行业成分股接口。

        Args:
            industry_name (str): 行业名称，例如："房地产开发", "银行", "白酒" 等

        Returns:
            pd.DataFrame: 指定行业的成分股数据
                - 代码: 股票代码
                - 名称: 股票名称
                - 最新价: 最新价格
                - 涨跌幅: 涨跌幅百分比
                - 涨跌额: 涨跌绝对值
                - 成交量: 成交量
                - 成交额: 成交金额
                - 市盈率: 市盈率
                - 流通市值: 流通市值

        示例用法:
            >>> adapter = AkshareDataSource()
            >>> bank_stocks = adapter.get_ths_industry_stocks("银行")
            >>> logger.info(str(bank_stocks.head()))
        """
^
src/adapters/akshare_adapter.py:514:80: E501 line too long (95 > 79 characters)
                f"[Akshare] 成功获取行业'{industry_name}'成分股数据: {len(df)}行, 列名={df.columns.tolist()}"
                                                                               ^
src/adapters/akshare_adapter.py:531:1: D400 First line should end with a period
        """获取同花顺行业名称列表-Akshare实现

        该接口获取同花顺的所有行业名称和代码。

        Returns:
            pd.DataFrame: 同花顺行业名称列表
                - name: 行业名称
                - code: 行业代码

        示例用法:
            >>> adapter = AkshareDataSource()
            >>> industry_names = adapter.get_ths_industry_names()
            >>> logger.info(str(industry_names.head()))
        """
^
src/adapters/akshare_adapter.py:561:80: E501 line too long (80 > 79 characters)
                f"[Akshare] 成功获取同花顺行业名称列表: {len(df)}行, 列名={df.columns.tolist()}"
                                                                               ^
src/adapters/akshare_adapter.py:579:1: D400 First line should end with a period
        """
        获取分钟K线数据（通过TDX适配器获取，AkShare本身不直接支持分钟K线）

        Args:
            symbol: str - 股票代码
            period: str - 周期 (1m/5m/15m/30m/60m)
            start_date: str - 开始日期
            end_date: str - 结束日期

        Returns:
            pd.DataFrame: 分钟K线数据
        """
^
src/adapters/akshare_adapter.py:593:21: F541 f-string is missing placeholders
        logger.info(f"[Akshare] 注意：AkShare不直接支持分钟K线数据，建议使用TDX适配器")
                    ^
src/adapters/akshare_adapter.py:597:1: D400 First line should end with a period
        """
        获取行业分类数据

        Returns:
            pd.DataFrame: 行业分类数据
                - index: 行业代码
                - name: 行业名称
                - stock_count: 成分股数量
                - up_count: 上涨股票数
                - down_count: 下跌股票数
                - leader_stock: 领涨股
        """
^
src/adapters/akshare_adapter.py:658:1: D400 First line should end with a period
        """
        获取概念分类数据

        Returns:
            pd.DataFrame: 概念分类数据
                - index: 概念代码
                - name: 概念名称
                - stock_count: 成分股数量
                - up_count: 上涨股票数
                - down_count: 下跌股票数
                - leader_stock: 领涨股
        """
^
src/adapters/akshare_adapter.py:719:1: D400 First line should end with a period
        """
        获取个股的行业和概念分类信息

        Args:
            symbol: str - 股票代码

        Returns:
            Dict: 个股行业和概念信息
                - symbol: 股票代码
                - industries: 行业列表
                - concepts: 概念列表
        """
^
src/adapters/akshare_adapter.py:765:80: E501 line too long (83 > 79 characters)
                            c.strip() for c in str(concept).split(",") if c.strip()
                                                                               ^
src/adapters/akshare_proxy_adapter.py:3:1: D400 First line should end with a period
"""
AkShare通用接口代理适配器

功能：
- 动态调用任何akshare接口，无需提前定义
- 提供统一的错误处理和重试机制
- 支持参数验证和类型转换
- 自动添加时间戳和数据标准化

使用场景：
- 快速接入新的akshare接口
- 测试和验证akshare功能
- 临时数据获取需求

注意：此适配器适合快速原型开发，生产环境建议使用专门的适配器
"""
^
src/adapters/akshare_proxy_adapter.py:31:80: E501 line too long (80 > 79 characters)
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/adapters/akshare_proxy_adapter.py:34:1: E402 module level import not at top of file
from mystocks.interfaces.data_source import IDataSource
^
src/adapters/akshare_proxy_adapter.py:43:1: D400 First line should end with a period
    """AkShare通用接口代理适配器

    可以动态调用任何akshare接口，提供统一的错误处理和数据标准化
    """
^
src/adapters/akshare_proxy_adapter.py:49:80: E501 line too long (80 > 79 characters)
        self, api_timeout: int = REQUEST_TIMEOUT, max_retries: int = MAX_RETRIES
                                                                               ^
src/adapters/akshare_proxy_adapter.py:51:1: D400 First line should end with a period
        """初始化AkShare代理适配器

        Args:
            api_timeout: API请求超时时间(秒)
            max_retries: 最大重试次数
        """
^
src/adapters/akshare_proxy_adapter.py:61:80: E501 line too long (81 > 79 characters)
            f"[AkshareProxy] 代理适配器初始化完成 (超时: {api_timeout}s, 重试: {max_retries}次)"
                                                                               ^
src/adapters/akshare_proxy_adapter.py:68:1: D400 First line should end with a period
        """发现所有可用的akshare函数"""
^
src/adapters/akshare_proxy_adapter.py:75:21: F841 local variable 'sig' is assigned to but never used
                    sig = inspect.signature(obj)
                    ^
src/adapters/akshare_proxy_adapter.py:83:1: D400 First line should end with a period
        """API调用重试装饰器"""
^
src/adapters/akshare_proxy_adapter.py:103:1: D400 First line should end with a period
        """动态调用akshare函数

        Args:
            function_name: akshare函数名称
            **kwargs: 函数参数

        Returns:
            函数执行结果
        """
^
src/adapters/akshare_proxy_adapter.py:106:1: RST210 Inline strong start-string without end-string.
        """动态调用akshare函数

        Args:
            function_name: akshare函数名称
            **kwargs: 函数参数

        Returns:
            函数执行结果
        """
^
src/adapters/akshare_proxy_adapter.py:125:80: E501 line too long (93 > 79 characters)
                        f"[AkshareProxy] 未找到函数 '{function_name}'，相似的函数有: {available_similar}"
                                                                               ^
src/adapters/akshare_proxy_adapter.py:143:80: E501 line too long (99 > 79 characters)
                    f"[AkshareProxy] 成功获取DataFrame数据: {len(result)}行, 列名={result.columns.tolist()}"
                                                                               ^
src/adapters/akshare_proxy_adapter.py:153:80: E501 line too long (80 > 79 characters)
                print(f"[AkshareProxy] 成功获取{type(result).__name__}数据: {result}")
                                                                               ^
src/adapters/akshare_proxy_adapter.py:165:1: D400 First line should end with a period
        """获取akshare函数的信息

        Args:
            function_name: 函数名称

        Returns:
            包含函数信息的字典
        """
^
src/adapters/akshare_proxy_adapter.py:185:80: E501 line too long (84 > 79 characters)
                "doc": doc.strip()[:200] + "..." if len(doc) > 200 else doc.strip(),
                                                                               ^
src/adapters/akshare_proxy_adapter.py:191:1: D400 First line should end with a period
        """搜索包含关键词的akshare函数

        Args:
            keyword: 搜索关键词

        Returns:
            匹配的函数名列表
        """
^
src/adapters/akshare_proxy_adapter.py:217:1: D400 First line should end with a period
        """列出所有股票相关的函数"""
^
src/adapters/akshare_proxy_adapter.py:229:1: D400 First line should end with a period
        """列出所有行业板块相关的函数"""
^
src/adapters/akshare_proxy_adapter.py:230:80: E501 line too long (83 > 79 characters)
        industry_keywords = ["industry", "board", "sector", "concept", "ths", "em"]
                                                                               ^
src/adapters/akshare_proxy_adapter.py:244:1: D400 First line should end with a period
        """获取股票日线数据"""
^
src/adapters/akshare_proxy_adapter.py:257:1: D400 First line should end with a period
        """获取指数日线数据"""
^
src/adapters/akshare_proxy_adapter.py:258:80: E501 line too long (80 > 79 characters)
        return self.call_akshare_function("stock_zh_index_daily", symbol=symbol)
                                                                               ^
src/adapters/akshare_proxy_adapter.py:261:1: D400 First line should end with a period
        """获取股票基本信息"""
^
src/adapters/akshare_proxy_adapter.py:262:80: E501 line too long (86 > 79 characters)
        result = self.call_akshare_function("stock_individual_info_em", symbol=symbol)
                                                                               ^
src/adapters/akshare_proxy_adapter.py:268:1: D400 First line should end with a period
        """获取指数成分股"""
^
src/adapters/akshare_proxy_adapter.py:278:1: D400 First line should end with a period
        """获取实时数据"""
^
src/adapters/akshare_proxy_adapter.py:286:80: E501 line too long (82 > 79 characters)
    def get_market_calendar(self, start_date: str, end_date: str) -> pd.DataFrame:
                                                                               ^
src/adapters/akshare_proxy_adapter.py:287:1: D400 First line should end with a period
        """获取交易日历"""
^
src/adapters/akshare_proxy_adapter.py:293:80: E501 line too long (86 > 79 characters)
    def get_financial_data(self, symbol: str, period: str = "annual") -> pd.DataFrame:
                                                                               ^
src/adapters/akshare_proxy_adapter.py:294:1: D400 First line should end with a period
        """获取财务数据"""
^
src/adapters/akshare_proxy_adapter.py:295:80: E501 line too long (85 > 79 characters)
        result = self.call_akshare_function("stock_financial_abstract", stock=symbol)
                                                                               ^
src/adapters/akshare_proxy_adapter.py:301:1: D400 First line should end with a period
        """获取新闻数据"""
^
src/adapters/akshare_proxy_adapter.py:313:1: D400 First line should end with a period
    """演示AkShare代理适配器的使用"""
^
src/adapters/akshare_proxy_adapter.py:323:5: F841 local variable 'stock_functions' is assigned to but never used
    stock_functions = proxy.search_functions("stock_zh_a")
    ^
src/adapters/akshare_proxy_adapter.py:327:80: E501 line too long (83 > 79 characters)
    industry_data = proxy.call_akshare_function("stock_board_industry_summary_ths")
                                                                               ^
src/adapters/baostock_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：BaoStock数据源适配器，提供历史行情和财务数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/baostock_adapter.py:1:1: D400 First line should end with a period
"""
# 功能：BaoStock数据源适配器，提供历史行情和财务数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/baostock_adapter.py:20:80: E501 line too long (80 > 79 characters)
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/adapters/baostock_adapter.py:28:1: D101 Missing docstring in public class
    class IDataSource:
^
src/adapters/baostock_adapter.py:29:1: D102 Missing docstring in public method
        def get_stock_daily(self, symbol, start_date, end_date):
^
src/adapters/baostock_adapter.py:32:1: D102 Missing docstring in public method
        def get_stock_basic(self, date=None):
^
src/adapters/baostock_adapter.py:40:1: D101 Missing docstring in public class
    class ColumnMapper:
^
src/adapters/baostock_adapter.py:42:1: D102 Missing docstring in public method
        def map_columns(df, source_format, target_format):
^
src/adapters/baostock_adapter.py:50:1: D103 Missing docstring in public function
    def normalize_date(date_str):
^
src/adapters/baostock_adapter.py:61:1: D103 Missing docstring in public function
    def format_stock_code_for_source(code, source):
^
src/adapters/baostock_adapter.py:64:1: D103 Missing docstring in public function
    def format_index_code_for_source(code, source):
^
src/adapters/baostock_adapter.py:69:1: D400 First line should end with a period
    """Baostock数据源实现"""
^
src/adapters/baostock_adapter.py:71:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/adapters/baostock_adapter.py:92:1: D105 Missing docstring in magic method
    def __del__(self) -> None:
^
src/adapters/baostock_adapter.py:100:1: D400 First line should end with a period
        """获取股票日线数据-Baostock实现"""
^
src/adapters/baostock_adapter.py:152:1: D400 First line should end with a period
        """获取指数日线数据-Baostock实现"""
^
src/adapters/baostock_adapter.py:212:1: D400 First line should end with a period
        """获取股票基本信息-Baostock实现"""
^
src/adapters/baostock_adapter.py:242:1: D400 First line should end with a period
        """获取指数成分股-Baostock实现"""
^
src/adapters/baostock_adapter.py:267:1: D400 First line should end with a period
        """获取实时数据-Baostock实现"""
^
src/adapters/baostock_adapter.py:270:80: E501 line too long (85 > 79 characters)
            rs = self.bs.query_all_stock(day=normalize_date(datetime.datetime.now()))
                                                                               ^
src/adapters/baostock_adapter.py:295:1: D400 First line should end with a period
        """获取交易日历-Baostock实现"""
^
src/adapters/baostock_adapter.py:305:1: D400 First line should end with a period
        """获取财务数据-Baostock实现"""
^
src/adapters/baostock_adapter.py:325:1: D400 First line should end with a period
        """获取新闻数据-Baostock实现"""
^
src/adapters/byapi_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：Byapi (biyingapi.com) 数据源适配器，提供A股实时行情、K线和财务数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2024-08-29
# 版本：2.1.0
# 依赖：requests, pandas (详见requirements.txt)
# 注意事项：
#   - API License: 04C01BF1-7F2F-41A3-B470-1F81F14B1FC8
#   - 内置频率控制: 300请求/分钟 (0.2s间隔)
#   - 支持A股市场，实时行情+历史K线+财务报表+涨跌停股池
#   - 辅助文件位于adapters/byapi/目录 (API文档和映射表)
# 版权：MyStocks Project © 2025
"""
^
src/adapters/byapi_adapter.py:1:1: D400 First line should end with a period
"""
# 功能：Byapi (biyingapi.com) 数据源适配器，提供A股实时行情、K线和财务数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2024-08-29
# 版本：2.1.0
# 依赖：requests, pandas (详见requirements.txt)
# 注意事项：
#   - API License: 04C01BF1-7F2F-41A3-B470-1F81F14B1FC8
#   - 内置频率控制: 300请求/分钟 (0.2s间隔)
#   - 支持A股市场，实时行情+历史K线+财务报表+涨跌停股池
#   - 辅助文件位于adapters/byapi/目录 (API文档和映射表)
# 版权：MyStocks Project © 2025
"""
^
src/adapters/byapi_adapter.py:24:1: D400 First line should end with a period
    """数据源异常"""
^
src/adapters/byapi_adapter.py:30:1: D400 First line should end with a period
    """数据源统一接口"""
^
src/adapters/byapi_adapter.py:35:1: D400 First line should end with a period
        """数据源名称"""
^
src/adapters/byapi_adapter.py:41:1: D400 First line should end with a period
        """支持的市场列表"""
^
src/adapters/byapi_adapter.py:46:80: E501 line too long (83 > 79 characters)
        self, symbol: str, start_date: str, end_date: str, frequency: str = "daily"
                                                                               ^
src/adapters/byapi_adapter.py:48:1: D400 First line should end with a period
        """获取K线数据"""
^
src/adapters/byapi_adapter.py:53:1: D400 First line should end with a period
        """获取实时行情"""
^
src/adapters/byapi_adapter.py:60:1: D400 First line should end with a period
        """获取财务数据"""
^
src/adapters/byapi_adapter.py:65:1: D400 First line should end with a period
        """获取股票列表"""
^
src/adapters/byapi_adapter.py:70:1: D400 First line should end with a period
    """
    Byapi (biyingapi.com) 数据源适配器

    特点:
    - 支持A股市场全量数据
    - 提供实时行情和历史K线
    - 包含完整的财务报表数据
    - 内置频率控制 (300请求/分钟)

    Args:
        licence: biyingapi.com API许可证
        base_url: API基础URL (默认: http://api.biyingapi.com)
        min_interval: 最小请求间隔秒数 (默认: 0.2s, 对应300次/分钟)
    """
^
src/adapters/byapi_adapter.py:85:1: D107 Missing docstring in __init__
    def __init__(
^
src/adapters/byapi_adapter.py:118:1: D102 Missing docstring in public method
    def source_name(self) -> str:
^
src/adapters/byapi_adapter.py:122:1: D102 Missing docstring in public method
    def supported_markets(self) -> List[str]:
^
src/adapters/byapi_adapter.py:126:1: D400 First line should end with a period
        """
        标准化股票代码格式

        Args:
            symbol: 原始代码 (如 '600000.SH' 或 '600000')

        Returns:
            byapi格式代码 (如 '600000.SH')
        """
^
src/adapters/byapi_adapter.py:147:1: D400 First line should end with a period
        """控制API请求频率"""
^
src/adapters/byapi_adapter.py:157:1: D400 First line should end with a period
        """
        发送HTTP请求并返回JSON数据

        Args:
            url: 完整的API URL
            timeout: 超时时间(秒)

        Returns:
            解析后的JSON对象

        Raises:
            DataSourceError: API请求失败
        """
^
src/adapters/byapi_adapter.py:182:1: D400 First line should end with a period
        """
        获取股票列表

        API: http://api.biyingapi.com/hslt/list/licence

        Returns:
            DataFrame包含:
            - symbol: 股票代码 (如 '600000.SH')
            - name: 股票名称
            - exchange: 交易所 (SSE/SZSE)
            - list_date: 上市日期
            - status: 状态 (固定为 'ACTIVE')
        """
^
src/adapters/byapi_adapter.py:216:80: E501 line too long (86 > 79 characters)
                df["exchange_code"].map({"SH": "SSE", "SZ": "SZSE"}).fillna("UNKNOWN")
                                                                               ^
src/adapters/byapi_adapter.py:229:80: E501 line too long (83 > 79 characters)
        self, symbol: str, start_date: str, end_date: str, frequency: str = "daily"
                                                                               ^
src/adapters/byapi_adapter.py:231:1: D400 First line should end with a period
        """
        获取K线数据

        API: https://api.biyingapi.com/hsstock/history/{symbol}/{level}/n/{licence}?st={start}&et={end}

        Args:
            symbol: 股票代码 (如 '600000.SH')
            start_date: 开始日期 (YYYY-MM-DD)
            end_date: 结束日期 (YYYY-MM-DD)
            frequency: 频率 (daily/5min/15min/30min/60min/weekly/monthly)

        Returns:
            DataFrame包含:
            - symbol, timestamp/date, open, high, low, close, volume, amount
        """
^
src/adapters/byapi_adapter.py:234:80: E501 line too long (103 > 79 characters)
        """
        获取K线数据

        API: https://api.biyingapi.com/hsstock/history/{symbol}/{level}/n/{licence}?st={start}&et={end}

        Args:
            symbol: 股票代码 (如 '600000.SH')
            start_date: 开始日期 (YYYY-MM-DD)
            end_date: 结束日期 (YYYY-MM-DD)
            frequency: 频率 (daily/5min/15min/30min/60min/weekly/monthly)

        Returns:
            DataFrame包含:
            - symbol, timestamp/date, open, high, low, close, volume, amount
        """



                                                   ^
src/adapters/byapi_adapter.py:257:80: E501 line too long (94 > 79 characters)
            f"https://api.biyingapi.com/hsstock/history/{std_symbol}/{level}/n/{self.licence}"
                                                                               ^
src/adapters/byapi_adapter.py:331:1: D400 First line should end with a period
        """
        获取实时行情

        API (旧): http://api.biyingapi.com/hsrl/ssjy/{code}/{licence}
        API (新): https://api.biyingapi.com/hsstock/real/time/{symbol}/{licence}

        优先使用旧接口(更稳定),新接口作为备选

        Args:
            symbols: 股票代码列表 (如 ['600000.SH', '000001.SZ'])

        Returns:
            DataFrame包含:
            - symbol, name, current_price, change, change_pct, open, high, low,
              pre_close, volume, amount, timestamp
        """
^
src/adapters/byapi_adapter.py:344:1: RST301 Unexpected indentation.
        """
        获取实时行情

        API (旧): http://api.biyingapi.com/hsrl/ssjy/{code}/{licence}
        API (新): https://api.biyingapi.com/hsstock/real/time/{symbol}/{licence}

        优先使用旧接口(更稳定),新接口作为备选

        Args:
            symbols: 股票代码列表 (如 ['600000.SH', '000001.SZ'])

        Returns:
            DataFrame包含:
            - symbol, name, current_price, change, change_pct, open, high, low,
              pre_close, volume, amount, timestamp
        """
^
src/adapters/byapi_adapter.py:393:35: F541 f-string is missing placeholders
            raise DataSourceError(f"获取实时行情失败: 所有股票均无数据")
                                  ^
src/adapters/byapi_adapter.py:400:1: D400 First line should end with a period
        """
        获取财务数据

        API: http://api.biyingapi.com/hsstock/financial/{type}/{symbol}/{licence}?st={start}&et={end}

        Args:
            symbol: 股票代码 (如 '600000.SH')
            report_period: 报告期 (YYYY-MM-DD 或 'latest' 获取最新一期)
            data_type: 数据类型
                - "income": 利润表
                - "balance": 资产负债表
                - "cashflow": 现金流量表
                - "metrics": 财务指标

        Returns:
            DataFrame包含财务数据 (列名根据data_type不同而不同)
        """
^
src/adapters/byapi_adapter.py:403:80: E501 line too long (101 > 79 characters)
        """
        获取财务数据

        API: http://api.biyingapi.com/hsstock/financial/{type}/{symbol}/{licence}?st={start}&et={end}

        Args:
            symbol: 股票代码 (如 '600000.SH')
            report_period: 报告期 (YYYY-MM-DD 或 'latest' 获取最新一期)
            data_type: 数据类型
                - "income": 利润表
                - "balance": 资产负债表
                - "cashflow": 现金流量表
                - "metrics": 财务指标

        Returns:
            DataFrame包含财务数据 (列名根据data_type不同而不同)
        """



                                                   ^
src/adapters/byapi_adapter.py:408:1: RST301 Unexpected indentation.
        """
        获取财务数据

        API: http://api.biyingapi.com/hsstock/financial/{type}/{symbol}/{licence}?st={start}&et={end}

        Args:
            symbol: 股票代码 (如 '600000.SH')
            report_period: 报告期 (YYYY-MM-DD 或 'latest' 获取最新一期)
            data_type: 数据类型
                - "income": 利润表
                - "balance": 资产负债表
                - "cashflow": 现金流量表
                - "metrics": 财务指标

        Returns:
            DataFrame包含财务数据 (列名根据data_type不同而不同)
        """
^
src/adapters/byapi_adapter.py:423:80: E501 line too long (88 > 79 characters)
                f"不支持的财务数据类型: {data_type}. 支持: {list(self.fundamental_type_map.keys())}"
                                                                               ^
src/adapters/byapi_adapter.py:429:80: E501 line too long (107 > 79 characters)
            url = f"http://api.biyingapi.com/hsstock/financial/{api_type}/{std_symbol}/{self.licence}?lt=1"
                                                                               ^
src/adapters/byapi_adapter.py:434:80: E501 line too long (100 > 79 characters)
                f"http://api.biyingapi.com/hsstock/financial/{api_type}/{std_symbol}/{self.licence}"
                                                                               ^
src/adapters/byapi_adapter.py:459:1: D400 First line should end with a period
        """
        获取涨停股池 (byapi特有功能)

        API: http://api.biyingapi.com/hslt/ztgc/{date}/{licence}

        Args:
            trade_date: 交易日期 (YYYY-MM-DD)

        Returns:
            DataFrame包含涨停股票列表
        """
^
src/adapters/byapi_adapter.py:470:80: E501 line too long (87 > 79 characters)
        url = f"{self.base_url}/hslt/ztgc/{trade_date.replace('-', '')}/{self.licence}"
                                                                               ^
src/adapters/byapi_adapter.py:487:1: D400 First line should end with a period
        """
        获取跌停股池 (byapi特有功能)

        API: http://api.biyingapi.com/hslt/dtgc/{date}/{licence}

        Args:
            trade_date: 交易日期 (YYYY-MM-DD)

        Returns:
            DataFrame包含跌停股票列表
        """
^
src/adapters/byapi_adapter.py:498:80: E501 line too long (87 > 79 characters)
        url = f"{self.base_url}/hslt/dtgc/{trade_date.replace('-', '')}/{self.licence}"
                                                                               ^
src/adapters/byapi_adapter.py:523:1: D400 First line should end with a period
        """
        获取技术指标 (byapi特有功能)

        API: http://api.biyingapi.com/hsstock/history/{indicator}/{symbol}/{level}/n/{licence}?st={start}&et={end}&lt={limit}

        Args:
            symbol: 股票代码
            indicator: 指标类型 (macd/ma/boll/kdj)
            frequency: 频率
            start_date: 开始日期 (可选)
            end_date: 结束日期 (可选)
            limit: 最大返回条数

        Returns:
            DataFrame包含技术指标数据
        """
^
src/adapters/byapi_adapter.py:526:80: E501 line too long (125 > 79 characters)
        """
        获取技术指标 (byapi特有功能)

        API: http://api.biyingapi.com/hsstock/history/{indicator}/{symbol}/{level}/n/{licence}?st={start}&et={end}&lt={limit}

        Args:
            symbol: 股票代码
            indicator: 指标类型 (macd/ma/boll/kdj)
            frequency: 频率
            start_date: 开始日期 (可选)
            end_date: 结束日期 (可选)
            limit: 最大返回条数

        Returns:
            DataFrame包含技术指标数据
        """



                                       ^
src/adapters/byapi_adapter.py:615:80: E501 line too long (84 > 79 characters)
        print(quotes[["symbol", "current_price", "change_pct", "volume", "amount"]])
                                                                               ^
src/adapters/customer_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：自定义数据源适配器，支持用户扩展数据源
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/customer_adapter.py:1:1: D400 First line should end with a period
"""
# 功能：自定义数据源适配器，支持用户扩展数据源
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/customer_adapter.py:20:80: E501 line too long (80 > 79 characters)
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/adapters/customer_adapter.py:23:1: E402 module level import not at top of file
from src.interfaces.data_source import IDataSource
^
src/adapters/customer_adapter.py:37:1: D400 First line should end with a period
    """Customer数据源实现（统一管理efinance和easyquotation）

    属性:
        efinance_available (bool): efinance库是否可用
        easyquotation_available (bool): easyquotation库是否可用
        use_column_mapping (bool): 是否使用列名映射标准化
    """
^
src/adapters/customer_adapter.py:46:1: D400 First line should end with a period
        """初始化Customer数据源

        Args:
            use_column_mapping: 是否启用列名映射标准化
        """
^
src/adapters/customer_adapter.py:53:80: E501 line too long (80 > 79 characters)
        self.use_column_mapping = use_column_mapping and COLUMN_MAPPER_AVAILABLE
                                                                               ^
src/adapters/customer_adapter.py:79:15: F541 f-string is missing placeholders
        print(f"[Customer] 数据源初始化完成:")
              ^
src/adapters/customer_adapter.py:82:80: E501 line too long (83 > 79 characters)
            f"  - easyquotation: {'可用' if self.easyquotation_available else '不可用'}"
                                                                               ^
src/adapters/customer_adapter.py:89:1: D400 First line should end with a period
        """标准化DataFrame列名"""
^
src/adapters/customer_adapter.py:105:1: D400 First line should end with a period
        """获取股票日线数据-Customer实现"""
^
src/adapters/customer_adapter.py:145:1: D400 First line should end with a period
        """获取指数日线数据-Customer实现"""
^
src/adapters/customer_adapter.py:153:80: E501 line too long (82 > 79 characters)
                df = self.ef.index.get_quote_history(symbol, start_date, end_date)
                                                                               ^
src/adapters/customer_adapter.py:164:1: D400 First line should end with a period
        """获取股票基本信息-Customer实现"""
^
src/adapters/customer_adapter.py:176:80: E501 line too long (85 > 79 characters)
                    return info.to_dict() if hasattr(info, "to_dict") else dict(info)
                                                                               ^
src/adapters/customer_adapter.py:184:1: D400 First line should end with a period
        """获取指数成分股-Customer实现"""
^
src/adapters/customer_adapter.py:202:80: E501 line too long (80 > 79 characters)
    def get_real_time_data(self, symbol: str) -> Union[pd.DataFrame, Dict, str]:
                                                                               ^
src/adapters/customer_adapter.py:203:1: D400 First line should end with a period
        """获取实时数据-Customer实现（重点实现efinance的沪深市场A股最新状况功能）"""
^
src/adapters/customer_adapter.py:276:80: E501 line too long (84 > 79 characters)
                                standardized_df[col] = standardized_df[col].replace(
                                                                               ^
src/adapters/customer_adapter.py:285:80: E501 line too long (88 > 79 characters)
                            f"[Customer] 数据处理完成：{len(standardized_df)}行数据，列名已标准化，数值清洗完成"
                                                                               ^
src/adapters/customer_adapter.py:300:80: E501 line too long (86 > 79 characters)
                                    stock_data = all_quotes[all_quotes[col] == symbol]
                                                                               ^
src/adapters/customer_adapter.py:305:80: E501 line too long (88 > 79 characters)
                                stock_data = all_quotes[all_quotes.iloc[:, 0] == symbol]
                                                                               ^
src/adapters/customer_adapter.py:314:80: E501 line too long (80 > 79 characters)
                                standardized_data = self._standardize_dataframe(
                                                                               ^
src/adapters/customer_adapter.py:413:1: D400 First line should end with a period
        """专门获取沪深市场A股最新状况的方法"""
^
src/adapters/customer_adapter.py:424:1: D400 First line should end with a period
        """获取交易日历-Customer实现"""
^
src/adapters/customer_adapter.py:439:80: E501 line too long (81 > 79 characters)
            calendar_df["trade_date"] = pd.to_datetime(calendar_df["trade_date"])
                                                                               ^
src/adapters/customer_adapter.py:449:80: E501 line too long (80 > 79 characters)
                filtered_df = filtered_df.rename(columns={"trade_date": "date"})
                                                                               ^
src/adapters/customer_adapter.py:463:1: D400 First line should end with a period
        """获取财务数据-Customer实现"""
^
src/adapters/customer_adapter.py:493:1: D400 First line should end with a period
        """获取新闻数据-Customer实现"""
^
src/adapters/data_source_manager.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：数据源管理器，统一管理多个数据源适配器的生命周期
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/data_source_manager.py:1:1: D400 First line should end with a period
"""
# 功能：数据源管理器，统一管理多个数据源适配器的生命周期
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/data_source_manager.py:23:1: D400 First line should end with a period
    """
    数据源管理器

    功能:
    1. 统一管理多个数据源适配器
    2. 数据源优先级和故障转移
    3. 数据验证和质量检查
    4. 缓存和性能优化

    使用示例:
        >>> manager = DataSourceManager()
        >>> manager.register_source('tdx', TdxDataSource())
        >>> manager.register_source('akshare', AkshareDataSource())
        >>>
        >>> # 获取实时行情(优先使用TDX)
        >>> quote = manager.get_real_time_data('600519', source='tdx')
        >>>
        >>> # 获取历史数据(自动故障转移)
        >>> df = manager.get_stock_daily('600519', '2024-01-01', '2024-12-31')
    """
^
src/adapters/data_source_manager.py:45:1: D400 First line should end with a period
        """初始化数据源管理器"""
^
src/adapters/data_source_manager.py:61:1: D400 First line should end with a period
        """
        注册数据源适配器

        Args:
            name: 数据源名称(如'tdx', 'akshare')
            source: IDataSource实例
        """
^
src/adapters/data_source_manager.py:75:1: D400 First line should end with a period
        """
        获取指定数据源

        Args:
            name: 数据源名称

        Returns:
            IDataSource实例,不存在返回None
        """
^
src/adapters/data_source_manager.py:87:1: D400 First line should end with a period
        """获取所有已注册的数据源名称"""
^
src/adapters/data_source_manager.py:95:1: D400 First line should end with a period
        """
        获取实时行情数据

        Args:
            symbol: 股票代码
            source: 指定数据源,None表示按优先级自动选择

        Returns:
            Dict: 成功时返回行情字典
            str: 失败时返回错误消息
        """
^
src/adapters/data_source_manager.py:134:80: E501 line too long (87 > 79 characters)
        self, symbol: str, start_date: str, end_date: str, source: Optional[str] = None
                                                                               ^
src/adapters/data_source_manager.py:136:1: D400 First line should end with a period
        """
        获取股票日线数据

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期
            source: 指定数据源,None表示按优先级自动选择

        Returns:
            pd.DataFrame: 日线数据
        """
^
src/adapters/data_source_manager.py:176:80: E501 line too long (87 > 79 characters)
        self, symbol: str, start_date: str, end_date: str, source: Optional[str] = None
                                                                               ^
src/adapters/data_source_manager.py:178:1: D400 First line should end with a period
        """
        获取指数日线数据

        Args:
            symbol: 指数代码
            start_date: 开始日期
            end_date: 结束日期
            source: 指定数据源,None表示按优先级自动选择

        Returns:
            pd.DataFrame: 指数日线数据
        """
^
src/adapters/data_source_manager.py:219:80: E501 line too long (81 > 79 characters)
    def get_stock_basic(self, symbol: str, source: Optional[str] = None) -> Dict:
                                                                               ^
src/adapters/data_source_manager.py:220:1: D400 First line should end with a period
        """获取股票基本信息"""
^
src/adapters/data_source_manager.py:235:80: E501 line too long (80 > 79 characters)
        self, symbol: str, period: str = "quarter", source: Optional[str] = None
                                                                               ^
src/adapters/data_source_manager.py:237:1: D400 First line should end with a period
        """获取财务数据"""
^
src/adapters/data_source_manager.py:258:1: D400 First line should end with a period
        """获取指数成分股"""
^
src/adapters/data_source_manager.py:273:1: D400 First line should end with a period
        """
        设置数据源优先级

        Args:
            data_type: 数据类型('real_time', 'daily', 'financial')
            priority_list: 优先级列表(从高到低)
        """
^
src/adapters/data_source_manager.py:288:1: D400 First line should end with a period
    """
    获取默认配置的数据源管理器

    自动注册TDX和AKShare数据源

    Returns:
        DataSourceManager实例
    """
^
src/adapters/data_source_manager.py:340:5: F811 redefinition of unused 'datetime' from line 14
    from datetime import datetime, timedelta
    ^
src/adapters/financial_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：财务数据适配器，整合多源财务报表和指标数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/financial_adapter.py:1:1: D400 First line should end with a period
"""
# 功能：财务数据适配器，整合多源财务报表和指标数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/financial_adapter.py:35:1: E402 module level import not at top of file
import pandas as pd
^
src/adapters/financial_adapter.py:36:1: E402 module level import not at top of file
from typing import Dict
^
src/adapters/financial_adapter.py:37:1: E402 module level import not at top of file
import sys
^
src/adapters/financial_adapter.py:38:1: E402 module level import not at top of file
from datetime import datetime
^
src/adapters/financial_adapter.py:41:1: E402 module level import not at top of file
from loguru import logger
^
src/adapters/financial_adapter.py:44:1: E402 module level import not at top of file
from src.interfaces.data_source import IDataSource
^
src/adapters/financial_adapter.py:47:1: E402 module level import not at top of file
from src.utils import date_utils, symbol_utils
^
src/adapters/financial_adapter.py:53:80: E501 line too long (89 > 79 characters)
    format="{time:YYYY-MM-DD HH:mm:ss} | {level} | {name}:{function}:{line} | {message}",
                                                                               ^
src/adapters/financial_adapter.py:58:80: E501 line too long (89 > 79 characters)
    format="{time:YYYY-MM-DD HH:mm:ss} | {level} | {name}:{function}:{line} | {message}",
                                                                               ^
src/adapters/financial_adapter.py:69:1: D400 First line should end with a period
    """
    财务数据适配器 - 参考数据/基本面数据统一门户

    数据分类: DataClassification.FUNDAMENTAL_METRICS (第2类-参考数据-基本面数据)
    存储目标: MySQL/MariaDB
    数据特性: 低频、结构化、关系型

    多数据源整合:
    - 当前实现: efinance(主要) + easyquotation(备用)
    - 计划扩展: akshare、tushare、byapi、新浪财经爬虫

    核心能力:
    - 统一的财务数据获取接口
    - 多数据源自动降级切换
    - 数据验证和清洗
    - 智能缓存机制
    """
^
src/adapters/financial_adapter.py:88:1: D400 First line should end with a period
        """
        初始化财务数据适配器

        当前支持: efinance + easyquotation
        扩展计划: akshare、tushare、byapi、新浪财经爬虫
        """
^
src/adapters/financial_adapter.py:107:80: E501 line too long (146 > 79 characters)
            f"数据源初始化完成 (efinance: {'可用' if self.efinance_available else '不可用'}, easyquotation: {'可用' if self.easyquotation_available else '不可用'})"
                                                                               ^
src/adapters/financial_adapter.py:111:1: D400 First line should end with a period
        """
        生成缓存键

        Args:
            symbol: 股票代码
            data_type: 数据类型
            **kwargs: 其他参数

        Returns:
            str: 缓存键
        """
^
src/adapters/financial_adapter.py:114:1: RST210 Inline strong start-string without end-string.
        """
        生成缓存键

        Args:
            symbol: 股票代码
            data_type: 数据类型
            **kwargs: 其他参数

        Returns:
            str: 缓存键
        """
^
src/adapters/financial_adapter.py:130:1: D400 First line should end with a period
        """
        从缓存中获取数据

        Args:
            cache_key: 缓存键

        Returns:
            缓存的数据，如果不存在或过期则返回None
        """
^
src/adapters/financial_adapter.py:142:80: E501 line too long (81 > 79 characters)
            if (datetime.now() - cached_item["timestamp"]).total_seconds() < 300:
                                                                               ^
src/adapters/financial_adapter.py:151:1: D400 First line should end with a period
        """
        保存数据到缓存

        Args:
            cache_key: 缓存键
            data: 要缓存的数据
        """
^
src/adapters/financial_adapter.py:158:80: E501 line too long (80 > 79 characters)
        self.data_cache[cache_key] = {"data": data, "timestamp": datetime.now()}
                                                                               ^
src/adapters/financial_adapter.py:162:1: D400 First line should end with a period
        """
        初始化多数据源

        当前实现: efinance + easyquotation
        扩展计划: akshare、tushare、byapi、新浪财经爬虫
        """
^
src/adapters/financial_adapter.py:202:1: D400 First line should end with a period
        """
        获取股票日线数据

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            DataFrame: 包含股票日线数据的DataFrame
        """
^
src/adapters/financial_adapter.py:216:80: E501 line too long (91 > 79 characters)
        validation_result = self._validate_stock_daily_params(symbol, start_date, end_date)
                                                                               ^
src/adapters/financial_adapter.py:220:80: E501 line too long (89 > 79 characters)
        normalized_symbol, normalized_start_date, normalized_end_date = validation_result
                                                                               ^
src/adapters/financial_adapter.py:232:80: E501 line too long (96 > 79 characters)
            easyquotation_result = self._fetch_stock_daily_from_easyquotation(normalized_symbol)
                                                                               ^
src/adapters/financial_adapter.py:241:10: F821 undefined name 'Optional'
    ) -> Optional[tuple[str, Optional[str], Optional[str]]]:
         ^
src/adapters/financial_adapter.py:241:30: F821 undefined name 'Optional'
    ) -> Optional[tuple[str, Optional[str], Optional[str]]]:
                             ^
src/adapters/financial_adapter.py:241:45: F821 undefined name 'Optional'
    ) -> Optional[tuple[str, Optional[str], Optional[str]]]:
                                            ^
src/adapters/financial_adapter.py:242:1: D400 First line should end with a period
        """
        验证和标准化get_stock_daily方法的参数

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            tuple: (normalized_symbol, normalized_start_date, normalized_end_date) 或 None（验证失败）
        """
^
src/adapters/financial_adapter.py:251:80: E501 line too long (95 > 79 characters)
        """
        验证和标准化get_stock_daily方法的参数

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            tuple: (normalized_symbol, normalized_start_date, normalized_end_date) 或 None（验证失败）
        """




                 ^
src/adapters/financial_adapter.py:282:40: F821 undefined name 'Optional'
        self, symbol: str, start_date: Optional[str], end_date: Optional[str]
                                       ^
src/adapters/financial_adapter.py:282:65: F821 undefined name 'Optional'
        self, symbol: str, start_date: Optional[str], end_date: Optional[str]
                                                                ^
src/adapters/financial_adapter.py:284:1: D400 First line should end with a period
        """
        使用efinance获取股票日线数据

        Args:
            symbol: 标准化的股票代码
            start_date: 标准化的开始日期
            end_date: 标准化的结束日期

        Returns:
            DataFrame: 股票日线数据
        """
^
src/adapters/financial_adapter.py:313:80: E501 line too long (80 > 79 characters)
                    return self._process_efinance_stock_daily_data(data, symbol)
                                                                               ^
src/adapters/financial_adapter.py:316:80: E501 line too long (101 > 79 characters)
                    return self._fetch_with_broader_date_range_efinance(symbol, start_date, end_date)
                                                                               ^
src/adapters/financial_adapter.py:328:40: F821 undefined name 'Optional'
        self, symbol: str, start_date: Optional[str], end_date: Optional[str]
                                       ^
src/adapters/financial_adapter.py:328:65: F821 undefined name 'Optional'
        self, symbol: str, start_date: Optional[str], end_date: Optional[str]
                                                                ^
src/adapters/financial_adapter.py:330:1: D400 First line should end with a period
        """
        使用更广泛的日期范围从efinance获取数据

        Args:
            symbol: 标准化的股票代码
            start_date: 标准化的开始日期
            end_date: 标准化的结束日期

        Returns:
            DataFrame: 过滤后的股票日线数据
        """
^
src/adapters/financial_adapter.py:351:80: E501 line too long (92 > 79 characters)
                return self._filter_broader_data_by_date(broader_data, start_date, end_date)
                                                                               ^
src/adapters/financial_adapter.py:361:55: F821 undefined name 'Optional'
        self, broader_data: pd.DataFrame, start_date: Optional[str], end_date: Optional[str]
                                                      ^
src/adapters/financial_adapter.py:361:80: F821 undefined name 'Optional'
        self, broader_data: pd.DataFrame, start_date: Optional[str], end_date: Optional[str]
                                                                               ^
src/adapters/financial_adapter.py:361:80: E501 line too long (92 > 79 characters)
        self, broader_data: pd.DataFrame, start_date: Optional[str], end_date: Optional[str]
                                                                               ^
src/adapters/financial_adapter.py:363:1: D400 First line should end with a period
        """
        根据日期范围过滤更广泛的数据

        Args:
            broader_data: 广泛日期范围的数据
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            DataFrame: 过滤后的数据
        """
^
src/adapters/financial_adapter.py:377:80: E501 line too long (105 > 79 characters)
            start_date_dt = pd.to_datetime(date_utils.normalize_date(start_date)) if start_date else None
                                                                               ^
src/adapters/financial_adapter.py:378:80: E501 line too long (99 > 79 characters)
            end_date_dt = pd.to_datetime(date_utils.normalize_date(end_date)) if end_date else None
                                                                               ^
src/adapters/financial_adapter.py:404:1: D400 First line should end with a period
        """
        处理efinance返回的股票日线数据

        Args:
            data: efinance返回的数据
            symbol: 股票代码

        Returns:
            DataFrame: 处理后的股票数据
        """
^
src/adapters/financial_adapter.py:436:80: E501 line too long (81 > 79 characters)
    def _fetch_stock_daily_from_easyquotation(self, symbol: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:437:1: D400 First line should end with a period
        """
        使用easyquotation获取股票日线数据

        Args:
            symbol: 标准化的股票代码

        Returns:
            DataFrame: 股票日线数据
        """
^
src/adapters/financial_adapter.py:471:1: D400 First line should end with a period
        """
        处理easyquotation返回的股票数据

        Args:
            df: easyquotation返回的DataFrame
            symbol: 股票代码

        Returns:
            DataFrame: 处理后的股票数据
        """
^
src/adapters/financial_adapter.py:517:1: D400 First line should end with a period
        """
        重命名列名以匹配预期格式

        Args:
            data: 原始数据

        Returns:
            DataFrame: 重命名后的数据
        """
^
src/adapters/financial_adapter.py:543:1: D400 First line should end with a period
        """
        验证get_index_daily方法的参数

        Args:
            index_code (str): 指数代码
            start_date (str, optional): 开始日期
            end_date (str, optional): 结束日期

        Returns:
            tuple: (normalized_index_code, normalized_start_date, normalized_end_date) 或 None（验证失败）
        """
^
src/adapters/financial_adapter.py:552:80: E501 line too long (99 > 79 characters)
        """
        验证get_index_daily方法的参数

        Args:
            index_code (str): 指数代码
            start_date (str, optional): 开始日期
            end_date (str, optional): 结束日期

        Returns:
            tuple: (normalized_index_code, normalized_start_date, normalized_end_date) 或 None（验证失败）
        """




                     ^
src/adapters/financial_adapter.py:577:80: E501 line too long (80 > 79 characters)
        return normalized_index_code, normalized_start_date, normalized_end_date
                                                                               ^
src/adapters/financial_adapter.py:579:80: E501 line too long (99 > 79 characters)
    def _fetch_index_data(self, normalized_index_code, normalized_start_date, normalized_end_date):
                                                                               ^
src/adapters/financial_adapter.py:580:1: D400 First line should end with a period
        """
        从efinance获取指数数据

        Args:
            normalized_index_code (str): 标准化后的指数代码
            normalized_start_date (str): 标准化后的开始日期
            normalized_end_date (str): 标准化后的结束日期

        Returns:
            pd.DataFrame: 指数数据
        """
^
src/adapters/financial_adapter.py:607:80: E501 line too long (102 > 79 characters)
                f"请求参数: code={formatted_code}, beg={normalized_start_date}, end={normalized_end_date}"
                                                                               ^
src/adapters/financial_adapter.py:617:32: F541 f-string is missing placeholders
                logger.warning(f"使用日期参数未获取到数据，尝试获取全部数据并过滤...")
                               ^
src/adapters/financial_adapter.py:618:80: E501 line too long (110 > 79 characters)
                data = self._fetch_and_filter_data(formatted_code, normalized_start_date, normalized_end_date)
                                                                               ^
src/adapters/financial_adapter.py:632:1: D400 First line should end with a period
        """
        从efinance获取历史数据

        Args:
            code (str): 股票/指数代码
            start_date (str): 开始日期
            end_date (str): 结束日期

        Returns:
            pd.DataFrame: 历史数据
        """
^
src/adapters/financial_adapter.py:644:80: E501 line too long (86 > 79 characters)
            return self.ef.stock.get_quote_history(code, beg=start_date, end=end_date)
                                                                               ^
src/adapters/financial_adapter.py:653:1: D400 First line should end with a period
        """
        获取全部数据并过滤日期范围

        Args:
            code (str): 股票/指数代码
            start_date (str): 开始日期
            end_date (str): 结束日期

        Returns:
            pd.DataFrame: 过滤后的数据
        """
^
src/adapters/financial_adapter.py:665:80: E501 line too long (82 > 79 characters)
        if data is not None and isinstance(data, pd.DataFrame) and not data.empty:
                                                                               ^
src/adapters/financial_adapter.py:674:1: D400 First line should end with a period
        """
        获取指数日线数据（重构后 - 22行）

        Args:
            index_code (str): 指数代码
            start_date (str, optional): 开始日期，格式为'YYYY-MM-DD'
            end_date (str, optional): 结束日期，格式为'YYYY-MM-DD'

        Returns:
            pd.DataFrame: 指数日线数据
        """
^
src/adapters/financial_adapter.py:686:80: E501 line too long (95 > 79 characters)
        validation_result = self._validate_index_daily_params(index_code, start_date, end_date)
                                                                               ^
src/adapters/financial_adapter.py:690:80: E501 line too long (93 > 79 characters)
        normalized_index_code, normalized_start_date, normalized_end_date = validation_result
                                                                               ^
src/adapters/financial_adapter.py:693:80: E501 line too long (110 > 79 characters)
        index_data = self._fetch_index_data(normalized_index_code, normalized_start_date, normalized_end_date)
                                                                               ^
src/adapters/financial_adapter.py:705:1: D400 First line should end with a period
        """
        获取股票基本信息（重构后 - 25行）

        Args:
            symbol: 股票代码

        Returns:
            Dict: 包含股票基本信息的字典
        """
^
src/adapters/financial_adapter.py:720:80: E501 line too long (80 > 79 characters)
        efinance_data = self._fetch_stock_basic_from_efinance(normalized_symbol)
                                                                               ^
src/adapters/financial_adapter.py:725:80: E501 line too long (90 > 79 characters)
        easyquotation_data = self._fetch_stock_basic_from_easyquotation(normalized_symbol)
                                                                               ^
src/adapters/financial_adapter.py:733:1: D400 First line should end with a period
        """
        验证get_stock_basic方法的参数

        Args:
            symbol (str): 股票代码

        Returns:
            str: 标准化后的股票代码或None（验证失败）
        """
^
src/adapters/financial_adapter.py:756:1: D400 First line should end with a period
        """
        从efinance获取股票基本信息

        Args:
            normalized_symbol (str): 标准化后的股票代码

        Returns:
            Dict: 股票基本信息字典
        """
^
src/adapters/financial_adapter.py:787:1: D400 First line should end with a period
        """
        处理efinance返回的股票基本信息

        Args:
            data: efinance返回的数据

        Returns:
            Dict: 股票基本信息字典
        """
^
src/adapters/financial_adapter.py:822:1: D400 First line should end with a period
        """
        从easyquotation获取股票基本信息

        Args:
            normalized_symbol (str): 标准化后的股票代码

        Returns:
            Dict: 股票基本信息字典
        """
^
src/adapters/financial_adapter.py:858:1: D400 First line should end with a period
        """
        获取指数的成分股数据

        Args:
            index_code (str): 指数代码或名称

        Returns:
            pd.DataFrame: 指数成分股数据
        """
^
src/adapters/financial_adapter.py:907:1: D400 First line should end with a period
        """
        获取实时数据（仅支持A股市场）

        Args:
            symbol: 股票代码（可选）

        Returns:
            DataFrame: 包含实时数据的DataFrame
        """
^
src/adapters/financial_adapter.py:941:80: E501 line too long (80 > 79 characters)
            easyquotation_result = self._fetch_realtime_data_from_easyquotation(
                                                                               ^
src/adapters/financial_adapter.py:950:64: F821 undefined name 'Optional'
    def _validate_realtime_params(self, symbol: str = None) -> Optional[tuple[str, str]]:
                                                               ^
src/adapters/financial_adapter.py:950:80: E501 line too long (89 > 79 characters)
    def _validate_realtime_params(self, symbol: str = None) -> Optional[tuple[str, str]]:
                                                                               ^
src/adapters/financial_adapter.py:951:1: D400 First line should end with a period
        """
        验证和标准化get_real_time_data方法的参数

        Args:
            symbol: 股票代码（可选）

        Returns:
            tuple: (normalized_symbol, cache_key) 或 None（验证失败）
        """
^
src/adapters/financial_adapter.py:982:1: D400 First line should end with a period
        """
        使用efinance获取实时数据

        Args:
            symbol: 标准化的股票代码或"market_snapshot"
            cache_key: 缓存键

        Returns:
            DataFrame: 实时数据
        """
^
src/adapters/financial_adapter.py:996:80: E501 line too long (84 > 79 characters)
                return self._fetch_efinance_single_stock_realtime(symbol, cache_key)
                                                                               ^
src/adapters/financial_adapter.py:1006:1: D400 First line should end with a period
        """
        使用efinance获取单个股票的实时数据

        Args:
            symbol: 股票代码
            cache_key: 缓存键

        Returns:
            DataFrame: 单个股票的实时数据
        """
^
src/adapters/financial_adapter.py:1038:1: D400 First line should end with a period
        """
        使用efinance获取A股市场快照

        Returns:
            DataFrame: 市场快照数据
        """
^
src/adapters/financial_adapter.py:1055:80: E501 line too long (81 > 79 characters)
                index_data = self.ef.stock.get_realtime_quotes(symbol=index_code)
                                                                               ^
src/adapters/financial_adapter.py:1056:80: E501 line too long (81 > 79 characters)
                if isinstance(index_data, pd.DataFrame) and not index_data.empty:
                                                                               ^
src/adapters/financial_adapter.py:1074:1: D400 First line should end with a period
        """
        使用easyquotation获取实时数据

        Args:
            symbol: 标准化的股票代码或"market_snapshot"
            cache_key: 缓存键

        Returns:
            DataFrame: 实时数据
        """
^
src/adapters/financial_adapter.py:1089:80: E501 line too long (86 > 79 characters)
                return self._fetch_easyquotation_market_snapshot(quotation, cache_key)
                                                                               ^
src/adapters/financial_adapter.py:1091:80: E501 line too long (91 > 79 characters)
                return self._fetch_easyquotation_single_stock(symbol, quotation, cache_key)
                                                                               ^
src/adapters/financial_adapter.py:1101:1: D400 First line should end with a period
        """
        使用easyquotation获取单个股票的实时数据

        Args:
            symbol: 股票代码
            quotation: easyquotation实例
            cache_key: 缓存键

        Returns:
            DataFrame: 单个股票的实时数据
        """
^
src/adapters/financial_adapter.py:1128:80: E501 line too long (94 > 79 characters)
    def _fetch_easyquotation_market_snapshot(self, quotation, cache_key: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1129:1: D400 First line should end with a period
        """
        使用easyquotation获取A股市场快照

        Args:
            quotation: easyquotation实例
            cache_key: 缓存键

        Returns:
            DataFrame: 市场快照数据
        """
^
src/adapters/financial_adapter.py:1170:80: E501 line too long (86 > 79 characters)
    def get_financial_data(self, symbol: str, period: str = "annual") -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1171:1: D400 First line should end with a period
        """
        获取股票财务数据（重构后 - 24行）

        Args:
            symbol: 股票代码
            period: 报告期类型 ("annual" 年报或 "quarterly" 季报)

        Returns:
            DataFrame: 包含股票财务数据的DataFrame
        """
^
src/adapters/financial_adapter.py:1198:80: E501 line too long (82 > 79 characters)
            result = self._get_annual_financial_data(normalized_symbol, cache_key)
                                                                               ^
src/adapters/financial_adapter.py:1200:80: E501 line too long (85 > 79 characters)
            result = self._get_quarterly_financial_data(normalized_symbol, cache_key)
                                                                               ^
src/adapters/financial_adapter.py:1204:71: F821 undefined name 'Optional'
    def _validate_financial_params(self, symbol: str, period: str) -> Optional[tuple[str, str, str]]:
                                                                      ^
src/adapters/financial_adapter.py:1204:80: E501 line too long (101 > 79 characters)
    def _validate_financial_params(self, symbol: str, period: str) -> Optional[tuple[str, str, str]]:
                                                                               ^
src/adapters/financial_adapter.py:1205:1: D400 First line should end with a period
        """
        验证财务数据参数

        Args:
            symbol: 股票代码
            period: 报告期类型

        Returns:
            tuple: (normalized_symbol, validated_period, cache_key) 或 None
        """
^
src/adapters/financial_adapter.py:1227:80: E501 line too long (84 > 79 characters)
        validated_period = period if period in ["annual", "quarterly"] else "annual"
                                                                               ^
src/adapters/financial_adapter.py:1237:80: E501 line too long (96 > 79 characters)
        cache_key = self._get_cache_key(normalized_symbol, "financial", period=validated_period)
                                                                               ^
src/adapters/financial_adapter.py:1241:80: E501 line too long (86 > 79 characters)
    def _get_annual_financial_data(self, symbol: str, cache_key: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1242:1: D400 First line should end with a period
        """
        获取年报数据

        Args:
            symbol: 标准化的股票代码
            cache_key: 缓存键

        Returns:
            DataFrame: 年报数据
        """
^
src/adapters/financial_adapter.py:1275:80: E501 line too long (89 > 79 characters)
    def _get_quarterly_financial_data(self, symbol: str, cache_key: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1276:1: D400 First line should end with a period
        """
        获取季报数据

        Args:
            symbol: 标准化的股票代码
            cache_key: 缓存键

        Returns:
            DataFrame: 季报数据
        """
^
src/adapters/financial_adapter.py:1303:80: E501 line too long (89 > 79 characters)
    def _try_get_individual_financial_summary(self, symbol: str, cache_key: str) -> bool:
                                                                               ^
src/adapters/financial_adapter.py:1304:1: D400 First line should end with a period
        """
        尝试获取个股财务摘要（如果方法可用）

        Args:
            symbol: 股票代码
            cache_key: 缓存键

        Returns:
            bool: 是否成功获取数据
        """
^
src/adapters/financial_adapter.py:1316:80: E501 line too long (84 > 79 characters)
            # financial_summary = self.ef.stock.get_stock_financial_analysis(symbol)
                                                                               ^
src/adapters/financial_adapter.py:1318:80: E501 line too long (80 > 79 characters)
            #     logger.info(f"efinance获取到个股财务摘要数据: {len(financial_summary)}行")
                                                                               ^
src/adapters/financial_adapter.py:1319:80: E501 line too long (94 > 79 characters)
            #     cleaned_data = self._validate_and_clean_data(financial_summary, "financial")
                                                                               ^
src/adapters/financial_adapter.py:1330:80: E501 line too long (88 > 79 characters)
    def _filter_company_data(self, all_data: pd.DataFrame, symbol: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1331:1: D400 First line should end with a period
        """
        筛选指定公司的财务数据

        Args:
            all_data: 所有公司财务数据
            symbol: 股票代码

        Returns:
            DataFrame: 筛选后的数据
        """
^
src/adapters/financial_adapter.py:1353:80: E501 line too long (108 > 79 characters)
    def _process_financial_data(self, data: pd.DataFrame, period_type: str, cache_key: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1354:1: D400 First line should end with a period
        """
        处理财务数据并添加报告期标识

        Args:
            data: 财务数据
            period_type: 报告期类型
            cache_key: 缓存键

        Returns:
            DataFrame: 处理后的数据
        """
^
src/adapters/financial_adapter.py:1370:80: E501 line too long (81 > 79 characters)
        cleaned_data = self._validate_and_clean_data(processed_data, "financial")
                                                                               ^
src/adapters/financial_adapter.py:1377:80: E501 line too long (100 > 79 characters)
    def _process_quarterly_data(self, quarterly_data: pd.DataFrame, cache_key: str) -> pd.DataFrame:
                                                                               ^
src/adapters/financial_adapter.py:1378:1: D400 First line should end with a period
        """
        处理季报数据

        Args:
            quarterly_data: 季报数据
            cache_key: 缓存键

        Returns:
            DataFrame: 处理后的季报数据
        """
^
src/adapters/financial_adapter.py:1395:80: E501 line too long (81 > 79 characters)
        cleaned_data = self._validate_and_clean_data(processed_data, "financial")
                                                                               ^
src/adapters/financial_adapter.py:1403:1: D400 First line should end with a period
        """
        获取交易日历

        Returns:
            DataFrame: 包含交易日历的DataFrame
        """
^
src/adapters/financial_adapter.py:1449:1: D400 First line should end with a period
        """
        获取股票新闻数据

        Args:
            symbol: 股票代码

        Returns:
            DataFrame: 包含股票新闻数据的DataFrame
        """
^
src/adapters/financial_adapter.py:1501:1: D400 First line should end with a period
        """
        验证和清洗数据（重构后 - 24行）

        Args:
            data: 原始数据
            data_type: 数据类型 ("stock", "index", "financial")

        Returns:
            DataFrame: 清洗后的数据
        """
^
src/adapters/financial_adapter.py:1535:1: D400 First line should end with a period
        """删除完全重复的行"""
^
src/adapters/financial_adapter.py:1543:1: D400 First line should end with a period
        """处理缺失值"""
^
src/adapters/financial_adapter.py:1564:1: D400 First line should end with a period
        """清洗股票和指数数据"""
^
src/adapters/financial_adapter.py:1582:1: D400 First line should end with a period
        """清洗财务数据"""
^
src/adapters/financial_adapter.py:1604:1: D400 First line should end with a period
        """处理日期列"""
^
src/adapters/financial_adapter.py:1637:1: D400 First line should end with a period
        """处理价格列的数据类型转换"""
^
src/adapters/financial_adapter.py:1652:25: E129 visually indented line with same indent as next logical line
                        and invalid_numeric_rows < len(cleaned_data) * 0.1):
                        ^
src/adapters/financial_adapter.py:1659:1: D400 First line should end with a period
        """验证价格范围"""
^
src/adapters/financial_adapter.py:1677:1: D400 First line should end with a period
        """验证价格关系的合理性"""
^
src/adapters/financial_adapter.py:1710:1: D400 First line should end with a period
        """按日期排序数据"""
^
src/adapters/financial_adapter_example.py:3:1: D205 1 blank line required between summary line and description
"""
Financial适配器使用示例
展示如何使用FinancialDataSource类获取各种金融数据
"""
^
src/adapters/financial_adapter_example.py:3:1: D400 First line should end with a period
"""
Financial适配器使用示例
展示如何使用FinancialDataSource类获取各种金融数据
"""
^
src/adapters/financial_adapter_example.py:14:1: E402 module level import not at top of file
from src.adapters.financial_adapter import FinancialDataSource
^
src/adapters/financial_adapter_example.py:15:1: E402 module level import not at top of file
import pandas as pd
^
src/adapters/financial_adapter_example.py:19:1: D400 First line should end with a period
    """主函数：演示Financial适配器的使用方法"""
^
src/adapters/financial_adapter_example.py:26:11: F541 f-string is missing placeholders
    print(f"数据源初始化状态:")
          ^
src/adapters/financial_adapter_example.py:77:80: E501 line too long (81 > 79 characters)
    index_data = financial_ds.get_index_daily(index_symbol, start_date, end_date)
                                                                               ^
src/adapters/tdx_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：通达信(TDX)数据源适配器，提供实时行情和多周期K线数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/tdx_adapter.py:1:1: D400 First line should end with a period
"""
# 功能：通达信(TDX)数据源适配器，提供实时行情和多周期K线数据
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/adapters/tdx_adapter.py:24:1: E402 module level import not at top of file
from pytdx.hq import TdxHq_API
^
src/adapters/tdx_adapter.py:28:1: E402 module level import not at top of file
from src.interfaces.data_source import IDataSource
^
src/adapters/tdx_adapter.py:29:1: E402 module level import not at top of file
from src.utils.column_mapper import ColumnMapper
^
src/adapters/tdx_adapter.py:30:1: E402 module level import not at top of file
from src.utils.date_utils import normalize_date
^
src/adapters/tdx_adapter.py:31:1: E402 module level import not at top of file
from src.utils.tdx_server_config import TdxServerConfig
^
src/adapters/tdx_adapter.py:35:1: D400 First line should end with a period
    """
    TDX(通达信)数据源适配器

    实现IDataSource接口,提供A股市场数据访问:
    - 实时行情 (get_real_time_data)
    - 历史日线 (get_stock_daily, get_index_daily)
    - 财务数据 (get_financial_data - 有限支持)
    - 板块信息 (get_index_components - 有限支持)

    特点:
    - 直连通达信服务器,无API限流
    - 使用本地pytdx代码(temp/pytdx/),可二次开发
    - 自动重试、连接管理、数据验证
    - 完整日志记录

    限制:
    - 仅支持A股(深交所+上交所),不含期货/期权
    - 部分IDataSource方法为stub实现(get_market_calendar, get_news_data)
    """
^
src/adapters/tdx_adapter.py:65:1: D400 First line should end with a period
        """
        初始化TDX数据源适配器

        Args:
            tdx_host: TDX服务器地址 (默认从环境变量TDX_SERVER_HOST读取)
            tdx_port: TDX服务器端口 (默认从环境变量TDX_SERVER_PORT读取)
            max_retries: 最大重试次数 (默认从环境变量TDX_MAX_RETRIES读取,默认3)
            retry_delay: 重试延迟秒数 (默认从环境变量TDX_RETRY_DELAY读取,默认1)
            api_timeout: API超时时间 (默认从环境变量TDX_API_TIMEOUT读取,默认10)
            use_server_config: 是否使用connect.cfg配置的服务器列表(默认True)
            config_file: connect.cfg文件路径(可选)
        """
^
src/adapters/tdx_adapter.py:78:80: E501 line too long (80 > 79 characters)
        self.max_retries = int(max_retries or os.getenv("TDX_MAX_RETRIES", "3"))
                                                                               ^
src/adapters/tdx_adapter.py:79:80: E501 line too long (80 > 79 characters)
        self.retry_delay = int(retry_delay or os.getenv("TDX_RETRY_DELAY", "1"))
                                                                               ^
src/adapters/tdx_adapter.py:80:80: E501 line too long (81 > 79 characters)
        self.api_timeout = int(api_timeout or os.getenv("TDX_API_TIMEOUT", "10"))
                                                                               ^
src/adapters/tdx_adapter.py:91:80: E501 line too long (86 > 79 characters)
                self.tdx_host, self.tdx_port = self.server_config.get_primary_server()
                                                                               ^
src/adapters/tdx_adapter.py:92:34: F541 f-string is missing placeholders
                self.logger.info(f"TDX适配器初始化: 使用connect.cfg配置")
                                 ^
src/adapters/tdx_adapter.py:104:80: E501 line too long (85 > 79 characters)
                self.tdx_port = int(tdx_port or os.getenv("TDX_SERVER_PORT", "7709"))
                                                                               ^
src/adapters/tdx_adapter.py:107:80: E501 line too long (85 > 79 characters)
            self.tdx_host = tdx_host or os.getenv("TDX_SERVER_HOST", "101.227.73.20")
                                                                               ^
src/adapters/tdx_adapter.py:108:80: E501 line too long (81 > 79 characters)
            self.tdx_port = int(tdx_port or os.getenv("TDX_SERVER_PORT", "7709"))
                                                                               ^
src/adapters/tdx_adapter.py:112:80: E501 line too long (84 > 79 characters)
            f"重试配置: max_retries={self.max_retries}, retry_delay={self.retry_delay}s"
                                                                               ^
src/adapters/tdx_adapter.py:118:1: D400 First line should end with a period
        """
        获取TDX连接(上下文管理器)

        Returns:
            TdxHq_API实例的上下文管理器

        Example:
            with self._get_tdx_connection() as api:
                data = api.get_security_quotes([...])
        """
^
src/adapters/tdx_adapter.py:133:1: D400 First line should end with a period
        """
        识别股票代码对应的市场类型

        Args:
            symbol: 6位数字股票代码 (如'600519', '000001')

        Returns:
            0 = 深圳证券交易所 (深市主板/中小板/创业板)
            1 = 上海证券交易所 (沪市主板/科创板)

        Raises:
            ValueError: 如果股票代码格式无效或无法识别市场

        市场识别规则:
            - 000xxx, 002xxx, 300xxx → 深圳 (主板/中小板/创业板)
            - 600xxx, 601xxx, 603xxx, 688xxx → 上海 (主板/科创板)
        """
^
src/adapters/tdx_adapter.py:184:1: D400 First line should end with a period
        """
        API调用重试装饰器(带指数退避和服务器故障转移)

        Args:
            func: 要包装的函数

        Returns:
            包装后的函数(自动重试)

        行为:
            - 失败时自动重试max_retries次
            - 每次重试延迟逐渐增加(指数退避)
            - 如果启用server_config,在重试时切换到备用服务器
            - 最后一次失败时抛出原始异常
        """
^
src/adapters/tdx_adapter.py:226:80: E501 line too long (84 > 79 characters)
                            f"API调用失败 (尝试 {attempt}/{self.max_retries}): {str(e)}, "
                                                                               ^
src/adapters/tdx_adapter.py:242:1: D400 First line should end with a period
        """
        验证K线数据完整性和合法性

        Args:
            df: K线DataFrame

        Returns:
            验证并清理后的DataFrame

        验证项:
            1. 检查必需列是否存在
            2. 价格列非负
            3. 成交量非负
            4. OHLC逻辑 (high >= max(open, close, low))
        """
^
src/adapters/tdx_adapter.py:280:80: E501 line too long (80 > 79 characters)
        invalid_rows = df[df["high"] < df[["open", "close", "low"]].max(axis=1)]
                                                                               ^
src/adapters/tdx_adapter.py:294:1: D400 First line should end with a period
        """
        获取股票日线数据

        Args:
            symbol: 6位数字股票代码 (如'600519')
            start_date: 开始日期 (格式: 'YYYY-MM-DD')
            end_date: 结束日期 (格式: 'YYYY-MM-DD')

        Returns:
            pd.DataFrame: 日线数据,包含以下列:
                - date: 日期
                - open: 开盘价
                - high: 最高价
                - low: 最低价
                - close: 收盘价
                - volume: 成交量
                - amount: 成交额

        Note:
            - pytdx单次最多返回800条数据,需要分页获取
            - 数据从最新日期开始向前获取
            - 返回的数据按日期升序排列

        Example:
            >>> tdx = TdxDataSource()
            >>> df = tdx.get_stock_daily('600519', '2024-01-01', '2024-12-31')
            >>> print(df.head())
        """
^
src/adapters/tdx_adapter.py:353:1: D400 First line should end with a period
                """获取单批K线数据"""
^
src/adapters/tdx_adapter.py:394:80: E501 line too long (81 > 79 characters)
                    self.logger.debug(f"获取第{batch_num + 1}批数据: {len(df_batch)}条")
                                                                               ^
src/adapters/tdx_adapter.py:406:80: E501 line too long (88 > 79 characters)
                            f"返回数据量({len(df_batch)}) < batch_size({batch_size}), 已到最早数据"
                                                                               ^
src/adapters/tdx_adapter.py:426:80: E501 line too long (83 > 79 characters)
                (df_result["date"] >= start_date) & (df_result["date"] <= end_date)
                                                                               ^
src/adapters/tdx_adapter.py:461:1: D400 First line should end with a period
        """
        获取指数日线数据

        Args:
            symbol: 6位数字指数代码 (如'000001'=上证指数, '399001'=深证成指)
            start_date: 开始日期 (格式: 'YYYY-MM-DD')
            end_date: 结束日期 (格式: 'YYYY-MM-DD')

        Returns:
            pd.DataFrame: 指数日线数据,包含以下列:
                - date: 日期
                - open: 开盘点位
                - high: 最高点位
                - low: 最低点位
                - close: 收盘点位
                - volume: 成交量
                - amount: 成交额

        Note:
            - 指数代码识别: 000xxx/399xxx=深圳, 其他=上海
            - 实现逻辑与get_stock_daily类似,但使用指数API

        Example:
            >>> tdx = TdxDataSource()
            >>> df = tdx.get_index_daily('000001', '2024-01-01', '2024-12-31')
            >>> print(df.head())
        """
^
src/adapters/tdx_adapter.py:522:1: D400 First line should end with a period
                """获取单批指数K线数据"""
^
src/adapters/tdx_adapter.py:564:80: E501 line too long (81 > 79 characters)
                    self.logger.debug(f"获取第{batch_num + 1}批数据: {len(df_batch)}条")
                                                                               ^
src/adapters/tdx_adapter.py:576:80: E501 line too long (88 > 79 characters)
                            f"返回数据量({len(df_batch)}) < batch_size({batch_size}), 已到最早数据"
                                                                               ^
src/adapters/tdx_adapter.py:596:80: E501 line too long (83 > 79 characters)
                (df_result["date"] >= start_date) & (df_result["date"] <= end_date)
                                                                               ^
src/adapters/tdx_adapter.py:629:1: D400 First line should end with a period
        """获取股票基本信息 - Phase 6实现(有限支持)"""
^
src/adapters/tdx_adapter.py:680:1: D400 First line should end with a period
        """获取指数成分股 - Phase 7实现(有限支持)"""
^
src/adapters/tdx_adapter.py:698:1: D400 First line should end with a period
        """
        获取实时行情数据

        Args:
            symbol: 6位数字股票代码 (如'600519')

        Returns:
            Dict: 成功时返回包含实时行情的字典
                {
                    'code': str,          # 股票代码
                    'name': str,          # 股票名称
                    'price': float,       # 最新价
                    'pre_close': float,   # 昨收价
                    'open': float,        # 今开价
                    'high': float,        # 最高价
                    'low': float,         # 最低价
                    'volume': int,        # 成交量(手)
                    'amount': float,      # 成交额(元)
                    'bid1': float,        # 买一价
                    'bid1_volume': int,   # 买一量
                    'ask1': float,        # 卖一价
                    'ask1_volume': int,   # 卖一量
                    'timestamp': str      # 查询时间戳
                }
            str: 失败时返回错误消息字符串

        Example:
            >>> tdx = TdxDataSource()
            >>> quote = tdx.get_real_time_data('600519')
            >>> if isinstance(quote, dict):
            >>>     print(f"当前价: {quote['price']}")
        """
^
src/adapters/tdx_adapter.py:720:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取实时行情数据

        Args:
            symbol: 6位数字股票代码 (如'600519')

        Returns:
            Dict: 成功时返回包含实时行情的字典
                {
                    'code': str,          # 股票代码
                    'name': str,          # 股票名称
                    'price': float,       # 最新价
                    'pre_close': float,   # 昨收价
                    'open': float,        # 今开价
                    'high': float,        # 最高价
                    'low': float,         # 最低价
                    'volume': int,        # 成交量(手)
                    'amount': float,      # 成交额(元)
                    'bid1': float,        # 买一价
                    'bid1_volume': int,   # 买一量
                    'ask1': float,        # 卖一价
                    'ask1_volume': int,   # 卖一量
                    'timestamp': str      # 查询时间戳
                }
            str: 失败时返回错误消息字符串

        Example:
            >>> tdx = TdxDataSource()
            >>> quote = tdx.get_real_time_data('600519')
            >>> if isinstance(quote, dict):
            >>>     print(f"当前价: {quote['price']}")
        """
^
src/adapters/tdx_adapter.py:721:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取实时行情数据

        Args:
            symbol: 6位数字股票代码 (如'600519')

        Returns:
            Dict: 成功时返回包含实时行情的字典
                {
                    'code': str,          # 股票代码
                    'name': str,          # 股票名称
                    'price': float,       # 最新价
                    'pre_close': float,   # 昨收价
                    'open': float,        # 今开价
                    'high': float,        # 最高价
                    'low': float,         # 最低价
                    'volume': int,        # 成交量(手)
                    'amount': float,      # 成交额(元)
                    'bid1': float,        # 买一价
                    'bid1_volume': int,   # 买一量
                    'ask1': float,        # 卖一价
                    'ask1_volume': int,   # 卖一量
                    'timestamp': str      # 查询时间戳
                }
            str: 失败时返回错误消息字符串

        Example:
            >>> tdx = TdxDataSource()
            >>> quote = tdx.get_real_time_data('600519')
            >>> if isinstance(quote, dict):
            >>>     print(f"当前价: {quote['price']}")
        """
^
src/adapters/tdx_adapter.py:760:80: E501 line too long (82 > 79 characters)
            if result is None or not isinstance(result, list) or len(result) == 0:
                                                                               ^
src/adapters/tdx_adapter.py:779:80: E501 line too long (84 > 79 characters)
                "pre_close": float(row.get("last_close", 0)),  # pytdx中昨收叫last_close
                                                                               ^
src/adapters/tdx_adapter.py:789:80: E501 line too long (83 > 79 characters)
                "timestamp": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),  # 当前时间戳
                                                                               ^
src/adapters/tdx_adapter.py:816:80: E501 line too long (82 > 79 characters)
    def get_market_calendar(self, start_date: str, end_date: str) -> pd.DataFrame:
                                                                               ^
src/adapters/tdx_adapter.py:817:1: D400 First line should end with a period
        """获取交易日历 - Phase 8 stub实现(TDX不支持)"""
^
src/adapters/tdx_adapter.py:823:80: E501 line too long (87 > 79 characters)
    def get_financial_data(self, symbol: str, period: str = "quarter") -> pd.DataFrame:
                                                                               ^
src/adapters/tdx_adapter.py:824:1: D400 First line should end with a period
        """获取财务数据 - Phase 6实现(有限支持)"""
^
src/adapters/tdx_adapter.py:855:1: D400 First line should end with a period
        """获取新闻数据 - Phase 8 stub实现(TDX不支持)"""
^
src/adapters/tdx_adapter.py:864:1: D400 First line should end with a period
        """
        获取股票K线数据(支持多种周期)

        Args:
            symbol: 6位数字股票代码
            start_date: 开始日期
            end_date: 结束日期
            period: K线周期
                - '1m':  1分钟
                - '5m':  5分钟
                - '15m': 15分钟
                - '30m': 30分钟
                - '1h':  1小时
                - '1d':  日线 (默认)

        Returns:
            pd.DataFrame: K线数据

        Example:
            >>> tdx = TdxDataSource()
            >>> # 获取5分钟K线
            >>> df = tdx.get_stock_kline('600519', '2024-01-01', '2024-01-31', period='5m')
        """
^
src/adapters/tdx_adapter.py:871:1: RST301 Unexpected indentation.
        """
        获取股票K线数据(支持多种周期)

        Args:
            symbol: 6位数字股票代码
            start_date: 开始日期
            end_date: 结束日期
            period: K线周期
                - '1m':  1分钟
                - '5m':  5分钟
                - '15m': 15分钟
                - '30m': 30分钟
                - '1h':  1小时
                - '1d':  日线 (默认)

        Returns:
            pd.DataFrame: K线数据

        Example:
            >>> tdx = TdxDataSource()
            >>> # 获取5分钟K线
            >>> df = tdx.get_stock_kline('600519', '2024-01-01', '2024-01-31', period='5m')
        """
^
src/adapters/tdx_adapter.py:885:80: E501 line too long (91 > 79 characters)
        """
        获取股票K线数据(支持多种周期)

        Args:
            symbol: 6位数字股票代码
            start_date: 开始日期
            end_date: 结束日期
            period: K线周期
                - '1m':  1分钟
                - '5m':  5分钟
                - '15m': 15分钟
                - '30m': 30分钟
                - '1h':  1小时
                - '1d':  日线 (默认)

        Returns:
            pd.DataFrame: K线数据

        Example:
            >>> tdx = TdxDataSource()
            >>> # 获取5分钟K线
            >>> df = tdx.get_stock_kline('600519', '2024-01-01', '2024-01-31', period='5m')
        """




                           ^
src/adapters/tdx_adapter.py:932:47: F541 f-string is missing placeholders
                        raise ConnectionError(f"无法连接到TDX服务器")
                                              ^
src/adapters/tdx_adapter.py:957:80: E501 line too long (83 > 79 characters)
                        df_batch["datetime"] = pd.to_datetime(df_batch["datetime"])
                                                                               ^
src/adapters/tdx_adapter.py:990:80: E501 line too long (87 > 79 characters)
                df_result["date_only"] = pd.to_datetime(df_result["date"]).dt.strftime(
                                                                               ^
src/adapters/tdx_adapter.py:1013:1: D400 First line should end with a period
        """
        获取指数K线数据(支持多种周期)

        Args:
            symbol: 6位数字指数代码
            start_date: 开始日期
            end_date: 结束日期
            period: K线周期 ('1m', '5m', '15m', '30m', '1h', '1d')

        Returns:
            pd.DataFrame: 指数K线数据
        """
^
src/adapters/tdx_adapter.py:1086:80: E501 line too long (83 > 79 characters)
                        df_batch["datetime"] = pd.to_datetime(df_batch["datetime"])
                                                                               ^
src/adapters/tdx_adapter.py:1109:80: E501 line too long (87 > 79 characters)
                df_result["date_only"] = pd.to_datetime(df_result["date"]).dt.strftime(
                                                                               ^
src/adapters/tdx_adapter.py:1131:1: D400 First line should end with a period
        """
        读取通达信二进制 .day 文件

        通达信 .day 文件格式:
        - 每条记录32字节
        - 格式: struct.unpack('IIIIIfII', ...)
        - 字段: [日期, 开盘价*100, 最高价*100, 最低价*100,
                收盘价*100, 成交额, 成交量, 保留字段]

        Args:
            file_path: .day 文件的绝对路径

        Returns:
            pd.DataFrame: 包含OHLCV数据
                - code: 股票代码
                - tradeDate: 交易日期
                - open: 开盘价
                - high: 最高价
                - low: 最低价
                - close: 收盘价
                - amount: 成交额
                - vol: 成交量

        Raises:
            FileNotFoundError: 文件不存在
            ValueError: 文件格式错误

        Example:
            >>> tdx = TdxDataSource()
            >>> df = tdx.read_day_file('/path/to/sh000001.day')
            >>> print(df.head())
        """
^
src/adapters/tdx_adapter.py:1137:1: RST301 Unexpected indentation.
        """
        读取通达信二进制 .day 文件

        通达信 .day 文件格式:
        - 每条记录32字节
        - 格式: struct.unpack('IIIIIfII', ...)
        - 字段: [日期, 开盘价*100, 最高价*100, 最低价*100,
                收盘价*100, 成交额, 成交量, 保留字段]

        Args:
            file_path: .day 文件的绝对路径

        Returns:
            pd.DataFrame: 包含OHLCV数据
                - code: 股票代码
                - tradeDate: 交易日期
                - open: 开盘价
                - high: 最高价
                - low: 最低价
                - close: 收盘价
                - amount: 成交额
                - vol: 成交量

        Raises:
            FileNotFoundError: 文件不存在
            ValueError: 文件格式错误

        Example:
            >>> tdx = TdxDataSource()
            >>> df = tdx.read_day_file('/path/to/sh000001.day')
            >>> print(df.head())
        """
^
src/adapters/tdx_adapter.py:1190:70: E203 whitespace before ':'
                        row = list(struct.unpack("IIIIIfII", buffer[i : i + row_size]))
                                                                     ^
src/adapters/tdx_adapter.py:1190:80: E501 line too long (87 > 79 characters)
                        row = list(struct.unpack("IIIIIfII", buffer[i : i + row_size]))
                                                                               ^
src/adapters/tdx_adapter.py:1238:80: E501 line too long (85 > 79 characters)
        invalid_count = (df[["open", "high", "low", "close"]] <= 0).any(axis=1).sum()
                                                                               ^
src/adapters/tdx_adapter.py:1249:1: D400 First line should end with a period
        """
        获取分钟K线数据

        Args:
            symbol: str - 股票代码
            period: str - 周期 (1m/5m/15m/30m/60m)
            start_date: str - 开始日期
            end_date: str - 结束日期

        Returns:
            pd.DataFrame: 分钟K线数据
        """
^
src/adapters/tdx_adapter.py:1264:1: D400 First line should end with a period
        """
        获取行业分类数据（TDX不直接提供此功能，返回空DataFrame）

        Returns:
            pd.DataFrame: 行业分类数据
        """
^
src/adapters/tdx_adapter.py:1274:1: D400 First line should end with a period
        """
        获取概念分类数据（TDX不直接提供此功能，返回空DataFrame）

        Returns:
            pd.DataFrame: 概念分类数据
        """
^
src/adapters/tdx_adapter.py:1284:1: D400 First line should end with a period
        """
        获取个股的行业和概念分类信息（TDX不直接提供此功能，返回空字典）

        Args:
            symbol: str - 股票代码

        Returns:
            Dict: 个股行业和概念信息
        """
^
src/adapters/test_customer_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
Customer 数据源适配器测试脚本
测试 efinance 和 easyquotation 数据源的功能

示例用法：
    >>> python test_customer_adapter.py
"""
^
src/adapters/test_customer_adapter.py:1:1: D400 First line should end with a period
"""
Customer 数据源适配器测试脚本
测试 efinance 和 easyquotation 数据源的功能

示例用法：
    >>> python test_customer_adapter.py
"""
^
src/adapters/test_customer_adapter.py:19:1: E402 module level import not at top of file
from src.adapters.customer_adapter import CustomerDataSource
^
src/adapters/test_customer_adapter.py:23:1: D400 First line should end with a period
    """测试Customer数据源"""
^
src/adapters/test_customer_adapter.py:44:19: F541 f-string is missing placeholders
            print(f"   前5行数据预览:")
                  ^
src/adapters/test_customer_adapter.py:60:19: F541 f-string is missing placeholders
            print(f"   数据预览:")
                  ^
src/adapters/test_customer_adapter.py:79:80: E501 line too long (84 > 79 characters)
        daily_data = customer_source.get_stock_daily("000001", start_date, end_date)
                                                                               ^
src/adapters/test_customer_adapter.py:82:19: F541 f-string is missing placeholders
            print(f"   数据预览:")
                  ^
src/adapters/test_customer_adapter.py:104:80: E501 line too long (81 > 79 characters)
        if isinstance(financial_data, pd.DataFrame) and not financial_data.empty:
                                                                               ^
src/adapters/test_customer_adapter.py:106:19: F541 f-string is missing placeholders
            print(f"   数据预览:")
                  ^
src/adapters/test_financial_adapter.py:3:1: D205 1 blank line required between summary line and description
"""
Financial适配器测试文件
用于测试FinancialDataSource类的功能
"""
^
src/adapters/test_financial_adapter.py:3:1: D400 First line should end with a period
"""
Financial适配器测试文件
用于测试FinancialDataSource类的功能
"""
^
src/adapters/test_financial_adapter.py:14:1: E402 module level import not at top of file
from src.adapters.financial_adapter import FinancialDataSource
^
src/adapters/test_financial_adapter.py:15:1: E402 module level import not at top of file
import pandas as pd
^
src/adapters/test_financial_adapter.py:19:1: D400 First line should end with a period
    """测试Financial适配器"""
^
src/adapters/test_financial_adapter.py:27:80: E501 line too long (130 > 79 characters)
        f"Financial数据源初始化状态: efinance可用={financial_ds.efinance_available}, easyquotation可用={financial_ds.easyquotation_available}"
                                                                               ^
src/adapters/test_simple.py:1:1: D200 One-line docstring should fit on one line with quotes
"""
简化测试脚本，用于检查Customer适配器是否能正常导入和初始化
"""
^
src/adapters/test_simple.py:1:1: D400 First line should end with a period
"""
简化测试脚本，用于检查Customer适配器是否能正常导入和初始化
"""
^
src/adapters/tushare_adapter.py:1:1: D205 1 blank line required between summary line and description
"""
Tushare 数据源适配器
实现了统一数据接口，提供 Tushare 数据访问

使用前需要：
1. 安装 tushare: pip install tushare
2. 申请 Tushare Token
3. 设置环境变量: TUSHARE_TOKEN=your_token
"""
^
src/adapters/tushare_adapter.py:1:1: D400 First line should end with a period
"""
Tushare 数据源适配器
实现了统一数据接口，提供 Tushare 数据访问

使用前需要：
1. 安装 tushare: pip install tushare
2. 申请 Tushare Token
3. 设置环境变量: TUSHARE_TOKEN=your_token
"""
^
src/adapters/tushare_adapter.py:20:1: E402 module level import not at top of file
from src.interfaces.refactored_interfaces import IDataSource
^
src/adapters/tushare_adapter.py:24:1: D400 First line should end with a period
    """Tushare数据源实现"""
^
src/adapters/tushare_adapter.py:26:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/adapters/tushare_adapter.py:48:1: D400 First line should end with a period
        """获取股票日线数据-Tushare实现"""
^
src/adapters/tushare_adapter.py:88:1: D400 First line should end with a period
        """获取指数日线数据-Tushare实现"""
^
src/adapters/tushare_adapter.py:125:1: D400 First line should end with a period
        """获取股票基本信息-Tushare实现"""
^
src/adapters/tushare_adapter.py:143:1: D400 First line should end with a period
        """获取指数成分股-Tushare实现"""
^
src/adapters/tushare_adapter.py:160:1: D400 First line should end with a period
        """获取实时数据-Tushare实现"""
^
src/adapters/tushare_adapter.py:167:1: D400 First line should end with a period
        """获取交易日历-Tushare实现"""
^
src/adapters/tushare_adapter.py:184:1: D400 First line should end with a period
        """获取财务数据-Tushare实现"""
^
src/adapters/tushare_adapter.py:202:1: D400 First line should end with a period
        """获取新闻数据-Tushare实现"""
^
src/adapters/tushare_adapter.py:207:1: D400 First line should end with a period
        """格式化股票代码为Tushare格式"""
^
src/adapters/tushare_adapter.py:217:1: D400 First line should end with a period
        """格式化指数代码为Tushare格式"""
^
src/api/alert_history_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI routes for alert history and analytics
Provides API endpoints for alert query, reporting, and analytics
"""
^
src/api/alert_history_routes.py:1:1: D400 First line should end with a period
"""
FastAPI routes for alert history and analytics
Provides API endpoints for alert query, reporting, and analytics
"""
^
src/api/alert_history_routes.py:24:33: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert_name: Optional[str] = Query(None),
                                ^
src/api/alert_history_routes.py:25:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    severity: Optional[str] = Query(None),
                              ^
src/api/alert_history_routes.py:26:30: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    service: Optional[str] = Query(None),
                             ^
src/api/alert_history_routes.py:27:29: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    status: Optional[str] = Query(None),
                            ^
src/api/alert_history_routes.py:28:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(7, ge=1, le=365),
                ^
src/api/alert_history_routes.py:29:18: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: int = Query(1000, ge=1, le=10000),
                 ^
src/api/alert_history_routes.py:30:19: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    offset: int = Query(0, ge=0),
                  ^
src/api/alert_history_routes.py:31:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:33:1: D400 First line should end with a period
    """
    Retrieve alert history with optional filtering

    Query Parameters:
    - alert_name: Filter by alert name
    - severity: Filter by severity (critical, warning, info)
    - service: Filter by service
    - status: Filter by status (firing, resolved, acknowledged, suppressed, escalated)
    - days: Days to look back (default: 7)
    - limit: Maximum results (default: 1000)
    - offset: Pagination offset (default: 0)
    """
^
src/api/alert_history_routes.py:40:80: E501 line too long (86 > 79 characters)
    """
    Retrieve alert history with optional filtering

    Query Parameters:
    - alert_name: Filter by alert name
    - severity: Filter by severity (critical, warning, info)
    - service: Filter by service
    - status: Filter by status (firing, resolved, acknowledged, suppressed, escalated)
    - days: Days to look back (default: 7)
    - limit: Maximum results (default: 1000)
    - offset: Pagination offset (default: 0)
    """



                   ^
src/api/alert_history_routes.py:67:47: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert_id: int, db: AlertHistoryDatabase = Depends(get_alert_history_db)
                                              ^
src/api/alert_history_routes.py:69:1: D400 First line should end with a period
    """Get specific alert record by ID"""
^
src/api/alert_history_routes.py:80:33: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert_name: Optional[str] = Query(None),
                                ^
src/api/alert_history_routes.py:81:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(7, ge=1, le=365),
                ^
src/api/alert_history_routes.py:82:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:84:1: D400 First line should end with a period
    """
    Get alert statistics for time period

    Returns:
    - Severity distribution
    - Resolution time statistics
    - Escalation statistics
    - Top services by alert count
    """
^
src/api/alert_history_routes.py:100:18: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: int = Query(10, ge=1, le=100),
                 ^
src/api/alert_history_routes.py:101:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(7, ge=1, le=365),
                ^
src/api/alert_history_routes.py:102:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    order_by: str = Query("count", regex="^(count|resolution_time|escalation_level)$"),
                    ^
src/api/alert_history_routes.py:102:80: E501 line too long (87 > 79 characters)
    order_by: str = Query("count", regex="^(count|resolution_time|escalation_level)$"),
                                                                               ^
src/api/alert_history_routes.py:103:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:105:1: D400 First line should end with a period
    """
    Get most impactful alerts

    Order by:
    - count: Total occurrences
    - resolution_time: Average resolution time (slowest)
    - escalation_level: Average escalation level (highest)
    """
^
src/api/alert_history_routes.py:115:80: E501 line too long (88 > 79 characters)
    return {"success": True, "count": len(alerts), "order_by": order_by, "data": alerts}
                                                                               ^
src/api/alert_history_routes.py:120:33: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert_name: Optional[str] = Query(None),
                                ^
src/api/alert_history_routes.py:121:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(30, ge=1, le=365),
                ^
src/api/alert_history_routes.py:122:24: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    granularity: str = Query("day", regex="^(day|hour)$"),
                       ^
src/api/alert_history_routes.py:123:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:125:1: D400 First line should end with a period
    """
    Get alert trend data for charting

    Granularity:
    - day: Daily buckets
    - hour: Hourly buckets
    """
^
src/api/alert_history_routes.py:147:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(7, ge=1, le=365),
                ^
src/api/alert_history_routes.py:148:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:150:1: D400 First line should end with a period
    """
    Get health metrics for a service

    Metrics:
    - Total alerts
    - Resolved count and rate
    - Severity distribution
    - Average resolution time
    - Health score (0-100)
    """
^
src/api/alert_history_routes.py:167:50: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert_data: dict, db: AlertHistoryDatabase = Depends(get_alert_history_db)
                                                 ^
src/api/alert_history_routes.py:169:1: D400 First line should end with a period
    """
    Save new alert history record

    Request body:
    {
        "alert_name": "HighAPIResponseTime",
        "severity": "warning",
        "service": "api",
        "category": "performance",
        "instance": "api-prod-1",
        "summary": "API response time high",
        "description": "p95 response time exceeded 1s",
        "labels": {"environment": "prod"},
        "annotations": {"runbook": "..."}
    }
    """
^
src/api/alert_history_routes.py:173:1: RST301 Unexpected indentation.
    """
    Save new alert history record

    Request body:
    {
        "alert_name": "HighAPIResponseTime",
        "severity": "warning",
        "service": "api",
        "category": "performance",
        "instance": "api-prod-1",
        "summary": "API response time high",
        "description": "p95 response time exceeded 1s",
        "labels": {"environment": "prod"},
        "annotations": {"runbook": "..."}
    }
    """
^
src/api/alert_history_routes.py:182:1: RST201 Block quote ends without a blank line; unexpected unindent.
    """
    Save new alert history record

    Request body:
    {
        "alert_name": "HighAPIResponseTime",
        "severity": "warning",
        "service": "api",
        "category": "performance",
        "instance": "api-prod-1",
        "summary": "API response time high",
        "description": "p95 response time exceeded 1s",
        "labels": {"environment": "prod"},
        "annotations": {"runbook": "..."}
    }
    """
^
src/api/alert_history_routes.py:218:48: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    resolution_time_seconds: Optional[float] = Query(None),
                                               ^
src/api/alert_history_routes.py:219:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:221:1: D400 First line should end with a period
    """Mark alert as resolved"""
^
src/api/alert_history_routes.py:237:28: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    acknowledged_by: str = Query(...),
                           ^
src/api/alert_history_routes.py:238:30: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    comment: Optional[str] = Query(None),
                             ^
src/api/alert_history_routes.py:239:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:241:1: D400 First line should end with a period
    """Acknowledge alert"""
^
src/api/alert_history_routes.py:259:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    to_level: int = Query(..., ge=1, le=3),
                    ^
src/api/alert_history_routes.py:260:29: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    reason: Optional[str] = Query(None),
                            ^
src/api/alert_history_routes.py:261:25: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    escalated_by: str = Query("system"),
                        ^
src/api/alert_history_routes.py:262:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:264:1: D400 First line should end with a period
    """Escalate alert to higher level"""
^
src/api/alert_history_routes.py:266:80: E501 line too long (83 > 79 characters)
        escalation_id = db.escalate_alert(alert_id, to_level, reason, escalated_by)
                                                                               ^
src/api/alert_history_routes.py:283:30: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    min_correlation: float = Query(0.5, ge=0.0, le=1.0),
                             ^
src/api/alert_history_routes.py:284:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:286:1: D400 First line should end with a period
    """Get alerts correlated with given alert"""
^
src/api/alert_history_routes.py:299:22: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert1_id: int = Query(...),
                     ^
src/api/alert_history_routes.py:300:22: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert2_id: int = Query(...),
                     ^
src/api/alert_history_routes.py:301:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    correlation_score: float = Query(..., ge=0.0, le=1.0),
                               ^
src/api/alert_history_routes.py:302:29: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    correlation_type: str = Query("temporal"),
                            ^
src/api/alert_history_routes.py:303:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:305:1: D400 First line should end with a period
    """Record correlation between two alerts"""
^
src/api/alert_history_routes.py:323:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(90, ge=30, le=365),
                ^
src/api/alert_history_routes.py:324:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:326:1: D400 First line should end with a period
    """
    Delete alert records older than specified days

    Warning: This operation cannot be undone
    """
^
src/api/alert_history_routes.py:342:30: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    service: Optional[str] = Query(None),
                             ^
src/api/alert_history_routes.py:343:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(7, ge=1, le=365),
                ^
src/api/alert_history_routes.py:344:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:346:1: D400 First line should end with a period
    """
    Get comprehensive daily alert report

    Includes:
    - Alert count by severity
    - Top alerts
    - Service health metrics
    - Trends
    """
^
src/api/alert_history_routes.py:377:33: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    alert_name: Optional[str] = Query(None),
                                ^
src/api/alert_history_routes.py:378:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    severity: Optional[str] = Query(None),
                              ^
src/api/alert_history_routes.py:379:30: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    service: Optional[str] = Query(None),
                             ^
src/api/alert_history_routes.py:380:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    days: int = Query(7, ge=1, le=365),
                ^
src/api/alert_history_routes.py:381:32: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    db: AlertHistoryDatabase = Depends(get_alert_history_db),
                               ^
src/api/alert_history_routes.py:383:1: D400 First line should end with a period
    """
    Export alerts as CSV

    Returns CSV format suitable for spreadsheet imports
    """
^
src/api/alert_history_routes.py:407:80: E501 line too long (81 > 79 characters)
    return {"success": True, "count": len(alerts), "csv_data": output.getvalue()}
                                                                               ^
src/backup_recovery/__init__.py:1:1: D400 First line should end with a period
"""
数据备份恢复模块

支持 TDengine 和 PostgreSQL 的完整备份恢复方案：
- TDengine: 全量备份 + 增量备份 (RTO: 10分钟, RPO: 1小时)
- PostgreSQL: 全量备份 + WAL 归档 (RTO: 5分钟, RPO: 5分钟)
"""
^
src/backup_recovery/backup_manager.py:1:1: D400 First line should end with a period
"""
备份管理器 - 支持 TDengine 和 PostgreSQL 的完整备份

策略:
- TDengine: 日全量备份 + 小时增量备份
- PostgreSQL: 日全量备份 + WAL 归档
"""
^
src/backup_recovery/backup_manager.py:28:1: D400 First line should end with a period
    """备份元数据"""
^
src/backup_recovery/backup_manager.py:46:1: D400 First line should end with a period
    """备份管理器"""
^
src/backup_recovery/backup_manager.py:54:1: D400 First line should end with a period
        """
        初始化备份管理器

        Args:
            backup_base_path: 备份根目录
            compression: 是否压缩备份
            retention_days: 备份保留天数
        """
^
src/backup_recovery/backup_manager.py:86:1: D400 First line should end with a period
        """
        TDengine 全量备份

        Returns:
            BackupMetadata: 备份元数据
        """
^
src/backup_recovery/backup_manager.py:86:1: D403 First word of the first line should be properly capitalized
        """
        TDengine 全量备份

        Returns:
            BackupMetadata: 备份元数据
        """
^
src/backup_recovery/backup_manager.py:129:80: E501 line too long (82 > 79 characters)
                compressed_file = self.tdengine_backup_dir / f"{backup_id}.tar.gz"
                                                                               ^
src/backup_recovery/backup_manager.py:136:80: E501 line too long (81 > 79 characters)
                    original_size / compressed_size if compressed_size > 0 else 0
                                                                               ^
src/backup_recovery/backup_manager.py:195:80: E501 line too long (82 > 79 characters)
    def backup_tdengine_incremental(self, since_backup_id: str) -> BackupMetadata:
                                                                               ^
src/backup_recovery/backup_manager.py:196:1: D400 First line should end with a period
        """
        TDengine 增量备份（基于时间戳）

        Args:
            since_backup_id: 上次备份的 ID

        Returns:
            BackupMetadata: 备份元数据
        """
^
src/backup_recovery/backup_manager.py:196:1: D403 First word of the first line should be properly capitalized
        """
        TDengine 增量备份（基于时间戳）

        Args:
            since_backup_id: 上次备份的 ID

        Returns:
            BackupMetadata: 备份元数据
        """
^
src/backup_recovery/backup_manager.py:215:80: E501 line too long (93 > 79 characters)
                    f"Previous backup {since_backup_id} not found, doing full backup instead"
                                                                               ^
src/backup_recovery/backup_manager.py:231:80: E501 line too long (81 > 79 characters)
                logger.info(f"Backing up TDengine incremental data from {table}")
                                                                               ^
src/backup_recovery/backup_manager.py:246:80: E501 line too long (87 > 79 characters)
                    logger.info(f"  Backed up {len(df)} incremental rows from {table}")
                                                                               ^
src/backup_recovery/backup_manager.py:254:80: E501 line too long (82 > 79 characters)
                compressed_file = self.tdengine_backup_dir / f"{backup_id}.tar.gz"
                                                                               ^
src/backup_recovery/backup_manager.py:261:80: E501 line too long (81 > 79 characters)
                    original_size / compressed_size if compressed_size > 0 else 0
                                                                               ^
src/backup_recovery/backup_manager.py:318:1: D400 First line should end with a period
        """
        PostgreSQL 全量备份（使用 pg_dump）

        Returns:
            BackupMetadata: 备份元数据
        """
^
src/backup_recovery/backup_manager.py:318:1: D403 First word of the first line should be properly capitalized
        """
        PostgreSQL 全量备份（使用 pg_dump）

        Returns:
            BackupMetadata: 备份元数据
        """
^
src/backup_recovery/backup_manager.py:331:13: F841 local variable 'pg_conn' is assigned to but never used
            pg_conn = self.conn_manager.get_postgresql_connection()
            ^
src/backup_recovery/backup_manager.py:348:1: S605 Starting a process with a shell, possible injection detected, security issue.
            result = os.system(
^
src/backup_recovery/backup_manager.py:360:80: E501 line too long (84 > 79 characters)
                compressed_file = self.postgresql_backup_dir / f"{backup_id}.sql.gz"
                                                                               ^
src/backup_recovery/backup_manager.py:367:80: E501 line too long (81 > 79 characters)
                    original_size / compressed_size if compressed_size > 0 else 0
                                                                               ^
src/backup_recovery/backup_manager.py:430:1: D400 First line should end with a period
        """清理过期备份（基于保留天数）"""
^
src/backup_recovery/backup_manager.py:431:80: E501 line too long (80 > 79 characters)
        cutoff_date = datetime.now().timestamp() - (self.retention_days * 86400)
                                                                               ^
src/backup_recovery/backup_manager.py:433:80: E501 line too long (81 > 79 characters)
        for backup_dir in [self.tdengine_backup_dir, self.postgresql_backup_dir]:
                                                                               ^
src/backup_recovery/backup_manager.py:443:1: D400 First line should end with a period
        """获取所有 TDengine 表"""
^
src/backup_recovery/backup_manager.py:459:1: D400 First line should end with a period
        """获取所有 PostgreSQL 表"""
^
src/backup_recovery/backup_manager.py:483:1: D400 First line should end with a period
        """统计 PostgreSQL 总行数"""
^
src/backup_recovery/backup_manager.py:505:1: D400 First line should end with a period
        """保存备份元数据"""
^
src/backup_recovery/backup_manager.py:514:1: D400 First line should end with a period
        """加载备份元数据"""
^
src/backup_recovery/backup_manager.py:524:1: D400 First line should end with a period
        """获取所有备份列表"""
^
src/backup_recovery/backup_manager.py:537:1: D400 First line should end with a period
        """获取最新的备份"""
^
src/backup_recovery/backup_scheduler.py:1:1: D400 First line should end with a period
"""
备份调度器 - 自动化备份任务

调度策略:
- TDengine: 每天凌晨 2:00 全量备份 + 每小时整点增量备份
- PostgreSQL: 每天凌晨 3:00 全量备份 + WAL 连续归档
"""
^
src/backup_recovery/backup_scheduler.py:27:1: D400 First line should end with a period
    """备份调度器"""
^
src/backup_recovery/backup_scheduler.py:30:1: D400 First line should end with a period
        """
        初始化备份调度器

        Args:
            backup_base_path: 备份根目录
        """
^
src/backup_recovery/backup_scheduler.py:47:1: D400 First line should end with a period
        """启动调度器"""
^
src/backup_recovery/backup_scheduler.py:49:80: E501 line too long (83 > 79 characters)
            logger.warning("APScheduler not installed, backup scheduling disabled")
                                                                               ^
src/backup_recovery/backup_scheduler.py:74:1: D400 First line should end with a period
        """停止调度器"""
^
src/backup_recovery/backup_scheduler.py:81:1: D400 First line should end with a period
        """
        调度 TDengine 全量备份

        时间: 每天 02:00
        """
^
src/backup_recovery/backup_scheduler.py:100:1: D400 First line should end with a period
        """
        调度 TDengine 增量备份

        时间: 每小时整点（除了 02:00，该时间做全量备份）
        """
^
src/backup_recovery/backup_scheduler.py:119:1: D400 First line should end with a period
        """
        调度 PostgreSQL 全量备份

        时间: 每天 03:00
        """
^
src/backup_recovery/backup_scheduler.py:138:1: D400 First line should end with a period
        """
        调度清理过期备份

        时间: 每天 04:00
        """
^
src/backup_recovery/backup_scheduler.py:159:1: D400 First line should end with a period
        """执行 TDengine 全量备份"""
^
src/backup_recovery/backup_scheduler.py:172:80: E501 line too long (86 > 79 characters)
                logger.error(f"TDengine full backup failed: {metadata.error_message}")
                                                                               ^
src/backup_recovery/backup_scheduler.py:178:1: D400 First line should end with a period
        """执行 TDengine 增量备份"""
^
src/backup_recovery/backup_scheduler.py:183:80: E501 line too long (86 > 79 characters)
                logger.info("Skipping incremental backup at 02:00 (full backup time)")
                                                                               ^
src/backup_recovery/backup_scheduler.py:189:80: E501 line too long (83 > 79 characters)
            latest_full = self.backup_manager.get_latest_backup("tdengine", "full")
                                                                               ^
src/backup_recovery/backup_scheduler.py:192:80: E501 line too long (88 > 79 characters)
                logger.warning("No latest full backup found, doing full backup instead")
                                                                               ^
src/backup_recovery/backup_scheduler.py:207:80: E501 line too long (83 > 79 characters)
                    f"TDengine incremental backup failed: {metadata.error_message}"
                                                                               ^
src/backup_recovery/backup_scheduler.py:214:1: D400 First line should end with a period
        """执行 PostgreSQL 全量备份"""
^
src/backup_recovery/backup_scheduler.py:227:80: E501 line too long (88 > 79 characters)
                logger.error(f"PostgreSQL full backup failed: {metadata.error_message}")
                                                                               ^
src/backup_recovery/backup_scheduler.py:233:1: D400 First line should end with a period
        """清理过期备份"""
^
src/backup_recovery/backup_scheduler.py:243:1: D400 First line should end with a period
        """获取所有计划的备份任务"""
^
src/backup_recovery/backup_scheduler.py:253:80: E501 line too long (80 > 79 characters)
                    job.next_run_time.isoformat() if job.next_run_time else None
                                                                               ^
src/backup_recovery/integrity_checker.py:1:1: D400 First line should end with a period
"""
备份完整性检查器

验证备份数据的完整性和一致性

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/backup_recovery/integrity_checker.py:25:1: D400 First line should end with a period
    """备份完整性检查器"""
^
src/backup_recovery/integrity_checker.py:27:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/backup_recovery/integrity_checker.py:39:1: D400 First line should end with a period
        """
        验证备份数据完整性

        Args:
            backup_path: 备份文件路径
            backup_metadata: 备份元数据
            expected_row_count: 预期总行数
            tolerance_percent: 行数匹配容差百分比

        Returns:
            (是否有效, 详细信息字典)
        """
^
src/backup_recovery/integrity_checker.py:82:1: S608 Possible SQL injection vector through string-based query construction.
                    query = f"SELECT COUNT(*) FROM {table}"
^
src/backup_recovery/integrity_checker.py:83:80: E501 line too long (83 > 79 characters)
                    cursor = self.conn_manager.get_postgresql_connection().cursor()
                                                                               ^
src/backup_recovery/integrity_checker.py:100:80: E501 line too long (84 > 79 characters)
                    details["errors"].append(f"Failed to verify table {table}: {e}")
                                                                               ^
src/backup_recovery/integrity_checker.py:105:80: E501 line too long (87 > 79 characters)
                row_count_diff = abs(details["total_rows_actual"] - expected_row_count)
                                                                               ^
src/backup_recovery/integrity_checker.py:110:80: E501 line too long (145 > 79 characters)
                    msg = f"Row count matches within tolerance: {details['total_rows_actual']} vs {expected_row_count} ({diff_percent*100:.2f}%)"
                                                                               ^
src/backup_recovery/integrity_checker.py:114:80: E501 line too long (127 > 79 characters)
                        f"Row count mismatch: {details['total_rows_actual']} vs {expected_row_count} ({diff_percent*100:.2f}%)"
                                                                               ^
src/backup_recovery/integrity_checker.py:116:80: E501 line too long (129 > 79 characters)
                    msg = f"Row count mismatch: {details['total_rows_actual']} vs {expected_row_count} ({diff_percent*100:.2f}%)"
                                                                               ^
src/backup_recovery/integrity_checker.py:140:1: D400 First line should end with a period
        """
        验证TDengine备份数据完整性

        Args:
            backup_path: 备份文件路径
            backup_metadata: 备份元数据
            expected_row_count: 预期总行数
            tolerance_percent: 行数匹配容差百分比

        Returns:
            (是否有效, 详细信息字典)
        """
^
src/backup_recovery/integrity_checker.py:191:80: E501 line too long (84 > 79 characters)
                    details["errors"].append(f"Failed to verify table {table}: {e}")
                                                                               ^
src/backup_recovery/integrity_checker.py:196:80: E501 line too long (87 > 79 characters)
                row_count_diff = abs(details["total_rows_actual"] - expected_row_count)
                                                                               ^
src/backup_recovery/integrity_checker.py:201:80: E501 line too long (145 > 79 characters)
                    msg = f"Row count matches within tolerance: {details['total_rows_actual']} vs {expected_row_count} ({diff_percent*100:.2f}%)"
                                                                               ^
src/backup_recovery/integrity_checker.py:205:80: E501 line too long (127 > 79 characters)
                        f"Row count mismatch: {details['total_rows_actual']} vs {expected_row_count} ({diff_percent*100:.2f}%)"
                                                                               ^
src/backup_recovery/integrity_checker.py:207:80: E501 line too long (129 > 79 characters)
                    msg = f"Row count mismatch: {details['total_rows_actual']} vs {expected_row_count} ({diff_percent*100:.2f}%)"
                                                                               ^
src/backup_recovery/integrity_checker.py:225:80: E501 line too long (80 > 79 characters)
        self, verification_result: Tuple[bool, Dict[str, Any]], output_path: str
                                                                               ^
src/backup_recovery/integrity_checker.py:227:1: D400 First line should end with a period
        """
        生成完整性验证报告

        Args:
            verification_result: 验证结果
            output_path: 输出路径

        Returns:
            是否生成成功
        """
^
src/backup_recovery/integrity_checker.py:259:1: D400 First line should end with a period
    """主函数 - 用于测试"""
^
src/backup_recovery/recovery_manager.py:1:1: D400 First line should end with a period
"""
备份恢复管理器

从备份文件恢复数据到数据库

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/backup_recovery/recovery_manager.py:27:1: D400 First line should end with a period
    """备份恢复管理器"""
^
src/backup_recovery/recovery_manager.py:29:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/backup_recovery/recovery_manager.py:43:1: D400 First line should end with a period
        """
        恢复备份

        Args:
            backup_file: 备份文件路径
            recovery_id: 恢复任务ID

        Returns:
            (是否成功, 消息)
        """
^
src/backup_recovery/recovery_manager.py:78:1: D400 First line should end with a period
                        """检查tar文件中的路径是否安全，防止路径遍历"""
^
src/backup_recovery/recovery_manager.py:90:80: E501 line too long (86 > 79 characters)
                        return os.path.commonpath([base_path, full_path]) == base_path
                                                                               ^
src/backup_recovery/recovery_manager.py:95:80: E501 line too long (87 > 79 characters)
                            raise ValueError(f"Unsafe path in tar file: {member.name}")
                                                                               ^
src/backup_recovery/recovery_manager.py:97:1: S202 tarfile.extractall used without any validation. Please check and discard dangerous members.
                    tar.extractall(backup_dir)
^
src/backup_recovery/recovery_manager.py:115:80: E501 line too long (85 > 79 characters)
                        success = self._restore_to_tdengine(parquet_file, table_name)
                                                                               ^
src/backup_recovery/recovery_manager.py:118:80: E501 line too long (87 > 79 characters)
                        success = self._restore_to_postgresql(parquet_file, table_name)
                                                                               ^
src/backup_recovery/recovery_manager.py:131:80: E501 line too long (88 > 79 characters)
                        self._log_recovery(log_file, f"Failed to restore: {table_name}")
                                                                               ^
src/backup_recovery/recovery_manager.py:134:80: E501 line too long (86 > 79 characters)
                    self._log_recovery(log_file, f"Error restoring {table_name}: {e}")
                                                                               ^
src/backup_recovery/recovery_manager.py:152:1: D400 First line should end with a period
        """读取备份元数据"""
^
src/backup_recovery/recovery_manager.py:175:80: E501 line too long (80 > 79 characters)
    def _restore_to_tdengine(self, parquet_file: Path, table_name: str) -> bool:
                                                                               ^
src/backup_recovery/recovery_manager.py:176:1: D400 First line should end with a period
        """将数据恢复到TDengine"""
^
src/backup_recovery/recovery_manager.py:192:80: E501 line too long (82 > 79 characters)
    def _restore_to_postgresql(self, parquet_file: Path, table_name: str) -> bool:
                                                                               ^
src/backup_recovery/recovery_manager.py:193:1: D400 First line should end with a period
        """将数据恢复到PostgreSQL"""
^
src/backup_recovery/recovery_manager.py:210:1: D400 First line should end with a period
        """记录恢复日志"""
^
src/backup_recovery/recovery_manager.py:218:1: D400 First line should end with a period
        """获取恢复状态"""
^
src/backup_recovery/recovery_manager.py:246:1: D400 First line should end with a period
        """列出所有恢复任务"""
^
src/backup_recovery/recovery_manager.py:269:1: D400 First line should end with a period
    """主函数 - 用于测试"""
^
src/contract_testing/__init__.py:1:1: D400 First line should end with a period
"""
Contract Testing Framework for MyStocks API

Implements Dredd-like contract testing for OpenAPI specifications.
Verifies API implementations against OpenAPI/Swagger specifications.

Modules:
    - contract_engine: Core contract testing engine
    - spec_validator: OpenAPI specification validation
    - test_hooks: Pre/post hooks for test setup and cleanup
    - api_consistency_checker: API vs spec consistency verification
"""
^
src/contract_testing/__init__.py:15:80: E501 line too long (86 > 79 characters)
from .spec_validator import SpecificationValidator, APIEndpoint, HTTPMethod, Parameter
                                                                               ^
src/contract_testing/api_consistency_checker.py:1:1: D400 First line should end with a period
"""
API Consistency Checker

Verifies that actual API implementation matches OpenAPI specification.
Compares expected vs actual endpoints, parameters, responses, etc.

Task 12.3 Implementation: API consistency verification
"""
^
src/contract_testing/api_consistency_checker.py:21:1: D400 First line should end with a period
    """Types of discrepancies between spec and implementation"""
^
src/contract_testing/api_consistency_checker.py:37:1: D400 First line should end with a period
    """Report of a single discrepancy"""
^
src/contract_testing/api_consistency_checker.py:49:1: D400 First line should end with a period
        """Convert to dictionary"""
^
src/contract_testing/api_consistency_checker.py:64:80: E501 line too long (83 > 79 characters)
    """
    Checks consistency between OpenAPI specification and actual API implementation.

    Identifies missing endpoints, parameter mismatches, response code discrepancies, etc.
    """

                                                                       ^
src/contract_testing/api_consistency_checker.py:66:80: E501 line too long (89 > 79 characters)
    """
    Checks consistency between OpenAPI specification and actual API implementation.

    Identifies missing endpoints, parameter mismatches, response code discrepancies, etc.
    """

                                                                       ^
src/contract_testing/api_consistency_checker.py:70:1: D400 First line should end with a period
        """
        Initialize consistency checker

        Args:
            spec_validator: SpecificationValidator instance with loaded spec
        """
^
src/contract_testing/api_consistency_checker.py:89:1: D400 First line should end with a period
        """
        Register an actual API endpoint for comparison

        Args:
            method: HTTP method
            path: URL path
            parameters: List of parameter names
            response_codes: List of supported response codes
            description: Endpoint description
        """
^
src/contract_testing/api_consistency_checker.py:109:1: D400 First line should end with a period
        """
        Scan API documentation and register endpoints

        Args:
            endpoint_docs: Dictionary of endpoint documentation
        """
^
src/contract_testing/api_consistency_checker.py:126:80: E501 line too long (86 > 79 characters)
                logger.warning(f"⚠️  Failed to register endpoint {endpoint_key}: {e}")
                                                                               ^
src/contract_testing/api_consistency_checker.py:129:1: D400 First line should end with a period
        """
        Check consistency between specification and API

        Returns:
            List of discrepancy reports
        """
^
src/contract_testing/api_consistency_checker.py:152:80: E501 line too long (90 > 79 characters)
            f"✅ Consistency check complete: {len(self.discrepancies)} discrepancies found"
                                                                               ^
src/contract_testing/api_consistency_checker.py:157:1: D400 First line should end with a period
        """Check for endpoints in spec but not in API"""
^
src/contract_testing/api_consistency_checker.py:159:80: E501 line too long (80 > 79 characters)
            f"{ep.method.value.upper()} {ep.path}" for ep in self.spec_endpoints
                                                                               ^
src/contract_testing/api_consistency_checker.py:175:80: E501 line too long (80 > 79 characters)
                suggestion=f"Implement {method} {path} as specified in OpenAPI",
                                                                               ^
src/contract_testing/api_consistency_checker.py:181:1: D400 First line should end with a period
        """Check for endpoints in API but not in spec"""
^
src/contract_testing/api_consistency_checker.py:183:80: E501 line too long (80 > 79 characters)
            f"{ep.method.value.upper()} {ep.path}" for ep in self.spec_endpoints
                                                                               ^
src/contract_testing/api_consistency_checker.py:205:1: D400 First line should end with a period
        """Check for parameter discrepancies"""
^
src/contract_testing/api_consistency_checker.py:228:80: E501 line too long (85 > 79 characters)
                        description=f"Required parameter '{param}' not found in API",
                                                                               ^
src/contract_testing/api_consistency_checker.py:234:80: E501 line too long (83 > 79 characters)
                    logger.warning(f"⚠️  Missing parameter: {param} in {spec_key}")
                                                                               ^
src/contract_testing/api_consistency_checker.py:244:80: E501 line too long (81 > 79 characters)
                    description=f"Undocumented parameter '{param}' found in API",
                                                                               ^
src/contract_testing/api_consistency_checker.py:247:80: E501 line too long (93 > 79 characters)
                    suggestion=f"Document '{param}' in OpenAPI specification for {spec_key}",
                                                                               ^
src/contract_testing/api_consistency_checker.py:253:1: D400 First line should end with a period
        """Check for response code discrepancies"""
^
src/contract_testing/api_consistency_checker.py:275:80: E501 line too long (82 > 79 characters)
                    suggestion=f"Ensure {code} response is handled in {spec_key}",
                                                                               ^
src/contract_testing/api_consistency_checker.py:278:80: E501 line too long (82 > 79 characters)
                logger.warning(f"⚠️  Missing response code: {code} in {spec_key}")
                                                                               ^
src/contract_testing/api_consistency_checker.py:291:80: E501 line too long (89 > 79 characters)
                    suggestion=f"Document response code {code} in OpenAPI specification",
                                                                               ^
src/contract_testing/api_consistency_checker.py:297:1: D400 First line should end with a period
        """Get critical discrepancies only"""
^
src/contract_testing/api_consistency_checker.py:301:1: D400 First line should end with a period
        """Get warning-level discrepancies"""
^
src/contract_testing/api_consistency_checker.py:305:1: D400 First line should end with a period
        """Get informational discrepancies"""
^
src/contract_testing/api_consistency_checker.py:309:1: D400 First line should end with a period
        """Get summary of consistency check"""
^
src/contract_testing/api_consistency_checker.py:321:1: D400 First line should end with a period
        """
        Calculate API consistency score (0-100)

        Returns:
            Score from 0 to 100
        """
^
src/contract_testing/api_consistency_checker.py:330:9: F841 local variable 'total_checks' is assigned to but never used
        total_checks = len(self.spec_endpoints)
        ^
src/contract_testing/api_consistency_checker.py:339:1: D400 First line should end with a period
        """Export consistency check report"""
^
src/contract_testing/api_consistency_checker.py:344:80: E501 line too long (81 > 79 characters)
            "critical_issues": [d.to_dict() for d in self.get_critical_issues()],
                                                                               ^
src/contract_testing/contract_engine.py:1:1: D400 First line should end with a period
"""
Contract Test Engine

Main orchestrator for contract testing.
Coordinates specification validation, test execution, and reporting.

Task 12.1 Implementation: Contract testing engine
"""
^
src/contract_testing/contract_engine.py:25:1: D400 First line should end with a period
    """Single test result"""
^
src/contract_testing/contract_engine.py:37:1: D400 First line should end with a period
        """Convert to dictionary"""
^
src/contract_testing/contract_engine.py:51:1: D400 First line should end with a period
    """
    Contract Testing Engine

    Orchestrates contract tests based on OpenAPI specification.
    Similar to Dredd but implemented in Python.
    """
^
src/contract_testing/contract_engine.py:59:1: D400 First line should end with a period
        """
        Initialize contract test engine

        Args:
            spec_path: Path to OpenAPI specification file
        """
^
src/contract_testing/contract_engine.py:73:80: E501 line too long (82 > 79 characters)
    def register_test_handler(self, endpoint_key: str, handler: Callable) -> None:
                                                                               ^
src/contract_testing/contract_engine.py:74:1: D400 First line should end with a period
        """
        Register a test handler for an endpoint

        Args:
            endpoint_key: Endpoint key (e.g., "GET /api/users")
            handler: Callable that executes the test
        """
^
src/contract_testing/contract_engine.py:92:1: D400 First line should end with a period
        """Register actual API endpoint"""
^
src/contract_testing/contract_engine.py:102:1: D400 First line should end with a period
        """
        Run all contract tests

        Returns:
            Test results summary
        """
^
src/contract_testing/contract_engine.py:113:80: E501 line too long (81 > 79 characters)
            f"📋 Testing {len(self.spec_validator.get_all_endpoints())} endpoints"
                                                                               ^
src/contract_testing/contract_engine.py:135:80: E501 line too long (93 > 79 characters)
                    f"❌ Test failed for {endpoint.method.value.upper()} {endpoint.path}: {e}"
                                                                               ^
src/contract_testing/contract_engine.py:138:80: E501 line too long (97 > 79 characters)
                    test_id=f"{endpoint.method.value.upper()}_{endpoint.path.replace('/', '_')}",
                                                                               ^
src/contract_testing/contract_engine.py:168:1: D400 First line should end with a period
        """Run test for single endpoint"""
^
src/contract_testing/contract_engine.py:169:80: E501 line too long (86 > 79 characters)
        test_id = f"{endpoint.method.value.upper()}_{endpoint.path.replace('/', '_')}"
                                                                               ^
src/contract_testing/contract_engine.py:188:80: E501 line too long (82 > 79 characters)
            self.hooks_manager.execute_hooks(HookType.BEFORE_TRANSACTION, context)
                                                                               ^
src/contract_testing/contract_engine.py:199:80: E501 line too long (81 > 79 characters)
            self.hooks_manager.execute_hooks(HookType.AFTER_TRANSACTION, context)
                                                                               ^
src/contract_testing/contract_engine.py:236:1: D400 First line should end with a period
        """Check API consistency with specification"""
^
src/contract_testing/contract_engine.py:242:1: D400 First line should end with a period
        """Get test results summary"""
^
src/contract_testing/contract_engine.py:261:80: E501 line too long (81 > 79 characters)
            "start_time": self.start_time.isoformat() if self.start_time else "",
                                                                               ^
src/contract_testing/contract_engine.py:266:1: D400 First line should end with a period
        """Return failed test summary"""
^
src/contract_testing/contract_engine.py:278:1: D400 First line should end with a period
        """Export test results to JSON"""
^
src/contract_testing/contract_engine.py:293:1: D400 First line should end with a period
        """Get all test results"""
^
src/contract_testing/report_generator.py:1:1: D400 First line should end with a period
"""
Contract Test Report Generator

Generates comprehensive reports from contract test results.
Supports JSON, HTML, and Markdown formats.
"""
^
src/contract_testing/report_generator.py:25:1: D400 First line should end with a period
        """Initialize report generator"""
^
src/contract_testing/report_generator.py:33:1: D400 First line should end with a period
        """Add test results"""
^
src/contract_testing/report_generator.py:36:80: E501 line too long (86 > 79 characters)
    def add_consistency_check(self, summary: Dict, discrepancies: List[Dict]) -> None:
                                                                               ^
src/contract_testing/report_generator.py:37:1: D400 First line should end with a period
        """Add consistency check results"""
^
src/contract_testing/report_generator.py:42:1: D400 First line should end with a period
        """Set test execution time range"""
^
src/contract_testing/report_generator.py:47:1: D400 First line should end with a period
        """Generate JSON report"""
^
src/contract_testing/report_generator.py:51:80: E501 line too long (85 > 79 characters)
                "start_time": self.start_time.isoformat() if self.start_time else "",
                                                                               ^
src/contract_testing/report_generator.py:65:1: D400 First line should end with a period
        """Generate Markdown report"""
^
src/contract_testing/report_generator.py:75:80: E501 line too long (85 > 79 characters)
            passed = sum(1 for r in self.test_results if r.get("status") == "passed")
                                                                               ^
src/contract_testing/report_generator.py:76:80: E501 line too long (85 > 79 characters)
            failed = sum(1 for r in self.test_results if r.get("status") == "failed")
                                                                               ^
src/contract_testing/report_generator.py:82:80: E501 line too long (85 > 79 characters)
                f"- **Pass Rate**: {(passed/total*100) if total > 0 else 0:.1f}%\n\n"
                                                                               ^
src/contract_testing/report_generator.py:91:80: E501 line too long (90 > 79 characters)
                            f"- `{result['endpoint_method']} {result['endpoint_path']}`\n"
                                                                               ^
src/contract_testing/report_generator.py:94:80: E501 line too long (83 > 79 characters)
                            lines.append(f"  - Error: {result['error_message']}\n")
                                                                               ^
src/contract_testing/report_generator.py:101:80: E501 line too long (108 > 79 characters)
                f"- **Consistency Score**: {self.consistency_summary.get('consistency_score', 0):.1f}/100\n"
                                                                               ^
src/contract_testing/report_generator.py:104:80: E501 line too long (104 > 79 characters)
                f"- **Total Discrepancies**: {self.consistency_summary.get('total_discrepancies', 0)}\n"
                                                                               ^
src/contract_testing/report_generator.py:107:80: E501 line too long (96 > 79 characters)
                f"- **Critical Issues**: {self.consistency_summary.get('critical_issues', 0)}\n"
                                                                               ^
src/contract_testing/report_generator.py:110:80: E501 line too long (84 > 79 characters)
                f"- **Warnings**: {self.consistency_summary.get('warnings', 0)}\n\n"
                                                                               ^
src/contract_testing/report_generator.py:116:80: E501 line too long (80 > 79 characters)
                d for d in self.discrepancies if d.get("severity") == "critical"
                                                                               ^
src/contract_testing/report_generator.py:118:80: E501 line too long (88 > 79 characters)
            warnings = [d for d in self.discrepancies if d.get("severity") == "warning"]
                                                                               ^
src/contract_testing/report_generator.py:124:80: E501 line too long (103 > 79 characters)
                        f"- **{disc['type']}** - `{disc['endpoint_method']} {disc['endpoint_path']}`\n"
                                                                               ^
src/contract_testing/report_generator.py:134:80: E501 line too long (103 > 79 characters)
                        f"- **{disc['type']}** - `{disc['endpoint_method']} {disc['endpoint_path']}`\n"
                                                                               ^
src/contract_testing/report_generator.py:145:1: D400 First line should end with a period
        """Generate HTML report"""
^
src/contract_testing/report_generator.py:147:80: E501 line too long (81 > 79 characters)
        passed = sum(1 for r in self.test_results if r.get("status") == "passed")
                                                                               ^
src/contract_testing/report_generator.py:217:80: E501 line too long (176 > 79 characters)
        html_content = f"""
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Contract Test Report</title>
    <style>
        * {{ font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }}
        body {{ margin: 20px; background: #f5f5f5; }}
        .container {{ max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }}
        h1 {{ color: #333; border-bottom: 3px solid #007bff; padding-bottom: 10px; }}
        h2 {{ color: #555; margin-top: 30px; }}
        .summary {{ display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; margin: 20px 0; }}
        .card {{ background: #f9f9f9; padding: 15px; border-radius: 5px; text-align: center; border-left: 4px solid #007bff; }}
        .card h3 {{ margin: 0; color: #555; }}
        .card .number {{ font-size: 28px; font-weight: bold; color: #007bff; }}
        .passed {{ border-left-color: #28a745; }}
        .passed .number {{ color: #28a745; }}
        .failed {{ border-left-color: #dc3545; }}
        .failed .number {{ color: #dc3545; }}
        .test-result {{ margin: 10px 0; padding: 10px; border-radius: 4px; }}
        .test-passed {{ background: #d4edda; }}
        .test-failed {{ background: #f8d7da; }}
        .consistency-critical {{ color: #dc3545; font-weight: bold; }}
        .consistency-warning {{ color: #ffc107; font-weight: bold; }}
        table {{ width: 100%; border-collapse: collapse; margin: 20px 0; }}
        th, td {{ padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }}
        th {{ background: #f0f0f0; font-weight: bold; }}
        tr:hover {{ background: #f9f9f9; }}
        .footer {{ margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd; color: #999; font-size: 12px; }}
    </style>
</head>
<body>
    <div class="container">
        <h1>📋 Contract Test Report</h1>
        <p><strong>Generated</strong>: {datetime.now().isoformat()}</p>

        <h2>Test Execution Summary</h2>
        <div class="summary">
            <div class="card">
                <h3>Total Tests</h3>
                <div class="number">{total}</div>
            </div>
            <div class="card passed">
                <h3>Passed</h3>
                <div class="number">{passed}</div>
            </div>
            <div class="card failed">
                <h3>Failed</h3>
                <div class="number">{failed}</div>
            </div>
            <div class="card">
                <h3>Pass Rate</h3>
                <div class="number">{(passed/total*100) if total > 0 else 0:.1f}%</div>
            </div>
        </div>

        <h2>API Consistency Score</h2>
        <div class="card">
            <h3>Consistency Score</h3>
            <div class="number">{consistency:.1f}/100</div>
        </div>

        <h2>Critical Issues</h2>
        <p>Critical issues must be resolved before deployment.</p>
        <div class="issues">
            {''.join([f'<div class="test-result consistency-critical">❌ {d["type"]}: {d["description"]}</div>' for d in self.discrepancies if d.get("severity") == "critical"])}
        </div>

        <div class="footer">
            <p>Generated by MyStocks Contract Testing Framework</p>
        </div>
    </div>
</body>
</html>
"""




                     ^
src/contract_testing/report_generator.py:234:1: D400 First line should end with a period
        """Generate all report formats"""
^
src/contract_testing/report_generator.py:238:80: E501 line too long (88 > 79 characters)
        self.generate_json_report(f"{output_dir}/contract_test_report_{timestamp}.json")
                                                                               ^
src/contract_testing/report_generator.py:242:80: E501 line too long (88 > 79 characters)
        self.generate_html_report(f"{output_dir}/contract_test_report_{timestamp}.html")
                                                                               ^
src/contract_testing/spec_validator.py:1:1: D400 First line should end with a period
"""
OpenAPI Specification Validator

Validates OpenAPI/Swagger specifications and extracts test cases.
"""
^
src/contract_testing/spec_validator.py:19:1: D400 First line should end with a period
    """HTTP methods supported by API"""
^
src/contract_testing/spec_validator.py:32:1: D400 First line should end with a period
    """API Parameter definition"""
^
src/contract_testing/spec_validator.py:42:1: D400 First line should end with a period
        """Convert to dictionary"""
^
src/contract_testing/spec_validator.py:55:1: D400 First line should end with a period
    """API Endpoint definition from OpenAPI spec"""
^
src/contract_testing/spec_validator.py:68:1: D400 First line should end with a period
        """Get endpoint signature for comparison"""
^
src/contract_testing/spec_validator.py:72:1: D400 First line should end with a period
        """Convert to dictionary"""
^
src/contract_testing/spec_validator.py:94:1: D400 First line should end with a period
        """
        Initialize validator

        Args:
            spec_path: Path to OpenAPI spec file (JSON or YAML)
        """
^
src/contract_testing/spec_validator.py:112:1: D400 First line should end with a period
        """
        Load OpenAPI specification from file

        Args:
            spec_path: Path to spec file (.json or .yaml)

        Returns:
            Loaded specification dictionary
        """
^
src/contract_testing/spec_validator.py:123:80: E501 line too long (81 > 79 characters)
            raise FileNotFoundError(f"Specification file not found: {spec_path}")
                                                                               ^
src/contract_testing/spec_validator.py:147:1: D400 First line should end with a period
        """
        Validate OpenAPI specification structure

        Returns:
            True if valid
        """
^
src/contract_testing/spec_validator.py:163:13: F402 import 'field' from line 12 shadowed by loop variable
        for field in required_fields:
            ^
src/contract_testing/spec_validator.py:167:80: E501 line too long (86 > 79 characters)
        logger.info(f"✅ Specification structure is valid (OpenAPI {openapi_version})")
                                                                               ^
src/contract_testing/spec_validator.py:171:1: D400 First line should end with a period
        """Extract metadata from specification"""
^
src/contract_testing/spec_validator.py:189:80: E501 line too long (81 > 79 characters)
            f"🔐 Security Schemes: {list(self.security_schemes.keys()) or 'None'}"
                                                                               ^
src/contract_testing/spec_validator.py:193:1: D400 First line should end with a period
        """Parse endpoints from specification"""
^
src/contract_testing/spec_validator.py:203:80: E501 line too long (83 > 79 characters)
                    endpoint = self._parse_endpoint(path, method_name, method_spec)
                                                                               ^
src/contract_testing/spec_validator.py:207:80: E501 line too long (80 > 79 characters)
                        f"⚠️  Failed to parse {method_name.upper()} {path}: {e}"
                                                                               ^
src/contract_testing/spec_validator.py:210:80: E501 line too long (83 > 79 characters)
        logger.info(f"✅ Parsed {len(self.endpoints)} endpoints from specification")
                                                                               ^
src/contract_testing/spec_validator.py:212:80: E501 line too long (81 > 79 characters)
    def _parse_endpoint(self, path: str, method: str, spec: Dict) -> APIEndpoint:
                                                                               ^
src/contract_testing/spec_validator.py:213:1: D400 First line should end with a period
        """
        Parse individual endpoint specification

        Args:
            path: URL path
            method: HTTP method
            spec: Endpoint specification

        Returns:
            APIEndpoint object
        """
^
src/contract_testing/spec_validator.py:261:1: D400 First line should end with a period
        """Get all parsed endpoints"""
^
src/contract_testing/spec_validator.py:265:1: D400 First line should end with a period
        """Get endpoints by tag"""
^
src/contract_testing/spec_validator.py:269:1: D400 First line should end with a period
        """
        Get specific endpoint

        Args:
            method: HTTP method (GET, POST, etc.)
            path: URL path

        Returns:
            APIEndpoint or None
        """
^
src/contract_testing/spec_validator.py:286:1: D400 First line should end with a period
        """Get specification summary"""
^
src/contract_testing/spec_validator.py:298:1: D400 First line should end with a period
        """Count endpoints by tag"""
^
src/contract_testing/spec_validator.py:306:1: D400 First line should end with a period
        """Count endpoints by HTTP method"""
^
src/contract_testing/spec_validator.py:314:1: D400 First line should end with a period
        """Export parsed endpoints to JSON"""
^
src/contract_testing/spec_validator.py:318:80: E501 line too long (83 > 79 characters)
        logger.info(f"✅ Exported {len(endpoints_data)} endpoints to {output_path}")
                                                                               ^
src/contract_testing/test_hooks.py:1:1: D400 First line should end with a period
"""
Test Hooks Manager for Contract Testing

Implements before/after hooks for test setup and cleanup.
Similar to Dredd's hook system.

Task 12.2 Implementation: Test hooks for data preparation and cleanup
"""
^
src/contract_testing/test_hooks.py:21:1: D400 First line should end with a period
    """Hook types supported by contract testing"""
^
src/contract_testing/test_hooks.py:33:1: D400 First line should end with a period
    """Context passed to hook functions"""
^
src/contract_testing/test_hooks.py:45:1: D400 First line should end with a period
        """Convert to dictionary"""
^
src/contract_testing/test_hooks.py:60:1: D400 First line should end with a period
    """Hook definition"""
^
src/contract_testing/test_hooks.py:69:1: D400 First line should end with a period
        """Execute hook"""
^
src/contract_testing/test_hooks.py:74:80: E501 line too long (80 > 79 characters)
            logger.error(f"❌ Hook failed: {self.name} ({self.type.value}): {e}")
                                                                               ^
src/contract_testing/test_hooks.py:87:1: D400 First line should end with a period
        """Initialize hooks manager"""
^
src/contract_testing/test_hooks.py:103:1: D400 First line should end with a period
        """
        Register a hook

        Args:
            hook_type: Type of hook
            handler: Callable to execute
            name: Hook name (auto-generated if not provided)
            description: Hook description
            priority: Execution priority (higher = earlier)
        """
^
src/contract_testing/test_hooks.py:127:80: E501 line too long (80 > 79 characters)
        self.hooks[hook_type.value].sort(key=lambda h: h.priority, reverse=True)
                                                                               ^
src/contract_testing/test_hooks.py:134:1: D400 First line should end with a period
        """Register beforeAll hook"""
^
src/contract_testing/test_hooks.py:142:1: D400 First line should end with a period
        """Register afterAll hook"""
^
src/contract_testing/test_hooks.py:143:80: E501 line too long (88 > 79 characters)
        self.register_hook(HookType.AFTER_ALL, handler, name, description, priority=100)
                                                                               ^
src/contract_testing/test_hooks.py:148:1: D400 First line should end with a period
        """Register beforeEach hook"""
^
src/contract_testing/test_hooks.py:156:1: D400 First line should end with a period
        """Register afterEach hook"""
^
src/contract_testing/test_hooks.py:157:80: E501 line too long (88 > 79 characters)
        self.register_hook(HookType.AFTER_EACH, handler, name, description, priority=50)
                                                                               ^
src/contract_testing/test_hooks.py:162:1: D400 First line should end with a period
        """Register beforeTransaction hook"""
^
src/contract_testing/test_hooks.py:164:80: E501 line too long (80 > 79 characters)
            HookType.BEFORE_TRANSACTION, handler, name, description, priority=10
                                                                               ^
src/contract_testing/test_hooks.py:170:1: D400 First line should end with a period
        """Register afterTransaction hook"""
^
src/contract_testing/test_hooks.py:176:1: D400 First line should end with a period
        """
        Execute all hooks of a given type

        Args:
            hook_type: Type of hooks to execute
            context: Hook context
        """
^
src/contract_testing/test_hooks.py:184:80: E501 line too long (83 > 79 characters)
        logger.debug(f"⚙️  Executing {len(hooks)} hooks of type {hook_type.value}")
                                                                               ^
src/contract_testing/test_hooks.py:191:80: E501 line too long (84 > 79 characters)
                self._log_hook_execution(hook, context, success=False, error=str(e))
                                                                               ^
src/contract_testing/test_hooks.py:201:1: D400 First line should end with a period
        """Log hook execution"""
^
src/contract_testing/test_hooks.py:213:1: D400 First line should end with a period
        """Get hook execution log"""
^
src/contract_testing/test_hooks.py:217:1: D400 First line should end with a period
        """Get all hooks of a given type"""
^
src/contract_testing/test_hooks.py:221:1: D400 First line should end with a period
        """Get all registered hooks"""
^
src/contract_testing/test_hooks.py:225:1: D400 First line should end with a period
        """Clear all registered hooks"""
^
src/contract_testing/test_hooks.py:231:1: D400 First line should end with a period
        """Export execution log to JSON"""
^
src/contract_testing/test_hooks.py:241:1: D400 First line should end with a period
    """Create test user for API testing"""
^
src/contract_testing/test_hooks.py:243:1: S105 Possible hardcoded password: 'test_token_abc'
    context.test_state["test_token"] = "test_token_abc"
^
src/contract_testing/test_hooks.py:248:1: D400 First line should end with a period
    """Clean up test data after test"""
^
src/contract_testing/test_hooks.py:256:1: D400 First line should end with a period
    """Add authentication headers to request"""
^
src/contract_testing/test_hooks.py:266:80: E501 line too long (84 > 79 characters)
        f"✅ Added auth headers to {context.endpoint_method} {context.endpoint_path}"
                                                                               ^
src/contract_testing/test_hooks.py:271:1: D400 First line should end with a period
    """Validate response structure matches specification"""
^
src/contract_testing/test_hooks.py:274:80: E501 line too long (83 > 79 characters)
            f"Empty response for {context.endpoint_method} {context.endpoint_path}"
                                                                               ^
src/core.py:3:1: D205 1 blank line required between summary line and description
"""
MyStocks 量化交易数据管理系统 - 重构版
完全基于原始设计理念实现的配置驱动、自动化管理系统

设计理念：
1. 配置驱动 - 通过YAML配置文件管理所有表结构
2. 自动化管理 - 避免人工手工管理数据库和表
3. 完整监控 - 专门的监控数据库记录所有操作
4. 数据分类 - 基于数据特性的5大分类体系
5. 业务分离 - 监控数据库与业务数据库完全分离

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-09-21
"""
^
src/core.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 重构版
完全基于原始设计理念实现的配置驱动、自动化管理系统

设计理念：
1. 配置驱动 - 通过YAML配置文件管理所有表结构
2. 自动化管理 - 避免人工手工管理数据库和表
3. 完整监控 - 专门的监控数据库记录所有操作
4. 数据分类 - 基于数据特性的5大分类体系
5. 业务分离 - 监控数据库与业务数据库完全分离

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-09-21
"""
^
src/core.py:46:1: D400 First line should end with a period
    """数据分类体系 - 基于原始设计的5大分类"""
^
src/core.py:62:80: E501 line too long (82 > 79 characters)
    TECHNICAL_INDICATORS = "technical_indicators"  # 技术指标 → PostgreSQL+TimescaleDB
                                                                               ^
src/core.py:63:80: E501 line too long (82 > 79 characters)
    QUANTITATIVE_FACTORS = "quantitative_factors"  # 量化因子 → PostgreSQL+TimescaleDB
                                                                               ^
src/core.py:83:1: D400 First line should end with a period
    """目标数据库类型 - 基于数据特性选择 (Week 3简化后)"""
^
src/core.py:90:1: D400 First line should end with a period
    """数据去重策略 - 智能去重决策体系"""
^
src/core.py:100:1: D400 First line should end with a period
        """
        初始化配置驱动的表管理器

        Args:
            config_file: 表配置文件路径
        """
^
src/core.py:114:1: D400 First line should end with a period
        """加载YAML配置文件"""
^
src/core.py:133:1: D400 First line should end with a period
        """创建默认配置文件"""
^
src/core.py:148:1: D400 First line should end with a period
        """生成默认配置结构"""
^
src/core.py:189:80: E501 line too long (80 > 79 characters)
                "data_quality_check": {"enable": True, "schedule": "0 1 * * *"},
                                                                               ^
src/core.py:190:80: E501 line too long (86 > 79 characters)
                "performance_monitoring": {"enable": True, "slow_query_threshold": 5},
                                                                               ^
src/core.py:195:1: D400 First line should end with a period
        """生成默认表配置"""
^
src/core.py:352:80: E501 line too long (80 > 79 characters)
                    {"name": "idx_daily_kline_date", "columns": ["trade_date"]},
                                                                               ^
src/core.py:411:80: E501 line too long (81 > 79 characters)
                    {"name": "idx_tech_ind_name", "columns": ["indicator_name"]},
                                                                               ^
src/core.py:479:80: E501 line too long (83 > 79 characters)
                        "default": "CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP",
                                                                               ^
src/core.py:558:80: E501 line too long (83 > 79 characters)
                    {"name": "idx_trade_calendar_date", "columns": ["trade_date"]},
                                                                               ^
src/core.py:568:1: D400 First line should end with a period
        """
        根据配置文件自动创建所有表

        Returns:
            Dict[str, bool]: 创建结果 {table_key: success}
        """
^
src/core.py:586:80: E501 line too long (123 > 79 characters)
                table_key = f"{table_config['database_type']}.{table_config['database_name']}.{table_config['table_name']}"
                                                                               ^
src/core.py:600:80: E501 line too long (85 > 79 characters)
                    f"创建表时出现异常: {table_config.get('table_name', 'Unknown')}, 错误: {e}"
                                                                               ^
src/core.py:608:1: D400 First line should end with a period
        """
        根据配置创建单个表

        Args:
            table_config: 表配置字典

        Returns:
            bool: 创建是否成功
        """
^
src/core.py:628:30: F541 f-string is missing placeholders
                logger.error(f"MySQL数据已迁移至PostgreSQL，Redis已由应用层缓存替代")
                             ^
src/core.py:645:80: E501 line too long (85 > 79 characters)
                kwargs["time_column"] = table_config.get("time_column", "created_at")
                                                                               ^
src/core.py:668:1: D400 First line should end with a period
        """
        转换列配置格式

        Args:
            column_configs: 配置文件中的列定义

        Returns:
            List[Dict]: 转换后的列定义
        """
^
src/core.py:708:1: D400 First line should end with a period
        """
        创建表索引

        Args:
            table_config: 表配置
            db_type: 数据库类型
        """
^
src/core.py:724:1: D400 First line should end with a period
        """
        验证所有表结构

        Returns:
            Dict[str, Any]: 验证结果
        """
^
src/core.py:745:80: E501 line too long (123 > 79 characters)
                table_key = f"{table_config['database_type']}.{table_config['database_name']}.{table_config['table_name']}"
                                                                               ^
src/core.py:766:80: E501 line too long (87 > 79 characters)
                    f"验证表结构时出现异常: {table_config.get('table_name', 'Unknown')}, 错误: {e}"
                                                                               ^
src/core.py:770:80: E501 line too long (100 > 79 characters)
            f"表结构验证完成: {validation_results['valid_tables']}/{validation_results['total_tables']} 有效"
                                                                               ^
src/core.py:775:1: D400 First line should end with a period
        """
        验证单个表结构

        Args:
            table_config: 表配置

        Returns:
            bool: 是否有效
        """
^
src/core.py:817:1: D400 First line should end with a period
        """
        根据数据分类获取表配置

        Args:
            classification: 数据分类

        Returns:
            Optional[Dict]: 表配置，如果未找到返回None
        """
^
src/core.py:836:1: D400 First line should end with a period
        """清理资源"""
^
src/core/__init__.py:1:1: D104 Missing docstring in public package
from .data_classification import (
^
src/core/batch_failure_strategy.py:1:1: D400 First line should end with a period
"""
批量操作失败策略

定义批量数据操作失败时的三种处理策略:
1. ROLLBACK - 回滚整个批次
2. CONTINUE - 跳过失败记录,继续处理
3. RETRY - 自动重试失败记录

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/core/batch_failure_strategy.py:21:1: D400 First line should end with a period
    """
    批量操作失败策略枚举

    - ROLLBACK: 任何记录失败则回滚整个批次 (ACID语义)
    - CONTINUE: 跳过失败记录,继续处理剩余记录 (最大努力语义)
    - RETRY: 自动重试失败记录,使用指数退避 (最终一致性语义)
    """
^
src/core/batch_failure_strategy.py:41:1: D400 First line should end with a period
    """
    批量操作结果

    记录批量操作的详细结果,包括成功/失败统计和错误详情
    """
^
src/core/batch_failure_strategy.py:74:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/core/batch_failure_strategy.py:82:1: D400 First line should end with a period
        """成功率 (0.0-1.0)"""
^
src/core/batch_failure_strategy.py:88:1: D400 First line should end with a period
        """转换为字典"""
^
src/core/batch_failure_strategy.py:104:80: E501 line too long (85 > 79 characters)
                list(self.error_messages.values())[:3] if self.error_messages else []
                                                                               ^
src/core/batch_failure_strategy.py:110:1: D400 First line should end with a period
    """
    批量失败处理器

    提供三种失败策略的具体实现逻辑
    """
^
src/core/batch_failure_strategy.py:123:1: D400 First line should end with a period
        """
        初始化失败处理器

        Args:
            strategy: 失败策略
            max_retries: 最大重试次数 (仅RETRY策略)
            retry_delay_base: 重试基础延迟(秒)
            retry_delay_multiplier: 重试延迟倍数 (指数退避)
        """
^
src/core/batch_failure_strategy.py:143:1: D400 First line should end with a period
        """
        执行批量操作 (根据策略处理失败)

        Args:
            data: 数据DataFrame
            operation: 操作函数 (接收DataFrame,返回bool表示成功/失败)
            operation_name: 操作名称 (用于日志)

        Returns:
            批量操作结果

        Example:
            handler = BatchFailureHandler(BatchFailureStrategy.RETRY)
            result = handler.execute_batch(
                df,
                lambda batch: mysql_access.insert_dataframe('table', batch),
                'insert_stock_data'
            )
            print(f"成功率: {result.success_rate:.2%}")
        """
^
src/core/batch_failure_strategy.py:156:1: RST301 Unexpected indentation.
        """
        执行批量操作 (根据策略处理失败)

        Args:
            data: 数据DataFrame
            operation: 操作函数 (接收DataFrame,返回bool表示成功/失败)
            operation_name: 操作名称 (用于日志)

        Returns:
            批量操作结果

        Example:
            handler = BatchFailureHandler(BatchFailureStrategy.RETRY)
            result = handler.execute_batch(
                df,
                lambda batch: mysql_access.insert_dataframe('table', batch),
                'insert_stock_data'
            )
            print(f"成功率: {result.success_rate:.2%}")
        """
^
src/core/batch_failure_strategy.py:159:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行批量操作 (根据策略处理失败)

        Args:
            data: 数据DataFrame
            operation: 操作函数 (接收DataFrame,返回bool表示成功/失败)
            operation_name: 操作名称 (用于日志)

        Returns:
            批量操作结果

        Example:
            handler = BatchFailureHandler(BatchFailureStrategy.RETRY)
            result = handler.execute_batch(
                df,
                lambda batch: mysql_access.insert_dataframe('table', batch),
                'insert_stock_data'
            )
            print(f"成功率: {result.success_rate:.2%}")
        """
^
src/core/batch_failure_strategy.py:164:9: F841 local variable 'total_records' is assigned to but never used
        total_records = len(data)
        ^
src/core/batch_failure_strategy.py:168:80: E501 line too long (81 > 79 characters)
            result = self._execute_with_rollback(data, operation, operation_name)
                                                                               ^
src/core/batch_failure_strategy.py:170:80: E501 line too long (81 > 79 characters)
            result = self._execute_with_continue(data, operation, operation_name)
                                                                               ^
src/core/batch_failure_strategy.py:187:1: D400 First line should end with a period
        """
        ROLLBACK策略: 任何失败都回滚整个批次

        实现原理:
        1. 尝试执行整批操作
        2. 如果失败,回滚所有已完成的操作
        3. 返回失败结果
        """
^
src/core/batch_failure_strategy.py:211:23: F541 f-string is missing placeholders
                print(f"❌ 批量操作失败,准备回滚")
                      ^
src/core/batch_failure_strategy.py:240:1: D400 First line should end with a period
        """
        CONTINUE策略: 逐条处理,跳过失败记录

        实现原理:
        1. 逐条执行操作
        2. 失败记录跳过,记录错误
        3. 继续处理剩余记录
        """
^
src/core/batch_failure_strategy.py:290:1: D400 First line should end with a period
        """
        RETRY策略: 失败记录自动重试 (指数退避)

        实现原理:
        1. 首次批量执行
        2. 收集失败记录
        3. 使用指数退避重试失败记录
        4. 重复直到成功或达到最大重试次数
        """
^
src/core/batch_failure_strategy.py:334:80: E501 line too long (84 > 79 characters)
                        all_error_messages[idx] = f"Failed at attempt {attempt + 1}"
                                                                               ^
src/core/batch_failure_strategy.py:376:1: D103 Missing docstring in public function
    def mock_operation(df: pd.DataFrame) -> bool:
^
src/core/batch_failure_strategy.py:379:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        return random.random() > 0.3
^
src/core/batch_failure_strategy.py:398:15: F541 f-string is missing placeholders
        print(f"\n结果统计:")
              ^
src/core/config.py:1:1: D205 1 blank line required between summary line and description
"""
数据库配置模块
提供数据库连接配置和环境变量管理
"""
^
src/core/config.py:1:1: D400 First line should end with a period
"""
数据库配置模块
提供数据库连接配置和环境变量管理
"""
^
src/core/config.py:7:1: F401 'typing.Optional' imported but unused
from typing import Optional
^
src/core/config.py:11:1: D400 First line should end with a period
    """数据库配置"""
^
src/core/config.py:13:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/core/config.py:17:80: E501 line too long (82 > 79 characters)
        self.postgresql_username = os.getenv('DB_POSTGRESQL_USERNAME', 'postgres')
                                                                               ^
src/core/config.py:18:80: E501 line too long (82 > 79 characters)
        self.postgresql_password = os.getenv('DB_POSTGRESQL_PASSWORD', 'postgres')
                                                                               ^
src/core/config.py:19:80: E501 line too long (82 > 79 characters)
        self.postgresql_database = os.getenv('DB_POSTGRESQL_DATABASE', 'mystocks')
                                                                               ^
src/core/config.py:29:1: D400 First line should end with a period
        """获取PostgreSQL连接字符串"""
^
src/core/config.py:40:1: D400 First line should end with a period
        """获取TDengine连接字符串"""
^
src/core/config.py:50:1: D400 First line should end with a period
        """验证配置是否有效"""
^
src/core/config.py:83:1: D400 First line should end with a period
    """获取全局数据库配置"""
^
src/core/config.py:87:22: W292 no newline at end of file
    return _db_config                     ^
src/core/config_driven_table_manager.py:1:1: D400 First line should end with a period
"""
配置驱动的表管理器

根据table_config.yaml自动创建和管理数据库表结构,支持安全模式和版本管理。

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/core/config_driven_table_manager.py:22:1: D400 First line should end with a period
    """配置驱动的表管理器"""
^
src/core/config_driven_table_manager.py:25:80: E501 line too long (83 > 79 characters)
        self, config_path: str = "config/table_config.yaml", safe_mode: bool = True
                                                                               ^
src/core/config_driven_table_manager.py:27:1: D400 First line should end with a period
        """
        初始化表管理器

        Args:
            config_path: 配置文件路径
            safe_mode: 是否启用安全模式(默认True)
        """
^
src/core/config_driven_table_manager.py:45:80: E501 line too long (82 > 79 characters)
            f"✅ ConfigDrivenTableManager initialized (safe_mode={self.safe_mode})"
                                                                               ^
src/core/config_driven_table_manager.py:49:1: D400 First line should end with a period
        """加载配置文件"""
^
src/core/config_driven_table_manager.py:60:1: D400 First line should end with a period
        """根据配置初始化所有表"""
^
src/core/config_driven_table_manager.py:76:80: E501 line too long (90 > 79 characters)
                        f"✅ 创建表: {table_def['table_name']} ({table_def['database_type']})"
                                                                               ^
src/core/config_driven_table_manager.py:89:80: E501 line too long (81 > 79 characters)
            f"skipped={result['tables_skipped']}, errors={len(result['errors'])}"
                                                                               ^
src/core/config_driven_table_manager.py:95:1: D400 First line should end with a period
        """
        创建单个表

        Args:
            table_def: 表定义字典

        Returns:
            True表示创建成功,False表示表已存在
        """
^
src/core/config_driven_table_manager.py:108:80: E501 line too long (83 > 79 characters)
        if self._table_exists(db_type, table_name, table_def.get("database_name")):
                                                                               ^
src/core/config_driven_table_manager.py:126:80: E501 line too long (80 > 79 characters)
        self, db_type: str, table_name: str, database_name: Optional[str] = None
                                                                               ^
src/core/config_driven_table_manager.py:128:1: D400 First line should end with a period
        """检查表是否存在"""
^
src/core/config_driven_table_manager.py:172:80: E501 line too long (87 > 79 characters)
                        database_name or self.config["databases"]["mysql"]["database"],
                                                                               ^
src/core/config_driven_table_manager.py:189:1: D400 First line should end with a period
        """创建TDengine Super Table"""
^
src/core/config_driven_table_manager.py:244:80: E501 line too long (81 > 79 characters)
                    raise ValueError(f"Invalid retention days: {retention_days}")
                                                                               ^
src/core/config_driven_table_manager.py:256:1: D400 First line should end with a period
        """创建PostgreSQL表 (支持TimescaleDB)"""
^
src/core/config_driven_table_manager.py:280:80: E501 line too long (84 > 79 characters)
                default = f" DEFAULT {col['default']}" if col.get("default") else ""
                                                                               ^
src/core/config_driven_table_manager.py:289:80: E501 line too long (87 > 79 characters)
                col_defs.append(f"{col['name']} {col_type}{nullable}{default}{unique}")
                                                                               ^
src/core/config_driven_table_manager.py:311:80: E501 line too long (84 > 79 characters)
                        f"SELECT create_hypertable('{table_name}', '{time_column}')"
                                                                               ^
src/core/config_driven_table_manager.py:319:80: E501 line too long (83 > 79 characters)
                idx_name = idx.get("name", f"idx_{table_name}_{idx['columns'][0]}")
                                                                               ^
src/core/config_driven_table_manager.py:324:80: E501 line too long (120 > 79 characters)
                    idx_sql = f"CREATE UNIQUE INDEX IF NOT EXISTS {idx_name} ON {table_name} ({', '.join(idx_columns)})"
                                                                               ^
src/core/config_driven_table_manager.py:326:80: E501 line too long (113 > 79 characters)
                    idx_sql = f"CREATE INDEX IF NOT EXISTS {idx_name} ON {table_name} ({', '.join(idx_columns)})"
                                                                               ^
src/core/config_driven_table_manager.py:346:1: D400 First line should end with a period
        """创建MySQL表"""
^
src/core/config_driven_table_manager.py:377:80: E501 line too long (81 > 79 characters)
                auto_inc = " AUTO_INCREMENT" if col.get("auto_increment") else ""
                                                                               ^
src/core/config_driven_table_manager.py:401:80: E501 line too long (83 > 79 characters)
                idx_name = idx.get("name", f"idx_{table_name}_{idx['columns'][0]}")
                                                                               ^
src/core/config_driven_table_manager.py:406:80: E501 line too long (106 > 79 characters)
                    idx_sql = f"CREATE UNIQUE INDEX {idx_name} ON {table_name} ({', '.join(idx_columns)})"
                                                                               ^
src/core/config_driven_table_manager.py:408:80: E501 line too long (99 > 79 characters)
                    idx_sql = f"CREATE INDEX {idx_name} ON {table_name} ({', '.join(idx_columns)})"
                                                                               ^
src/core/config_driven_table_manager.py:428:1: D400 First line should end with a period
        """验证表结构是否符合配置"""
^
src/core/config_driven_table_manager.py:447:80: E501 line too long (81 > 79 characters)
            expected_columns = {col["name"]: col for col in table_def["columns"]}
                                                                               ^
src/core/config_driven_table_manager.py:451:80: E501 line too long (87 > 79 characters)
            missing_columns = set(expected_columns.keys()) - set(actual_columns.keys())
                                                                               ^
src/core/config_driven_table_manager.py:453:80: E501 line too long (83 > 79 characters)
                logger.warning(f"表 {table_name} 缺少列: {', '.join(missing_columns)}")
                                                                               ^
src/core/config_driven_table_manager.py:457:80: E501 line too long (85 > 79 characters)
            extra_columns = set(actual_columns.keys()) - set(expected_columns.keys())
                                                                               ^
src/core/config_driven_table_manager.py:488:1: D400 First line should end with a period
        """获取表结构信息"""
^
src/core/config_driven_table_manager.py:537:1: D400 First line should end with a period
    """主函数 - 用于测试"""
^
src/core/config_loader.py:1:1: D400 First line should end with a period
"""
YAML配置加载器

使用PyYAML解析配置文件,Pydantic V2进行类型验证。
支持环境变量替换。

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/core/config_loader.py:17:1: D400 First line should end with a period
    """YAML配置加载器"""
^
src/core/config_loader.py:21:1: D400 First line should end with a period
        """
        加载YAML配置文件

        Args:
            config_path: 配置文件路径

        Returns:
            解析后的配置字典

        Raises:
            FileNotFoundError: 配置文件不存在
            yaml.YAMLError: YAML格式错误
        """
^
src/core/connection_pool_config.py:1:1: D205 1 blank line required between summary line and description
"""
连接池配置模块
定义数据库连接池的配置参数
"""
^
src/core/connection_pool_config.py:1:1: D400 First line should end with a period
"""
连接池配置模块
定义数据库连接池的配置参数
"""
^
src/core/connection_pool_config.py:7:1: F401 'typing.Optional' imported but unused
from typing import Optional
^
src/core/connection_pool_config.py:11:1: D400 First line should end with a period
    """连接池配置"""
^
src/core/connection_pool_config.py:13:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/core/connection_pool_config.py:16:80: E501 line too long (80 > 79 characters)
        self.pool_max_connections = int(os.getenv('POOL_MAX_CONNECTIONS', '20'))
                                                                               ^
src/core/connection_pool_config.py:20:80: E501 line too long (117 > 79 characters)
        self.pool_max_inactive_connection_lifetime = float(os.getenv('POOL_MAX_INACTIVE_CONNECTION_LIFETIME', '300'))
                                                                               ^
src/core/connection_pool_config.py:23:80: E501 line too long (82 > 79 characters)
        self.health_check_interval = int(os.getenv('HEALTH_CHECK_INTERVAL', '60'))
                                                                               ^
src/core/connection_pool_config.py:27:80: E501 line too long (99 > 79 characters)
        self.enable_pool_monitoring = os.getenv('ENABLE_POOL_MONITORING', 'true').lower() == 'true'
                                                                               ^
src/core/connection_pool_config.py:33:1: D400 First line should end with a period
        """从环境变量加载配置"""
^
src/core/connection_pool_config.py:37:1: D400 First line should end with a period
        """
        验证配置是否有效

        Returns:
            bool: 配置是否有效
        """
^
src/core/connection_pool_config.py:47:80: E501 line too long (104 > 79 characters)
            raise ValueError("Maximum connections must be greater than or equal to minimum connections")
                                                                               ^
src/core/connection_pool_config.py:64:1: D400 First line should end with a period
        """
        获取连接池配置字典

        Returns:
            dict: 连接池配置
        """
^
src/core/connection_pool_config.py:76:80: E501 line too long (90 > 79 characters)
            'max_inactive_connection_lifetime': self.pool_max_inactive_connection_lifetime
                                                                               ^
src/core/connection_pool_config.py:85:1: D400 First line should end with a period
    """
    获取全局连接池配置

    Returns:
        ConnectionPoolConfig: 连接池配置
    """
^
src/core/connection_pool_config.py:98:1: D400 First line should end with a period
    """
    根据系统资源获取最优连接池大小

    Returns:
        tuple: (min_connections, max_connections)
    """
^
src/core/connection_pool_config.py:119:1: D400 First line should end with a period
    """
    获取生产环境连接池配置

    Returns:
        ConnectionPoolConfig: 生产环境配置
    """
^
src/core/connection_pool_config.py:147:1: D400 First line should end with a period
    """获取开发环境配置"""
^
src/core/connection_pool_config.py:160:1: D400 First line should end with a period
    """获取测试环境配置"""
^
src/core/connection_pool_config.py:173:1: D400 First line should end with a period
    """
    根据当前环境获取配置

    Returns:
        ConnectionPoolConfig: 环境特定的配置
    """
^
src/core/connection_pool_config.py:186:45: W292 no newline at end of file
        return get_development_pool_config()                                            ^
src/core/data_classification.py:1:1: D400 First line should end with a period
"""
数据分类枚举模块

定义MyStocks系统的5层数据分类体系(23个子项)和数据库类型枚举。
这是整个系统架构的基础,所有数据路由决策都基于这些枚举。

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/core/data_classification.py:16:1: D400 First line should end with a period
    """
    数据分类枚举 - 23个子项完整定义

    基于宪法第I节: 5层数据分类体系 (不可协商)
    所有数据必须归属以下23个分类之一
    """
^
src/core/data_classification.py:142:1: D400 First line should end with a period
        """返回所有23个数据分类的列表"""
^
src/core/data_classification.py:147:1: D400 First line should end with a period
        """返回市场数据分类 (6项)"""
^
src/core/data_classification.py:159:1: D400 First line should end with a period
        """返回参考数据分类 (9项)"""
^
src/core/data_classification.py:174:1: D400 First line should end with a period
        """返回衍生数据分类 (6项)"""
^
src/core/data_classification.py:186:1: D400 First line should end with a period
        """返回交易数据分类 (7项)"""
^
src/core/data_classification.py:199:1: D400 First line should end with a period
        """返回元数据分类 (6项)"""
^
src/core/data_classification.py:211:1: D400 First line should end with a period
    """
    数据库类型枚举

    定义系统支持的2种数据库类型,每种数据库针对特定数据特性优化
    """
^
src/core/data_classification.py:225:1: D400 First line should end with a period
        """返回所有数据库类型列表"""
^
src/core/data_classification.py:230:1: D400 First line should end with a period
    """
    数据去重策略枚举

    定义4种智能去重策略，用于处理重复数据的不同场景
    """
^
src/core/data_classification.py:250:1: D400 First line should end with a period
        """返回所有去重策略列表"""
^
src/core/data_manager.py:1:1: D400 First line should end with a period
"""
DataManager - 简化的数据管理核心类 (US3 Architecture Simplification)

这个类整合了原来的多层架构:
- 合并了DataStorageStrategy的路由逻辑
- 提供适配器注册和管理
- 统一的数据保存/加载接口
- 直接管理数据库连接

目标:
- <5ms 路由决策时间
- 简化的API接口
- 更好的可维护性

创建日期: 2025-10-25
版本: 1.0.0 (US3)
"""
^
src/core/data_manager.py:32:1: D205 1 blank line required between summary line and description
    """
    Null监控实现 - 用于禁用监控时的占位
    实现监控接口但不执行任何操作
    """
^
src/core/data_manager.py:32:1: D400 First line should end with a period
    """
    Null监控实现 - 用于禁用监控时的占位
    实现监控接口但不执行任何操作
    """
^
src/core/data_manager.py:38:1: D400 First line should end with a period
        """记录操作开始 - 无操作"""
^
src/core/data_manager.py:42:1: D400 First line should end with a period
        """记录操作结果 - 无操作"""
^
src/core/data_manager.py:46:1: D400 First line should end with a period
        """记录操作 - 无操作"""
^
src/core/data_manager.py:50:1: D400 First line should end with a period
        """记录性能指标 - 无操作"""
^
src/core/data_manager.py:54:1: D400 First line should end with a period
        """记录操作性能 - 无操作"""
^
src/core/data_manager.py:58:1: D400 First line should end with a period
        """记录质量检查 - 无操作"""
^
src/core/data_manager.py:63:1: D400 First line should end with a period
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:66:1: RST214 Inline literal start-string without end-string.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:66:1: RST215 Inline interpreted text or phrase reference start-string without end-string.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:72:1: RST301 Unexpected indentation.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:75:1: RST201 Block quote ends without a blank line; unexpected unindent.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:79:1: RST301 Unexpected indentation.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:82:1: RST201 Block quote ends without a blank line; unexpected unindent.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:83:1: RST401 Unexpected section title.
    """
    DataManager - 简化的数据管理核心类

    示例:
        ```python
        dm = DataManager()
        dm.register_adapter('akshare', akshare_adapter)

        # 保存数据 - 自动路由到正确的数据库
        dm.save_data(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载数据
        data = dm.load_data(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            symbol='600000.SH'
        )
        ```
    """
^
src/core/data_manager.py:131:1: D400 First line should end with a period
        """
        初始化DataManager

        Args:
            enable_monitoring: 是否启用监控 (默认False以简化架构)
        """
^
src/core/data_manager.py:145:80: E501 line too long (86 > 79 characters)
                from src.monitoring.monitoring_database import get_monitoring_database
                                                                               ^
src/core/data_manager.py:146:80: E501 line too long (86 > 79 characters)
                from src.monitoring.performance_monitor import get_performance_monitor
                                                                               ^
src/core/data_manager.py:158:80: E501 line too long (80 > 79 characters)
            self._performance_monitor = null_monitor  # type: ignore[assignment]
                                                                               ^
src/core/data_manager.py:171:80: E501 line too long (93 > 79 characters)
            "DataManager initialized with dual-database architecture (TDengine + PostgreSQL)"
                                                                               ^
src/core/data_manager.py:175:1: D400 First line should end with a period
        """
        注册数据适配器

        Args:
            name: 适配器名称 (如 'akshare', 'baostock', 'tdx')
            adapter: 适配器实例 (需实现IDataSource接口)
        """
^
src/core/data_manager.py:189:1: D400 First line should end with a period
        """
        注销数据适配器

        Args:
            name: 适配器名称

        Returns:
            True if successful, False if adapter not found
        """
^
src/core/data_manager.py:207:1: D400 First line should end with a period
        """
        列出所有已注册的适配器

        Returns:
            适配器名称列表
        """
^
src/core/data_manager.py:216:1: D400 First line should end with a period
        """
        获取指定的适配器实例

        Args:
            name: 适配器名称

        Returns:
            适配器实例，如果不存在则返回None
        """
^
src/core/data_manager.py:227:80: E501 line too long (88 > 79 characters)
    def get_target_database(self, classification: DataClassification) -> DatabaseTarget:
                                                                               ^
src/core/data_manager.py:228:1: D400 First line should end with a period
        """
        获取数据分类的目标数据库 (优化版 - <5ms)

        Args:
            classification: 数据分类

        Returns:
            目标数据库类型

        性能优化:
        - 使用预计算的字典映射
        - O(1) 时间复杂度
        - 预期<1ms响应时间
        """
^
src/core/data_manager.py:251:1: D400 First line should end with a period
        """
        保存数据到正确的数据库

        Args:
            classification: 数据分类
            data: 要保存的数据 (pandas DataFrame)
            table_name: 目标表名
            **kwargs: 其他参数传递给底层数据库访问层

        Returns:
            True if successful, False otherwise
        """
^
src/core/data_manager.py:254:1: RST210 Inline strong start-string without end-string.
        """
        保存数据到正确的数据库

        Args:
            classification: 数据分类
            data: 要保存的数据 (pandas DataFrame)
            table_name: 目标表名
            **kwargs: 其他参数传递给底层数据库访问层

        Returns:
            True if successful, False otherwise
        """
^
src/core/data_manager.py:310:1: D400 First line should end with a period
        """
        从正确的数据库加载数据

        Args:
            classification: 数据分类
            table_name: 源表名
            **filters: 过滤条件 (如 symbol='600000.SH', start_date='2024-01-01')

        Returns:
            pandas DataFrame if successful, None otherwise
        """
^
src/core/data_manager.py:313:1: RST210 Inline strong start-string without end-string.
        """
        从正确的数据库加载数据

        Args:
            classification: 数据分类
            table_name: 源表名
            **filters: 过滤条件 (如 symbol='600000.SH', start_date='2024-01-01')

        Returns:
            pandas DataFrame if successful, None otherwise
        """
^
src/core/data_manager.py:362:1: D400 First line should end with a period
        """
        获取路由统计信息

        Returns:
            包含路由统计的字典
        """
^
src/core/data_manager.py:371:80: E501 line too long (87 > 79 characters)
                1 for db in self._ROUTING_MAP.values() if db == DatabaseTarget.TDENGINE
                                                                               ^
src/core/data_manager.py:386:1: D400 First line should end with a period
        """
        验证数据有效性

        Args:
            classification: 数据分类
            data: 要验证的数据

        Returns:
            (is_valid, error_messages)
        """
^
src/core/data_manager.py:409:1: D400 First line should end with a period
        """
        检查DataManager和数据库连接健康状态

        Returns:
            健康状态字典
        """
^
src/core/database.py:1:1: D205 1 blank line required between summary line and description
"""
数据库访问模块
提供统一的数据库访问接口
"""
^
src/core/database.py:1:1: D400 First line should end with a period
"""
数据库访问模块
提供统一的数据库访问接口
"""
^
src/core/database.py:6:1: F401 'asyncio' imported but unused
import asyncio
^
src/core/database.py:8:1: F401 'typing.Optional' imported but unused
from typing import Optional, List, Dict, Any, Union
^
src/core/database.py:8:1: F401 'typing.Union' imported but unused
from typing import Optional, List, Dict, Any, Union
^
src/core/database.py:9:1: F401 '.database_pool.get_connection_pool' imported but unused
from .database_pool import get_connection_pool, DatabaseConnectionManager
^
src/core/database.py:10:1: F401 '.exceptions.DatabaseConnectionError' imported but unused
from .exceptions import DatabaseConnectionError, DatabaseOperationError, DataValidationError
^
src/core/database.py:10:1: F401 '.exceptions.DatabaseOperationError' imported but unused
from .exceptions import DatabaseConnectionError, DatabaseOperationError, DataValidationError
^
src/core/database.py:10:80: E501 line too long (92 > 79 characters)
from .exceptions import DatabaseConnectionError, DatabaseOperationError, DataValidationError
                                                                               ^
src/core/database.py:11:1: F401 '.config.DatabaseConfig' imported but unused
from .config import DatabaseConfig
^
src/core/database.py:21:1: D400 First line should end with a period
    """获取数据库管理器"""
^
src/core/database.py:30:1: D400 First line should end with a period
    """
    获取PostgreSQL数据库会话

    Returns:
        DatabaseConnectionManager: 数据库连接管理器
    """
^
src/core/database.py:41:1: D400 First line should end with a period
    """数据库操作辅助类"""
^
src/core/database.py:44:1: D400 First line should end with a period
        """
        初始化数据库助手

        Args:
            db_manager: 数据库管理器
        """
^
src/core/database.py:53:1: D400 First line should end with a period
        """
        验证分页参数

        Args:
            page: 页码
            page_size: 页大小

        Returns:
            tuple: (offset, limit)

        Raises:
            DataValidationError: 参数验证失败
        """
^
src/core/database.py:84:1: D400 First line should end with a period
        """
        构建WHERE子句

        Args:
            conditions: 条件字典

        Returns:
            tuple: (where_clause, params)
        """
^
src/core/database.py:123:1: D400 First line should end with a period
        """
        构建ORDER BY子句

        Args:
            order_by: 排序字段

        Returns:
            str: ORDER BY子句
        """
^
src/core/database.py:147:1: D400 First line should end with a period
    """数据库查询构建器"""
^
src/core/database.py:150:1: D400 First line should end with a period
        """
        初始化查询构建器

        Args:
            table_name: 表名
        """
^
src/core/database.py:164:1: D400 First line should end with a period
        """
        选择字段

        Args:
            *fields: 字段名

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:167:1: RST213 Inline emphasis start-string without end-string.
        """
        选择字段

        Args:
            *fields: 字段名

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:180:1: D400 First line should end with a period
        """
        添加WHERE条件

        Args:
            **conditions: 条件

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:183:1: RST210 Inline strong start-string without end-string.
        """
        添加WHERE条件

        Args:
            **conditions: 条件

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:193:1: D400 First line should end with a period
        """
        添加排序

        Args:
            **order_by: 排序条件

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:196:1: RST210 Inline strong start-string without end-string.
        """
        添加排序

        Args:
            **order_by: 排序条件

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:206:1: D400 First line should end with a period
        """
        添加分页

        Args:
            page: 页码
            page_size: 页大小

        Returns:
            DatabaseQueryBuilder: 查询构建器
        """
^
src/core/database.py:216:80: E501 line too long (81 > 79 characters)
        offset, limit = DatabaseHelper(None).validate_pagination(page, page_size)
                                                                               ^
src/core/database.py:222:1: D400 First line should end with a period
        """
        构建SELECT查询

        Returns:
            tuple: (query, params)
        """
^
src/core/database.py:249:1: S608 Possible SQL injection vector through string-based query construction.
        query = f"SELECT {select_clause} FROM {from_clause}"
^
src/core/database.py:257:80: E501 line too long (91 > 79 characters)
    async def execute(self, db_manager: DatabaseConnectionManager) -> List[Dict[str, Any]]:
                                                                               ^
src/core/database.py:258:1: D400 First line should end with a period
        """
        执行查询

        Args:
            db_manager: 数据库管理器

        Returns:
            List[Dict[str, Any]]: 查询结果
        """
^
src/core/database.py:274:1: D400 First line should end with a period
    """
    数据库连接装饰器

    Args:
        func: 被装饰的函数

    Returns:
        function: 装饰后的函数
    """
^
src/core/database.py:291:1: D400 First line should end with a period
    """批量操作"""
^
src/core/database.py:294:1: D400 First line should end with a period
        """
        初始化批量操作

        Args:
            db_manager: 数据库管理器
        """
^
src/core/database.py:304:1: D400 First line should end with a period
        """
        添加批量插入操作

        Args:
            table: 表名
            data: 数据列表
        """
^
src/core/database.py:317:1: S608 Possible SQL injection vector through string-based query construction.
        query = f"""
            INSERT INTO {table} ({', '.join(columns)})
            VALUES ({', '.join(placeholders)})
        """
^
src/core/database.py:326:80: E501 line too long (84 > 79 characters)
    def update(self, table: str, data: List[Dict[str, Any]], where_key: str = 'id'):
                                                                               ^
src/core/database.py:327:1: D400 First line should end with a period
        """
        添加批量更新操作

        Args:
            table: 表名
            data: 数据列表
            where_key: 更新条件字段
        """
^
src/core/database.py:339:80: E501 line too long (85 > 79 characters)
        set_placeholders = [f"{col} = ${i + 2}" for i, col in enumerate(set_columns)]
                                                                               ^
src/core/database.py:341:1: S608 Possible SQL injection vector through string-based query construction.
        query = f"""
            UPDATE {table}
            SET {', '.join(set_placeholders)}
            WHERE {where_key} = $1
        """
^
src/core/database.py:352:1: D400 First line should end with a period
        """
        执行批量操作

        Returns:
            Dict[str, int]: 操作结果统计
        """
^
src/core/database.py:383:1: D400 First line should end with a period
    """数据库事务"""
^
src/core/database.py:386:1: D400 First line should end with a period
        """
        初始化事务

        Args:
            db_manager: 数据库管理器
        """
^
src/core/database.py:396:1: D400 First line should end with a period
        """进入事务"""
^
src/core/database.py:402:1: D400 First line should end with a period
        """退出事务"""
^
src/core/database.py:412:1: D400 First line should end with a period
        """在事务中执行查询"""
^
src/core/database.py:419:1: D400 First line should end with a period
        """在事务中执行命令"""
^
src/core/database.py:423:58: W292 no newline at end of file
            return await self.connection.execute(command)                                                         ^
src/core/database_pool.py:1:1: D205 1 blank line required between summary line and description
"""
数据库连接池管理模块
实现高效的数据库连接管理，提高系统性能
"""
^
src/core/database_pool.py:1:1: D400 First line should end with a period
"""
数据库连接池管理模块
实现高效的数据库连接管理，提高系统性能
"""
^
src/core/database_pool.py:7:1: F401 'logging' imported but unused
import logging
^
src/core/database_pool.py:10:1: F401 'typing.Optional' imported but unused
from typing import Optional, Dict, Any
^
src/core/database_pool.py:18:5: F401 '.memory_manager.get_memory_monitor' imported but unused
    from .memory_manager import get_memory_monitor, get_memory_stats
    ^
src/core/database_pool.py:27:1: D400 First line should end with a period
    """PostgreSQL连接池管理器"""
^
src/core/database_pool.py:30:1: D400 First line should end with a period
        """
        初始化连接池

        Args:
            config: 数据库配置
        """
^
src/core/database_pool.py:51:80: E501 line too long (84 > 79 characters)
    async def initialize(self, min_connections: int = 5, max_connections: int = 20):
                                                                               ^
src/core/database_pool.py:52:1: D400 First line should end with a period
        """
        初始化连接池

        Args:
            min_connections: 最小连接数
            max_connections: 最大连接数
        """
^
src/core/database_pool.py:88:51: E128 continuation line under-indented for visual indent
                                                  min_connections=min_connections,
                                                  ^
src/core/database_pool.py:88:80: E501 line too long (82 > 79 characters)
                                                  min_connections=min_connections,
                                                                               ^
src/core/database_pool.py:89:51: E128 continuation line under-indented for visual indent
                                                  max_connections=max_connections)
                                                  ^
src/core/database_pool.py:89:80: E501 line too long (82 > 79 characters)
                                                  max_connections=max_connections)
                                                                               ^
src/core/database_pool.py:92:27: E128 continuation line under-indented for visual indent
                          min_connections=min_connections,
                          ^
src/core/database_pool.py:93:27: E128 continuation line under-indented for visual indent
                          max_connections=max_connections,
                          ^
src/core/database_pool.py:94:27: E128 continuation line under-indented for visual indent
                          total_connections=max_connections)
                          ^
src/core/database_pool.py:106:1: D400 First line should end with a period
        """关闭连接池"""
^
src/core/database_pool.py:119:1: D400 First line should end with a period
        """
        获取数据库连接

        Args:
            timeout: 连接超时时间（秒）

        Yields:
            asyncpg.Connection: 数据库连接
        """
^
src/core/database_pool.py:156:47: E128 continuation line under-indented for visual indent
                                              connection_id=connection_id,
                                              ^
src/core/database_pool.py:157:47: E128 continuation line under-indented for visual indent
                                              total_connections=self._stats['active_connections'])
                                              ^
src/core/database_pool.py:157:80: E501 line too long (98 > 79 characters)
                                              total_connections=self._stats['active_connections'])
                                                                               ^
src/core/database_pool.py:160:24: E128 continuation line under-indented for visual indent
                       connection_id=connection_id,
                       ^
src/core/database_pool.py:161:24: E128 continuation line under-indented for visual indent
                       active_connections=self._stats['active_connections'])
                       ^
src/core/database_pool.py:191:80: E501 line too long (83 > 79 characters)
                    hold_time = time.time() - self._connection_times[connection_id]
                                                                               ^
src/core/database_pool.py:198:51: E128 continuation line under-indented for visual indent
                                                  connection_id=connection_id,
                                                  ^
src/core/database_pool.py:199:51: E128 continuation line under-indented for visual indent
                                                  hold_time=hold_time,
                                                  ^
src/core/database_pool.py:200:51: E128 continuation line under-indented for visual indent
                                                  total_connections=self._stats['active_connections'])
                                                  ^
src/core/database_pool.py:200:80: E501 line too long (102 > 79 characters)
                                                  total_connections=self._stats['active_connections'])
                                                                               ^
src/core/database_pool.py:203:28: E128 continuation line under-indented for visual indent
                           connection_id=connection_id,
                           ^
src/core/database_pool.py:204:28: E128 continuation line under-indented for visual indent
                           hold_time=hold_time,
                           ^
src/core/database_pool.py:205:28: E128 continuation line under-indented for visual indent
                           active_connections=self._stats['active_connections'])
                           ^
src/core/database_pool.py:205:80: E501 line too long (80 > 79 characters)
                           active_connections=self._stats['active_connections'])
                                                                               ^
src/core/database_pool.py:207:80: E501 line too long (95 > 79 characters)
    async def execute_query(self, query: str, params: tuple = None, timeout: int = 30) -> list:
                                                                               ^
src/core/database_pool.py:208:1: D400 First line should end with a period
        """
        执行查询语句

        Args:
            query: SQL查询语句
            params: 查询参数
            timeout: 超时时间

        Returns:
            list: 查询结果
        """
^
src/core/database_pool.py:229:28: E128 continuation line under-indented for visual indent
                           rows=len(result),
                           ^
src/core/database_pool.py:230:28: E128 continuation line under-indented for visual indent
                           query=query[:100] + "..." if len(query) > 100 else query)
                           ^
src/core/database_pool.py:230:80: E501 line too long (84 > 79 characters)
                           query=query[:100] + "..." if len(query) > 100 else query)
                                                                               ^
src/core/database_pool.py:237:28: E128 continuation line under-indented for visual indent
                           query=query[:100] + "..." if len(query) > 100 else query,
                           ^
src/core/database_pool.py:237:80: E501 line too long (84 > 79 characters)
                           query=query[:100] + "..." if len(query) > 100 else query,
                                                                               ^
src/core/database_pool.py:238:28: E128 continuation line under-indented for visual indent
                           error=str(e))
                           ^
src/core/database_pool.py:246:80: E501 line too long (98 > 79 characters)
    async def execute_command(self, command: str, params: tuple = None, timeout: int = 30) -> str:
                                                                               ^
src/core/database_pool.py:247:1: D400 First line should end with a period
        """
        执行命令语句

        Args:
            command: SQL命令语句
            params: 命令参数
            timeout: 超时时间

        Returns:
            str: 命令执行状态
        """
^
src/core/database_pool.py:268:28: E128 continuation line under-indented for visual indent
                           command=command[:100] + "..." if len(command) > 100 else command)
                           ^
src/core/database_pool.py:268:80: E501 line too long (92 > 79 characters)
                           command=command[:100] + "..." if len(command) > 100 else command)
                                                                               ^
src/core/database_pool.py:275:28: E128 continuation line under-indented for visual indent
                           command=command[:100] + "..." if len(command) > 100 else command,
                           ^
src/core/database_pool.py:275:80: E501 line too long (92 > 79 characters)
                           command=command[:100] + "..." if len(command) > 100 else command,
                                                                               ^
src/core/database_pool.py:276:28: E128 continuation line under-indented for visual indent
                           error=str(e))
                           ^
src/core/database_pool.py:285:1: D400 First line should end with a period
        """
        获取连接池统计信息

        Returns:
            Dict[str, Any]: 统计信息
        """
^
src/core/database_pool.py:297:29: E128 continuation line under-indented for visual indent
                            (self._stats['pool_hits'] + self._stats['pool_misses'])) if
                            ^
src/core/database_pool.py:297:80: E501 line too long (87 > 79 characters)
                            (self._stats['pool_hits'] + self._stats['pool_misses'])) if
                                                                               ^
src/core/database_pool.py:298:29: E131 continuation line unaligned for hanging indent
                            (self._stats['pool_hits'] + self._stats['pool_misses']) > 0 else 0,
                            ^
src/core/database_pool.py:298:80: E501 line too long (95 > 79 characters)
                            (self._stats['pool_hits'] + self._stats['pool_misses']) > 0 else 0,
                                                                               ^
src/core/database_pool.py:300:26: E128 continuation line under-indented for visual indent
                         self._stats['total_queries']) if self._stats['total_queries'] > 0 else 0
                         ^
src/core/database_pool.py:300:80: E501 line too long (97 > 79 characters)
                         self._stats['total_queries']) if self._stats['total_queries'] > 0 else 0
                                                                               ^
src/core/database_pool.py:304:1: D400 First line should end with a period
        """
        健康检查

        Returns:
            bool: 是否健康
        """
^
src/core/database_pool.py:323:1: D400 First line should end with a period
        """记录内存使用快照"""
^
src/core/database_pool.py:332:80: E501 line too long (82 > 79 characters)
                'process_memory_mb': memory_stats['current']['process_memory_mb'],
                                                                               ^
src/core/database_pool.py:333:80: E501 line too long (90 > 79 characters)
                'system_memory_percent': memory_stats['current']['system_memory_percent'],
                                                                               ^
src/core/database_pool.py:345:80: E501 line too long (89 > 79 characters)
                self._stats['memory_snapshots'] = self._stats['memory_snapshots'][-1000:]
                                                                               ^
src/core/database_pool.py:351:29: E128 continuation line under-indented for visual indent
                            event_type=event_type,
                            ^
src/core/database_pool.py:352:29: E128 continuation line under-indented for visual indent
                            memory_mb=current_memory,
                            ^
src/core/database_pool.py:353:29: E128 continuation line under-indented for visual indent
                            active_connections=self._stats['active_connections'])
                            ^
src/core/database_pool.py:353:80: E501 line too long (81 > 79 characters)
                            active_connections=self._stats['active_connections'])
                                                                               ^
src/core/database_pool.py:359:1: D400 First line should end with a period
        """获取内存分析报告"""
^
src/core/database_pool.py:378:80: E501 line too long (110 > 79 characters)
                memory_growth = ((last_memory - first_memory) / first_memory) * 100 if first_memory > 0 else 0
                                                                               ^
src/core/database_pool.py:386:80: E501 line too long (113 > 79 characters)
                    'active_connections': snapshot.get('connection_pool_stats', {}).get('active_connections', 0),
                                                                               ^
src/core/database_pool.py:409:1: D400 First line should end with a period
        """检测内存泄漏指标"""
^
src/core/database_pool.py:428:80: E501 line too long (95 > 79 characters)
            slope = (n * sum_xy - sum_x * sum_y) / (n * sum_x2 - sum_x * sum_x) if n > 1 else 0
                                                                               ^
src/core/database_pool.py:445:80: E501 line too long (124 > 79 characters)
            active_connections = [s.get('connection_pool_stats', {}).get('active_connections', 0) for s in recent_snapshots]
                                                                               ^
src/core/database_pool.py:449:80: E501 line too long (136 > 79 characters)
                decreasing_connections = all(recent_connections[i] >= recent_connections[i+1] for i in range(len(recent_connections)-1))
                                                                               ^
src/core/database_pool.py:453:80: E501 line too long (90 > 79 characters)
                    indicators['recommendation'] = 'Investigate potential connection leak'
                                                                               ^
src/core/database_pool.py:462:1: D400 First line should end with a period
        """清理内存快照数据"""
^
src/core/database_pool.py:472:1: D400 First line should end with a period
    """
    获取全局连接池实例

    Returns:
        DatabaseConnectionPool: 连接池实例
    """
^
src/core/database_pool.py:489:1: D400 First line should end with a period
    """关闭全局连接池"""
^
src/core/database_pool.py:499:1: D400 First line should end with a period
    """数据库连接管理器"""
^
src/core/database_pool.py:501:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/core/database_pool.py:505:1: D400 First line should end with a period
        """初始化连接池"""
^
src/core/database_pool.py:509:1: D400 First line should end with a period
        """获取数据库连接"""
^
src/core/database_pool.py:514:80: E501 line too long (87 > 79 characters)
    async def execute_query(self, query: str, params: tuple = None, timeout: int = 30):
                                                                               ^
src/core/database_pool.py:515:1: D400 First line should end with a period
        """执行查询"""
^
src/core/database_pool.py:520:80: E501 line too long (91 > 79 characters)
    async def execute_command(self, command: str, params: tuple = None, timeout: int = 30):
                                                                               ^
src/core/database_pool.py:521:1: D400 First line should end with a period
        """执行命令"""
^
src/core/database_pool.py:527:1: D400 First line should end with a period
        """获取统计信息"""
^
src/core/database_pool.py:533:1: D400 First line should end with a period
        """健康检查"""
^
src/core/database_pool.py:544:1: D400 First line should end with a period
    """获取数据库连接管理器"""
^
src/core/database_pool.py:545:31: W292 no newline at end of file
    return _connection_manager                              ^
src/core/error_handling.py:1:1: D205 1 blank line required between summary line and description
"""
Comprehensive Error Handling and Recovery Mechanisms
综合错误处理和恢复机制

创建日期: 2025-11-26
版本: 1.0.0
"""
^
src/core/error_handling.py:1:1: D400 First line should end with a period
"""
Comprehensive Error Handling and Recovery Mechanisms
综合错误处理和恢复机制

创建日期: 2025-11-26
版本: 1.0.0
"""
^
src/core/error_handling.py:24:1: D400 First line should end with a period
    """错误严重程度枚举"""
^
src/core/error_handling.py:33:1: D400 First line should end with a period
    """错误分类枚举"""
^
src/core/error_handling.py:45:1: D400 First line should end with a period
    """可重试错误基类"""
^
src/core/error_handling.py:47:1: D107 Missing docstring in __init__
    def __init__(
^
src/core/error_handling.py:47:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(
    ^
src/core/error_handling.py:60:1: D400 First line should end with a period
    """不可重试错误基类"""
^
src/core/error_handling.py:62:1: D107 Missing docstring in __init__
    def __init__(
^
src/core/error_handling.py:62:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(
    ^
src/core/error_handling.py:74:1: D400 First line should end with a period
    """数据库连接错误"""
^
src/core/error_handling.py:76:1: D107 Missing docstring in __init__
    def __init__(self, message: str):
^
src/core/error_handling.py:76:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, message: str):
    ^
src/core/error_handling.py:81:1: D400 First line should end with a period
    """数据库查询错误"""
^
src/core/error_handling.py:83:1: D107 Missing docstring in __init__
    def __init__(self, message: str):
^
src/core/error_handling.py:83:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, message: str):
    ^
src/core/error_handling.py:88:1: D400 First line should end with a period
    """网络超时错误"""
^
src/core/error_handling.py:90:1: D107 Missing docstring in __init__
    def __init__(self, message: str):
^
src/core/error_handling.py:90:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, message: str):
    ^
src/core/error_handling.py:95:1: D400 First line should end with a period
    """数据验证错误"""
^
src/core/error_handling.py:97:1: D107 Missing docstring in __init__
    def __init__(self, message: str):
^
src/core/error_handling.py:97:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, message: str):
    ^
src/core/error_handling.py:98:80: E501 line too long (81 > 79 characters)
        super().__init__(message, ErrorCategory.VALIDATION, ErrorSeverity.MEDIUM)
                                                                               ^
src/core/error_handling.py:102:1: D400 First line should end with a period
    """资源耗尽错误"""
^
src/core/error_handling.py:104:1: D107 Missing docstring in __init__
    def __init__(self, message: str):
^
src/core/error_handling.py:104:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, message: str):
    ^
src/core/error_handling.py:109:1: D400 First line should end with a period
    """错误恢复策略"""
^
src/core/error_handling.py:118:1: D400 First line should end with a period
        """指数退避策略"""
^
src/core/error_handling.py:130:80: E501 line too long (80 > 79 characters)
        base_delay: float = 1.0, increment: float = 0.5, max_delay: float = 10.0
                                                                               ^
src/core/error_handling.py:132:1: D400 First line should end with a period
        """线性退避策略"""
^
src/core/error_handling.py:142:1: D400 First line should end with a period
    """错误处理器"""
^
src/core/error_handling.py:144:1: D107 Missing docstring in __init__
    def __init__(self, enable_logging: bool = True, enable_metrics: bool = True):
^
src/core/error_handling.py:144:80: E501 line too long (81 > 79 characters)
    def __init__(self, enable_logging: bool = True, enable_metrics: bool = True):
                                                                               ^
src/core/error_handling.py:155:1: D400 First line should end with a period
        """记录错误"""
^
src/core/error_handling.py:197:80: E501 line too long (80 > 79 characters)
        if severity in [ErrorSeverity.HIGH.value, ErrorSeverity.CRITICAL.value]:
                                                                               ^
src/core/error_handling.py:203:1: D400 First line should end with a period
        """获取错误统计"""
^
src/core/error_handling.py:207:80: E501 line too long (87 > 79 characters)
            "total_errors": sum(stats["total"] for stats in self.error_stats.values()),
                                                                               ^
src/core/error_handling.py:211:1: D400 First line should end with a period
        """重置错误统计"""
^
src/core/error_handling.py:220:1: D400 First line should end with a period
    """获取全局错误处理器实例"""
^
src/core/error_handling.py:236:1: D400 First line should end with a period
    """
    错误处理装饰器

    Args:
        max_attempts: 最大重试次数
        delay_strategy: 延迟策略函数
        retry_on: 指定重试的异常类型
        fallback_value: 失败时的回退值
        catch_exceptions: 捕获的异常类型
        reraise: 是否重新抛出异常
        context: 错误上下文信息
    """
^
src/core/error_handling.py:264:21: F841 local variable 'last_error' is assigned to but never used
                    last_error = e
                    ^
src/core/error_handling.py:274:80: E501 line too long (110 > 79 characters)
                            f"Retrying {func.__name__} in {delay:.2f}s (attempt {attempt + 1}/{max_attempts})"
                                                                               ^
src/core/error_handling.py:281:80: E501 line too long (87 > 79 characters)
                            logger.warning(f"Using fallback value for {func.__name__}")
                                                                               ^
src/core/error_handling.py:287:80: E501 line too long (98 > 79 characters)
                                f"Failed to execute {func.__name__} after {max_attempts} attempts"
                                                                               ^
src/core/error_handling.py:302:21: F841 local variable 'last_error' is assigned to but never used
                    last_error = e
                    ^
src/core/error_handling.py:312:80: E501 line too long (110 > 79 characters)
                            f"Retrying {func.__name__} in {delay:.2f}s (attempt {attempt + 1}/{max_attempts})"
                                                                               ^
src/core/error_handling.py:319:80: E501 line too long (87 > 79 characters)
                            logger.warning(f"Using fallback value for {func.__name__}")
                                                                               ^
src/core/error_handling.py:325:80: E501 line too long (98 > 79 characters)
                                f"Failed to execute {func.__name__} after {max_attempts} attempts"
                                                                               ^
src/core/error_handling.py:341:1: D400 First line should end with a period
    """熔断器"""
^
src/core/error_handling.py:343:1: D107 Missing docstring in __init__
    def __init__(
^
src/core/error_handling.py:357:1: D102 Missing docstring in public method
    def __call__(self, func):
^
src/core/error_handling.py:400:1: D400 First line should end with a period
    """
    验证DataFrame

    Args:
        df: 要验证的DataFrame
        required_columns: 必需的列
        min_rows: 最小行数
        max_empty_ratio: 最大空值比例

    Returns:
        bool: 验证是否通过
    """
^
src/core/error_handling.py:423:80: E501 line too long (84 > 79 characters)
        missing_columns = [col for col in required_columns if col not in df.columns]
                                                                               ^
src/core/error_handling.py:442:80: E501 line too long (88 > 79 characters)
    func: Callable, *args, default_return: Any = None, log_errors: bool = True, **kwargs
                                                                               ^
src/core/error_handling.py:444:1: D400 First line should end with a period
    """
    安全执行函数

    Args:
        func: 要执行的函数
        *args: 位置参数
        default_return: 默认返回值
        log_errors: 是否记录错误
        **kwargs: 关键字参数

    Returns:
        Any: 函数结果或默认返回值
    """
^
src/core/error_handling.py:447:1: RST213 Inline emphasis start-string without end-string.
    """
    安全执行函数

    Args:
        func: 要执行的函数
        *args: 位置参数
        default_return: 默认返回值
        log_errors: 是否记录错误
        **kwargs: 关键字参数

    Returns:
        Any: 函数结果或默认返回值
    """
^
src/core/error_handling.py:447:1: RST210 Inline strong start-string without end-string.
    """
    安全执行函数

    Args:
        func: 要执行的函数
        *args: 位置参数
        default_return: 默认返回值
        log_errors: 是否记录错误
        **kwargs: 关键字参数

    Returns:
        Any: 函数结果或默认返回值
    """
^
src/core/error_handling.py:476:1: D103 Missing docstring in public function
    def test_retry_function(should_fail: bool = True):
^
src/core/exceptions.py:1:1: D400 First line should end with a period
"""
MyStocks Custom Exception Hierarchy

This module defines all custom exceptions used throughout the MyStocks application.
For details, see docs/guides/PHASE1_EXCEPTION_HIERARCHY.md
"""
^
src/core/exceptions.py:4:80: E501 line too long (83 > 79 characters)
"""
MyStocks Custom Exception Hierarchy

This module defines all custom exceptions used throughout the MyStocks application.
For details, see docs/guides/PHASE1_EXCEPTION_HIERARCHY.md
"""



                                      ^
src/core/exceptions.py:20:1: D107 Missing docstring in __init__
    def __init__(
^
src/core/exceptions.py:20:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(
    ^
src/core/exceptions.py:35:80: E501 line too long (88 > 79 characters)
        if original_exception and not isinstance(original_exception, MyStocksException):
                                                                               ^
src/core/exceptions.py:41:1: D102 Missing docstring in public method
    def format_message(self) -> str:
^
src/core/exceptions.py:44:80: E501 line too long (80 > 79 characters)
            context_str = ", ".join(f"{k}={v}" for k, v in self.context.items())
                                                                               ^
src/core/exceptions.py:48:1: D102 Missing docstring in public method
    def to_dict(self) -> Dict[str, Any]:
^
src/core/exceptions.py:57:80: E501 line too long (81 > 79 characters)
                str(self.original_exception) if self.original_exception else None
                                                                               ^
src/core/exceptions.py:61:1: D105 Missing docstring in magic method
    def __repr__(self) -> str:
^
src/core/exceptions.py:63:80: E501 line too long (88 > 79 characters)
            f"{self.__class__.__name__}(code={self.code!r}, severity={self.severity!r})"
                                                                               ^
src/core/logging.py:1:1: D205 1 blank line required between summary line and description
"""
统一日志系统模块
为MyStocks系统提供统一的日志记录接口
"""
^
src/core/logging.py:1:1: D400 First line should end with a period
"""
统一日志系统模块
为MyStocks系统提供统一的日志记录接口
"""
^
src/core/logging.py:77:1: D400 First line should end with a period
    """统一日志记录器类"""
^
src/core/logging.py:79:1: D107 Missing docstring in __init__
    def __init__(self, name: str = "MyStocks"):
^
src/core/logging.py:83:1: D400 First line should end with a period
        """追踪级别日志"""
^
src/core/logging.py:87:1: D400 First line should end with a period
        """调试级别日志"""
^
src/core/logging.py:91:1: D400 First line should end with a period
        """信息级别日志"""
^
src/core/logging.py:95:1: D400 First line should end with a period
        """成功级别日志"""
^
src/core/logging.py:99:1: D400 First line should end with a period
        """警告级别日志"""
^
src/core/logging.py:103:1: D400 First line should end with a period
        """错误级别日志"""
^
src/core/logging.py:107:1: D400 First line should end with a period
        """严重级别日志"""
^
src/core/logging.py:111:1: D400 First line should end with a period
        """异常级别日志（自动包含异常堆栈）"""
^
src/core/logging.py:122:1: D400 First line should end with a period
        """
        异常捕获上下文管理器

        Args:
            message: 异常发生时记录的消息
            reraise: 是否重新抛出异常
            exclude: 要排除的异常类型
            level: 日志级别
        """
^
src/core/logging.py:146:1: D400 First line should end with a period
        """
        记录函数执行时间的装饰器

        Usage:
            @logger.log_performance
            def my_function():
                pass
        """
^
src/core/logging.py:151:1: RST301 Unexpected indentation.
        """
        记录函数执行时间的装饰器

        Usage:
            @logger.log_performance
            def my_function():
                pass
        """
^
src/core/logging.py:157:80: E501 line too long (81 > 79 characters)
            start_time = self.logger.catch()(lambda: __import__("time").time())()
                                                                               ^
src/core/logging.py:185:1: D400 First line should end with a period
    """添加日志处理器"""
^
src/core/logging.py:190:1: D400 First line should end with a period
    """移除日志处理器"""
^
src/core/logging.py:196:1: D400 First line should end with a period
    """
    将日志写入PostgreSQL监控数据库

    Args:
        message: loguru的日志消息记录
    """
^
src/core/logging.py:247:80: E501 line too long (95 > 79 characters)
            """
            INSERT INTO logs (timestamp, level, module, function, message, exception, metadata)
            VALUES (%(timestamp)s, %(level)s, %(module)s, %(function)s, %(message)s, %(exception)s, %(metadata)s::jsonb)
            """,

                                                               ^
src/core/logging.py:248:80: E501 line too long (120 > 79 characters)
            """
            INSERT INTO logs (timestamp, level, module, function, message, exception, metadata)
            VALUES (%(timestamp)s, %(level)s, %(module)s, %(function)s, %(message)s, %(exception)s, %(metadata)s::jsonb)
            """,

                                                               ^
src/core/logging.py:257:1: S110 Try, Except, Pass detected.
    except Exception:
^
src/core/logging.py:276:13: F541 f-string is missing placeholders
logger.info(f"日志级别: 控制台=INFO, 文件=DEBUG, 数据库=WARNING")
            ^
src/core/memory_manager.py:3:1: D400 First line should end with a period
"""
MyStocks 内存管理器

提供统一的内存管理功能，包括：
1. 内存使用监控
2. 资源自动清理
3. 内存限制管理
4. 缓存大小控制
5. 内存泄漏检测

作者: MyStocks项目组
版本: v1.0
日期: 2025-12-06
"""
^
src/core/memory_manager.py:33:1: D204 1 blank line required after class docstring
    """内存统计信息"""
^
src/core/memory_manager.py:33:1: D400 First line should end with a period
    """内存统计信息"""
^
src/core/memory_manager.py:43:1: D400 First line should end with a period
    """内存限制管理器"""
^
src/core/memory_manager.py:45:80: E501 line too long (82 > 79 characters)
    def __init__(self, max_memory_mb: int = 1024, warning_threshold: float = 0.8):
                                                                               ^
src/core/memory_manager.py:46:1: D400 First line should end with a period
        """
        初始化内存限制

        Args:
            max_memory_mb: 最大内存使用量（MB）
            warning_threshold: 警告阈值（0-1）
        """
^
src/core/memory_manager.py:60:1: D400 First line should end with a period
        """
        检查当前内存使用量

        Returns:
            float: 当前内存使用量（MB）
        """
^
src/core/memory_manager.py:71:1: D400 First line should end with a period
        """检查是否接近内存限制"""
^
src/core/memory_manager.py:76:1: D400 First line should end with a period
        """检查是否超过内存限制"""
^
src/core/memory_manager.py:81:1: D400 First line should end with a period
        """注册内存监控回调"""
^
src/core/memory_manager.py:86:1: D400 First line should end with a period
        """通知所有监控器"""
^
src/core/memory_manager.py:96:1: D400 First line should end with a period
    """资源管理器 - 自动管理生命周期"""
^
src/core/memory_manager.py:99:1: D400 First line should end with a period
        """初始化资源管理器"""
^
src/core/memory_manager.py:107:25: E128 continuation line under-indented for visual indent
                        resource_id: str,
                        ^
src/core/memory_manager.py:108:25: E128 continuation line under-indented for visual indent
                        resource: Any,
                        ^
src/core/memory_manager.py:109:25: E128 continuation line under-indented for visual indent
                        cleanup_callback: Optional[Callable] = None,
                        ^
src/core/memory_manager.py:110:25: E128 continuation line under-indented for visual indent
                        weak_ref: bool = False):
                        ^
src/core/memory_manager.py:111:1: D400 First line should end with a period
        """
        注册资源进行管理

        Args:
            resource_id: 资源ID
            resource: 资源对象
            cleanup_callback: 清理回调函数
            weak_ref: 是否使用弱引用
        """
^
src/core/memory_manager.py:131:21: E128 continuation line under-indented for visual indent
                    lambda ref: self._auto_cleanup(resource_id))
                    ^
src/core/memory_manager.py:134:1: D400 First line should end with a period
        """注销资源"""
^
src/core/memory_manager.py:143:1: D400 First line should end with a period
        """清理单个资源"""
^
src/core/memory_manager.py:154:1: D400 First line should end with a period
        """自动清理资源（弱引用回调）"""
^
src/core/memory_manager.py:159:1: D400 First line should end with a period
        """获取资源"""
^
src/core/memory_manager.py:164:1: D400 First line should end with a period
        """清理所有资源"""
^
src/core/memory_manager.py:179:1: D400 First line should end with a period
        """获取资源统计信息"""
^
src/core/memory_manager.py:190:1: D400 First line should end with a period
    """内存监控器"""
^
src/core/memory_manager.py:195:1: D400 First line should end with a period
        """
        初始化内存监控器

        Args:
            check_interval: 检查间隔（秒）
            max_history: 最大历史记录数
        """
^
src/core/memory_manager.py:211:1: D400 First line should end with a period
        """启动内存监控"""
^
src/core/memory_manager.py:222:1: D400 First line should end with a period
        """停止内存监控"""
^
src/core/memory_manager.py:233:1: D400 First line should end with a period
        """监控循环"""
^
src/core/memory_manager.py:252:1: D400 First line should end with a period
        """收集内存统计信息"""
^
src/core/memory_manager.py:264:80: E501 line too long (82 > 79 characters)
        active_objects = len([obj for obj in gc.get_objects() if obj is not None])
                                                                               ^
src/core/memory_manager.py:279:1: D400 First line should end with a period
        """更新统计历史"""
^
src/core/memory_manager.py:288:1: D400 First line should end with a period
        """检查内存限制"""
^
src/core/memory_manager.py:291:80: E501 line too long (109 > 79 characters)
            logger.warning(f"内存使用接近限制: {stats.process_memory_mb:.2f}MB/{self._memory_limit.max_memory_mb}MB")
                                                                               ^
src/core/memory_manager.py:295:80: E501 line too long (107 > 79 characters)
            logger.error(f"内存使用超过限制: {stats.process_memory_mb:.2f}MB/{self._memory_limit.max_memory_mb}MB")
                                                                               ^
src/core/memory_manager.py:304:1: D400 First line should end with a period
        """检测可能的内存泄漏候选者"""
^
src/core/memory_manager.py:321:1: D400 First line should end with a period
        """紧急清理"""
^
src/core/memory_manager.py:333:1: D400 First line should end with a period
        """获取当前统计信息"""
^
src/core/memory_manager.py:335:80: E501 line too long (83 > 79 characters)
            return self._stats_history[-1] if self._stats_history else MemoryStats(
                                                                               ^
src/core/memory_manager.py:345:1: D400 First line should end with a period
        """获取历史统计"""
^
src/core/memory_manager.py:356:1: D400 First line should end with a period
    """获取全局资源管理器"""
^
src/core/memory_manager.py:361:1: D400 First line should end with a period
    """获取全局内存监控器"""
^
src/core/memory_manager.py:366:1: D400 First line should end with a period
    """初始化内存管理系统"""
^
src/core/memory_manager.py:380:1: D400 First line should end with a period
    """关闭内存管理系统"""
^
src/core/memory_manager.py:401:1: D400 First line should end with a period
    """注册资源进行管理"""
^
src/core/memory_manager.py:402:80: E501 line too long (80 > 79 characters)
    _resource_manager.register_resource(resource_id, resource, cleanup_callback)
                                                                               ^
src/core/memory_manager.py:406:1: D400 First line should end with a period
    """注销资源"""
^
src/core/memory_manager.py:411:1: D400 First line should end with a period
    """清理所有资源"""
^
src/core/memory_manager.py:416:1: D400 First line should end with a period
    """获取内存统计信息"""
^
src/core/memory_manager.py:431:6: W292 no newline at end of file
    }     ^
src/core/models/__init__.py:1:1: D104 Missing docstring in public package
src/core/monitoring.py:1:1: D205 1 blank line required between summary line and description
"""
Monitoring and Alerting System for API Endpoints
API端点监控和警报系统

创建日期: 2025-11-26
版本: 1.0.0
"""
^
src/core/monitoring.py:1:1: D400 First line should end with a period
"""
Monitoring and Alerting System for API Endpoints
API端点监控和警报系统

创建日期: 2025-11-26
版本: 1.0.0
"""
^
src/core/monitoring.py:25:1: D400 First line should end with a period
    """警报严重程度"""
^
src/core/monitoring.py:34:1: D400 First line should end with a period
    """指标类型"""
^
src/core/monitoring.py:44:1: D400 First line should end with a period
    """警报规则"""
^
src/core/monitoring.py:56:1: D400 First line should end with a period
    """指标值"""
^
src/core/monitoring.py:67:1: D400 First line should end with a period
    """警报"""
^
src/core/monitoring.py:79:1: D400 First line should end with a period
    """指标收集器"""
^
src/core/monitoring.py:81:1: D107 Missing docstring in __init__
    def __init__(self, max_history: int = 10000):
^
src/core/monitoring.py:92:80: E501 line too long (84 > 79 characters)
        self, name: str, value: float = 1.0, labels: Optional[Dict[str, str]] = None
                                                                               ^
src/core/monitoring.py:94:1: D400 First line should end with a period
        """增加计数器"""
^
src/core/monitoring.py:102:1: D400 First line should end with a period
        """设置仪表值"""
^
src/core/monitoring.py:110:1: D400 First line should end with a period
        """记录直方图"""
^
src/core/monitoring.py:116:80: E501 line too long (81 > 79 characters)
        self, name: str, duration: float, labels: Optional[Dict[str, str]] = None
                                                                               ^
src/core/monitoring.py:118:1: D400 First line should end with a period
        """记录计时器"""
^
src/core/monitoring.py:127:1: D400 First line should end with a period
        """创建指标键"""
^
src/core/monitoring.py:134:1: D400 First line should end with a period
        """获取指标摘要"""
^
src/core/monitoring.py:173:1: D400 First line should end with a period
        """计算百分位数"""
^
src/core/monitoring.py:182:1: D400 First line should end with a period
    """警报管理器"""
^
src/core/monitoring.py:184:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/core/monitoring.py:192:1: D400 First line should end with a period
        """添加警报规则"""
^
src/core/monitoring.py:197:1: D400 First line should end with a period
        """移除警报规则"""
^
src/core/monitoring.py:211:1: D400 First line should end with a period
        """检查指标是否触发警报"""
^
src/core/monitoring.py:221:80: E501 line too long (87 > 79 characters)
                matching_metrics = [m for m in metrics.values() if m.name == rule_name]
                                                                               ^
src/core/monitoring.py:227:80: E501 line too long (80 > 79 characters)
                        alert_id = f"{rule_name}_{metric.timestamp.timestamp()}"
                                                                               ^
src/core/monitoring.py:234:80: E501 line too long (119 > 79 characters)
                                message=f"{rule_name} {rule.condition} {rule.threshold} (current: {metric.value:.2f})",
                                                                               ^
src/core/monitoring.py:243:80: E501 line too long (80 > 79 characters)
                        alert_id = f"{rule_name}_{metric.timestamp.timestamp()}"
                                                                               ^
src/core/monitoring.py:255:1: D400 First line should end with a period
        """评估条件"""
^
src/core/monitoring.py:270:1: D400 First line should end with a period
        """获取活跃警报"""
^
src/core/monitoring.py:275:1: D400 First line should end with a period
        """获取警报摘要"""
^
src/core/monitoring.py:284:80: E501 line too long (87 > 79 characters)
                "recent_alerts": [asdict(alert) for alert in self.alert_history[-10:]],
                                                                               ^
src/core/monitoring.py:290:1: D400 First line should end with a period
    """系统监控器"""
^
src/core/monitoring.py:292:1: D107 Missing docstring in __init__
    def __init__(self, metrics_collector: MetricsCollector):
^
src/core/monitoring.py:299:1: D400 First line should end with a period
        """开始监控"""
^
src/core/monitoring.py:304:80: E501 line too long (86 > 79 characters)
        self.monitor_thread = threading.Thread(target=self._monitor_loop, daemon=True)
                                                                               ^
src/core/monitoring.py:309:1: D400 First line should end with a period
        """停止监控"""
^
src/core/monitoring.py:316:1: D400 First line should end with a period
        """监控循环"""
^
src/core/monitoring.py:325:1: D400 First line should end with a period
        """收集系统指标"""
^
src/core/monitoring.py:332:80: E501 line too long (81 > 79 characters)
        self.metrics_collector.set_gauge("system_memory_percent", memory.percent)
                                                                               ^
src/core/monitoring.py:355:1: D400 First line should end with a period
    """API监控器"""
^
src/core/monitoring.py:357:1: D107 Missing docstring in __init__
    def __init__(self, metrics_collector: MetricsCollector):
^
src/core/monitoring.py:364:80: E501 line too long (80 > 79 characters)
        self, endpoint: str, method: str, status_code: int, response_time: float
                                                                               ^
src/core/monitoring.py:366:1: D400 First line should end with a period
        """记录API请求"""
^
src/core/monitoring.py:371:80: E501 line too long (81 > 79 characters)
            "api_requests_total", labels={"endpoint": endpoint, "method": method}
                                                                               ^
src/core/monitoring.py:385:80: E501 line too long (88 > 79 characters)
            f"api_status_{status_code}", labels={"endpoint": endpoint, "method": method}
                                                                               ^
src/core/monitoring.py:401:1: D400 First line should end with a period
        """获取API摘要"""
^
src/core/monitoring.py:413:80: E501 line too long (88 > 79 characters)
            avg_response_time = statistics.mean(response_times) if response_times else 0
                                                                               ^
src/core/monitoring.py:429:1: D400 First line should end with a period
        """计算百分位数"""
^
src/core/monitoring.py:445:1: D400 First line should end with a period
    """获取全局指标收集器"""
^
src/core/monitoring.py:453:1: D400 First line should end with a period
    """获取全局警报管理器"""
^
src/core/monitoring.py:461:1: D400 First line should end with a period
    """获取全局系统监控器"""
^
src/core/monitoring.py:469:1: D400 First line should end with a period
    """获取全局API监控器"""
^
src/core/monitoring.py:477:1: D400 First line should end with a period
    """设置默认警报规则"""
^
src/core/monitoring.py:519:1: D400 First line should end with a period
    """初始化监控系统"""
^
src/core/monitoring.py:533:1: D400 First line should end with a period
    """获取监控仪表板数据"""
^
src/core/monitoring.py:542:80: E501 line too long (81 > 79 characters)
        "system": {"timestamp": datetime.now().isoformat(), "status": "running"},
                                                                               ^
src/core/monitoring.py:556:9: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
    for i in range(100):
        ^
src/core/monitoring.py:559:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        status_code = 200 if random.random() > 0.1 else 500  # 10%错误率
^
src/core/monitoring.py:560:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        response_time = random.uniform(0.1, 3.0)  # 0.1-3.0秒响应时间
^
src/core/monitoring.py:562:80: E501 line too long (80 > 79 characters)
        api_monitor.record_request(endpoint, method, status_code, response_time)
                                                                               ^
src/core/monitoring.py:567:11: F541 f-string is missing placeholders
    print(f"\nMonitoring Dashboard:")
          ^
src/core/services/__init__.py:1:1: D104 Missing docstring in public package
src/core/unified_manager.py:1:1: D400 First line should end with a period
"""
MyStocks统一数据管理器 - 简化版本 (US3 Architecture Simplification)

这是系统的向后兼容性包装器,提供与之前版本相同的API。
所有核心逻辑已委托给DataManager以简化架构。

版本: 3.0.0 (US3 Simplified - Thin Wrapper)
创建日期: 2025-10-25
"""
^
src/core/unified_manager.py:40:1: D400 First line should end with a period
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:51:1: RST214 Inline literal start-string without end-string.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:51:1: RST215 Inline interpreted text or phrase reference start-string without end-string.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:56:1: RST301 Unexpected indentation.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:59:1: RST201 Block quote ends without a blank line; unexpected unindent.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:63:1: RST301 Unexpected indentation.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:66:1: RST201 Block quote ends without a blank line; unexpected unindent.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:67:1: RST401 Unexpected section title.
    """
    MyStocks统一数据管理器 - Thin Wrapper版本

    **重要**: 这是一个向后兼容性包装器。所有核心功能已委托给DataManager。

    **核心功能**:
    1. 自动路由: 根据数据分类自动选择最优数据库
    2. 统一接口: 2行代码完成保存/加载操作
    3. 故障恢复: 数据库不可用时自动排队
    4. 批量操作: 支持高性能批量保存

    **使用示例**:
        ```python
        manager = MyStocksUnifiedManager()

        # 保存Tick数据 → 自动路由到TDengine
        manager.save_data_by_classification(
            DataClassification.TICK_DATA,
            tick_df,
            table_name='tick_600000'
        )

        # 加载日线数据 → 自动路由到PostgreSQL
        kline_df = manager.load_data_by_classification(
            DataClassification.DAILY_KLINE,
            table_name='daily_kline',
            filters={'symbol': '600000.SH'}
        )
        ```
    """
^
src/core/unified_manager.py:72:1: D400 First line should end with a period
        """
        初始化统一管理器

        Args:
            enable_monitoring: 是否启用监控功能 (默认True)
        """
^
src/core/unified_manager.py:122:1: D400 First line should end with a period
        """
        按分类保存数据 (核心方法 #1)

        委托给DataManager处理。

        Args:
            classification: 数据分类枚举
            data: 数据DataFrame
            table_name: 目标表名
            **kwargs: 额外参数

        Returns:
            bool: 保存是否成功
        """
^
src/core/unified_manager.py:127:1: RST210 Inline strong start-string without end-string.
        """
        按分类保存数据 (核心方法 #1)

        委托给DataManager处理。

        Args:
            classification: 数据分类枚举
            data: 数据DataFrame
            table_name: 目标表名
            **kwargs: 额外参数

        Returns:
            bool: 保存是否成功
        """
^
src/core/unified_manager.py:164:1: D400 First line should end with a period
        """
        按分类加载数据 (核心方法 #2)

        委托给DataManager处理。

        Args:
            classification: 数据分类枚举
            table_name: 源表名
            filters: 过滤条件字典

        Returns:
            Optional[pd.DataFrame]: 加载的数据或None
        """
^
src/core/unified_manager.py:182:80: E501 line too long (86 > 79 characters)
            return self._data_manager.load_data(classification, table_name, **filters)
                                                                               ^
src/core/unified_manager.py:187:80: E501 line too long (85 > 79 characters)
    def get_routing_info(self, classification: DataClassification) -> Dict[str, Any]:
                                                                               ^
src/core/unified_manager.py:188:1: D400 First line should end with a period
        """
        获取数据分类的路由信息

        Args:
            classification: 数据分类

        Returns:
            路由信息字典
        """
^
src/core/unified_manager.py:213:1: D400 First line should end with a period
        """
        批量保存数据（带故障处理策略）

        Args:
            classification: 数据分类
            data: 要保存的数据
            table_name: 目标表名
            batch_size: 批次大小
            failure_strategy: 失败处理策略
            **kwargs: 额外参数

        Returns:
            BatchOperationResult: 批量操作结果
        """
^
src/core/unified_manager.py:216:1: RST210 Inline strong start-string without end-string.
        """
        批量保存数据（带故障处理策略）

        Args:
            classification: 数据分类
            data: 要保存的数据
            table_name: 目标表名
            batch_size: 批次大小
            failure_strategy: 失败处理策略
            **kwargs: 额外参数

        Returns:
            BatchOperationResult: 批量操作结果
        """
^
src/core/unified_manager.py:232:37: E203 whitespace before ':'
            batch_data = data.iloc[i : i + batch_size]
                                    ^
src/core/unified_manager.py:239:80: E501 line too long (87 > 79 characters)
                batch_index=i // batch_size, success=success, row_count=len(batch_data)
                                                                               ^
src/core/unified_manager.py:243:80: E501 line too long (81 > 79 characters)
            if not success and failure_strategy == BatchFailureStrategy.ROLLBACK:
                                                                               ^
src/core/unified_manager.py:249:1: D400 First line should end with a period
        """
        获取监控统计信息

        Returns:
            监控统计字典
        """
^
src/core/unified_manager.py:264:80: E501 line too long (80 > 79 characters)
                stats["performance"] = self.performance_monitor.get_statistics()
                                                                               ^
src/core/unified_manager.py:265:1: S110 Try, Except, Pass detected.
            except Exception:
^
src/core/unified_manager.py:276:1: D400 First line should end with a period
        """
        检查数据质量

        Args:
            classification: 数据分类
            table_name: 表名
            **filters: 过滤条件

        Returns:
            数据质量检查结果
        """
^
src/core/unified_manager.py:279:1: RST210 Inline strong start-string without end-string.
        """
        检查数据质量

        Args:
            classification: 数据分类
            table_name: 表名
            **filters: 过滤条件

        Returns:
            数据质量检查结果
        """
^
src/core/unified_manager.py:295:80: E501 line too long (88 > 79 characters)
            data = self.load_data_by_classification(classification, table_name, filters)
                                                                               ^
src/core/unified_manager.py:312:1: D200 One-line docstring should fit on one line with quotes
        """
        关闭所有数据库连接
        """
^
src/core/unified_manager.py:312:1: D400 First line should end with a period
        """
        关闭所有数据库连接
        """
^
src/core/unified_manager.py:325:1: D400 First line should end with a period
        """析构函数：确保连接被关闭"""
^
src/core/unified_manager.py:328:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/data_access.py:3:1: D205 1 blank line required between summary line and description
"""
MyStocks 量化交易数据管理系统 - 统一数据访问层
完全按照原始设计理念实现的5大数据分类体系和自动化路由

设计理念：
1. 5大数据分类：市场数据、参考数据、衍生数据、交易数据、元数据
2. 自动路由：根据数据特性自动选择最适合的数据库
3. TDengine为高频数据核心：专门处理Tick和分钟级数据
4. 监控集成：所有操作自动记录到监控数据库
5. 配置驱动：表结构和访问模式完全由配置文件管理

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-09-21
"""
^
src/data_access.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 统一数据访问层
完全按照原始设计理念实现的5大数据分类体系和自动化路由

设计理念：
1. 5大数据分类：市场数据、参考数据、衍生数据、交易数据、元数据
2. 自动路由：根据数据特性自动选择最适合的数据库
3. TDengine为高频数据核心：专门处理Tick和分钟级数据
4. 监控集成：所有操作自动记录到监控数据库
5. 配置驱动：表结构和访问模式完全由配置文件管理

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-09-21
"""
^
src/data_access.py:37:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/data_access.py:40:1: F401 'src.storage.database.connection_manager.get_connection_manager' imported but unused
from src.storage.database.connection_manager import get_connection_manager
^
src/data_access.py:48:80: E501 line too long (86 > 79 characters)
def _get_database_name_from_classification(classification: DataClassification) -> str:
                                                                               ^
src/data_access.py:49:1: D400 First line should end with a period
    """
    从数据分类获取数据库名称 (US3架构简化)

    Args:
        classification: 数据分类

    Returns:
        数据库名称字符串
    """
^
src/data_access.py:68:1: D400 First line should end with a period
    """数据访问层接口"""
^
src/data_access.py:78:1: D400 First line should end with a period
        """保存数据"""
^
src/data_access.py:89:1: D400 First line should end with a period
        """加载数据"""
^
src/data_access.py:101:1: D400 First line should end with a period
        """更新数据"""
^
src/data_access.py:112:1: D400 First line should end with a period
        """删除数据"""
^
src/data_access.py:117:1: D400 First line should end with a period
    """TDengine数据访问器 - 高频时序数据专用"""
^
src/data_access.py:120:1: D400 First line should end with a period
        """
        初始化TDengine数据访问器

        Args:
            monitoring_db: 监控数据库
        """
^
src/data_access.py:137:1: D400 First line should end with a period
        """
        保存时序数据到TDengine，支持去重策略

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选，默认根据分类确定）
            **kwargs: 其他参数，支持 dedup_strategy 参数

        Returns:
            bool: 保存是否成功
        """
^
src/data_access.py:140:1: RST210 Inline strong start-string without end-string.
        """
        保存时序数据到TDengine，支持去重策略

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选，默认根据分类确定）
            **kwargs: 其他参数，支持 dedup_strategy 参数

        Returns:
            bool: 保存是否成功
        """
^
src/data_access.py:162:80: E501 line too long (82 > 79 characters)
            database_name = _get_database_name_from_classification(classification)
                                                                               ^
src/data_access.py:165:80: E501 line too long (83 > 79 characters)
            processed_data = self._preprocess_timeseries_data(data, classification)
                                                                               ^
src/data_access.py:175:80: E501 line too long (81 > 79 characters)
                processed_data, actual_table_name, dedup_strategy, classification
                                                                               ^
src/data_access.py:189:80: E501 line too long (87 > 79 characters)
                success = self._insert_tick_data(cursor, final_data, actual_table_name)
                                                                               ^
src/data_access.py:204:80: E501 line too long (107 > 79 characters)
                    f"TDengine保存成功: {actual_table_name}, {len(final_data)}条记录，去重策略: {dedup_strategy.value}"
                                                                               ^
src/data_access.py:215:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/data_access.py:226:1: D400 First line should end with a period
        """
        从TDengine加载时序数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/data_access.py:229:1: RST210 Inline strong start-string without end-string.
        """
        从TDengine加载时序数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/data_access.py:239:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/data_access.py:248:80: E501 line too long (82 > 79 characters)
            database_name = _get_database_name_from_classification(classification)
                                                                               ^
src/data_access.py:260:80: E501 line too long (84 > 79 characters)
            processed_data = self._postprocess_timeseries_data(data, classification)
                                                                               ^
src/data_access.py:273:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/data_access.py:285:1: D400 First line should end with a period
        """TDengine通常不支持更新操作，使用插入替代"""
^
src/data_access.py:296:1: D400 First line should end with a period
        """TDengine删除数据（谨慎使用）"""
^
src/data_access.py:300:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/data_access.py:301:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/data_access.py:316:1: D400 First line should end with a period
        """
        应用TDengine特定的去重策略

        Args:
            data: 原始数据
            table_name: 表名
            strategy: 去重策略
            classification: 数据分类

        Returns:
            处理后的数据
        """
^
src/data_access.py:340:80: E501 line too long (84 > 79 characters)
                return self._handle_tdengine_merge(data, table_name, classification)
                                                                               ^
src/data_access.py:342:80: E501 line too long (85 > 79 characters)
                return self._handle_tdengine_reject(data, table_name, classification)
                                                                               ^
src/data_access.py:352:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/data_access.py:354:1: D400 First line should end with a period
        """TDengine最新覆盖策略：基于时间戳去重，保留最新记录（重构后）"""
^
src/data_access.py:362:80: E501 line too long (80 > 79 characters)
            data[time_column] = self._standardize_time_column(data, time_column)
                                                                               ^
src/data_access.py:365:80: E501 line too long (85 > 79 characters)
            deduped_data = self._execute_latest_wins_deduplication(data, time_column)
                                                                               ^
src/data_access.py:376:80: E501 line too long (91 > 79 characters)
    def _validate_time_column_for_deduplication(self, data: pd.DataFrame) -> Optional[str]:
                                                                               ^
src/data_access.py:377:1: D400 First line should end with a period
        """验证并获取时间列名称"""
^
src/data_access.py:384:80: E501 line too long (90 > 79 characters)
    def _standardize_time_column(self, data: pd.DataFrame, time_column: str) -> pd.Series:
                                                                               ^
src/data_access.py:385:1: D400 First line should end with a period
        """标准化时间列为datetime类型"""
^
src/data_access.py:388:80: E501 line too long (103 > 79 characters)
    def _execute_latest_wins_deduplication(self, data: pd.DataFrame, time_column: str) -> pd.DataFrame:
                                                                               ^
src/data_access.py:389:1: D400 First line should end with a period
        """执行LATEST_WINS去重策略"""
^
src/data_access.py:402:80: E501 line too long (96 > 79 characters)
    def _log_latest_wins_results(self, original_data: pd.DataFrame, deduped_data: pd.DataFrame):
                                                                               ^
src/data_access.py:403:1: D400 First line should end with a period
        """记录LATEST_WINS去重结果"""
^
src/data_access.py:411:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/data_access.py:413:1: D400 First line should end with a period
        """TDengine首次保留策略：查询已存在的数据，过滤重复（重构后）"""
^
src/data_access.py:429:80: E501 line too long (88 > 79 characters)
            filtered_data = self._filter_existing_data(data, existing_data, time_column)
                                                                               ^
src/data_access.py:441:1: D400 First line should end with a period
        """验证时间列是否存在"""
^
src/data_access.py:452:1: D400 First line should end with a period
        """查询TDengine中已存在的数据"""
^
src/data_access.py:477:1: D400 First line should end with a period
        """构建TDengine存在性查询SQL"""
^
src/data_access.py:478:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"""
        SELECT DISTINCT {time_column}
        FROM {table_name}
        WHERE {time_column} BETWEEN '{min_time}' AND '{max_time}'
        """
^
src/data_access.py:489:80: E501 line too long (102 > 79 characters)
                f"{time_column} BETWEEN '{min_time}' AND '{max_time}' AND symbol IN ('{symbols_str}')"
                                                                               ^
src/data_access.py:504:1: D400 First line should end with a period
        """过滤掉已存在的数据"""
^
src/data_access.py:520:80: E501 line too long (96 > 79 characters)
    def _log_first_wins_results(self, original_data: pd.DataFrame, filtered_data: pd.DataFrame):
                                                                               ^
src/data_access.py:521:1: D400 First line should end with a period
        """记录FIRST_WINS处理结果"""
^
src/data_access.py:529:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/data_access.py:531:1: D400 First line should end with a period
        """TDengine合并策略：时序数据通常使用最新覆盖"""
^
src/data_access.py:533:80: E501 line too long (82 > 79 characters)
        return self._handle_tdengine_latest_wins(data, table_name, classification)
                                                                               ^
src/data_access.py:536:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/data_access.py:538:1: D400 First line should end with a period
        """TDengine拒绝重复策略：检查重复并拒绝"""
^
src/data_access.py:568:1: D400 First line should end with a period
        """预处理时序数据"""
^
src/data_access.py:599:80: E501 line too long (80 > 79 characters)
            col for col in required_columns if col not in processed_data.columns
                                                                               ^
src/data_access.py:609:1: D400 First line should end with a period
        """后处理时序数据"""
^
src/data_access.py:620:80: E501 line too long (85 > 79 characters)
    def _insert_tick_data(self, cursor, data: pd.DataFrame, table_name: str) -> bool:
                                                                               ^
src/data_access.py:621:1: D400 First line should end with a period
        """插入Tick数据"""
^
src/data_access.py:624:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, price, volume, amount, exchange)
                VALUES (?, ?, ?, ?, ?, ?)
            """
^
src/data_access.py:625:80: E501 line too long (86 > 79 characters)
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, price, volume, amount, exchange)
                VALUES (?, ?, ?, ?, ?, ?)
            """

                                                 ^
src/data_access.py:651:80: E501 line too long (88 > 79 characters)
    def _insert_minute_kline(self, cursor, data: pd.DataFrame, table_name: str) -> bool:
                                                                               ^
src/data_access.py:652:1: D400 First line should end with a period
        """插入分钟K线数据"""
^
src/data_access.py:655:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, open, high, low, close, volume, amount, frequency)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """
^
src/data_access.py:656:80: E501 line too long (104 > 79 characters)
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, open, high, low, close, volume, amount, frequency)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """

                                                 ^
src/data_access.py:688:1: D400 First line should end with a period
        """插入通用时序数据"""
^
src/data_access.py:693:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"INSERT INTO {table_name} ({', '.join(columns)}) VALUES ({placeholders})"
^
src/data_access.py:693:80: E501 line too long (99 > 79 characters)
            insert_sql = f"INSERT INTO {table_name} ({', '.join(columns)}) VALUES ({placeholders})"
                                                                               ^
src/data_access.py:713:1: D400 First line should end with a period
        """构建时序数据查询语句"""
^
src/data_access.py:714:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/data_access.py:732:80: E501 line too long (87 > 79 characters)
                    if isinstance(value, dict) and "start" in value and "end" in value:
                                                                               ^
src/data_access.py:734:80: E501 line too long (82 > 79 characters)
                            f"ts >= '{value['start']}' AND ts <= '{value['end']}'"
                                                                               ^
src/data_access.py:760:1: D400 First line should end with a period
    """PostgreSQL数据访问器 - 历史数据仓库和分析"""
^
src/data_access.py:763:1: D400 First line should end with a period
        """
        初始化PostgreSQL数据访问器

        Args:
            monitoring_db: 监控数据库
        """
^
src/data_access.py:780:1: D400 First line should end with a period
        """
        保存数据到PostgreSQL

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/data_access.py:783:1: RST210 Inline strong start-string without end-string.
        """
        保存数据到PostgreSQL

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/data_access.py:793:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/data_access.py:802:80: E501 line too long (82 > 79 characters)
            database_name = _get_database_name_from_classification(classification)
                                                                               ^
src/data_access.py:805:80: E501 line too long (83 > 79 characters)
            processed_data = self._preprocess_analytical_data(data, classification)
                                                                               ^
src/data_access.py:839:80: E501 line too long (80 > 79 characters)
                f"PostgreSQL保存成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/data_access.py:846:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/data_access.py:857:1: D400 First line should end with a period
        """
        从PostgreSQL加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/data_access.py:860:1: RST210 Inline strong start-string without end-string.
        """
        从PostgreSQL加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/data_access.py:870:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/data_access.py:879:80: E501 line too long (82 > 79 characters)
            database_name = _get_database_name_from_classification(classification)
                                                                               ^
src/data_access.py:891:80: E501 line too long (84 > 79 characters)
            processed_data = self._postprocess_analytical_data(data, classification)
                                                                               ^
src/data_access.py:897:80: E501 line too long (80 > 79 characters)
                f"PostgreSQL加载成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/data_access.py:904:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/data_access.py:916:1: D400 First line should end with a period
        """
        更新PostgreSQL数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/data_access.py:919:1: RST210 Inline strong start-string without end-string.
        """
        更新PostgreSQL数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/data_access.py:930:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/data_access.py:939:80: E501 line too long (82 > 79 characters)
            database_name = _get_database_name_from_classification(classification)
                                                                               ^
src/data_access.py:940:80: E501 line too long (86 > 79 characters)
            key_columns = key_columns or self._get_default_key_columns(classification)
                                                                               ^
src/data_access.py:947:80: E501 line too long (88 > 79 characters)
            success = self._execute_update(cursor, data, actual_table_name, key_columns)
                                                                               ^
src/data_access.py:951:80: E501 line too long (86 > 79 characters)
                self.monitoring_db.log_operation_result(operation_id, True, len(data))
                                                                               ^
src/data_access.py:965:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/data_access.py:976:1: D400 First line should end with a period
        """
        删除PostgreSQL数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/data_access.py:979:1: RST210 Inline strong start-string without end-string.
        """
        删除PostgreSQL数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/data_access.py:989:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/data_access.py:1002:80: E501 line too long (82 > 79 characters)
            database_name = _get_database_name_from_classification(classification)
                                                                               ^
src/data_access.py:1009:80: E501 line too long (85 > 79 characters)
            delete_sql, params = self._build_delete_query(actual_table_name, filters)
                                                                               ^
src/data_access.py:1016:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, True, affected_rows)
                                                                               ^
src/data_access.py:1025:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/data_access.py:1029:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/data_access.py:1030:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/data_access.py:1044:80: E501 line too long (88 > 79 characters)
    def _get_default_key_columns(self, classification: DataClassification) -> List[str]:
                                                                               ^
src/data_access.py:1045:1: D400 First line should end with a period
        """根据数据分类获取默认主键列"""
^
src/data_access.py:1062:80: E501 line too long (82 > 79 characters)
            DataClassification.MODEL_OUTPUTS: ["model_id", "symbol", "calc_date"],
                                                                               ^
src/data_access.py:1074:1: D400 First line should end with a period
        """预处理分析数据"""
^
src/data_access.py:1114:1: D400 First line should end with a period
        """获取PostgreSQL SQLAlchemy引擎"""
^
src/data_access.py:1125:80: E501 line too long (84 > 79 characters)
            f"postgresql+psycopg2://{user}:{password}@{host}:{port}/{database_name}"
                                                                               ^
src/data_access.py:1139:1: D400 First line should end with a period
        """使用SQLAlchemy引擎执行UPSERT操作"""
^
src/data_access.py:1154:80: E501 line too long (87 > 79 characters)
                    table_name, engine, if_exists="append", index=False, method="multi"
                                                                               ^
src/data_access.py:1170:1: D400 First line should end with a period
        """后处理分析数据"""
^
src/data_access.py:1189:1: D400 First line should end with a period
        """PostgreSQL Upsert操作 - 使用ON CONFLICT实现（重构后）"""
^
src/data_access.py:1189:1: D403 First word of the first line should be properly capitalized
        """PostgreSQL Upsert操作 - 使用ON CONFLICT实现（重构后）"""
^
src/data_access.py:1196:80: E501 line too long (86 > 79 characters)
            upsert_sql = self._build_upsert_sql(table_name, data.columns, key_columns)
                                                                               ^
src/data_access.py:1206:80: E501 line too long (87 > 79 characters)
                f"PostgreSQL UPSERT操作完成: {table_name}, 处理记录数: {len(records_to_insert)}"
                                                                               ^
src/data_access.py:1215:80: E501 line too long (89 > 79 characters)
    def _build_upsert_sql(self, table_name: str, columns, key_columns: List[str]) -> str:
                                                                               ^
src/data_access.py:1216:1: D400 First line should end with a period
        """构建UPSERT SQL语句"""
^
src/data_access.py:1231:1: S608 Possible SQL injection vector through string-based query construction.
        return f"""
        INSERT INTO {table_name} ({column_names})
        VALUES ({placeholders})
        ON CONFLICT ({conflict_columns})
        DO UPDATE SET
            {update_set},
            updated_at = CURRENT_TIMESTAMP
        """
^
src/data_access.py:1241:1: D400 First line should end with a period
        """准备UPSERT记录，处理pandas特殊类型"""
^
src/data_access.py:1261:80: E501 line too long (81 > 79 characters)
        self, cursor, data: pd.DataFrame, table_name: str, key_columns: List[str]
                                                                               ^
src/data_access.py:1263:1: D400 First line should end with a period
        """执行更新操作（重构后）"""
^
src/data_access.py:1267:80: E501 line too long (89 > 79 characters)
                set_clauses, set_values = self._build_set_clauses(data, row, key_columns)
                                                                               ^
src/data_access.py:1270:80: E501 line too long (89 > 79 characters)
                where_clauses, where_values = self._build_where_clauses(key_columns, row)
                                                                               ^
src/data_access.py:1273:80: E501 line too long (91 > 79 characters)
                update_sql = self._build_update_sql(table_name, set_clauses, where_clauses)
                                                                               ^
src/data_access.py:1285:80: E501 line too long (102 > 79 characters)
    def _build_set_clauses(self, data: pd.DataFrame, row: pd.Series, key_columns: List[str]) -> tuple:
                                                                               ^
src/data_access.py:1286:1: D400 First line should end with a period
        """构建SET子句和对应的值"""
^
src/data_access.py:1295:80: E501 line too long (84 > 79 characters)
    def _build_where_clauses(self, key_columns: List[str], row: pd.Series) -> tuple:
                                                                               ^
src/data_access.py:1296:1: D400 First line should end with a period
        """构建WHERE子句和对应的值"""
^
src/data_access.py:1304:80: E501 line too long (106 > 79 characters)
    def _build_update_sql(self, table_name: str, set_clauses: List[str], where_clauses: List[str]) -> str:
                                                                               ^
src/data_access.py:1305:1: D400 First line should end with a period
        """构建UPDATE SQL语句"""
^
src/data_access.py:1306:1: S608 Possible SQL injection vector through string-based query construction.
        return f"""
            UPDATE {table_name}
            SET {', '.join(set_clauses)}
            WHERE {' AND '.join(where_clauses)}
        """
^
src/data_access.py:1319:1: D400 First line should end with a period
        """
        构建分析数据查询语句 - 使用参数化查询防止SQL注入（重构后）

        返回值: (sql_string, bind_parameters)
        """
^
src/data_access.py:1328:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/data_access.py:1334:80: E501 line too long (85 > 79 characters)
            filter_conditions, filter_params = self._build_filter_conditions(filters)
                                                                               ^
src/data_access.py:1339:80: E501 line too long (80 > 79 characters)
        kwargs_conditions, kwargs_params = self._build_kwargs_conditions(kwargs)
                                                                               ^
src/data_access.py:1352:80: E501 line too long (83 > 79 characters)
        limit_offset_clause, limit_params = self._build_limit_offset_clause(kwargs)
                                                                               ^
src/data_access.py:1359:1: D400 First line should end with a period
        """验证表名安全性 - 防止SQL注入"""
^
src/data_access.py:1360:10: N806 variable 'ALLOWED_TABLES' in function should be lowercase
        ALLOWED_TABLES = {
         ^
src/data_access.py:1379:1: D400 First line should end with a period
        """构建过滤条件"""
^
src/data_access.py:1397:1: D400 First line should end with a period
        """构建kwargs条件（排除特殊参数）"""
^
src/data_access.py:1412:80: E501 line too long (94 > 79 characters)
    def _build_order_by_clause(self, classification: DataClassification, kwargs: Dict) -> str:
                                                                               ^
src/data_access.py:1413:1: D400 First line should end with a period
        """构建ORDER BY子句"""
^
src/data_access.py:1431:1: D400 First line should end with a period
        """构建LIMIT和OFFSET子句"""
^
src/data_access.py:1438:80: E501 line too long (91 > 79 characters)
                limit_offset_clause += f" LIMIT {limit_val}"  # Integers are safe for LIMIT
                                                                               ^
src/data_access.py:1446:80: E501 line too long (94 > 79 characters)
                limit_offset_clause += f" OFFSET {offset_val}"  # Integers are safe for OFFSET
                                                                               ^
src/data_access.py:1454:1: D400 First line should end with a period
        """
        构建删除查询语句 - 使用参数化查询防止SQL注入

        返回值: (sql_string, bind_parameters)
        """
^
src/data_access.py:1459:80: E501 line too long (85 > 79 characters)
        # SECURITY FIX: Whitelist table names to prevent injection through table_name
                                                                               ^
src/data_access.py:1460:10: N806 variable 'ALLOWED_TABLES' in function should be lowercase
        ALLOWED_TABLES = {
         ^
src/data_access.py:1478:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"DELETE FROM {table_name}"
^
src/data_access.py:1485:80: E501 line too long (87 > 79 characters)
                # SECURITY FIX: Use parameterized query instead of string concatenation
                                                                               ^
src/data_access/__init__.py:1:1: D400 First line should end with a period
"""
数据访问层模块

提供2种数据库的统一访问接口:
- TDengine: 高频时序数据
- PostgreSQL: 历史分析数据、参考数据和元数据

创建日期: 2025-10-11
版本: 2.0.0 (简化为TDengine + PostgreSQL双数据库架构)
"""
^
src/data_access/postgresql_access.py:1:1: D400 First line should end with a period
"""
PostgreSQL数据访问层

封装PostgreSQL+TimescaleDB的所有CRUD操作。
专门处理历史分析数据和衍生计算结果(日线/技术指标/回测结果)。

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/data_access/postgresql_access.py:22:1: D400 First line should end with a period
    """
    PostgreSQL+TimescaleDB数据访问类

    提供历史分析数据的存储和查询接口:
    - 时序表(Hypertable)管理
    - 批量写入(execute_values优化)
    - 复杂时间范围查询
    - JOIN查询支持
    - 聚合和窗口函数
    """
^
src/data_access/postgresql_access.py:34:1: D400 First line should end with a period
        """初始化PostgreSQL连接池"""
^
src/data_access/postgresql_access.py:39:1: D400 First line should end with a period
        """从连接池获取连接"""
^
src/data_access/postgresql_access.py:45:1: D400 First line should end with a period
        """归还连接到连接池"""
^
src/data_access/postgresql_access.py:50:80: E501 line too long (88 > 79 characters)
        self, table_name: str, schema: Dict[str, str], primary_key: Optional[str] = None
                                                                               ^
src/data_access/postgresql_access.py:52:1: D400 First line should end with a period
        """
        创建普通表

        Args:
            table_name: 表名
            schema: 字段定义 {'symbol': 'VARCHAR(20)', 'date': 'DATE', 'close': 'DECIMAL(10,2)'}
            primary_key: 主键字段 (可选)

        Example:
            create_table('daily_kline', {
                'symbol': 'VARCHAR(20)',
                'date': 'DATE',
                'open': 'DECIMAL(10,2)',
                'high': 'DECIMAL(10,2)',
                'low': 'DECIMAL(10,2)',
                'close': 'DECIMAL(10,2)',
                'volume': 'BIGINT'
            }, primary_key='symbol, date')
        """
^
src/data_access/postgresql_access.py:57:80: E501 line too long (92 > 79 characters)
        """
        创建普通表

        Args:
            table_name: 表名
            schema: 字段定义 {'symbol': 'VARCHAR(20)', 'date': 'DATE', 'close': 'DECIMAL(10,2)'}
            primary_key: 主键字段 (可选)

        Example:
            create_table('daily_kline', {
                'symbol': 'VARCHAR(20)',
                'date': 'DATE',
                'open': 'DECIMAL(10,2)',
                'high': 'DECIMAL(10,2)',
                'low': 'DECIMAL(10,2)',
                'close': 'DECIMAL(10,2)',
                'volume': 'BIGINT'
            }, primary_key='symbol, date')
        """





           ^
src/data_access/postgresql_access.py:68:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        创建普通表

        Args:
            table_name: 表名
            schema: 字段定义 {'symbol': 'VARCHAR(20)', 'date': 'DATE', 'close': 'DECIMAL(10,2)'}
            primary_key: 主键字段 (可选)

        Example:
            create_table('daily_kline', {
                'symbol': 'VARCHAR(20)',
                'date': 'DATE',
                'open': 'DECIMAL(10,2)',
                'high': 'DECIMAL(10,2)',
                'low': 'DECIMAL(10,2)',
                'close': 'DECIMAL(10,2)',
                'volume': 'BIGINT'
            }, primary_key='symbol, date')
        """
^
src/data_access/postgresql_access.py:100:80: E501 line too long (88 > 79 characters)
        self, table_name: str, time_column: str = "time", chunk_interval: str = "7 days"
                                                                               ^
src/data_access/postgresql_access.py:102:1: D400 First line should end with a period
        """
        将表转换为TimescaleDB时序表(Hypertable)

        Args:
            table_name: 表名
            time_column: 时间列名 (默认'time')
            chunk_interval: 分块间隔 (默认7天)

        Example:
            create_hypertable('daily_kline', 'date', '30 days')
        """
^
src/data_access/postgresql_access.py:140:1: D400 First line should end with a period
        """
        批量插入DataFrame数据 (使用execute_values优化)

        Args:
            table_name: 表名
            df: 数据DataFrame

        Returns:
            插入的行数

        Example:
            df = pd.DataFrame({
                'symbol': ['600000.SH'] * 100,
                'date': pd.date_range('2025-01-01', periods=100),
                'close': np.random.uniform(10, 20, 100)
            })
            insert_dataframe('daily_kline', df)
        """
^
src/data_access/postgresql_access.py:154:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        批量插入DataFrame数据 (使用execute_values优化)

        Args:
            table_name: 表名
            df: 数据DataFrame

        Returns:
            插入的行数

        Example:
            df = pd.DataFrame({
                'symbol': ['600000.SH'] * 100,
                'date': pd.date_range('2025-01-01', periods=100),
                'close': np.random.uniform(10, 20, 100)
            })
            insert_dataframe('daily_kline', df)
        """
^
src/data_access/postgresql_access.py:169:80: E501 line too long (80 > 79 characters)
            data = [tuple(row) for row in df.itertuples(index=False, name=None)]
                                                                               ^
src/data_access/postgresql_access.py:172:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"INSERT INTO {table_name} ({columns_str}) VALUES %s"
^
src/data_access/postgresql_access.py:197:1: D400 First line should end with a period
        """
        批量Upsert (INSERT ... ON CONFLICT UPDATE)

        Args:
            table_name: 表名
            df: 数据DataFrame
            conflict_columns: 冲突检测列 (通常是主键)
            update_columns: 需要更新的列 (None表示更新所有非冲突列)

        Returns:
            影响的行数

        Example:
            upsert_dataframe('daily_kline', df,
                           conflict_columns=['symbol', 'date'],
                           update_columns=['close', 'volume'])
        """
^
src/data_access/postgresql_access.py:224:80: E501 line too long (80 > 79 characters)
            data = [tuple(row) for row in df.itertuples(index=False, name=None)]
                                                                               ^
src/data_access/postgresql_access.py:230:80: E501 line too long (88 > 79 characters)
                update_columns = [col for col in columns if col not in conflict_columns]
                                                                               ^
src/data_access/postgresql_access.py:237:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
                INSERT INTO {table_name} ({columns_str})
                VALUES %s
                ON CONFLICT ({conflict_str})
                DO UPDATE SET {update_str}
            """
^
src/data_access/postgresql_access.py:268:1: D400 First line should end with a period
        """
        通用查询

        Args:
            table_name: 表名
            columns: 查询字段列表 (None表示所有字段)
            where: WHERE子句 (不含WHERE关键字)
            order_by: ORDER BY子句 (不含ORDER BY关键字)
            limit: 返回行数限制

        Returns:
            查询结果DataFrame

        Example:
            df = query('daily_kline',
                      columns=['symbol', 'date', 'close'],
                      where="symbol = '600000.SH' AND date >= '2025-01-01'",
                      order_by='date DESC',
                      limit=100)
        """
^
src/data_access/postgresql_access.py:292:14: N806 variable 'ALLOWED_TABLES' in function should be lowercase
            ALLOWED_TABLES = {
             ^
src/data_access/postgresql_access.py:322:18: N806 variable 'ALLOWED_COLUMNS' in function should be lowercase
                ALLOWED_COLUMNS = {
                 ^
src/data_access/postgresql_access.py:359:80: E501 line too long (84 > 79 characters)
                    if col not in ALLOWED_COLUMNS and not col.startswith("custom_"):
                                                                               ^
src/data_access/postgresql_access.py:366:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"SELECT {cols} FROM {table_name}"
^
src/data_access/postgresql_access.py:370:80: E501 line too long (101 > 79 characters)
                # If WHERE contains parameter placeholders, keep it as-is for parameterized execution
                                                                               ^
src/data_access/postgresql_access.py:374:80: E501 line too long (89 > 79 characters)
                    # For literal WHERE clauses, do basic validation to prevent injection
                                                                               ^
src/data_access/postgresql_access.py:375:80: E501 line too long (83 > 79 characters)
                    dangerous_patterns = ["'", ";", "--", "/*", "*/", "xp_", "sp_"]
                                                                               ^
src/data_access/postgresql_access.py:380:80: E501 line too long (88 > 79 characters)
                                f"Potentially dangerous SQL pattern detected: {pattern}"
                                                                               ^
src/data_access/postgresql_access.py:433:1: D400 First line should end with a period
        """
        按时间范围查询

        Args:
            table_name: 表名
            time_column: 时间列名
            start_time: 开始时间
            end_time: 结束时间
            columns: 查询字段列表
            filters: 额外过滤条件

        Returns:
            查询结果DataFrame
        """
^
src/data_access/postgresql_access.py:458:80: E501 line too long (84 > 79 characters)
    def execute_sql(self, sql: str, params: Optional[Tuple] = None) -> pd.DataFrame:
                                                                               ^
src/data_access/postgresql_access.py:459:1: D300 Use """triple double quotes"""
        """
        执行自定义SQL查询

        Args:
            sql: SQL语句
            params: 参数元组 (用于参数化查询)

        Returns:
            查询结果DataFrame

        Example:
            df = execute_sql(
                \"\"\"
                SELECT symbol, AVG(close) as avg_close
                FROM daily_kline
                WHERE date >= %s
                GROUP BY symbol
                HAVING AVG(close) > %s
                \"\"\",
                params=('2025-01-01', 50.0)
            )
        """
^
src/data_access/postgresql_access.py:459:1: D301 Use r""" if any backslashes in a docstring
        """
        执行自定义SQL查询

        Args:
            sql: SQL语句
            params: 参数元组 (用于参数化查询)

        Returns:
            查询结果DataFrame

        Example:
            df = execute_sql(
                \"\"\"
                SELECT symbol, AVG(close) as avg_close
                FROM daily_kline
                WHERE date >= %s
                GROUP BY symbol
                HAVING AVG(close) > %s
                \"\"\",
                params=('2025-01-01', 50.0)
            )
        """
^
src/data_access/postgresql_access.py:459:1: D400 First line should end with a period
        """
        执行自定义SQL查询

        Args:
            sql: SQL语句
            params: 参数元组 (用于参数化查询)

        Returns:
            查询结果DataFrame

        Example:
            df = execute_sql(
                \"\"\"
                SELECT symbol, AVG(close) as avg_close
                FROM daily_kline
                WHERE date >= %s
                GROUP BY symbol
                HAVING AVG(close) > %s
                \"\"\",
                params=('2025-01-01', 50.0)
            )
        """
^
src/data_access/postgresql_access.py:478:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行自定义SQL查询

        Args:
            sql: SQL语句
            params: 参数元组 (用于参数化查询)

        Returns:
            查询结果DataFrame

        Example:
            df = execute_sql(
                \"\"\"
                SELECT symbol, AVG(close) as avg_close
                FROM daily_kline
                WHERE date >= %s
                GROUP BY symbol
                HAVING AVG(close) > %s
                \"\"\",
                params=('2025-01-01', 50.0)
            )
        """
^
src/data_access/postgresql_access.py:496:1: D400 First line should end with a period
        """
        删除数据 (Security-enhanced version)

        Args:
            table_name: 表名
            where: WHERE子句 (不含WHERE关键字，支持参数化查询)
            params: 参数元组 (用于参数化查询)

        Returns:
            删除的行数

        Example:
            # 使用参数化查询 (推荐)
            deleted = delete('daily_kline', "date < %s", ('2020-01-01',))

            # 或者使用带验证的字面量
            deleted = delete('daily_kline', "date < '2020-01-01'")
        """
^
src/data_access/postgresql_access.py:518:14: N806 variable 'ALLOWED_TABLES' in function should be lowercase
            ALLOWED_TABLES = {
             ^
src/data_access/postgresql_access.py:549:1: S608 Possible SQL injection vector through string-based query construction.
                sql = f"DELETE FROM {table_name} WHERE {where}"
^
src/data_access/postgresql_access.py:569:80: E501 line too long (84 > 79 characters)
                            f"Potentially dangerous SQL pattern detected: {pattern}"
                                                                               ^
src/data_access/postgresql_access.py:571:1: S608 Possible SQL injection vector through string-based query construction.
                sql = f"DELETE FROM {table_name} WHERE {where}"
^
src/data_access/postgresql_access.py:590:1: D400 First line should end with a period
        """
        获取表统计信息 (Security-enhanced version)

        Args:
            table_name: 表名

        Returns:
            统计信息字典
        """
^
src/data_access/postgresql_access.py:603:14: N806 variable 'ALLOWED_TABLES' in function should be lowercase
            ALLOWED_TABLES = {
             ^
src/data_access/postgresql_access.py:660:1: D400 First line should end with a period
        """
        保存数据（DataManager API适配器）

        Args:
            data: 数据DataFrame
            classification: 数据分类（US3架构参数，此处未使用）
            table_name: 表名
            **kwargs: 其他参数（如upsert=True, conflict_columns）

        Returns:
            bool: 保存是否成功
        """
^
src/data_access/postgresql_access.py:663:1: RST210 Inline strong start-string without end-string.
        """
        保存数据（DataManager API适配器）

        Args:
            data: 数据DataFrame
            classification: 数据分类（US3架构参数，此处未使用）
            table_name: 表名
            **kwargs: 其他参数（如upsert=True, conflict_columns）

        Returns:
            bool: 保存是否成功
        """
^
src/data_access/postgresql_access.py:676:80: E501 line too long (85 > 79 characters)
                row_count = self.upsert_dataframe(table_name, data, conflict_columns)
                                                                               ^
src/data_access/postgresql_access.py:686:1: D400 First line should end with a period
        """
        加载数据（DataManager API适配器）

        Args:
            table_name: 表名
            **filters: 过滤条件

        Returns:
            pd.DataFrame or None: 查询结果
        """
^
src/data_access/postgresql_access.py:689:1: RST210 Inline strong start-string without end-string.
        """
        加载数据（DataManager API适配器）

        Args:
            table_name: 表名
            **filters: 过滤条件

        Returns:
            pd.DataFrame or None: 查询结果
        """
^
src/data_access/postgresql_access.py:708:1: S608 Possible SQL injection vector through string-based query construction.
                sql = f"SELECT * FROM {table_name} WHERE {filters['where']}"
^
src/data_access/postgresql_access.py:712:80: E501 line too long (82 > 79 characters)
                    table_name, where=filters["where"], limit=filters.get("limit")
                                                                               ^
src/data_access/postgresql_access.py:716:1: S608 Possible SQL injection vector through string-based query construction.
                sql = f"SELECT * FROM {table_name}"
^
src/data_access/postgresql_access.py:725:1: D400 First line should end with a period
        """关闭所有连接"""
^
src/data_access/postgresql_access.py:731:1: D400 First line should end with a period
        """关闭所有连接（兼容旧接口）"""
^
src/data_access/tdengine_access.py:1:1: D400 First line should end with a period
"""
TDengine数据访问层

封装TDengine WebSocket连接的所有CRUD操作。
专门处理高频时序数据(Tick/分钟线/盘口快照)的存储和查询。

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/data_access/tdengine_access.py:19:1: D400 First line should end with a period
    """
    TDengine数据访问类

    提供高频时序数据的存储和查询接口:
    - 超表(STable)管理
    - 批量写入(自动按timestamp分区)
    - 时间范围查询
    - 聚合查询(OHLC等)
    """
^
src/data_access/tdengine_access.py:30:1: D400 First line should end with a period
        """初始化TDengine连接"""
^
src/data_access/tdengine_access.py:35:1: D400 First line should end with a period
        """获取TDengine连接(懒加载)"""
^
src/data_access/tdengine_access.py:43:1: D400 First line should end with a period
        """
        创建超表(STable)

        Args:
            stable_name: 超表名称
            schema: 字段定义 {'ts': 'TIMESTAMP', 'price': 'FLOAT', 'volume': 'INT'}
            tags: 标签定义 {'symbol': 'BINARY(20)', 'exchange': 'BINARY(10)'}

        Example:
            create_stable('tick_data',
                         {'ts': 'TIMESTAMP', 'price': 'FLOAT', 'volume': 'INT'},
                         {'symbol': 'BINARY(20)', 'exchange': 'BINARY(10)'})
        """
^
src/data_access/tdengine_access.py:53:80: E501 line too long (80 > 79 characters)
        """
        创建超表(STable)

        Args:
            stable_name: 超表名称
            schema: 字段定义 {'ts': 'TIMESTAMP', 'price': 'FLOAT', 'volume': 'INT'}
            tags: 标签定义 {'symbol': 'BINARY(20)', 'exchange': 'BINARY(10)'}

        Example:
            create_stable('tick_data',
                         {'ts': 'TIMESTAMP', 'price': 'FLOAT', 'volume': 'INT'},
                         {'symbol': 'BINARY(20)', 'exchange': 'BINARY(10)'})
        """





 ^
src/data_access/tdengine_access.py:59:80: E501 line too long (81 > 79 characters)
        fields = ", ".join([f"{name} {dtype}" for name, dtype in schema.items()])
                                                                               ^
src/data_access/tdengine_access.py:60:80: E501 line too long (83 > 79 characters)
        tag_fields = ", ".join([f"{name} {dtype}" for name, dtype in tags.items()])
                                                                               ^
src/data_access/tdengine_access.py:64:80: E501 line too long (87 > 79 characters)
            f"CREATE STABLE IF NOT EXISTS {stable_name} ({fields}) TAGS ({tag_fields})"
                                                                               ^
src/data_access/tdengine_access.py:79:1: D400 First line should end with a period
        """
        创建子表(基于超表)

        Args:
            table_name: 子表名称 (建议: {stable_name}_{symbol})
            stable_name: 超表名称
            tag_values: 标签值 {'symbol': '600000.SH', 'exchange': 'SSE'}

        Example:
            create_table('tick_data_600000', 'tick_data', {'symbol': '600000.SH', 'exchange': 'SSE'})
        """
^
src/data_access/tdengine_access.py:88:80: E501 line too long (101 > 79 characters)
        """
        创建子表(基于超表)

        Args:
            table_name: 子表名称 (建议: {stable_name}_{symbol})
            stable_name: 超表名称
            tag_values: 标签值 {'symbol': '600000.SH', 'exchange': 'SSE'}

        Example:
            create_table('tick_data_600000', 'tick_data', {'symbol': '600000.SH', 'exchange': 'SSE'})
        """




                                 ^
src/data_access/tdengine_access.py:94:80: E501 line too long (85 > 79 characters)
            [f"'{v}'" if isinstance(v, str) else str(v) for v in tag_values.values()]
                                                                               ^
src/data_access/tdengine_access.py:99:80: E501 line too long (88 > 79 characters)
            f"CREATE TABLE IF NOT EXISTS {table_name} USING {stable_name} TAGS ({tags})"
                                                                               ^
src/data_access/tdengine_access.py:113:1: D400 First line should end with a period
        """
        批量插入DataFrame数据

        Args:
            table_name: 表名
            df: 数据DataFrame (必须包含timestamp列)
            timestamp_col: 时间戳列名 (默认'ts')

        Returns:
            插入的行数

        Example:
            df = pd.DataFrame({
                'ts': pd.date_range('2025-01-01', periods=1000, freq='1s'),
                'price': np.random.uniform(10, 20, 1000),
                'volume': np.random.randint(100, 10000, 1000)
            })
            insert_dataframe('tick_data_600000', df)
        """
^
src/data_access/tdengine_access.py:128:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        批量插入DataFrame数据

        Args:
            table_name: 表名
            df: 数据DataFrame (必须包含timestamp列)
            timestamp_col: 时间戳列名 (默认'ts')

        Returns:
            插入的行数

        Example:
            df = pd.DataFrame({
                'ts': pd.date_range('2025-01-01', periods=1000, freq='1s'),
                'price': np.random.uniform(10, 20, 1000),
                'volume': np.random.randint(100, 10000, 1000)
            })
            insert_dataframe('tick_data_600000', df)
        """
^
src/data_access/tdengine_access.py:155:80: E501 line too long (83 > 79 characters)
                    values.append(f"'{val.strftime('%Y-%m-%d %H:%M:%S.%f')[:-3]}'")
                                                                               ^
src/data_access/tdengine_access.py:165:27: E203 whitespace before ':'
            batch = rows[i : i + batch_size]
                          ^
src/data_access/tdengine_access.py:166:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"INSERT INTO {table_name} ({columns}) VALUES {', '.join(batch)}"
^
src/data_access/tdengine_access.py:166:80: E501 line too long (83 > 79 characters)
            sql = f"INSERT INTO {table_name} ({columns}) VALUES {', '.join(batch)}"
                                                                               ^
src/data_access/tdengine_access.py:187:1: D400 First line should end with a period
        """
        按时间范围查询数据

        Args:
            table_name: 表名
            start_time: 开始时间
            end_time: 结束时间
            columns: 查询字段列表 (None表示所有字段)
            limit: 返回行数限制

        Returns:
            查询结果DataFrame

        Example:
            df = query_by_time_range(
                'tick_data_600000',
                datetime(2025, 1, 1, 9, 30),
                datetime(2025, 1, 1, 15, 0),
                columns=['ts', 'price', 'volume'],
                limit=10000
            )
        """
^
src/data_access/tdengine_access.py:206:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        按时间范围查询数据

        Args:
            table_name: 表名
            start_time: 开始时间
            end_time: 结束时间
            columns: 查询字段列表 (None表示所有字段)
            limit: 返回行数限制

        Returns:
            查询结果DataFrame

        Example:
            df = query_by_time_range(
                'tick_data_600000',
                datetime(2025, 1, 1, 9, 30),
                datetime(2025, 1, 1, 15, 0),
                columns=['ts', 'price', 'volume'],
                limit=10000
            )
        """
^
src/data_access/tdengine_access.py:213:1: S608 Possible SQL injection vector through string-based query construction.
        sql = f"""
            SELECT {cols}
            FROM {table_name}
            WHERE ts >= '{start_time.strftime('%Y-%m-%d %H:%M:%S')}'
              AND ts < '{end_time.strftime('%Y-%m-%d %H:%M:%S')}'
            ORDER BY ts ASC
        """
^
src/data_access/tdengine_access.py:245:1: D400 First line should end with a period
        """
        查询最新N条数据

        Args:
            table_name: 表名
            limit: 返回行数 (默认100)

        Returns:
            最新数据DataFrame
        """
^
src/data_access/tdengine_access.py:257:1: S608 Possible SQL injection vector through string-based query construction.
        sql = f"""
            SELECT *
            FROM {table_name}
            ORDER BY ts DESC
            LIMIT {limit}
        """
^
src/data_access/tdengine_access.py:288:1: D400 First line should end with a period
        """
        聚合为K线数据

        Args:
            table_name: 表名
            start_time: 开始时间
            end_time: 结束时间
            interval: 聚合周期 ('1m', '5m', '15m', '1h', '1d')
            price_col: 价格字段名
            volume_col: 成交量字段名

        Returns:
            K线DataFrame (columns: ts, open, high, low, close, volume)

        Example:
            kline = aggregate_to_kline(
                'tick_data_600000',
                datetime(2025, 1, 1),
                datetime(2025, 1, 2),
                interval='5m'
            )
        """
^
src/data_access/tdengine_access.py:307:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        聚合为K线数据

        Args:
            table_name: 表名
            start_time: 开始时间
            end_time: 结束时间
            interval: 聚合周期 ('1m', '5m', '15m', '1h', '1d')
            price_col: 价格字段名
            volume_col: 成交量字段名

        Returns:
            K线DataFrame (columns: ts, open, high, low, close, volume)

        Example:
            kline = aggregate_to_kline(
                'tick_data_600000',
                datetime(2025, 1, 1),
                datetime(2025, 1, 2),
                interval='5m'
            )
        """
^
src/data_access/tdengine_access.py:312:1: S608 Possible SQL injection vector through string-based query construction.
        sql = f"""
            SELECT
                _wstart as ts,
                FIRST({price_col}) as open,
                MAX({price_col}) as high,
                MIN({price_col}) as low,
                LAST({price_col}) as close,
                SUM({volume_col}) as volume
            FROM {table_name}
            WHERE ts >= '{start_time.strftime('%Y-%m-%d %H:%M:%S')}'
              AND ts < '{end_time.strftime('%Y-%m-%d %H:%M:%S')}'
            INTERVAL({interval})
        """
^
src/data_access/tdengine_access.py:344:1: D400 First line should end with a period
        """
        删除时间范围内的数据

        Args:
            table_name: 表名
            start_time: 开始时间
            end_time: 结束时间

        Returns:
            删除的行数
        """
^
src/data_access/tdengine_access.py:357:1: S608 Possible SQL injection vector through string-based query construction.
        sql = f"""
            DELETE FROM {table_name}
            WHERE ts >= '{start_time.strftime('%Y-%m-%d %H:%M:%S')}'
              AND ts < '{end_time.strftime('%Y-%m-%d %H:%M:%S')}'
        """
^
src/data_access/tdengine_access.py:376:1: D400 First line should end with a period
        """
        获取表信息(行数、时间范围、磁盘占用)

        Args:
            table_name: 表名

        Returns:
            表信息字典
        """
^
src/data_access/tdengine_access.py:387:1: S608 Possible SQL injection vector through string-based query construction.
        sql = f"""
            SELECT
                COUNT(*) as row_count,
                MIN(ts) as start_time,
                MAX(ts) as end_time
            FROM {table_name}
        """
^
src/data_access/tdengine_access.py:415:1: D400 First line should end with a period
        """
        保存数据（DataManager API适配器）

        Args:
            data: 数据DataFrame
            classification: 数据分类（US3架构参数，此处未使用）
            table_name: 表名
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/data_access/tdengine_access.py:418:1: RST210 Inline strong start-string without end-string.
        """
        保存数据（DataManager API适配器）

        Args:
            data: 数据DataFrame
            classification: 数据分类（US3架构参数，此处未使用）
            table_name: 表名
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/data_access/tdengine_access.py:429:80: E501 line too long (81 > 79 characters)
                table_name, data, timestamp_col=kwargs.get("timestamp_col", "ts")
                                                                               ^
src/data_access/tdengine_access.py:437:1: D400 First line should end with a period
        """
        加载数据（DataManager API适配器）

        Args:
            table_name: 表名
            **filters: 过滤条件（如start_time, end_time）

        Returns:
            pd.DataFrame or None: 查询结果
        """
^
src/data_access/tdengine_access.py:440:1: RST210 Inline strong start-string without end-string.
        """
        加载数据（DataManager API适配器）

        Args:
            table_name: 表名
            **filters: 过滤条件（如start_time, end_time）

        Returns:
            pd.DataFrame or None: 查询结果
        """
^
src/data_access/tdengine_access.py:457:80: E501 line too long (85 > 79 characters)
                return self.query_latest(table_name, limit=filters.get("limit", 100))
                                                                               ^
src/data_access/tdengine_access.py:463:1: D400 First line should end with a period
        """关闭连接"""
^
src/data_sources/__init__.py:1:1: D400 First line should end with a period
"""
Data Sources Module

数据源模块，提供统一的数据源管理和访问接口。

核心组件:
- DataSourceFactory: 数据源工厂，负责创建和管理数据源实例
- TdxBinaryParser: 通达信二进制数据解析器
- Mock数据源: 开发和测试使用的模拟数据源
- 真实数据源: TDengine、PostgreSQL等生产数据源

使用示例:
    from src.data_sources import get_timeseries_source, get_relational_source

    # 获取时序数据源（根据环境变量自动选择）
    ts_source = get_timeseries_source()
    quotes = ts_source.get_realtime_quotes(symbols=["600000"])

    # 获取关系数据源
    rel_source = get_relational_source()
    watchlist = rel_source.get_watchlist(user_id=1)

版本: 1.0.0
"""
^
src/data_sources/baostock_importer.py:1:1: D100 Missing docstring in public module
import baostock as bs
^
src/data_sources/baostock_importer.py:13:1: D200 One-line docstring should fit on one line with quotes
    """
    装饰器：自动登录、登出，并在登录失败时返回空DataFrame。
    """
^
src/data_sources/baostock_importer.py:13:1: D400 First line should end with a period
    """
    装饰器：自动登录、登出，并在登录失败时返回空DataFrame。
    """
^
src/data_sources/baostock_importer.py:30:1: D101 Missing docstring in public class
class BaoStockData:
^
src/data_sources/baostock_importer.py:31:1: D107 Missing docstring in __init__
    def __init__(self, log_level=logging.INFO):
^
src/data_sources/baostock_importer.py:47:1: D105 Missing docstring in magic method
    def __del__(self):
^
src/data_sources/baostock_importer.py:52:1: D400 First line should end with a period
        """统一登录方法，返回登录对象"""
^
src/data_sources/baostock_importer.py:60:1: D400 First line should end with a period
        """统一登出方法"""
^
src/data_sources/baostock_importer.py:65:1: D205 1 blank line required between summary line and description
        """
        将baostock的rs对象转换为DataFrame，并处理错误
        :param rs: baostock返回的rs对象
        :param error_msg: 错误时的日志信息
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:65:1: D400 First line should end with a period
        """
        将baostock的rs对象转换为DataFrame，并处理错误
        :param rs: baostock返回的rs对象
        :param error_msg: 错误时的日志信息
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:81:1: D205 1 blank line required between summary line and description
        """
        交易日查询
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认为当前日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:81:1: D400 First line should end with a period
        """
        交易日查询
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认为当前日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:88:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:96:1: D205 1 blank line required between summary line and description
        """
        证券代码查询
        :param day: 需要查询的交易日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:96:1: D400 First line should end with a period
        """
        证券代码查询
        :param day: 需要查询的交易日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:108:1: D205 1 blank line required between summary line and description
        """
        证券基本资料
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param code_name: 股票名称，支持模糊查询
        :return: pandas.DataFrame
        示例: bao.query_stock_basic('300377')
        """
^
src/data_sources/baostock_importer.py:108:1: D400 First line should end with a period
        """
        证券基本资料
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param code_name: 股票名称，支持模糊查询
        :return: pandas.DataFrame
        示例: bao.query_stock_basic('300377')
        """
^
src/data_sources/baostock_importer.py:110:80: E501 line too long (90 > 79 characters)
        """
        证券基本资料
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param code_name: 股票名称，支持模糊查询
        :return: pandas.DataFrame
        示例: bao.query_stock_basic('300377')
        """


                                                    ^
src/data_sources/baostock_importer.py:112:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        证券基本资料
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param code_name: 股票名称，支持模糊查询
        :return: pandas.DataFrame
        示例: bao.query_stock_basic('300377')
        """
^
src/data_sources/baostock_importer.py:121:1: D205 1 blank line required between summary line and description
        """
        统一股票代码格式为 sh.600000、sz.000001
        支持输入 sh.600000、sh600000、600000、SZ000001、000001 等
        """
^
src/data_sources/baostock_importer.py:121:1: D400 First line should end with a period
        """
        统一股票代码格式为 sh.600000、sz.000001
        支持输入 sh.600000、sh600000、600000、SZ000001、000001 等
        """
^
src/data_sources/baostock_importer.py:145:1: D205 1 blank line required between summary line and description
        """
        获取K线数据
        :param symbol: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param timeframe: K线周期，支持"5m","15m","30m","1h","1d","1w","1M"
        :param adj: 复权类型，默认"3"不复权；"2"前复权；"1"后复权
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时取今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时取最近一个交易日
        :return: pandas.DataFrame
        示例: bao.query_history_k_data_plus('300377', '1d', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:145:1: D400 First line should end with a period
        """
        获取K线数据
        :param symbol: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param timeframe: K线周期，支持"5m","15m","30m","1h","1d","1w","1M"
        :param adj: 复权类型，默认"3"不复权；"2"前复权；"1"后复权
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时取今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时取最近一个交易日
        :return: pandas.DataFrame
        示例: bao.query_history_k_data_plus('300377', '1d', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:147:80: E501 line too long (92 > 79 characters)
        """
        获取K线数据
        :param symbol: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param timeframe: K线周期，支持"5m","15m","30m","1h","1d","1w","1M"
        :param adj: 复权类型，默认"3"不复权；"2"前复权；"1"后复权
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时取今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时取最近一个交易日
        :return: pandas.DataFrame
        示例: bao.query_history_k_data_plus('300377', '1d', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                    ^
src/data_sources/baostock_importer.py:152:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        获取K线数据
        :param symbol: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param timeframe: K线周期，支持"5m","15m","30m","1h","1d","1w","1M"
        :param adj: 复权类型，默认"3"不复权；"2"前复权；"1"后复权
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时取今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时取最近一个交易日
        :return: pandas.DataFrame
        示例: bao.query_history_k_data_plus('300377', '1d', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:153:80: E501 line too long (105 > 79 characters)
        """
        获取K线数据
        :param symbol: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param timeframe: K线周期，支持"5m","15m","30m","1h","1d","1w","1M"
        :param adj: 复权类型，默认"3"不复权；"2"前复权；"1"后复权
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时取今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时取最近一个交易日
        :return: pandas.DataFrame
        示例: bao.query_history_k_data_plus('300377', '1d', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                    ^
src/data_sources/baostock_importer.py:172:80: E501 line too long (82 > 79 characters)
            fields = "date,time,code,open,high,low,close,volume,amount,adjustflag"
                                                                               ^
src/data_sources/baostock_importer.py:174:80: E501 line too long (115 > 79 characters)
            fields = "date,code,open,high,low,close,preclose,volume,amount,adjustflag,turn,tradestatus,pctChg,isST"
                                                                               ^
src/data_sources/baostock_importer.py:177:80: E501 line too long (84 > 79 characters)
                "date,code,open,high,low,close,volume,amount,adjustflag,turn,pctChg"
                                                                               ^
src/data_sources/baostock_importer.py:184:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:204:48: N803 argument name 'yearType' should be lowercase
    def query_dividend_data(self, code, year, yearType):
                                               ^
src/data_sources/baostock_importer.py:205:1: D205 1 blank line required between summary line and description
        """
        查询除权除息信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 年份，如：2017
        :param yearType: 年份类别，"report":预案公告年份，"operate":除权除息年份
        :return: pandas.DataFrame
        示例: bao.query_dividend_data('300377', 2023, 'operate')
        """
^
src/data_sources/baostock_importer.py:205:1: D400 First line should end with a period
        """
        查询除权除息信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 年份，如：2017
        :param yearType: 年份类别，"report":预案公告年份，"operate":除权除息年份
        :return: pandas.DataFrame
        示例: bao.query_dividend_data('300377', 2023, 'operate')
        """
^
src/data_sources/baostock_importer.py:207:80: E501 line too long (90 > 79 characters)
        """
        查询除权除息信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 年份，如：2017
        :param yearType: 年份类别，"report":预案公告年份，"operate":除权除息年份
        :return: pandas.DataFrame
        示例: bao.query_dividend_data('300377', 2023, 'operate')
        """


                                                  ^
src/data_sources/baostock_importer.py:210:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        查询除权除息信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 年份，如：2017
        :param yearType: 年份类别，"report":预案公告年份，"operate":除权除息年份
        :return: pandas.DataFrame
        示例: bao.query_dividend_data('300377', 2023, 'operate')
        """
^
src/data_sources/baostock_importer.py:218:1: D205 1 blank line required between summary line and description
        """
        查询复权因子信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        示例: bao.query_adjust_factor('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:218:1: D400 First line should end with a period
        """
        查询复权因子信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        示例: bao.query_adjust_factor('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:220:80: E501 line too long (90 > 79 characters)
        """
        查询复权因子信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        示例: bao.query_adjust_factor('300377', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                  ^
src/data_sources/baostock_importer.py:223:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        查询复权因子信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        示例: bao.query_adjust_factor('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:224:80: E501 line too long (93 > 79 characters)
        """
        查询复权因子信息
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认为今天-7天
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认当前日期
        :return: pandas.DataFrame
        示例: bao.query_adjust_factor('300377', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                  ^
src/data_sources/baostock_importer.py:228:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:232:80: E501 line too long (88 > 79 characters)
        rs = bs.query_adjust_factor(code=code, start_date=start_date, end_date=end_date)
                                                                               ^
src/data_sources/baostock_importer.py:236:1: D205 1 blank line required between summary line and description
        """
        季频盈利能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_profit_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:236:1: D400 First line should end with a period
        """
        季频盈利能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_profit_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:238:80: E501 line too long (90 > 79 characters)
        """
        季频盈利能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_profit_data('300377', year=2023, quarter=2)
        """


                                                    ^
src/data_sources/baostock_importer.py:241:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频盈利能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_profit_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:256:1: D205 1 blank line required between summary line and description
        """
        季频营运能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_operation_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:256:1: D400 First line should end with a period
        """
        季频营运能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_operation_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:258:80: E501 line too long (90 > 79 characters)
        """
        季频营运能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_operation_data('300377', year=2023, quarter=2)
        """


                                                    ^
src/data_sources/baostock_importer.py:261:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频营运能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_operation_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:276:1: D205 1 blank line required between summary line and description
        """
        季频成长能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_growth_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:276:1: D400 First line should end with a period
        """
        季频成长能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_growth_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:278:80: E501 line too long (90 > 79 characters)
        """
        季频成长能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_growth_data('300377', year=2023, quarter=2)
        """


                                                    ^
src/data_sources/baostock_importer.py:281:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频成长能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_growth_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:296:1: D205 1 blank line required between summary line and description
        """
        季频偿债能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_balance_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:296:1: D400 First line should end with a period
        """
        季频偿债能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_balance_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:298:80: E501 line too long (90 > 79 characters)
        """
        季频偿债能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_balance_data('300377', year=2023, quarter=2)
        """


                                                    ^
src/data_sources/baostock_importer.py:301:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频偿债能力
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_balance_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:316:1: D205 1 blank line required between summary line and description
        """
        季频现金流量
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_cash_flow_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:316:1: D400 First line should end with a period
        """
        季频现金流量
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_cash_flow_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:318:80: E501 line too long (90 > 79 characters)
        """
        季频现金流量
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_cash_flow_data('300377', year=2023, quarter=2)
        """


                                                    ^
src/data_sources/baostock_importer.py:321:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频现金流量
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_cash_flow_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:336:1: D205 1 blank line required between summary line and description
        """
        季频杜邦指数
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_dupont_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:336:1: D400 First line should end with a period
        """
        季频杜邦指数
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_dupont_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:338:80: E501 line too long (90 > 79 characters)
        """
        季频杜邦指数
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_dupont_data('300377', year=2023, quarter=2)
        """


                                                    ^
src/data_sources/baostock_importer.py:341:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频杜邦指数
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param year: 统计年份，为空时默认当前年
        :param quarter: 统计季度，可为1,2,3,4，为空时默认当前季度
        :return: pandas.DataFrame
        示例: bao.query_dupont_data('300377', year=2023, quarter=2)
        """
^
src/data_sources/baostock_importer.py:356:1: D205 1 blank line required between summary line and description
        """
        季频公司业绩快报
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_performance_express_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:356:1: D400 First line should end with a period
        """
        季频公司业绩快报
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_performance_express_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:358:80: E501 line too long (90 > 79 characters)
        """
        季频公司业绩快报
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_performance_express_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                  ^
src/data_sources/baostock_importer.py:361:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频公司业绩快报
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_performance_express_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:362:80: E501 line too long (106 > 79 characters)
        """
        季频公司业绩快报
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_performance_express_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                  ^
src/data_sources/baostock_importer.py:371:1: D205 1 blank line required between summary line and description
        """
        季频公司业绩预告
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_forcast_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:371:1: D400 First line should end with a period
        """
        季频公司业绩预告
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_forcast_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:373:80: E501 line too long (90 > 79 characters)
        """
        季频公司业绩预告
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_forcast_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                  ^
src/data_sources/baostock_importer.py:376:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        季频公司业绩预告
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_forcast_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """
^
src/data_sources/baostock_importer.py:377:80: E501 line too long (94 > 79 characters)
        """
        季频公司业绩预告
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化
        :param start_date: 开始日期，格式YYYY-MM-DD
        :param end_date: 结束日期，格式YYYY-MM-DD
        :return: pandas.DataFrame
        示例: bao.query_forcast_report('300377', start_date='2024-01-01', end_date='2024-06-30')
        """


                                                  ^
src/data_sources/baostock_importer.py:380:80: E501 line too long (85 > 79 characters)
        rs = bs.query_forecast_report(code, start_date=start_date, end_date=end_date)
                                                                               ^
src/data_sources/baostock_importer.py:384:1: D205 1 blank line required between summary line and description
        """
        存款利率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:384:1: D400 First line should end with a period
        """
        存款利率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:391:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:395:80: E501 line too long (81 > 79 characters)
        rs = bs.query_deposit_rate_data(start_date=start_date, end_date=end_date)
                                                                               ^
src/data_sources/baostock_importer.py:399:1: D205 1 blank line required between summary line and description
        """
        贷款利率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:399:1: D400 First line should end with a period
        """
        贷款利率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:406:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:414:48: N803 argument name 'yearType' should be lowercase
        self, start_date=None, end_date=None, yearType=None
                                               ^
src/data_sources/baostock_importer.py:416:1: D205 1 blank line required between summary line and description
        """
        存款准备金率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :param yearType: 年份类别，0查询公告日期；1查询生效日期，默认0
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:416:1: D400 First line should end with a period
        """
        存款准备金率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :param yearType: 年份类别，0查询公告日期；1查询生效日期，默认0
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:424:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:428:10: N806 variable 'yearType' in function should be lowercase
        yearType = yearType or "0"
         ^
src/data_sources/baostock_importer.py:435:1: D205 1 blank line required between summary line and description
        """
        货币供应量(月度)
        :param start_date: 开始日期，格式YYYY-MM，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:435:1: D400 First line should end with a period
        """
        货币供应量(月度)
        :param start_date: 开始日期，格式YYYY-MM，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:447:80: E501 line too long (87 > 79 characters)
        rs = bs.query_money_supply_data_month(start_date=start_date, end_date=end_date)
                                                                               ^
src/data_sources/baostock_importer.py:451:1: D205 1 blank line required between summary line and description
        """
        货币供应量(年度)
        :param start_date: 开始日期，格式YYYY，为空时默认不限
        :param end_date: 结束日期，格式YYYY，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:451:1: D400 First line should end with a period
        """
        货币供应量(年度)
        :param start_date: 开始日期，格式YYYY，为空时默认不限
        :param end_date: 结束日期，格式YYYY，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:463:80: E501 line too long (86 > 79 characters)
        rs = bs.query_money_supply_data_year(start_date=start_date, end_date=end_date)
                                                                               ^
src/data_sources/baostock_importer.py:467:1: D205 1 blank line required between summary line and description
        """
        银行间同业拆放利率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:467:1: D400 First line should end with a period
        """
        银行间同业拆放利率
        :param start_date: 开始日期，格式YYYY-MM-DD，为空时默认不限
        :param end_date: 结束日期，格式YYYY-MM-DD，为空时默认不限
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:474:80: E501 line too long (82 > 79 characters)
            start_date = (datetime.now() - timedelta(days=7)).strftime("%Y-%m-%d")
                                                                               ^
src/data_sources/baostock_importer.py:483:1: D205 1 blank line required between summary line and description
        """
        行业分类
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化。为空时返回全量数据
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        示例: bao.query_stock_industry('300377')
        """
^
src/data_sources/baostock_importer.py:483:1: D400 First line should end with a period
        """
        行业分类
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化。为空时返回全量数据
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        示例: bao.query_stock_industry('300377')
        """
^
src/data_sources/baostock_importer.py:485:80: E501 line too long (100 > 79 characters)
        """
        行业分类
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化。为空时返回全量数据
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        示例: bao.query_stock_industry('300377')
        """


                                                      ^
src/data_sources/baostock_importer.py:487:1: RST206 Field list ends without a blank line; unexpected unindent.
        """
        行业分类
        :param code: 股票代码，支持 sh.600000、sz.000001、600000、000001、sh600000、sz300377 等格式，自动标准化。为空时返回全量数据
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        示例: bao.query_stock_industry('300377')
        """
^
src/data_sources/baostock_importer.py:499:1: D205 1 blank line required between summary line and description
        """
        上证50成分股
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:499:1: D400 First line should end with a period
        """
        上证50成分股
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:511:1: D205 1 blank line required between summary line and description
        """
        沪深300成分股
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:511:1: D400 First line should end with a period
        """
        沪深300成分股
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:523:1: D205 1 blank line required between summary line and description
        """
        中证500成分股
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        """
^
src/data_sources/baostock_importer.py:523:1: D400 First line should end with a period
        """
        中证500成分股
        :param date: 查询日期，格式YYYY-MM-DD，为空时默认最新日期
        :return: pandas.DataFrame
        """
^
src/data_sources/factory.py:1:1: D400 First line should end with a period
"""
数据源工厂模块

本模块实现工厂模式，提供统一的数据源实例创建和管理机制。
支持通过环境变量配置切换不同的数据源实现（Mock/Database/API）。

核心功能：
1. 数据源实例化和生命周期管理
2. 环境变量驱动的配置管理
3. 数据源注册和发现机制
4. 单例模式优化避免重复实例化

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/factory.py:50:1: D400 First line should end with a period
    """数据源工厂异常基类"""
^
src/data_sources/factory.py:52:1: D107 Missing docstring in __init__
    def __init__(self, message: str, error_code: str = "FACTORY_ERROR"):
^
src/data_sources/factory.py:52:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, message: str, error_code: str = "FACTORY_ERROR"):
    ^
src/data_sources/factory.py:59:1: D400 First line should end with a period
    """不支持的数据源类型异常"""
^
src/data_sources/factory.py:61:1: D107 Missing docstring in __init__
    def __init__(self, source_type: str, supported_types: list):
^
src/data_sources/factory.py:61:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, source_type: str, supported_types: list):
    ^
src/data_sources/factory.py:70:1: D400 First line should end with a period
    """数据源未注册异常"""
^
src/data_sources/factory.py:72:1: D107 Missing docstring in __init__
    def __init__(self, source_type: str, category: str):
^
src/data_sources/factory.py:72:5: B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
    def __init__(self, source_type: str, category: str):
    ^
src/data_sources/factory.py:74:80: E501 line too long (85 > 79 characters)
            f"Data source '{source_type}' not registered for category '{category}'. "
                                                                               ^
src/data_sources/factory.py:84:1: D400 First line should end with a period
    """
    单例模式装饰器

    确保类只有一个实例，避免重复创建数据源连接。
    使用线程锁保证线程安全。
    """
^
src/data_sources/factory.py:110:1: D400 First line should end with a period
    """
    数据源工厂类

    提供统一的数据源实例创建接口，支持：
    1. 环境变量驱动的数据源类型配置
    2. 数据源实现的动态注册和发现
    3. 单例模式管理，避免重复实例化
    4. 自动降级和容错机制

    使用示例:
        # 获取时序数据源
        ts_source = DataSourceFactory.get_timeseries_source()
        quotes = ts_source.get_realtime_quotes(symbols=["600000"])

        # 获取关系数据源
        rel_source = DataSourceFactory.get_relational_source()
        watchlist = rel_source.get_watchlist(user_id=1)

        # 获取业务数据源
        biz_source = DataSourceFactory.get_business_source()
        dashboard = biz_source.get_dashboard_summary(user_id=1)
    """
^
src/data_sources/factory.py:134:1: D400 First line should end with a period
        """初始化数据源工厂"""
^
src/data_sources/factory.py:156:1: D400 First line should end with a period
        """
        注册时序数据源实现

        Args:
            source_type: 数据源类型标识 (如: "mock", "tdengine", "api")
            source_class: 实现ITimeSeriesDataSource接口的类

        Raises:
            TypeError: source_class未实现ITimeSeriesDataSource接口
        """
^
src/data_sources/factory.py:177:1: D400 First line should end with a period
        """
        注册关系数据源实现

        Args:
            source_type: 数据源类型标识 (如: "mock", "postgresql")
            source_class: 实现IRelationalDataSource接口的类

        Raises:
            TypeError: source_class未实现IRelationalDataSource接口
        """
^
src/data_sources/factory.py:198:1: D400 First line should end with a period
        """
        注册业务数据源实现

        Args:
            source_type: 数据源类型标识 (如: "mock", "composite")
            source_class: 实现IBusinessDataSource接口的类

        Raises:
            TypeError: source_class未实现IBusinessDataSource接口
        """
^
src/data_sources/factory.py:221:1: D400 First line should end with a period
        """
        获取时序数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "tdengine", "api"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            ITimeSeriesDataSource: 时序数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_timeseries_source()

            # 显式指定类型
            source = factory.get_timeseries_source(source_type="mock")

            # 传递额外参数
            source = factory.get_timeseries_source(
                source_type="tdengine",
                host="localhost",
                port=6041
            )
        """
^
src/data_sources/factory.py:226:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取时序数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "tdengine", "api"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            ITimeSeriesDataSource: 时序数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_timeseries_source()

            # 显式指定类型
            source = factory.get_timeseries_source(source_type="mock")

            # 传递额外参数
            source = factory.get_timeseries_source(
                source_type="tdengine",
                host="localhost",
                port=6041
            )
        """
^
src/data_sources/factory.py:226:1: RST210 Inline strong start-string without end-string.
        """
        获取时序数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "tdengine", "api"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            ITimeSeriesDataSource: 时序数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_timeseries_source()

            # 显式指定类型
            source = factory.get_timeseries_source(source_type="mock")

            # 传递额外参数
            source = factory.get_timeseries_source(
                source_type="tdengine",
                host="localhost",
                port=6041
            )
        """
^
src/data_sources/factory.py:244:1: RST301 Unexpected indentation.
        """
        获取时序数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "tdengine", "api"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            ITimeSeriesDataSource: 时序数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_timeseries_source()

            # 显式指定类型
            source = factory.get_timeseries_source(source_type="mock")

            # 传递额外参数
            source = factory.get_timeseries_source(
                source_type="tdengine",
                host="localhost",
                port=6041
            )
        """
^
src/data_sources/factory.py:247:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取时序数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "tdengine", "api"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            ITimeSeriesDataSource: 时序数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_timeseries_source()

            # 显式指定类型
            source = factory.get_timeseries_source(source_type="mock")

            # 传递额外参数
            source = factory.get_timeseries_source(
                source_type="tdengine",
                host="localhost",
                port=6041
            )
        """
^
src/data_sources/factory.py:260:80: E501 line too long (84 > 79 characters)
            raise UnsupportedDataSourceType(source_type, SUPPORTED_TIMESERIES_TYPES)
                                                                               ^
src/data_sources/factory.py:281:1: D400 First line should end with a period
        """
        获取关系数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "postgresql"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            IRelationalDataSource: 关系数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_relational_source()

            # 显式指定类型
            source = factory.get_relational_source(source_type="postgresql")
        """
^
src/data_sources/factory.py:286:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取关系数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "postgresql"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            IRelationalDataSource: 关系数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_relational_source()

            # 显式指定类型
            source = factory.get_relational_source(source_type="postgresql")
        """
^
src/data_sources/factory.py:286:1: RST210 Inline strong start-string without end-string.
        """
        获取关系数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "postgresql"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            IRelationalDataSource: 关系数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_relational_source()

            # 显式指定类型
            source = factory.get_relational_source(source_type="postgresql")
        """
^
src/data_sources/factory.py:313:80: E501 line too long (84 > 79 characters)
            raise UnsupportedDataSourceType(source_type, SUPPORTED_RELATIONAL_TYPES)
                                                                               ^
src/data_sources/factory.py:334:1: D400 First line should end with a period
        """
        获取业务数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "composite"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            IBusinessDataSource: 业务数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_business_source()

            # 显式指定类型
            source = factory.get_business_source(source_type="composite")
        """
^
src/data_sources/factory.py:339:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取业务数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "composite"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            IBusinessDataSource: 业务数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_business_source()

            # 显式指定类型
            source = factory.get_business_source(source_type="composite")
        """
^
src/data_sources/factory.py:339:1: RST210 Inline strong start-string without end-string.
        """
        获取业务数据源实例

        Args:
            source_type: 数据源类型，None时从环境变量读取
                        可选值: "mock", "composite"
            **kwargs: 传递给数据源构造函数的额外参数

        Returns:
            IBusinessDataSource: 业务数据源实例

        Raises:
            UnsupportedDataSourceType: 不支持的数据源类型
            DataSourceNotRegistered: 数据源未注册

        示例:
            # 从环境变量获取 (推荐)
            source = factory.get_business_source()

            # 显式指定类型
            source = factory.get_business_source(source_type="composite")
        """
^
src/data_sources/factory.py:366:80: E501 line too long (82 > 79 characters)
            raise UnsupportedDataSourceType(source_type, SUPPORTED_BUSINESS_TYPES)
                                                                               ^
src/data_sources/factory.py:387:1: D400 First line should end with a period
        """
        列出所有已注册的数据源

        Returns:
            Dict: 包含所有类别的已注册数据源

        示例返回:
            {
                "timeseries": ["mock", "tdengine", "api"],
                "relational": ["mock", "postgresql"],
                "business": ["mock", "composite"]
            }
        """
^
src/data_sources/factory.py:397:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        列出所有已注册的数据源

        Returns:
            Dict: 包含所有类别的已注册数据源

        示例返回:
            {
                "timeseries": ["mock", "tdengine", "api"],
                "relational": ["mock", "postgresql"],
                "business": ["mock", "composite"]
            }
        """
^
src/data_sources/factory.py:407:1: D400 First line should end with a period
        """
        获取当前环境变量配置

        Returns:
            Dict: 当前生效的数据源配置

        示例返回:
            {
                "timeseries": "mock",
                "relational": "postgresql",
                "business": "composite"
            }
        """
^
src/data_sources/factory.py:417:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取当前环境变量配置

        Returns:
            Dict: 当前生效的数据源配置

        示例返回:
            {
                "timeseries": "mock",
                "relational": "postgresql",
                "business": "composite"
            }
        """
^
src/data_sources/factory.py:421:80: E501 line too long (86 > 79 characters)
            "timeseries": os.getenv(ENV_TIMESERIES_SOURCE, DEFAULT_TIMESERIES_SOURCE),
                                                                               ^
src/data_sources/factory.py:422:80: E501 line too long (86 > 79 characters)
            "relational": os.getenv(ENV_RELATIONAL_SOURCE, DEFAULT_RELATIONAL_SOURCE),
                                                                               ^
src/data_sources/factory.py:423:80: E501 line too long (80 > 79 characters)
            "business": os.getenv(ENV_BUSINESS_SOURCE, DEFAULT_BUSINESS_SOURCE),
                                                                               ^
src/data_sources/factory.py:429:1: D400 First line should end with a period
        """
        清除数据源实例缓存

        Args:
            category: 要清除的类别，None时清除所有缓存
                     可选值: "timeseries", "relational", "business"

        使用场景:
            - 数据源配置更改后需要重新创建实例
            - 测试时需要重置数据源状态

        示例:
            # 清除所有缓存
            factory.clear_cache()

            # 只清除时序数据源缓存
            factory.clear_cache(category="timeseries")
        """
^
src/data_sources/factory.py:458:1: D400 First line should end with a period
        """
        注册内置数据源实现

        这里会自动注册所有已实现的数据源类型。
        目前支持Mock数据源，其他数据源在实现后自动注册。
        """
^
src/data_sources/factory.py:466:80: E501 line too long (86 > 79 characters)
            from src.data_sources.mock.timeseries_mock import MockTimeSeriesDataSource
                                                                               ^
src/data_sources/factory.py:473:80: E501 line too long (86 > 79 characters)
            from src.data_sources.mock.relational_mock import MockRelationalDataSource
                                                                               ^
src/data_sources/factory.py:480:80: E501 line too long (82 > 79 characters)
            from src.data_sources.mock.business_mock import MockBusinessDataSource
                                                                               ^
src/data_sources/factory.py:492:80: E501 line too long (85 > 79 characters)
            self.register_timeseries_source("tdengine", TDengineTimeSeriesDataSource)
                                                                               ^
src/data_sources/factory.py:512:80: E501 line too long (83 > 79 characters)
            self.register_business_source("composite", CompositeBusinessDataSource)
                                                                               ^
src/data_sources/factory.py:521:1: D400 First line should end with a period
    """
    便捷函数: 获取时序数据源

    等同于 DataSourceFactory().get_timeseries_source(**kwargs)
    """
^
src/data_sources/factory.py:523:1: RST210 Inline strong start-string without end-string.
    """
    便捷函数: 获取时序数据源

    等同于 DataSourceFactory().get_timeseries_source(**kwargs)
    """
^
src/data_sources/factory.py:530:1: D400 First line should end with a period
    """
    便捷函数: 获取关系数据源

    等同于 DataSourceFactory().get_relational_source(**kwargs)
    """
^
src/data_sources/factory.py:532:1: RST210 Inline strong start-string without end-string.
    """
    便捷函数: 获取关系数据源

    等同于 DataSourceFactory().get_relational_source(**kwargs)
    """
^
src/data_sources/factory.py:539:1: D400 First line should end with a period
    """
    便捷函数: 获取业务数据源

    等同于 DataSourceFactory().get_business_source(**kwargs)
    """
^
src/data_sources/factory.py:541:1: RST210 Inline strong start-string without end-string.
    """
    便捷函数: 获取业务数据源

    等同于 DataSourceFactory().get_business_source(**kwargs)
    """
^
src/data_sources/mock/__init__.py:1:1: D400 First line should end with a period
"""
Mock数据源模块

提供所有数据源接口的Mock实现，用于开发和测试。

核心组件:
- MockTimeSeriesDataSource: 时序数据Mock
- MockRelationalDataSource: 关系数据Mock (待实现)
- MockBusinessDataSource: 业务数据Mock (待实现)

使用示例:
    from src.data_sources.mock import MockTimeSeriesDataSource

    # 创建Mock数据源
    mock_source = MockTimeSeriesDataSource(seed=42)  # 固定种子便于测试

    # 获取实时行情
    quotes = mock_source.get_realtime_quotes(symbols=["600000", "000001"])

版本: 1.0.0
"""
^
src/data_sources/mock/business_mock.py:1:1: D400 First line should end with a period
"""
Mock业务数据源实现

本模块实现IBusinessDataSource接口的Mock版本。
业务数据源协调时序和关系数据源，提供复合查询和业务聚合功能。

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/mock/business_mock.py:23:1: D400 First line should end with a period
    """Mock业务数据源实现"""
^
src/data_sources/mock/business_mock.py:31:1: D400 First line should end with a period
        """
        初始化Mock业务数据源

        Args:
            timeseries_source: 时序数据源实例
            relational_source: 关系数据源实例
            seed: 随机种子
        """
^
src/data_sources/mock/business_mock.py:46:80: E501 line too long (86 > 79 characters)
            from src.data_sources.mock.timeseries_mock import MockTimeSeriesDataSource
                                                                               ^
src/data_sources/mock/business_mock.py:51:80: E501 line too long (86 > 79 characters)
            from src.data_sources.mock.relational_mock import MockRelationalDataSource
                                                                               ^
src/data_sources/mock/business_mock.py:64:1: D400 First line should end with a period
        """获取仪表盘汇总数据"""
^
src/data_sources/mock/business_mock.py:92:80: E501 line too long (81 > 79 characters)
            "market_status": "trading" if datetime.now().hour < 15 else "closed",
                                                                               ^
src/data_sources/mock/business_mock.py:114:1: D400 First line should end with a period
        """获取板块表现"""
^
src/data_sources/mock/business_mock.py:128:80: E501 line too long (81 > 79 characters)
                stocks = self.rel.get_stocks_by_industry(sector["code"], limit=5)
                                                                               ^
src/data_sources/mock/business_mock.py:130:80: E501 line too long (80 > 79 characters)
                stocks = self.rel.get_stocks_by_concept(sector["code"], limit=5)
                                                                               ^
src/data_sources/mock/business_mock.py:133:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            avg_change = round(random.uniform(-5.0, 5.0), 2)
^
src/data_sources/mock/business_mock.py:139:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "up_stocks": random.randint(0, len(stocks)),
^
src/data_sources/mock/business_mock.py:140:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "down_stocks": random.randint(0, len(stocks)),
^
src/data_sources/mock/business_mock.py:144:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "total_amount": round(random.uniform(1000000000, 50000000000), 2),
^
src/data_sources/mock/business_mock.py:144:80: E501 line too long (86 > 79 characters)
                    "total_amount": round(random.uniform(1000000000, 50000000000), 2),
                                                                               ^
src/data_sources/mock/business_mock.py:149:80: E501 line too long (84 > 79 characters)
        sector_performance.sort(key=lambda x: x["avg_change_percent"], reverse=True)
                                                                               ^
src/data_sources/mock/business_mock.py:157:80: E501 line too long (80 > 79 characters)
                    1 for s in sector_performance if s["avg_change_percent"] > 0
                                                                               ^
src/data_sources/mock/business_mock.py:160:80: E501 line too long (80 > 79 characters)
                    1 for s in sector_performance if s["avg_change_percent"] < 0
                                                                               ^
src/data_sources/mock/business_mock.py:174:1: D400 First line should end with a period
        """执行策略回测"""
^
src/data_sources/mock/business_mock.py:177:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            f"BT_{datetime.now().strftime('%Y%m%d%H%M%S')}_{random.randint(1000, 9999)}"
^
src/data_sources/mock/business_mock.py:177:80: E501 line too long (88 > 79 characters)
            f"BT_{datetime.now().strftime('%Y%m%d%H%M%S')}_{random.randint(1000, 9999)}"
                                                                               ^
src/data_sources/mock/business_mock.py:185:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        num_trades = random.randint(10, 50)
^
src/data_sources/mock/business_mock.py:187:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            trade_date = start_date + timedelta(days=random.randint(0, days))
^
src/data_sources/mock/business_mock.py:188:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            symbol = random.choice(symbols)
^
src/data_sources/mock/business_mock.py:193:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "action": random.choice(["buy", "sell"]),
^
src/data_sources/mock/business_mock.py:194:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "price": round(random.uniform(10.0, 100.0), 2),
^
src/data_sources/mock/business_mock.py:195:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "quantity": random.randint(100, 10000),
^
src/data_sources/mock/business_mock.py:197:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "commission": round(random.uniform(5.0, 50.0), 2),
^
src/data_sources/mock/business_mock.py:207:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "quantity": random.randint(100, 5000),
^
src/data_sources/mock/business_mock.py:208:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "avg_cost": round(random.uniform(10.0, 50.0), 2),
^
src/data_sources/mock/business_mock.py:209:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "current_price": round(random.uniform(10.0, 50.0), 2),
^
src/data_sources/mock/business_mock.py:210:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "profit_loss": round(random.uniform(-10000, 50000), 2),
^
src/data_sources/mock/business_mock.py:211:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "profit_loss_percent": round(random.uniform(-20.0, 50.0), 2),
^
src/data_sources/mock/business_mock.py:211:80: E501 line too long (81 > 79 characters)
                    "profit_loss_percent": round(random.uniform(-20.0, 50.0), 2),
                                                                               ^
src/data_sources/mock/business_mock.py:220:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            change = random.uniform(-0.02, 0.03)  # ±2-3%波动
^
src/data_sources/mock/business_mock.py:233:80: E501 line too long (86 > 79 characters)
        final_equity = equity_curve[-1]["equity"] if equity_curve else initial_capital
                                                                               ^
src/data_sources/mock/business_mock.py:247:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "max_drawdown": round(random.uniform(-15.0, -5.0), 2),
^
src/data_sources/mock/business_mock.py:248:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "sharpe_ratio": round(random.uniform(0.5, 2.5), 2),
^
src/data_sources/mock/business_mock.py:249:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "win_rate": round(random.uniform(0.45, 0.65), 2),
^
src/data_sources/mock/business_mock.py:265:1: D400 First line should end with a period
        """获取回测结果"""
^
src/data_sources/mock/business_mock.py:272:80: E501 line too long (81 > 79 characters)
            r for r in self._backtest_results.values() if r["user_id"] == user_id
                                                                               ^
src/data_sources/mock/business_mock.py:286:1: D400 First line should end with a period
        """计算风险指标"""
^
src/data_sources/mock/business_mock.py:292:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "var_1day": round(total_value * random.uniform(0.01, 0.03), 2),
^
src/data_sources/mock/business_mock.py:293:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "var_5day": round(total_value * random.uniform(0.02, 0.05), 2),
^
src/data_sources/mock/business_mock.py:294:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "cvar_1day": round(total_value * random.uniform(0.015, 0.04), 2),
^
src/data_sources/mock/business_mock.py:295:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "volatility_annual": round(random.uniform(0.15, 0.35), 2),
^
src/data_sources/mock/business_mock.py:296:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "beta": round(random.uniform(0.8, 1.2), 2),
^
src/data_sources/mock/business_mock.py:298:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "top1_weight": round(random.uniform(0.15, 0.30), 2),
^
src/data_sources/mock/business_mock.py:299:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "top3_weight": round(random.uniform(0.35, 0.60), 2),
^
src/data_sources/mock/business_mock.py:300:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "top5_weight": round(random.uniform(0.50, 0.80), 2),
^
src/data_sources/mock/business_mock.py:303:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "银行": round(random.uniform(0.0, 0.20), 2),
^
src/data_sources/mock/business_mock.py:304:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "证券": round(random.uniform(0.0, 0.15), 2),
^
src/data_sources/mock/business_mock.py:305:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "医药": round(random.uniform(0.0, 0.10), 2),
^
src/data_sources/mock/business_mock.py:306:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "电子": round(random.uniform(0.0, 0.15), 2),
^
src/data_sources/mock/business_mock.py:307:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "其他": round(random.uniform(0.40, 0.60), 2),
^
src/data_sources/mock/business_mock.py:312:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "sector_rotation": round(random.uniform(-0.05, 0.05) * total_value, 2),
^
src/data_sources/mock/business_mock.py:312:80: E501 line too long (87 > 79 characters)
                "sector_rotation": round(random.uniform(-0.05, 0.05) * total_value, 2),
                                                                               ^
src/data_sources/mock/business_mock.py:321:1: D400 First line should end with a period
        """检查风险预警"""
^
src/data_sources/mock/business_mock.py:328:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            is_triggered = random.choice([True, False, False])  # 33%触发概率
^
src/data_sources/mock/business_mock.py:336:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "trigger_value": round(random.uniform(0.0, 100.0), 2),
^
src/data_sources/mock/business_mock.py:339:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "severity": random.choice(["low", "medium", "high"]),
^
src/data_sources/mock/business_mock.py:353:1: D400 First line should end with a period
        """分析交易信号"""
^
src/data_sources/mock/business_mock.py:365:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            num_signals = random.randint(0, 5)
^
src/data_sources/mock/business_mock.py:368:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    random.choice(symbols)
^
src/data_sources/mock/business_mock.py:370:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    else f"60{random.randint(0, 9999):04d}"
^
src/data_sources/mock/business_mock.py:374:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "signal_id": f"SIG_{datetime.now().strftime('%Y%m%d%H%M%S')}_{random.randint(1000, 9999)}",
^
src/data_sources/mock/business_mock.py:374:80: E501 line too long (115 > 79 characters)
                        "signal_id": f"SIG_{datetime.now().strftime('%Y%m%d%H%M%S')}_{random.randint(1000, 9999)}",
                                                                               ^
src/data_sources/mock/business_mock.py:378:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "signal_type": random.choice(["buy", "sell", "hold"]),
^
src/data_sources/mock/business_mock.py:379:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "signal_strength": round(random.uniform(0.5, 1.0), 2),
^
src/data_sources/mock/business_mock.py:380:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "target_price": round(random.uniform(10.0, 100.0), 2),
^
src/data_sources/mock/business_mock.py:381:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "stop_loss": round(random.uniform(8.0, 15.0), 2),
^
src/data_sources/mock/business_mock.py:382:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "take_profit": round(random.uniform(12.0, 120.0), 2),
^
src/data_sources/mock/business_mock.py:384:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                        "confidence": round(random.uniform(0.6, 0.95), 2),
^
src/data_sources/mock/business_mock.py:392:80: E501 line too long (88 > 79 characters)
        self, user_id: int, portfolio: List[Dict[str, Any]], benchmark: str = "sh000001"
                                                                               ^
src/data_sources/mock/business_mock.py:394:1: D400 First line should end with a period
        """获取组合分析"""
^
src/data_sources/mock/business_mock.py:399:80: E501 line too long (86 > 79 characters)
        total_return = ((total_value / total_cost) - 1) * 100 if total_cost > 0 else 0
                                                                               ^
src/data_sources/mock/business_mock.py:412:80: E501 line too long (87 > 79 characters)
                        round((value / total_value) * 100, 2) if total_value > 0 else 0
                                                                               ^
src/data_sources/mock/business_mock.py:431:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "1day_return": round(random.uniform(-3.0, 3.0), 2),
^
src/data_sources/mock/business_mock.py:432:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "1week_return": round(random.uniform(-5.0, 5.0), 2),
^
src/data_sources/mock/business_mock.py:433:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "1month_return": round(random.uniform(-10.0, 10.0), 2),
^
src/data_sources/mock/business_mock.py:434:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "ytd_return": round(random.uniform(-15.0, 25.0), 2),
^
src/data_sources/mock/business_mock.py:439:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "benchmark_return": round(random.uniform(-5.0, 15.0), 2),
^
src/data_sources/mock/business_mock.py:440:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "alpha": round(random.uniform(-2.0, 5.0), 2),
^
src/data_sources/mock/business_mock.py:441:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "tracking_error": round(random.uniform(2.0, 8.0), 2),
^
src/data_sources/mock/business_mock.py:452:1: D400 First line should end with a period
        """执行归因分析"""
^
src/data_sources/mock/business_mock.py:454:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        total_return = round(random.uniform(-10.0, 20.0), 2)
^
src/data_sources/mock/business_mock.py:459:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "银行": round(random.uniform(-2.0, 3.0), 2),
^
src/data_sources/mock/business_mock.py:460:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "证券": round(random.uniform(-1.0, 4.0), 2),
^
src/data_sources/mock/business_mock.py:461:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "医药": round(random.uniform(-1.5, 2.5), 2),
^
src/data_sources/mock/business_mock.py:462:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "电子": round(random.uniform(-2.0, 5.0), 2),
^
src/data_sources/mock/business_mock.py:463:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "其他": round(random.uniform(-3.0, 3.0), 2),
^
src/data_sources/mock/business_mock.py:466:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "allocation_effect": round(random.uniform(-2.0, 2.0), 2),
^
src/data_sources/mock/business_mock.py:467:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "selection_effect": round(random.uniform(-3.0, 5.0), 2),
^
src/data_sources/mock/business_mock.py:468:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "interaction_effect": round(random.uniform(-1.0, 1.0), 2),
^
src/data_sources/mock/business_mock.py:476:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "contribution": round(random.uniform(-2.0, 5.0), 2),
^
src/data_sources/mock/business_mock.py:477:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "weight_effect": round(random.uniform(-1.0, 1.0), 2),
^
src/data_sources/mock/business_mock.py:478:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "return_effect": round(random.uniform(-2.0, 4.0), 2),
^
src/data_sources/mock/business_mock.py:485:80: E501 line too long (85 > 79 characters)
        self, criteria: Dict[str, Any], sort_by: str = "market_cap", limit: int = 100
                                                                               ^
src/data_sources/mock/business_mock.py:487:1: D400 First line should end with a period
        """执行股票筛选"""
^
src/data_sources/mock/business_mock.py:492:80: E501 line too long (80 > 79 characters)
            stocks = self.rel.get_stocks_by_industry(industry["code"], limit=50)
                                                                               ^
src/data_sources/mock/business_mock.py:506:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "market_cap": round(random.uniform(1000000000, 500000000000), 2),
^
src/data_sources/mock/business_mock.py:506:80: E501 line too long (85 > 79 characters)
                    "market_cap": round(random.uniform(1000000000, 500000000000), 2),
                                                                               ^
src/data_sources/mock/business_mock.py:507:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "pe_ratio": round(random.uniform(5.0, 50.0), 2),
^
src/data_sources/mock/business_mock.py:508:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "pb_ratio": round(random.uniform(0.5, 10.0), 2),
^
src/data_sources/mock/business_mock.py:509:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "roe": round(random.uniform(0.05, 0.30), 2),
^
src/data_sources/mock/business_mock.py:510:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "revenue_growth": round(random.uniform(-0.10, 0.50), 2),
^
src/data_sources/mock/business_mock.py:511:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "profit_margin": round(random.uniform(0.02, 0.30), 2),
^
src/data_sources/mock/business_mock.py:512:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "score": round(random.uniform(60.0, 95.0), 2),
^
src/data_sources/mock/business_mock.py:525:1: D400 First line should end with a period
        """业务数据源健康检查"""
^
src/data_sources/mock/business_mock.py:538:80: E501 line too long (81 > 79 characters)
            "business_metrics": {"total_backtests": len(self._backtest_results)},
                                                                               ^
src/data_sources/mock/relational_mock.py:1:1: D400 First line should end with a period
"""
Mock关系数据源实现

本模块实现IRelationalDataSource接口的Mock版本，用于开发和测试。
使用内存存储模拟PostgreSQL数据库，支持完整的CRUD操作。

核心特性:
1. 内存存储 - 使用字典和列表模拟数据库表
2. 事务支持 - 简化的事务管理（回滚恢复快照）
3. 关联查询 - 支持外键关联（模拟joinedload）
4. 数据持久化 - 可选的JSON文件持久化

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/mock/relational_mock.py:29:1: D400 First line should end with a period
    """
    Mock关系数据源实现

    使用内存存储模拟PostgreSQL关系数据库。
    所有数据存储在内存中，重启后数据会丢失（除非启用持久化）。
    """
^
src/data_sources/mock/relational_mock.py:37:1: D400 First line should end with a period
        """
        初始化Mock关系数据源

        Args:
            seed: 随机种子，设置后每次生成相同数据
            locale: 语言区域，默认中文
        """
^
src/data_sources/mock/relational_mock.py:49:80: E501 line too long (83 > 79 characters)
        self._watchlist: Dict[int, List[Dict]] = {}  # {user_id: [watchlist_items]}
                                                                               ^
src/data_sources/mock/relational_mock.py:56:80: E501 line too long (80 > 79 characters)
        self._stock_industry_map: Dict[str, str] = {}  # {symbol: industry_code}
                                                                               ^
src/data_sources/mock/relational_mock.py:57:80: E501 line too long (87 > 79 characters)
        self._stock_concept_map: Dict[str, List[str]] = {}  # {symbol: [concept_codes]}
                                                                               ^
src/data_sources/mock/relational_mock.py:67:1: D400 First line should end with a period
        """初始化Mock数据"""
^
src/data_sources/mock/relational_mock.py:70:80: E501 line too long (83 > 79 characters)
            symbol = f"6{str(i).zfill(5)}" if i % 2 == 0 else f"0{str(i).zfill(5)}"
                                                                               ^
src/data_sources/mock/relational_mock.py:83:80: E501 line too long (87 > 79 characters)
                    "float_shares": self.fake.random_int(min=50000000, max=5000000000),
                                                                               ^
src/data_sources/mock/relational_mock.py:176:1: D400 First line should end with a period
        """获取用户自选股列表"""
^
src/data_sources/mock/relational_mock.py:185:80: E501 line too long (82 > 79 characters)
                item for item in watchlist if item.get("group_name") == group_name
                                                                               ^
src/data_sources/mock/relational_mock.py:192:80: E501 line too long (80 > 79 characters)
                (s for s in self._stocks if s["symbol"] == item["symbol"]), None
                                                                               ^
src/data_sources/mock/relational_mock.py:213:1: D400 First line should end with a period
        """添加股票到自选股"""
^
src/data_sources/mock/relational_mock.py:215:80: E501 line too long (83 > 79 characters)
        stock_info = next((s for s in self._stocks if s["symbol"] == symbol), None)
                                                                               ^
src/data_sources/mock/relational_mock.py:229:80: E501 line too long (84 > 79 characters)
            (item for item in self._watchlist[user_id] if item["symbol"] == symbol),
                                                                               ^
src/data_sources/mock/relational_mock.py:234:80: E501 line too long (84 > 79 characters)
                f"Stock {symbol} already in watchlist", error_code="DUPLICATE_ENTRY"
                                                                               ^
src/data_sources/mock/relational_mock.py:252:1: D400 First line should end with a period
        """从自选股中删除股票"""
^
src/data_sources/mock/relational_mock.py:258:80: E501 line too long (81 > 79 characters)
            item for item in self._watchlist[user_id] if item["symbol"] != symbol
                                                                               ^
src/data_sources/mock/relational_mock.py:263:80: E501 line too long (82 > 79 characters)
    def update_watchlist_note(self, user_id: int, symbol: str, note: str) -> bool:
                                                                               ^
src/data_sources/mock/relational_mock.py:264:1: D400 First line should end with a period
        """更新自选股备注"""
^
src/data_sources/mock/relational_mock.py:281:1: D400 First line should end with a period
        """获取用户策略配置列表"""
^
src/data_sources/mock/relational_mock.py:301:1: D400 First line should end with a period
        """保存策略配置"""
^
src/data_sources/mock/relational_mock.py:327:1: D400 First line should end with a period
        """更新策略状态"""
^
src/data_sources/mock/relational_mock.py:340:1: D400 First line should end with a period
        """删除策略配置"""
^
src/data_sources/mock/relational_mock.py:359:1: D400 First line should end with a period
        """获取用户风险预警列表"""
^
src/data_sources/mock/relational_mock.py:381:1: D400 First line should end with a period
        """保存风险预警配置"""
^
src/data_sources/mock/relational_mock.py:404:80: E501 line too long (86 > 79 characters)
    def toggle_risk_alert(self, user_id: int, alert_id: str, is_active: bool) -> bool:
                                                                               ^
src/data_sources/mock/relational_mock.py:405:1: D400 First line should end with a period
        """切换风险预警状态"""
^
src/data_sources/mock/relational_mock.py:420:1: D400 First line should end with a period
        """获取用户偏好设置"""
^
src/data_sources/mock/relational_mock.py:443:1: D400 First line should end with a period
        """更新用户偏好设置"""
^
src/data_sources/mock/relational_mock.py:459:1: D400 First line should end with a period
        """获取股票基本信息"""
^
src/data_sources/mock/relational_mock.py:484:80: E501 line too long (83 > 79 characters)
    def search_stocks(self, keyword: str, limit: int = 20) -> List[Dict[str, Any]]:
                                                                               ^
src/data_sources/mock/relational_mock.py:485:1: D400 First line should end with a period
        """搜索股票"""
^
src/data_sources/mock/relational_mock.py:512:1: D400 First line should end with a period
        """获取行业列表"""
^
src/data_sources/mock/relational_mock.py:516:1: D400 First line should end with a period
        """获取概念列表"""
^
src/data_sources/mock/relational_mock.py:522:1: D400 First line should end with a period
        """获取指定行业的股票列表"""
^
src/data_sources/mock/relational_mock.py:523:80: E501 line too long (88 > 79 characters)
        stocks = [stock for stock in self._stocks if stock["industry"] == industry_code]
                                                                               ^
src/data_sources/mock/relational_mock.py:530:1: D400 First line should end with a period
        """获取指定概念的股票列表"""
^
src/data_sources/mock/relational_mock.py:538:80: E501 line too long (80 > 79 characters)
        stocks = [stock for stock in self._stocks if stock["symbol"] in symbols]
                                                                               ^
src/data_sources/mock/relational_mock.py:545:1: D400 First line should end with a period
        """开始事务"""
^
src/data_sources/mock/relational_mock.py:561:1: D400 First line should end with a period
        """提交事务"""
^
src/data_sources/mock/relational_mock.py:572:1: D400 First line should end with a period
        """回滚事务"""
^
src/data_sources/mock/relational_mock.py:583:80: E501 line too long (83 > 79 characters)
            self._user_preferences = self._transaction_snapshot["user_preferences"]
                                                                               ^
src/data_sources/mock/relational_mock.py:591:1: D400 First line should end with a period
        """关系数据源健康检查"""
^
src/data_sources/mock/timeseries_mock.py:1:1: D400 First line should end with a period
"""
Mock时序数据源实现

本模块实现ITimeSeriesDataSource接口的Mock版本，用于开发和测试。
使用faker库生成参数化的随机数据，支持灵活的数据生成。

核心特性:
1. 参数化数据生成 - 可控制数据量、时间范围
2. 真实数据模拟 - 价格、成交量等数据符合实际规律
3. 高性能 - 内存中生成，响应速度快
4. 完整接口实现 - 100%实现ITimeSeriesDataSource

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/mock/timeseries_mock.py:28:1: D400 First line should end with a period
    """
    Mock时序数据源实现

    用于开发测试环境，无需真实数据库连接。
    生成的数据符合实际市场规律，可用于前端开发和集成测试。
    """
^
src/data_sources/mock/timeseries_mock.py:36:1: D400 First line should end with a period
        """
        初始化Mock数据源

        Args:
            seed: 随机种子，设置后每次生成相同数据（便于测试）
            locale: 语言区域，默认中文
        """
^
src/data_sources/mock/timeseries_mock.py:62:1: D400 First line should end with a period
        """生成股票池"""
^
src/data_sources/mock/timeseries_mock.py:75:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "base_price": round(random.uniform(5.0, 300.0), 2),
^
src/data_sources/mock/timeseries_mock.py:81:1: D400 First line should end with a period
        """获取股票基础信息"""
^
src/data_sources/mock/timeseries_mock.py:90:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "base_price": round(random.uniform(5.0, 300.0), 2),
^
src/data_sources/mock/timeseries_mock.py:96:1: D400 First line should end with a period
        """
        生成价格波动

        Args:
            base_price: 基准价格
            volatility: 波动率 (默认2%)

        Returns:
            波动后的价格
        """
^
src/data_sources/mock/timeseries_mock.py:106:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_percent = random.uniform(-volatility, volatility)
^
src/data_sources/mock/timeseries_mock.py:112:80: E501 line too long (85 > 79 characters)
        self, symbols: Optional[List[str]] = None, fields: Optional[List[str]] = None
                                                                               ^
src/data_sources/mock/timeseries_mock.py:114:1: D400 First line should end with a period
        """
        获取实时行情数据

        生成逻辑:
        - 价格基于base_price上下2%波动
        - 成交量在100万到1亿之间
        - 涨跌幅在-10%到+10%之间
        """
^
src/data_sources/mock/timeseries_mock.py:137:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            pre_close = round(base_price * random.uniform(0.98, 1.02), 2)
^
src/data_sources/mock/timeseries_mock.py:144:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            volume = random.randint(1000000, 100000000)
^
src/data_sources/mock/timeseries_mock.py:148:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            high = round(max(price, pre_close) * random.uniform(1.0, 1.05), 2)
^
src/data_sources/mock/timeseries_mock.py:149:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            low = round(min(price, pre_close) * random.uniform(0.95, 1.0), 2)
^
src/data_sources/mock/timeseries_mock.py:150:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            open_price = round(random.uniform(low, high), 2)
^
src/data_sources/mock/timeseries_mock.py:165:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "bid1_volume": random.randint(100, 10000),
^
src/data_sources/mock/timeseries_mock.py:167:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "ask1_volume": random.randint(100, 10000),
^
src/data_sources/mock/timeseries_mock.py:173:80: E501 line too long (88 > 79 characters)
                quote = {k: v for k, v in quote.items() if k in fields or k == "symbol"}
                                                                               ^
src/data_sources/mock/timeseries_mock.py:186:1: D400 First line should end with a period
        """
        获取K线数据

        生成逻辑:
        - 根据interval生成对应数量的K线
        - 价格遵循随机游走模型
        - OHLC关系合理 (high >= close/open >= low)
        """
^
src/data_sources/mock/timeseries_mock.py:216:80: E501 line too long (87 > 79 characters)
        dates = pd.date_range(start=start_time, periods=min(num_bars, 1000), freq=freq)
                                                                               ^
src/data_sources/mock/timeseries_mock.py:230:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            high_price = max(open_price, close_price) * random.uniform(1.0, 1.02)
^
src/data_sources/mock/timeseries_mock.py:230:80: E501 line too long (81 > 79 characters)
            high_price = max(open_price, close_price) * random.uniform(1.0, 1.02)
                                                                               ^
src/data_sources/mock/timeseries_mock.py:231:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            low_price = min(open_price, close_price) * random.uniform(0.98, 1.0)
^
src/data_sources/mock/timeseries_mock.py:231:80: E501 line too long (80 > 79 characters)
            low_price = min(open_price, close_price) * random.uniform(0.98, 1.0)
                                                                               ^
src/data_sources/mock/timeseries_mock.py:234:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            volume = random.randint(1000000, 50000000)
^
src/data_sources/mock/timeseries_mock.py:257:1: D400 First line should end with a period
        """
        获取分时图数据

        生成逻辑:
        - 生成从9:30到15:00的分钟级数据
        - 价格围绕基准价格波动
        - 成交量和成交额累计增长
        """
^
src/data_sources/mock/timeseries_mock.py:307:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            minute_volume = random.randint(10000, 500000)
^
src/data_sources/mock/timeseries_mock.py:333:80: E501 line too long (84 > 79 characters)
        self, symbol: str, start_date: date, end_date: date, flow_type: str = "main"
                                                                               ^
src/data_sources/mock/timeseries_mock.py:335:1: D400 First line should end with a period
        """
        获取资金流向数据

        生成逻辑:
        - 主力资金净流入在-5亿到+5亿之间
        - 超大单、大单、中单、小单比例合理
        """
^
src/data_sources/mock/timeseries_mock.py:351:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            main_net_inflow = random.uniform(-500000000, 500000000)
^
src/data_sources/mock/timeseries_mock.py:357:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            super_net_inflow = main_net_inflow * random.uniform(0.4, 0.7)
^
src/data_sources/mock/timeseries_mock.py:361:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            medium_net_inflow = -main_net_inflow * random.uniform(0.3, 0.6)
^
src/data_sources/mock/timeseries_mock.py:385:1: D400 First line should end with a period
        """
        获取资金流向排名

        生成逻辑:
        - 从股票池中随机选择limit只股票
        - 按资金净流入排序
        """
^
src/data_sources/mock/timeseries_mock.py:396:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        selected_stocks = random.sample(
^
src/data_sources/mock/timeseries_mock.py:405:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            main_net_inflow = random.uniform(-300000000, 300000000)
^
src/data_sources/mock/timeseries_mock.py:411:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            change_percent = round(random.uniform(-10.0, 10.0), 2)
^
src/data_sources/mock/timeseries_mock.py:439:80: E501 line too long (87 > 79 characters)
    def get_market_overview(self, trade_date: Optional[date] = None) -> Dict[str, Any]:
                                                                               ^
src/data_sources/mock/timeseries_mock.py:440:1: D400 First line should end with a period
        """
        获取市场概览数据

        生成逻辑:
        - 总股票数固定
        - 涨跌家数符合正态分布
        - 指数数据真实
        """
^
src/data_sources/mock/timeseries_mock.py:452:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        up_stocks = random.randint(int(total_stocks * 0.3), int(total_stocks * 0.7))
^
src/data_sources/mock/timeseries_mock.py:452:80: E501 line too long (84 > 79 characters)
        up_stocks = random.randint(int(total_stocks * 0.3), int(total_stocks * 0.7))
                                                                               ^
src/data_sources/mock/timeseries_mock.py:453:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        down_stocks = random.randint(0, total_stocks - up_stocks)
^
src/data_sources/mock/timeseries_mock.py:477:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "limit_up_stocks": random.randint(0, 50),
^
src/data_sources/mock/timeseries_mock.py:478:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "limit_down_stocks": random.randint(0, 15),
^
src/data_sources/mock/timeseries_mock.py:479:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "total_volume": random.randint(400000000000, 600000000000),
^
src/data_sources/mock/timeseries_mock.py:480:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "total_amount": round(random.uniform(5000000000000, 7000000000000), 2),
^
src/data_sources/mock/timeseries_mock.py:480:80: E501 line too long (83 > 79 characters)
            "total_amount": round(random.uniform(5000000000000, 7000000000000), 2),
                                                                               ^
src/data_sources/mock/timeseries_mock.py:481:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "avg_change_percent": round(random.uniform(-2.0, 2.0), 2),
^
src/data_sources/mock/timeseries_mock.py:488:1: D400 First line should end with a period
        """获取指数实时数据"""
^
src/data_sources/mock/timeseries_mock.py:502:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            pre_close = round(base_value * random.uniform(0.99, 1.01), 2)
^
src/data_sources/mock/timeseries_mock.py:509:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            open_value = round(random.uniform(low, high), 2)
^
src/data_sources/mock/timeseries_mock.py:522:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "volume": random.randint(200000000000, 300000000000),
^
src/data_sources/mock/timeseries_mock.py:523:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "amount": round(random.uniform(2500000000000, 3500000000000), 2),
^
src/data_sources/mock/timeseries_mock.py:523:80: E501 line too long (85 > 79 characters)
                    "amount": round(random.uniform(2500000000000, 3500000000000), 2),
                                                                               ^
src/data_sources/mock/timeseries_mock.py:533:80: E501 line too long (82 > 79 characters)
        self, symbol: str, start_date: date, end_date: date, indicators: List[str]
                                                                               ^
src/data_sources/mock/timeseries_mock.py:535:1: D400 First line should end with a period
        """
        计算技术指标

        生成逻辑:
        - 先生成K线数据
        - 基于K线计算各类技术指标
        """
^
src/data_sources/mock/timeseries_mock.py:556:80: E501 line too long (83 > 79 characters)
            result_df["MA5"] = result_df["close"].rolling(window=5).mean().round(2)
                                                                               ^
src/data_sources/mock/timeseries_mock.py:559:80: E501 line too long (85 > 79 characters)
            result_df["MA10"] = result_df["close"].rolling(window=10).mean().round(2)
                                                                               ^
src/data_sources/mock/timeseries_mock.py:562:80: E501 line too long (85 > 79 characters)
            result_df["MA20"] = result_df["close"].rolling(window=20).mean().round(2)
                                                                               ^
src/data_sources/mock/timeseries_mock.py:587:1: D400 First line should end with a period
        """获取竞价抢筹数据"""
^
src/data_sources/mock/timeseries_mock.py:591:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        selected_stocks = random.sample(
^
src/data_sources/mock/timeseries_mock.py:600:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            auction_price = round(base_price * random.uniform(0.95, 1.05), 2)
^
src/data_sources/mock/timeseries_mock.py:601:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            auction_volume = random.randint(100000, 5000000)
^
src/data_sources/mock/timeseries_mock.py:617:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    "change_percent": round(random.uniform(-5.0, 5.0), 2),
^
src/data_sources/mock/timeseries_mock.py:631:1: D400 First line should end with a period
        """检查时序数据质量"""
^
src/data_sources/mock/timeseries_mock.py:642:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "missing_records": random.randint(0, 3),
^
src/data_sources/mock/timeseries_mock.py:643:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "completeness_rate": round(random.uniform(96.0, 100.0), 2),
^
src/data_sources/mock/timeseries_mock.py:645:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "quality_score": round(random.uniform(92.0, 100.0), 2),
^
src/data_sources/mock/timeseries_mock.py:650:1: D400 First line should end with a period
        """时序数据源健康检查"""
^
src/data_sources/mock/timeseries_mock.py:654:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "response_time_ms": random.randint(1, 10),
^
src/data_sources/mock/timeseries_mock.py:658:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "total_queries_today": random.randint(1000, 50000),
^
src/data_sources/mock/timeseries_mock.py:659:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "avg_response_time_ms": random.randint(5, 50),
^
src/data_sources/mock/timeseries_mock.py:660:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "error_rate_percent": round(random.uniform(0.0, 0.1), 2),
^
src/data_sources/mock_data_source.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据源实现类
封装现有的Mock函数，适配统一接口标准
"""
^
src/data_sources/mock_data_source.py:1:1: D400 First line should end with a period
"""
Mock数据源实现类
封装现有的Mock函数，适配统一接口标准
"""
^
src/data_sources/mock_data_source.py:21:1: D205 1 blank line required between summary line and description
    """
    Mock数据源实现类
    封装现有的Mock函数，适配统一接口标准
    """
^
src/data_sources/mock_data_source.py:21:1: D400 First line should end with a period
    """
    Mock数据源实现类
    封装现有的Mock函数，适配统一接口标准
    """
^
src/data_sources/mock_data_source.py:27:1: D400 First line should end with a period
        """初始化Mock数据源"""
^
src/data_sources/mock_data_source.py:31:1: D400 First line should end with a period
        """获取股票列表"""
^
src/data_sources/mock_data_source.py:39:1: D400 First line should end with a period
        """获取股票详细信息"""
^
src/data_sources/mock_data_source.py:55:1: D400 First line should end with a period
        """获取实时行情"""
^
src/data_sources/mock_data_source.py:82:80: E501 line too long (82 > 79 characters)
    def get_history_profit(self, stock_code: str, days: int = 30) -> pd.DataFrame:
                                                                               ^
src/data_sources/mock_data_source.py:83:1: D400 First line should end with a period
        """获取历史收益"""
^
src/data_sources/mock_data_source.py:89:1: D400 First line should end with a period
        """获取技术指标"""
^
src/data_sources/mock_data_source.py:118:80: E501 line too long (96 > 79 characters)
                                        "indicator_name": f"{indicator_type}_{name}_{sub_name}",
                                                                               ^
src/data_sources/mock_data_source.py:121:80: E501 line too long (82 > 79 characters)
                                            if isinstance(sub_value, (int, float))
                                                                               ^
src/data_sources/mock_data_source.py:133:80: E501 line too long (81 > 79 characters)
                                    "indicator_name": f"{indicator_type}_{name}",
                                                                               ^
src/data_sources/mock_data_source.py:150:1: D400 First line should end with a period
        """获取所有技术指标"""
^
src/data_sources/mock_data_source.py:154:1: D400 First line should end with a period
        """获取趋势指标"""
^
src/data_sources/mock_data_source.py:158:1: D400 First line should end with a period
        """获取动量指标"""
^
src/data_sources/mock_data_source.py:162:1: D400 First line should end with a period
        """获取波动率指标"""
^
src/data_sources/mock_data_source.py:166:1: D400 First line should end with a period
        """获取成交量指标"""
^
src/data_sources/mock_data_source.py:170:1: D400 First line should end with a period
        """获取交易信号"""
^
src/data_sources/mock_data_source.py:174:1: D400 First line should end with a period
        """获取K线历史数据"""
^
src/data_sources/mock_data_source.py:178:1: D400 First line should end with a period
        """获取形态识别结果"""
^
src/data_sources/mock_data_source.py:182:1: D400 First line should end with a period
        """获取实时告警"""
^
src/data_sources/mock_data_source.py:186:1: D400 First line should end with a period
        """获取监控摘要"""
^
src/data_sources/mock_data_source.py:190:1: D400 First line should end with a period
        """获取监控状态"""
^
src/data_sources/mock_data_source.py:194:1: D400 First line should end with a period
        """获取市场监控数据"""
^
src/data_sources/mock_data_source.py:198:1: D400 First line should end with a period
        """获取预定义查询列表"""
^
src/data_sources/mock_data_source.py:202:1: D400 First line should end with a period
        """执行预定义查询"""
^
src/data_sources/mock_data_source.py:206:1: D400 First line should end with a period
        """执行自定义查询"""
^
src/data_sources/mock_data_source.py:212:1: D400 First line should end with a period
        """获取查询结果"""
^
src/data_sources/mock_data_source.py:216:1: D400 First line should end with a period
        """获取策略定义列表"""
^
src/data_sources/mock_data_source.py:220:1: D400 First line should end with a period
        """单策略运行"""
^
src/data_sources/mock_data_source.py:224:1: D400 First line should end with a period
        """批量策略运行"""
^
src/data_sources/mock_data_source.py:228:1: D400 First line should end with a period
        """获取策略结果"""
^
src/data_sources/mock_data_source.py:232:1: D400 First line should end with a period
        """获取匹配的股票"""
^
src/data_sources/mock_data_source.py:236:1: D400 First line should end with a period
        """获取策略统计"""
^
src/data_sources/mock_data_source.py:240:1: D400 First line should end with a period
        """获取指标列表"""
^
src/data_sources/mock_data_source.py:244:1: D400 First line should end with a period
        """获取指标详情"""
^
src/data_sources/mock_data_source.py:250:1: D400 First line should end with a period
        """获取指标数据表格"""
^
src/data_sources/mock_data_source.py:251:80: E501 line too long (83 > 79 characters)
        return mock_IndicatorLibrary.get_indicator_data(indicator_id, symbol, days)
                                                                               ^
src/data_sources/mock_data_source.py:256:1: D400 First line should end with a period
        """从指定适配器获取数据（统一适配器调用入口）"""
^
src/data_sources/mock_data_source.py:268:1: D400 First line should end with a period
        """使用故障转移机制获取数据"""
^
src/data_sources/real/__init__.py:1:1: D400 First line should end with a period
"""
真实数据源实现模块

提供所有数据源接口的生产级真实实现。

核心组件:
- TDengineTimeSeriesDataSource: TDengine时序数据源
- PostgreSQLRelationalDataSource: PostgreSQL关系数据源
- CompositeBusinessDataSource: 复合业务数据源（整合TDengine + PostgreSQL）

使用示例:
    from src.data_sources.real import (
        TDengineTimeSeriesDataSource,
        PostgreSQLRelationalDataSource,
        CompositeBusinessDataSource
    )

    # 创建TDengine数据源
    td_source = TDengineTimeSeriesDataSource()

    # 获取实时行情
    quotes = td_source.get_realtime_quotes(symbols=["600000", "000001"])

    # 创建PostgreSQL数据源
    pg_source = PostgreSQLRelationalDataSource()

    # 获取自选股
    watchlist = pg_source.get_watchlist(user_id=1001)

    # 创建复合业务数据源
    biz_source = CompositeBusinessDataSource()

    # 获取仪表盘汇总
    dashboard = biz_source.get_dashboard_summary(user_id=1001)

版本: 2.0.0
"""
^
src/data_sources/real/__init__.py:15:1: RST203 Definition list ends without a blank line; unexpected unindent.
"""
真实数据源实现模块

提供所有数据源接口的生产级真实实现。

核心组件:
- TDengineTimeSeriesDataSource: TDengine时序数据源
- PostgreSQLRelationalDataSource: PostgreSQL关系数据源
- CompositeBusinessDataSource: 复合业务数据源（整合TDengine + PostgreSQL）

使用示例:
    from src.data_sources.real import (
        TDengineTimeSeriesDataSource,
        PostgreSQLRelationalDataSource,
        CompositeBusinessDataSource
    )

    # 创建TDengine数据源
    td_source = TDengineTimeSeriesDataSource()

    # 获取实时行情
    quotes = td_source.get_realtime_quotes(symbols=["600000", "000001"])

    # 创建PostgreSQL数据源
    pg_source = PostgreSQLRelationalDataSource()

    # 获取自选股
    watchlist = pg_source.get_watchlist(user_id=1001)

    # 创建复合业务数据源
    biz_source = CompositeBusinessDataSource()

    # 获取仪表盘汇总
    dashboard = biz_source.get_dashboard_summary(user_id=1001)

版本: 2.0.0
"""
^
src/data_sources/real/__init__.py:39:80: E501 line too long (82 > 79 characters)
from src.data_sources.real.tdengine_timeseries import TDengineTimeSeriesDataSource
                                                                               ^
src/data_sources/real/__init__.py:40:80: E501 line too long (86 > 79 characters)
from src.data_sources.real.postgresql_relational import PostgreSQLRelationalDataSource
                                                                               ^
src/data_sources/real/__init__.py:41:80: E501 line too long (80 > 79 characters)
from src.data_sources.real.composite_business import CompositeBusinessDataSource
                                                                               ^
src/data_sources/real/composite_business.py:1:1: D400 First line should end with a period
"""
复合业务数据源实现

本模块实现了IBusinessDataSource接口，整合时序数据源(TDengine)和关系数据源(PostgreSQL)。
负责处理复杂业务逻辑：仪表盘汇总、策略回测、风险分析、持仓归因等。

架构特点:
- 双数据源整合：协调TDengine(时序数据) + PostgreSQL(关系数据)
- 并行查询优化：使用ThreadPoolExecutor加速多源查询
- 业务计算封装：VaR计算、夏普比率、归因分析等
- 缓存优化：热点数据缓存减少数据库查询

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/real/composite_business.py:30:1: D400 First line should end with a period
    """
    复合业务数据源实现

    整合时序数据源和关系数据源，提供复杂业务逻辑支持。

    核心功能:
    - 仪表盘汇总 (2个方法)
    - 策略回测 (2个方法)
    - 风险管理 (2个方法)
    - 交易管理 (3个方法)
    - 数据分析 (1个方法)
    - 健康检查 (1个方法)

    设计模式:
    - 组合模式: 内部持有时序和关系数据源
    - 并行模式: 使用线程池并行查询多个数据源
    - 缓存模式: 缓存热点数据减少数据库访问
    """
^
src/data_sources/real/composite_business.py:50:1: D400 First line should end with a period
        """
        初始化复合业务数据源

        Args:
            max_workers: 并行查询线程池大小
        """
^
src/data_sources/real/composite_business.py:73:1: D400 First line should end with a period
        """
        获取仪表盘汇总数据

        并行查询策略:
        1. 市场概览（来自时序数据源）
        2. 自选股列表（来自关系数据源）
        3. 板块热度（来自时序数据源）
        4. 资金流排名（来自时序数据源）

        然后汇总所有数据返回
        """
^
src/data_sources/real/composite_business.py:128:80: E501 line too long (80 > 79 characters)
                    "last_update": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/data_sources/real/composite_business.py:154:80: E501 line too long (82 > 79 characters)
        self, sector_type: str, trade_date: Optional[date] = None, limit: int = 20
                                                                               ^
src/data_sources/real/composite_business.py:156:1: D400 First line should end with a period
        """
        获取板块表现

        整合关系数据源（行业/概念列表）和时序数据源（成分股行情）
        """
^
src/data_sources/real/composite_business.py:171:80: E501 line too long (87 > 79 characters)
                sectors = self.relational_source.get_industry_list(classification="sw")
                                                                               ^
src/data_sources/real/composite_business.py:213:1: D400 First line should end with a period
        """
        执行策略回测

        步骤:
        1. 从关系数据源获取策略配置
        2. 从时序数据源获取历史K线数据
        3. 执行回测逻辑（简化版）
        4. 计算收益指标
        """
^
src/data_sources/real/composite_business.py:299:1: D400 First line should end with a period
        """
        获取回测结果列表

        简化版本：返回空列表
        生产版本应该从数据库查询历史回测记录
        """
^
src/data_sources/real/composite_business.py:306:80: E501 line too long (80 > 79 characters)
            logger.info(f"获取回测结果: user_id={user_id}, backtest_id={backtest_id}")
                                                                               ^
src/data_sources/real/composite_business.py:321:1: D400 First line should end with a period
        """
        计算风险指标

        使用时序数据计算波动率、VaR等指标
        """
^
src/data_sources/real/composite_business.py:338:80: E501 line too long (81 > 79 characters)
                "calculation_time": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/data_sources/real/composite_business.py:372:1: D400 First line should end with a period
        """
        检查风险预警

        整合关系数据源（预警配置）和时序数据源（实时行情）
        """
^
src/data_sources/real/composite_business.py:413:80: E501 line too long (83 > 79 characters)
                            "message": f"{symbol} {alert_type}触发预警（阈值{threshold}）",
                                                                               ^
src/data_sources/real/composite_business.py:432:1: D400 First line should end with a period
        """
        分析交易信号

        整合策略配置（关系数据源）和历史行情（时序数据源）
        """
^
src/data_sources/real/composite_business.py:470:80: E501 line too long (92 > 79 characters)
                            "signal_id": f"SIG{datetime.now().strftime('%Y%m%d%H%M%S')}{i}",
                                                                               ^
src/data_sources/real/composite_business.py:496:1: D400 First line should end with a period
        """
        获取持仓分析

        简化版本：返回Mock数据
        生产版本应该从持仓表查询实际数据
        """
^
src/data_sources/real/composite_business.py:548:1: D400 First line should end with a period
        """
        执行归因分析

        整合持仓数据、行情数据、市场数据进行收益归因
        """
^
src/data_sources/real/composite_business.py:591:80: E501 line too long (81 > 79 characters)
                "top_detractors": [{"symbol": "600001", "contribution": -0.008}],
                                                                               ^
src/data_sources/real/composite_business.py:610:1: D400 First line should end with a period
        """
        执行股票筛选

        整合股票基础信息（关系数据源）和实时行情（时序数据源）
        """
^
src/data_sources/real/composite_business.py:654:1: D400 First line should end with a period
        """
        业务数据源健康检查

        检查所有依赖数据源的健康状态
        """
^
src/data_sources/real/composite_business.py:662:80: E501 line too long (88 > 79 characters)
                "timeseries": self.executor.submit(self.timeseries_source.health_check),
                                                                               ^
src/data_sources/real/composite_business.py:663:80: E501 line too long (88 > 79 characters)
                "relational": self.executor.submit(self.relational_source.health_check),
                                                                               ^
src/data_sources/real/composite_business.py:694:80: E501 line too long (81 > 79 characters)
                "last_calculation": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/data_sources/real/composite_business.py:706:1: D400 First line should end with a period
        """清理线程池"""
^
src/data_sources/real/postgresql_relational.py:1:1: D400 First line should end with a period
"""
PostgreSQL关系数据源实现

本模块实现了IRelationalDataSource接口，使用PostgreSQL数据库作为后端存储。
负责处理用户配置、策略管理、风险预警、股票基础信息等结构化关系数据。

特性:
- 完整的ACID事务支持
- 高效的JOIN查询
- JSONB字段支持半结构化数据
- 全文搜索 (pg_trgm扩展)
- 连接池管理

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/real/postgresql_relational.py:30:1: D400 First line should end with a period
    """
    PostgreSQL关系数据源实现

    使用PostgreSQL数据库实现IRelationalDataSource接口的所有方法。
    提供生产级的关系数据存储和查询能力。

    核心功能:
    - 自选股管理 (4个方法)
    - 策略配置管理 (4个方法)
    - 风险管理配置 (3个方法)
    - 用户配置管理 (2个方法)
    - 股票基础信息 (2个方法)
    - 行业概念板块 (4个方法)
    - 数据库操作辅助 (4个方法)
    """
^
src/data_sources/real/postgresql_relational.py:47:1: D400 First line should end with a period
        """
        初始化PostgreSQL关系数据源

        Args:
            connection_pool_size: 连接池大小
        """
^
src/data_sources/real/postgresql_relational.py:62:80: E501 line too long (88 > 79 characters)
        self, user_id: int, list_type: str = "favorite", include_stock_info: bool = True
                                                                               ^
src/data_sources/real/postgresql_relational.py:64:1: D400 First line should end with a period
        """
        获取自选股列表

        使用LEFT JOIN避免N+1查询问题，一次查询获取所有数据
        """
^
src/data_sources/real/postgresql_relational.py:104:80: E501 line too long (80 > 79 characters)
                        row[5].strftime("%Y-%m-%d %H:%M:%S") if row[5] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:122:80: E501 line too long (89 > 79 characters)
                f"获取自选股成功: user_id={user_id}, list_type={list_type}, count={len(result)}"
                                                                               ^
src/data_sources/real/postgresql_relational.py:137:1: D400 First line should end with a period
        """
        添加股票到自选列表

        使用INSERT ... ON CONFLICT处理重复插入
        """
^
src/data_sources/real/postgresql_relational.py:157:80: E501 line too long (82 > 79 characters)
            insert_sql = """
                INSERT INTO watchlist (user_id, symbol, list_type, note, added_at)
                VALUES (%s, %s, %s, %s, CURRENT_TIMESTAMP)
                RETURNING id, user_id, symbol, list_type, note, added_at
            """

                                                  ^
src/data_sources/real/postgresql_relational.py:178:80: E501 line too long (85 > 79 characters)
                f"添加自选股成功: user_id={user_id}, symbol={symbol}, list_type={list_type}"
                                                                               ^
src/data_sources/real/postgresql_relational.py:192:1: D400 First line should end with a period
        """
        从自选列表移除股票

        list_type为None时删除所有类型的记录
        """
^
src/data_sources/real/postgresql_relational.py:220:80: E501 line too long (87 > 79 characters)
                f"删除自选股成功: user_id={user_id}, symbol={symbol}, deleted={deleted_count}"
                                                                               ^
src/data_sources/real/postgresql_relational.py:232:1: D200 One-line docstring should fit on one line with quotes
        """
        更新自选股备注
        """
^
src/data_sources/real/postgresql_relational.py:232:1: D400 First line should end with a period
        """
        更新自选股备注
        """
^
src/data_sources/real/postgresql_relational.py:267:1: D400 First line should end with a period
        """
        获取策略配置列表

        支持按策略类型和状态过滤
        """
^
src/data_sources/real/postgresql_relational.py:290:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
                SELECT id, user_id, name, strategy_type, status,
                       parameters, description, created_at, updated_at
                FROM strategy_configs
                WHERE {where_sql}
                ORDER BY updated_at DESC
            """
^
src/data_sources/real/postgresql_relational.py:313:80: E501 line too long (84 > 79 characters)
                            row[7].strftime("%Y-%m-%d %H:%M:%S") if row[7] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:316:80: E501 line too long (84 > 79 characters)
                            row[8].strftime("%Y-%m-%d %H:%M:%S") if row[8] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:339:1: D400 First line should end with a period
        """
        保存策略配置

        使用JSONB字段存储策略参数
        """
^
src/data_sources/real/postgresql_relational.py:371:80: E501 line too long (84 > 79 characters)
                (user_id, name, strategy_type, json.dumps(parameters), description),
                                                                               ^
src/data_sources/real/postgresql_relational.py:404:1: D400 First line should end with a period
        """
        更新策略状态

        包含权限验证（user_id）
        """
^
src/data_sources/real/postgresql_relational.py:435:80: E501 line too long (80 > 79 characters)
            logger.info(f"更新策略状态成功: strategy_id={strategy_id}, status={status}")
                                                                               ^
src/data_sources/real/postgresql_relational.py:446:1: D400 First line should end with a period
        """
        删除策略配置

        包含权限验证（user_id）
        """
^
src/data_sources/real/postgresql_relational.py:489:1: D400 First line should end with a period
        """
        获取风险预警配置

        支持多条件过滤
        """
^
src/data_sources/real/postgresql_relational.py:515:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
                SELECT id, user_id, symbol, alert_type, condition, threshold,
                       notification_methods, enabled, triggered_count,
                       last_triggered, created_at, updated_at
                FROM risk_alerts
                WHERE {where_sql}
                ORDER BY created_at DESC
            """
^
src/data_sources/real/postgresql_relational.py:541:80: E501 line too long (84 > 79 characters)
                            row[9].strftime("%Y-%m-%d %H:%M:%S") if row[9] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:544:80: E501 line too long (86 > 79 characters)
                            row[10].strftime("%Y-%m-%d %H:%M:%S") if row[10] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:547:80: E501 line too long (86 > 79 characters)
                            row[11].strftime("%Y-%m-%d %H:%M:%S") if row[11] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:572:1: D400 First line should end with a period
        """
        保存风险预警配置

        使用JSONB存储通知方式数组
        """
^
src/data_sources/real/postgresql_relational.py:590:80: E501 line too long (80 > 79 characters)
            insert_sql = """
                INSERT INTO risk_alerts
                (user_id, symbol, alert_type, condition, threshold,
                 notification_methods, enabled, triggered_count,
                 created_at, updated_at)
                VALUES (%s, %s, %s, %s, %s, %s::jsonb, %s, 0,
                        CURRENT_TIMESTAMP, CURRENT_TIMESTAMP)
                RETURNING id, user_id, symbol, alert_type, condition, threshold,
                          notification_methods, enabled, created_at
            """


          ^
src/data_sources/real/postgresql_relational.py:631:80: E501 line too long (84 > 79 characters)
    def toggle_risk_alert(self, alert_id: int, user_id: int, enabled: bool) -> bool:
                                                                               ^
src/data_sources/real/postgresql_relational.py:632:1: D400 First line should end with a period
        """
        启用/禁用风险预警

        包含权限验证
        """
^
src/data_sources/real/postgresql_relational.py:670:1: D400 First line should end with a period
        """
        获取用户偏好设置

        JSONB字段自动反序列化为dict
        """
^
src/data_sources/real/postgresql_relational.py:703:80: E501 line too long (87 > 79 characters)
                "updated_at": row[4].strftime("%Y-%m-%d %H:%M:%S") if row[4] else None,
                                                                               ^
src/data_sources/real/postgresql_relational.py:719:1: D400 First line should end with a period
        """
        更新用户偏好设置

        支持部分更新（使用JSONB的||运算符合并）
        """
^
src/data_sources/real/postgresql_relational.py:735:80: E501 line too long (86 > 79 characters)
                set_clauses.append("display_settings = display_settings || %s::jsonb")
                                                                               ^
src/data_sources/real/postgresql_relational.py:740:80: E501 line too long (80 > 79 characters)
                    "notification_settings = notification_settings || %s::jsonb"
                                                                               ^
src/data_sources/real/postgresql_relational.py:745:80: E501 line too long (86 > 79 characters)
                set_clauses.append("trading_settings = trading_settings || %s::jsonb")
                                                                               ^
src/data_sources/real/postgresql_relational.py:756:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
                INSERT INTO user_preferences (user_id, display_settings, notification_settings, trading_settings, updated_at)
                VALUES (%s, '{{}}'::jsonb, '{{}}'::jsonb, '{{}}'::jsonb, CURRENT_TIMESTAMP)
                ON CONFLICT (user_id) DO UPDATE SET {set_sql}
            """
^
src/data_sources/real/postgresql_relational.py:757:80: E501 line too long (125 > 79 characters)
            sql = f"""
                INSERT INTO user_preferences (user_id, display_settings, notification_settings, trading_settings, updated_at)
                VALUES (%s, '{{}}'::jsonb, '{{}}'::jsonb, '{{}}'::jsonb, CURRENT_TIMESTAMP)
                ON CONFLICT (user_id) DO UPDATE SET {set_sql}
            """

                                                        ^
src/data_sources/real/postgresql_relational.py:758:80: E501 line too long (91 > 79 characters)
            sql = f"""
                INSERT INTO user_preferences (user_id, display_settings, notification_settings, trading_settings, updated_at)
                VALUES (%s, '{{}}'::jsonb, '{{}}'::jsonb, '{{}}'::jsonb, CURRENT_TIMESTAMP)
                ON CONFLICT (user_id) DO UPDATE SET {set_sql}
            """

                                                        ^
src/data_sources/real/postgresql_relational.py:786:1: D400 First line should end with a period
        """
        获取股票基础信息

        支持批量查询和多条件过滤
        """
^
src/data_sources/real/postgresql_relational.py:814:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
                SELECT symbol, name, pinyin, market, industry, sector,
                       list_date, total_shares, float_shares, status, updated_at
                FROM stock_basic_info
                WHERE {where_sql}
                ORDER BY symbol
            """
^
src/data_sources/real/postgresql_relational.py:816:80: E501 line too long (80 > 79 characters)
            sql = f"""
                SELECT symbol, name, pinyin, market, industry, sector,
                       list_date, total_shares, float_shares, status, updated_at
                FROM stock_basic_info
                WHERE {where_sql}
                ORDER BY symbol
            """

                                                        ^
src/data_sources/real/postgresql_relational.py:835:80: E501 line too long (85 > 79 characters)
                        "list_date": row[6].strftime("%Y-%m-%d") if row[6] else None,
                                                                               ^
src/data_sources/real/postgresql_relational.py:840:80: E501 line too long (86 > 79 characters)
                            row[10].strftime("%Y-%m-%d %H:%M:%S") if row[10] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:855:80: E501 line too long (83 > 79 characters)
    def search_stocks(self, keyword: str, limit: int = 20) -> List[Dict[str, Any]]:
                                                                               ^
src/data_sources/real/postgresql_relational.py:856:1: D400 First line should end with a period
        """
        搜索股票

        使用pg_trgm扩展支持模糊搜索和拼音搜索
        优先级: 代码匹配 > 名称匹配 > 拼音匹配
        """
^
src/data_sources/real/postgresql_relational.py:927:80: E501 line too long (84 > 79 characters)
    def get_industry_list(self, classification: str = "sw") -> List[Dict[str, Any]]:
                                                                               ^
src/data_sources/real/postgresql_relational.py:928:1: D400 First line should end with a period
        """
        获取行业分类列表

        支持申万、证监会、中金等分类标准
        """
^
src/data_sources/real/postgresql_relational.py:938:80: E501 line too long (94 > 79 characters)
            sql = """
                SELECT code, name, classification, level, parent_code, stock_count, updated_at
                FROM industry_classification
                WHERE classification = %s
                ORDER BY level, code
            """

                                                         ^
src/data_sources/real/postgresql_relational.py:958:80: E501 line too long (84 > 79 characters)
                            row[6].strftime("%Y-%m-%d %H:%M:%S") if row[6] else None
                                                                               ^
src/data_sources/real/postgresql_relational.py:967:80: E501 line too long (81 > 79 characters)
                f"获取行业列表成功: classification={classification}, count={len(result)}"
                                                                               ^
src/data_sources/real/postgresql_relational.py:976:1: D200 One-line docstring should fit on one line with quotes
        """
        获取概念板块列表
        """
^
src/data_sources/real/postgresql_relational.py:976:1: D400 First line should end with a period
        """
        获取概念板块列表
        """
^
src/data_sources/real/postgresql_relational.py:1000:80: E501 line too long (86 > 79 characters)
                        "updated_at": row[4].strftime("%Y-%m-%d") if row[4] else None,
                                                                               ^
src/data_sources/real/postgresql_relational.py:1015:1: D400 First line should end with a period
        """
        获取行业成分股

        通过stock_industry_mapping关联查询
        """
^
src/data_sources/real/postgresql_relational.py:1041:80: E501 line too long (80 > 79 characters)
                f"获取行业成分股成功: industry_code={industry_code}, count={len(result)}"
                                                                               ^
src/data_sources/real/postgresql_relational.py:1050:1: D400 First line should end with a period
        """
        获取概念成分股

        通过stock_concept_mapping关联查询
        """
^
src/data_sources/real/postgresql_relational.py:1087:1: D400 First line should end with a period
        """
        开始事务

        返回数据库连接对象用于事务控制
        """
^
src/data_sources/real/postgresql_relational.py:1102:1: D200 One-line docstring should fit on one line with quotes
        """
        提交事务
        """
^
src/data_sources/real/postgresql_relational.py:1102:1: D400 First line should end with a period
        """
        提交事务
        """
^
src/data_sources/real/postgresql_relational.py:1115:1: D200 One-line docstring should fit on one line with quotes
        """
        回滚事务
        """
^
src/data_sources/real/postgresql_relational.py:1115:1: D400 First line should end with a period
        """
        回滚事务
        """
^
src/data_sources/real/postgresql_relational.py:1128:1: D400 First line should end with a period
        """
        PostgreSQL关系数据源健康检查

        返回连接状态、连接池信息、性能指标
        """
^
src/data_sources/real/tdengine_timeseries.py:1:1: D400 First line should end with a period
"""
TDengine时序数据源实现

基于TDengine超表实现ITimeSeriesDataSource接口。
专门处理高频时序数据的查询和存储。

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/data_sources/real/tdengine_timeseries.py:21:1: D400 First line should end with a period
    """
    TDengine时序数据源实现

    基于TDengine超表存储和查询高频市场数据：
    - tick_data: Tick级成交数据
    - minute_kline: 分钟K线
    - daily_kline: 日K线
    - fund_flow: 资金流向
    - index_realtime: 指数实时行情
    """
^
src/data_sources/real/tdengine_timeseries.py:33:1: D400 First line should end with a period
        """
        初始化TDengine时序数据源

        Args:
            connection_pool_size: 连接池大小
            timeout: 查询超时时间(秒)
        """
^
src/data_sources/real/tdengine_timeseries.py:47:1: D400 First line should end with a period
        """
        获取实时行情

        从minute_kline超表查询最新1分钟K线作为实时行情。

        Args:
            symbols: 股票代码列表 (如: ["600000", "000001"])
            fields: 返回字段列表

        Returns:
            实时行情列表

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:69:80: E501 line too long (80 > 79 characters)
                df = self.td_access.query_latest(table_name=table_name, limit=1)
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:98:80: E501 line too long (81 > 79 characters)
                change_pct = (change / pre_close * 100) if pre_close > 0 else 0.0
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:140:1: D400 First line should end with a period
        """
        获取K线数据

        Args:
            symbol: 股票代码
            period: 周期 (1m/5m/15m/30m/60m/daily/weekly/monthly)
            start_date: 开始日期
            end_date: 结束日期
            limit: 返回数量限制
            adjust: 复权类型 (qfq前复权/hfq后复权/None不复权)

        Returns:
            K线数据列表

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:227:1: D400 First line should end with a period
        """
        获取分时图数据

        从minute_kline超表获取指定交易日的分钟数据。

        Args:
            symbol: 股票代码
            trade_date: 交易日期 (None表示今天)

        Returns:
            分时数据列表

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:271:80: E501 line too long (88 > 79 characters)
                    row["amount"] / row["volume"] if row["volume"] > 0 else row["close"]
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:305:1: D400 First line should end with a period
        """
        获取资金流向

        从fund_flow超表查询指定日期的资金流向数据。

        Args:
            symbol: 股票代码
            trade_date: 交易日期 (None表示最新)

        Returns:
            资金流向数据

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:336:80: E501 line too long (80 > 79 characters)
                df = self.td_access.query_latest(table_name=table_name, limit=1)
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:382:1: D400 First line should end with a period
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向 (inflow净流入/outflow净流出)
            limit: 返回数量

        Returns:
            资金流向排名列表

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:420:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
                SELECT symbol, {field}, net_inflow_rate, ts
                FROM fund_flow
                WHERE ts >= '{start_time.strftime('%Y-%m-%d %H:%M:%S')}'
                  AND ts < '{end_time.strftime('%Y-%m-%d %H:%M:%S')}'
                ORDER BY {field} {order}
                LIMIT {limit}
            """
^
src/data_sources/real/tdengine_timeseries.py:458:1: D400 First line should end with a period
        """
        获取市场概览

        聚合查询所有股票的最新数据，统计涨跌家数。

        Returns:
            市场概览数据

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:475:80: E501 line too long (83 > 79 characters)
            sql = """
                SELECT symbol, last(close) as price, last(change_pct) as change_pct
                FROM daily_kline
                WHERE ts >= NOW - 1d
                GROUP BY symbol
            """

                                                         ^
src/data_sources/real/tdengine_timeseries.py:527:80: E501 line too long (81 > 79 characters)
    def get_index_realtime(self, index_codes: List[str]) -> List[Dict[str, Any]]:
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:528:1: D400 First line should end with a period
        """
        获取指数实时行情

        从index_realtime超表查询指数最新数据。

        Args:
            index_codes: 指数代码列表

        Returns:
            指数实时行情列表

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:550:80: E501 line too long (80 > 79 characters)
                df = self.td_access.query_latest(table_name=table_name, limit=1)
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:596:1: D400 First line should end with a period
        """
        计算技术指标

        基于K线数据计算常用技术指标。

        Args:
            symbol: 股票代码
            indicators: 指标列表 (MA5/MA10/MA20/MACD/KDJ/RSI/BOLL)
            period: K线周期
            count: 计算数据点数

        Returns:
            技术指标数据

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:652:80: E501 line too long (88 > 79 characters)
        self, symbol: str, trade_date: Optional[date] = None, auction_type: str = "open"
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:654:1: D400 First line should end with a period
        """
        获取竞价数据

        Args:
            symbol: 股票代码
            trade_date: 交易日期
            auction_type: 竞价类型 (open开盘竞价/close收盘竞价)

        Returns:
            竞价数据

        Raises:
            DataSourceQueryError: 查询失败
            DataSourceDataNotFound: 数据不存在
        """
^
src/data_sources/real/tdengine_timeseries.py:702:80: E501 line too long (83 > 79 characters)
                    query_params={"symbol": symbol, "trade_date": str(trade_date)},
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:713:80: E501 line too long (85 > 79 characters)
                "volume": int(row.get("bid1_volume", 0) + row.get("ask1_volume", 0)),
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:714:80: E501 line too long (88 > 79 characters)
                "bid_volumes": [int(row.get(f"bid{i}_volume", 0)) for i in range(1, 6)],
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:715:80: E501 line too long (88 > 79 characters)
                "ask_volumes": [int(row.get(f"ask{i}_volume", 0)) for i in range(1, 6)],
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:736:1: D400 First line should end with a period
        """
        检查时序数据质量

        检查指定时间范围内的数据完整性、准确性和新鲜度。

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            数据质量报告

        Raises:
            DataSourceQueryError: 查询失败
        """
^
src/data_sources/real/tdengine_timeseries.py:770:80: E501 line too long (88 > 79 characters)
                (actual_records / expected_records * 100) if expected_records > 0 else 0
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:812:80: E501 line too long (85 > 79 characters)
                                "issue": f"abnormal_change_{row['change_pct']:.2f}%",
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:852:1: D400 First line should end with a period
        """
        健康检查

        Returns:
            健康状态信息
        """
^
src/data_sources/real/tdengine_timeseries.py:892:1: D400 First line should end with a period
        """
        获取子表名称

        Args:
            stable_name: 超表名
            symbol: 股票/指数代码
            is_index: 是否为指数

        Returns:
            子表名称
        """
^
src/data_sources/real/tdengine_timeseries.py:916:1: D400 First line should end with a period
        """
        获取股票名称（从缓存或数据库）

        Args:
            symbol: 股票代码

        Returns:
            股票名称
        """
^
src/data_sources/real/tdengine_timeseries.py:930:1: D400 First line should end with a period
        """
        获取指数名称

        Args:
            index_code: 指数代码

        Returns:
            指数名称
        """
^
src/data_sources/real/tdengine_timeseries.py:947:80: E501 line too long (86 > 79 characters)
    def _get_pre_close(self, symbol: str, trade_date: Optional[date] = None) -> float:
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:948:1: D400 First line should end with a period
        """
        获取昨收价

        Args:
            symbol: 股票代码
            trade_date: 交易日期

        Returns:
            昨收价
        """
^
src/data_sources/real/tdengine_timeseries.py:986:1: D400 First line should end with a period
        """
        计算移动平均

        Args:
            data: 价格数据
            period: 周期

        Returns:
            MA值列表
        """
^
src/data_sources/real/tdengine_timeseries.py:1004:45: E203 whitespace before ':'
                ma = sum(data[i - period + 1 : i + 1]) / period
                                            ^
src/data_sources/real/tdengine_timeseries.py:1010:80: E501 line too long (80 > 79 characters)
        self, data: List[float], fast: int = 12, slow: int = 26, signal: int = 9
                                                                               ^
src/data_sources/real/tdengine_timeseries.py:1012:1: D400 First line should end with a period
        """
        计算MACD指标

        Args:
            data: 价格数据
            fast: 快线周期
            slow: 慢线周期
            signal: 信号线周期

        Returns:
            MACD数据
        """
^
src/data_sources/real/tdengine_timeseries.py:1055:1: D400 First line should end with a period
        """
        计算指数移动平均

        Args:
            data: 价格数据
            period: 周期

        Returns:
            EMA值列表
        """
^
src/data_sources/real_data_source.py:1:1: D205 1 blank line required between summary line and description
"""
真实数据源实现类
对接数据库，适配统一接口标准
"""
^
src/data_sources/real_data_source.py:1:1: D400 First line should end with a period
"""
真实数据源实现类
对接数据库，适配统一接口标准
"""
^
src/data_sources/real_data_source.py:18:1: D205 1 blank line required between summary line and description
    """
    真实数据源实现类
    对接数据库，适配统一接口标准
    """
^
src/data_sources/real_data_source.py:18:1: D400 First line should end with a period
    """
    真实数据源实现类
    对接数据库，适配统一接口标准
    """
^
src/data_sources/real_data_source.py:24:1: D400 First line should end with a period
        """
        安全调用数据库方法，处理连接异常

        Args:
            method_name: 方法名称（用于日志）
            method: 要调用的方法
            *args: 位置参数
            **kwargs: 关键字参数

        Returns:
            方法调用结果或默认值
        """
^
src/data_sources/real_data_source.py:27:1: RST213 Inline emphasis start-string without end-string.
        """
        安全调用数据库方法，处理连接异常

        Args:
            method_name: 方法名称（用于日志）
            method: 要调用的方法
            *args: 位置参数
            **kwargs: 关键字参数

        Returns:
            方法调用结果或默认值
        """
^
src/data_sources/real_data_source.py:27:1: RST210 Inline strong start-string without end-string.
        """
        安全调用数据库方法，处理连接异常

        Args:
            method_name: 方法名称（用于日志）
            method: 要调用的方法
            *args: 位置参数
            **kwargs: 关键字参数

        Returns:
            方法调用结果或默认值
        """
^
src/data_sources/real_data_source.py:49:1: D400 First line should end with a period
        """获取股票列表"""
^
src/data_sources/real_data_source.py:50:80: E501 line too long (83 > 79 characters)
        return self._safe_call("get_stock_list", db_service.get_stock_list, params)
                                                                               ^
src/data_sources/real_data_source.py:53:1: D400 First line should end with a period
        """获取股票详细信息"""
^
src/data_sources/real_data_source.py:59:1: D400 First line should end with a period
        """获取实时行情"""
^
src/data_sources/real_data_source.py:68:1: D400 First line should end with a period
        """获取技术指标"""
^
src/data_sources/real_data_source.py:69:80: E501 line too long (87 > 79 characters)
        params = {"symbol": stock_code, "start_date": start_date, "end_date": end_date}
                                                                               ^
src/data_sources/real_data_source.py:71:80: E501 line too long (83 > 79 characters)
            "get_technical_indicators", db_service.get_technical_indicators, params
                                                                               ^
src/data_sources/real_data_source.py:74:80: E501 line too long (82 > 79 characters)
    def get_history_profit(self, stock_code: str, days: int = 30) -> pd.DataFrame:
                                                                               ^
src/data_sources/real_data_source.py:75:1: D400 First line should end with a period
        """获取历史收益"""
^
src/data_sources/real_data_source.py:80:1: D400 First line should end with a period
        """获取所有技术指标"""
^
src/data_sources/real_data_source.py:88:1: D400 First line should end with a period
        """获取趋势指标"""
^
src/data_sources/real_data_source.py:94:1: D400 First line should end with a period
        """获取动量指标"""
^
src/data_sources/real_data_source.py:96:80: E501 line too long (85 > 79 characters)
            "get_momentum_indicators", db_service.get_momentum_indicators, stock_code
                                                                               ^
src/data_sources/real_data_source.py:100:1: D400 First line should end with a period
        """获取波动率指标"""
^
src/data_sources/real_data_source.py:108:1: D400 First line should end with a period
        """获取成交量指标"""
^
src/data_sources/real_data_source.py:110:80: E501 line too long (81 > 79 characters)
            "get_volume_indicators", db_service.get_volume_indicators, stock_code
                                                                               ^
src/data_sources/real_data_source.py:114:1: D400 First line should end with a period
        """获取交易信号"""
^
src/data_sources/real_data_source.py:120:1: D400 First line should end with a period
        """获取K线历史数据"""
^
src/data_sources/real_data_source.py:122:80: E501 line too long (85 > 79 characters)
            "get_stock_history", db_service.get_stock_history, {"symbol": stock_code}
                                                                               ^
src/data_sources/real_data_source.py:126:1: D400 First line should end with a period
        """获取形态识别结果"""
^
src/data_sources/real_data_source.py:128:80: E501 line too long (85 > 79 characters)
            "get_pattern_recognition", db_service.get_pattern_recognition, stock_code
                                                                               ^
src/data_sources/real_data_source.py:132:1: D400 First line should end with a period
        """获取实时告警"""
^
src/data_sources/real_data_source.py:138:1: D400 First line should end with a period
        """获取监控摘要"""
^
src/data_sources/real_data_source.py:144:1: D400 First line should end with a period
        """获取监控状态"""
^
src/data_sources/real_data_source.py:150:1: D400 First line should end with a period
        """获取市场监控数据"""
^
src/data_sources/real_data_source.py:156:1: D400 First line should end with a period
        """获取预定义查询列表"""
^
src/data_sources/real_data_source.py:161:1: D400 First line should end with a period
        """执行预定义查询"""
^
src/data_sources/real_data_source.py:167:1: D400 First line should end with a period
        """执行自定义查询"""
^
src/data_sources/real_data_source.py:175:1: D400 First line should end with a period
        """获取查询结果"""
^
src/data_sources/real_data_source.py:182:1: D400 First line should end with a period
        """获取策略定义列表"""
^
src/data_sources/real_data_source.py:188:1: D400 First line should end with a period
        """单策略运行"""
^
src/data_sources/real_data_source.py:193:1: D400 First line should end with a period
        """批量策略运行"""
^
src/data_sources/real_data_source.py:198:1: D400 First line should end with a period
        """获取策略结果"""
^
src/data_sources/real_data_source.py:204:1: D400 First line should end with a period
        """获取匹配的股票"""
^
src/data_sources/real_data_source.py:209:1: D400 First line should end with a period
        """获取策略统计"""
^
src/data_sources/real_data_source.py:215:1: D400 First line should end with a period
        """获取指标列表"""
^
src/data_sources/real_data_source.py:220:1: D400 First line should end with a period
        """获取指标详情"""
^
src/data_sources/real_data_source.py:227:1: D400 First line should end with a period
        """获取指标数据表格"""
^
src/data_sources/real_data_source.py:239:1: D400 First line should end with a period
        """从指定适配器获取数据（统一适配器调用入口）"""
^
src/data_sources/real_data_source.py:251:1: D400 First line should end with a period
        """使用故障转移机制获取数据"""
^
src/data_sources/real_data_source.py:263:1: D400 First line should end with a period
        """获取分钟K线数据"""
^
src/data_sources/real_data_source.py:275:1: D400 First line should end with a period
        """获取行业分类数据"""
^
src/data_sources/real_data_source.py:282:1: D400 First line should end with a period
        """获取概念分类数据"""
^
src/data_sources/real_data_source.py:284:80: E501 line too long (87 > 79 characters)
        return self._safe_call("get_concept_classify", db_service.get_concept_classify)
                                                                               ^
src/data_sources/real_data_source.py:287:1: D400 First line should end with a period
        """获取个股的行业和概念分类信息"""
^
src/data_sources/real_data_source.py:290:80: E501 line too long (87 > 79 characters)
            "get_stock_industry_concept", db_service.get_stock_industry_concept, symbol
                                                                               ^
src/data_sources/tdx/read_tdx_block.py:1:1: D100 Missing docstring in public module
## -*- coding: utf-8 -*-
^
src/data_sources/tdx/read_tdx_block.py:1:1: E266 too many leading '#' for block comment
## -*- coding: utf-8 -*-
^
src/data_sources/tdx/read_tdx_block.py:28:1: D400 First line should end with a period
    """file= block_gn.dat, _fg.dat, _zs.dat"""
^
src/data_sources/tdx/read_tdx_block.py:40:27: E203 whitespace before ':'
    blocks = [blk[i * 2813 : (i + 1) * 2813] for i in range(head[1])]
                          ^
src/data_sources/tdx/read_tdx_block.py:45:21: E203 whitespace before ':'
        stks = bk[13 : (12 + 7 * num)].decode("gbk").split("\x00")
                    ^
src/data_sources/tdx/read_tdx_block.py:54:1: D103 Missing docstring in public function
def read_file_loc(file_name, splits):
^
src/data_sources/tdx/read_tdx_block.py:61:1: D103 Missing docstring in public function
def get_block_zs_tdx_loc(block="hy"):
^
src/data_sources/tdx/read_tdx_block.py:65:80: E501 line too long (83 > 79 characters)
    mapping = {"hy": "2", "dq": "3", "gn": "4", "fg": "5", "yjhy": "12", "zs": "6"}
                                                                               ^
src/data_sources/tdx/read_tdx_block.py:66:80: E501 line too long (86 > 79 characters)
    df = pd.DataFrame(buf_line, columns=["name", "code", "type", "t1", "t2", "block"])
                                                                               ^
src/data_sources/tdx/read_tdx_block.py:76:1: D103 Missing docstring in public function
def get_stock_hyblock_tdx_loc():
^
src/data_sources/tdx/read_tdx_block.py:81:5: F841 local variable 'mapping' is assigned to but never used
    mapping = {"0": "sz.", "1": "sh.", "2": "bj."}
    ^
src/data_sources/tdx/read_tdx_block.py:85:80: E501 line too long (81 > 79 characters)
    df = pd.DataFrame(buf_lis, columns=["c0", "code", "block", "c1", "c2", "c3"])
                                                                               ^
src/data_sources/tdx/read_tdx_block.py:93:1: D103 Missing docstring in public function
def hy_block(blk="hy"):
^
src/data_sources/tdx/read_tdx_day_file.py:4:1: D205 1 blank line required between summary line and description
"""
Created on Wed Mar  5 13:28:29 2025
@author: CHENGJUN
"""
^
src/data_sources/tdx/read_tdx_day_file.py:4:1: D400 First line should end with a period
"""
Created on Wed Mar  5 13:28:29 2025
@author: CHENGJUN
"""
^
src/data_sources/tdx/read_tdx_day_file.py:15:1: D400 First line should end with a period
    """
    读取日线文件并解析数据。

    参数：
    file_path (str): 日线文件的路径。

    返回值：
    list: 解析后的数据列表，每个元素是一个字典，包含日期、开盘价、最高价、最低价、收盘价、成交额和成交量。
    """
^
src/data_sources/tdx_binary_parser.py:1:1: D400 First line should end with a period
"""
TDX二进制文件解析器 (TDX Binary File Parser)

功能说明:
- 解析通达信本地二进制数据文件
- 支持日线(.day)、5分钟(.lc5)、1分钟(.lc1)数据
- 自动处理前后复权
- 增量读取和缓存优化

文件格式说明:
- 日线数据(.day): 每条记录32字节
  - date (4字节): YYYYMMDD格式
  - open, high, low, close (各4字节): 价格×1000
  - amount (4字节): 成交金额
  - volume (4字节): 成交量
  - reserved (4字节): 保留字段

- 分钟数据(.lc5/.lc1): 每条记录32字节
  - date (2字节): 年份-1900
  - minute (2字节): 分钟偏移
  - open, high, low, close (各4字节): 价格×1000
  - amount (4字节): 成交金额
  - volume (4字节): 成交量

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/data_sources/tdx_binary_parser.py:11:1: RST301 Unexpected indentation.
"""
TDX二进制文件解析器 (TDX Binary File Parser)

功能说明:
- 解析通达信本地二进制数据文件
- 支持日线(.day)、5分钟(.lc5)、1分钟(.lc1)数据
- 自动处理前后复权
- 增量读取和缓存优化

文件格式说明:
- 日线数据(.day): 每条记录32字节
  - date (4字节): YYYYMMDD格式
  - open, high, low, close (各4字节): 价格×1000
  - amount (4字节): 成交金额
  - volume (4字节): 成交量
  - reserved (4字节): 保留字段

- 分钟数据(.lc5/.lc1): 每条记录32字节
  - date (2字节): 年份-1900
  - minute (2字节): 分钟偏移
  - open, high, low, close (各4字节): 价格×1000
  - amount (4字节): 成交金额
  - volume (4字节): 成交量

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/data_sources/tdx_binary_parser.py:39:1: D400 First line should end with a period
    """
    TDX二进制文件解析器

    功能:
    - 读取.day日线数据
    - 读取.lc5五分钟数据
    - 读取.lc1一分钟数据
    - 自动识别市场和股票代码
    - 支持前后复权
    """
^
src/data_sources/tdx_binary_parser.py:57:1: D400 First line should end with a period
        """
        初始化TDX二进制解析器

        参数:
            data_path: TDX数据目录路径（默认从环境变量TDX_DATA_PATH读取）
        """
^
src/data_sources/tdx_binary_parser.py:92:1: D400 First line should end with a period
        """
        读取日线数据

        参数:
            symbol: 股票代码（如 '600000' 或 'sh600000'）
            start_date: 开始日期（可选）
            end_date: 结束日期（可选）

        返回:
            pd.DataFrame: 日线数据，包含 date, open, high, low, close, volume, amount

        示例:
            >>> parser = TdxBinaryParser()
            >>> data = parser.read_day_data('600000', start_date=date(2024, 1, 1))
            >>> print(data.head())
        """
^
src/data_sources/tdx_binary_parser.py:105:80: E501 line too long (82 > 79 characters)
        """
        读取日线数据

        参数:
            symbol: 股票代码（如 '600000' 或 'sh600000'）
            start_date: 开始日期（可选）
            end_date: 结束日期（可选）

        返回:
            pd.DataFrame: 日线数据，包含 date, open, high, low, close, volume, amount

        示例:
            >>> parser = TdxBinaryParser()
            >>> data = parser.read_day_data('600000', start_date=date(2024, 1, 1))
            >>> print(data.head())
        """




                                       ^
src/data_sources/tdx_binary_parser.py:144:1: D400 First line should end with a period
        """
        读取5分钟数据

        参数:
            symbol: 股票代码
            start_date: 开始日期（可选）
            end_date: 结束日期（可选）

        返回:
            pd.DataFrame: 5分钟数据
        """
^
src/data_sources/tdx_binary_parser.py:173:80: E501 line too long (81 > 79 characters)
                    data["datetime"] < pd.Timestamp(end_date) + timedelta(days=1)
                                                                               ^
src/data_sources/tdx_binary_parser.py:189:1: D400 First line should end with a period
        """
        读取1分钟数据

        参数:
            symbol: 股票代码
            start_date: 开始日期（可选）
            end_date: 结束日期（可选）

        返回:
            pd.DataFrame: 1分钟数据
        """
^
src/data_sources/tdx_binary_parser.py:218:80: E501 line too long (81 > 79 characters)
                    data["datetime"] < pd.Timestamp(end_date) + timedelta(days=1)
                                                                               ^
src/data_sources/tdx_binary_parser.py:229:1: D400 First line should end with a period
        """
        列出指定市场的所有可用股票

        参数:
            market: 市场代码 ('sh' 或 'sz')

        返回:
            list: 股票代码列表
        """
^
src/data_sources/tdx_binary_parser.py:251:44: E203 whitespace before ':'
                    code = code[len(market) :]
                                           ^
src/data_sources/tdx_binary_parser.py:258:1: D400 First line should end with a period
        """
        获取指定股票的最新数据日期

        参数:
            symbol: 股票代码

        返回:
            date: 最新数据日期，如果没有数据则返回None
        """
^
src/data_sources/tdx_binary_parser.py:275:1: D400 First line should end with a period
        """
        解析股票代码，提取市场和代码

        参数:
            symbol: 股票代码（如 '600000' 或 'sh600000'）

        返回:
            tuple: (market, code)
        """
^
src/data_sources/tdx_binary_parser.py:299:1: D400 First line should end with a period
        """获取日线文件路径"""
^
src/data_sources/tdx_binary_parser.py:305:1: D400 First line should end with a period
        """获取5分钟文件路径"""
^
src/data_sources/tdx_binary_parser.py:310:1: D400 First line should end with a period
        """获取1分钟文件路径"""
^
src/data_sources/tdx_binary_parser.py:315:1: D400 First line should end with a period
        """
        解析日线二进制文件

        日线数据结构（32字节）：
        - date (4字节): YYYYMMDD格式的整数
        - open (4字节): 开盘价×1000
        - high (4字节): 最高价×1000
        - low (4字节): 最低价×1000
        - close (4字节): 收盘价×1000
        - amount (4字节): 成交金额（元）
        - volume (4字节): 成交量（手）
        - reserved (4字节): 保留字段
        """
^
src/data_sources/tdx_binary_parser.py:382:80: E501 line too long (81 > 79 characters)
    def _parse_min_file(self, file_path: str, interval: int = 5) -> pd.DataFrame:
                                                                               ^
src/data_sources/tdx_binary_parser.py:383:1: D400 First line should end with a period
        """
        解析分钟线二进制文件

        分钟数据结构（32字节）：
        - year (2字节): 年份-1900
        - minute (2字节): 从当日0点开始的分钟数
        - open (4字节): 开盘价×1000
        - high (4字节): 最高价×1000
        - low (4字节): 最低价×1000
        - close (4字节): 收盘价×1000
        - amount (4字节): 成交金额
        - volume (4字节): 成交量
        - reserved (4字节): 保留
        """
^
src/data_sources/tdx_binary_parser.py:479:80: E501 line too long (81 > 79 characters)
        day_data = parser.read_day_data(test_symbol, start_date=date(2024, 1, 1))
                                                                               ^
src/data_sources/tdx_binary_parser.py:483:19: F541 f-string is missing placeholders
            print(f"\n  最近5天数据:")
                  ^
src/data_sources/tdx_binary_parser.py:487:19: F541 f-string is missing placeholders
            print(f"\n测试3: 获取最新数据日期")
                  ^
src/data_sources/tdx_importer.py:1:1: D400 First line should end with a period
"""
TDX数据增量导入器 (TDX Incremental Importer)

功能说明:
- 从TDX本地文件增量导入数据到MyStocks数据库
- 通过5-tier数据分类自动路由到对应数据库
- 支持断点续传和增量更新
- 批量处理优化性能

数据路由策略:
- 日线/分钟线数据 → TDengine (时序数据库)
- 导入记录元数据 → MySQL (元数据库)

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/data_sources/tdx_importer.py:24:1: E402 module level import not at top of file
import pandas as pd
^
src/data_sources/tdx_importer.py:25:1: E402 module level import not at top of file
from typing import Dict, List, Optional
^
src/data_sources/tdx_importer.py:26:1: E402 module level import not at top of file
from datetime import date, datetime, timedelta
^
src/data_sources/tdx_importer.py:27:1: E402 module level import not at top of file
from dataclasses import dataclass
^
src/data_sources/tdx_importer.py:28:1: E402 module level import not at top of file
import logging
^
src/data_sources/tdx_importer.py:29:1: E402 module level import not at top of file
from tqdm import tqdm
^
src/data_sources/tdx_importer.py:31:1: E402 module level import not at top of file
from src.data_sources.tdx_binary_parser import TdxBinaryParser
^
src/data_sources/tdx_importer.py:32:1: E402 module level import not at top of file
from src.core import DataClassification
^
src/data_sources/tdx_importer.py:37:1: D400 First line should end with a period
    """导入任务配置"""
^
src/data_sources/tdx_importer.py:49:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/data_sources/tdx_importer.py:55:1: D400 First line should end with a period
    """
    TDX数据增量导入器

    功能:
    - 自动扫描TDX数据文件
    - 增量导入到数据库
    - 支持断点续传
    - 进度跟踪和日志
    """
^
src/data_sources/tdx_importer.py:66:1: D400 First line should end with a period
        """
        初始化TDX导入器

        参数:
            unified_manager: MyStocksUnifiedManager实例（如果为None则不保存到数据库）
            data_path: TDX数据路径
        """
^
src/data_sources/tdx_importer.py:100:1: D400 First line should end with a period
        """
        导入指定市场的日线数据

        参数:
            market: 市场代码 ('sh' 或 'sz')
            start_date: 开始日期（可选，默认全部）
            end_date: 结束日期（可选，默认到最新）
            symbols: 指定股票列表（可选，默认全部）
            batch_size: 批量处理大小

        返回:
            dict: 导入统计信息

        示例:
            >>> from unified_manager import MyStocksUnifiedManager
            >>> manager = MyStocksUnifiedManager()
            >>> importer = TdxImporter(unified_manager=manager)
            >>> result = importer.import_market_daily('sh', start_date=date(2024, 1, 1))
            >>> print(f"成功导入 {result['success_count']} 只股票")
        """
^
src/data_sources/tdx_importer.py:117:80: E501 line too long (88 > 79 characters)
        """
        导入指定市场的日线数据

        参数:
            market: 市场代码 ('sh' 或 'sz')
            start_date: 开始日期（可选，默认全部）
            end_date: 结束日期（可选，默认到最新）
            symbols: 指定股票列表（可选，默认全部）
            batch_size: 批量处理大小

        返回:
            dict: 导入统计信息

        示例:
            >>> from unified_manager import MyStocksUnifiedManager
            >>> manager = MyStocksUnifiedManager()
            >>> importer = TdxImporter(unified_manager=manager)
            >>> result = importer.import_market_daily('sh', start_date=date(2024, 1, 1))
            >>> print(f"成功导入 {result['success_count']} 只股票")
        """




                                  ^
src/data_sources/tdx_importer.py:135:38: E203 whitespace before ':'
            batch_symbols = symbols[i : i + batch_size]
                                     ^
src/data_sources/tdx_importer.py:151:80: E501 line too long (86 > 79 characters)
                            symbol=symbol, data=data, data_type="daily", market=market
                                                                               ^
src/data_sources/tdx_importer.py:168:80: E501 line too long (85 > 79 characters)
    def import_incremental(self, market: str = "sh", lookback_days: int = 7) -> Dict:
                                                                               ^
src/data_sources/tdx_importer.py:169:1: D400 First line should end with a period
        """
        增量导入（只导入最近N天的数据）

        参数:
            market: 市场代码
            lookback_days: 回溯天数（默认7天）

        返回:
            dict: 导入统计
        """
^
src/data_sources/tdx_importer.py:191:1: D400 First line should end with a period
        """
        保存数据到数据库（通过5-tier数据分类路由）

        参数:
            symbol: 股票代码
            data: 数据DataFrame
            data_type: 数据类型 ('daily', '5min', '1min')
            market: 市场
        """
^
src/data_sources/tdx_importer.py:232:1: D400 First line should end with a period
        """
        获取导入进度

        参数:
            market: 市场代码

        返回:
            dict: 进度信息
                - total_symbols: 总股票数
                - imported_symbols: 已导入数
                - latest_date: 最新数据日期
        """
^
src/data_sources/tdx_importer.py:269:1: D400 First line should end with a period
        """打印导入统计摘要"""
^
src/data_sources/tdx_importer.py:270:80: E501 line too long (86 > 79 characters)
        duration = (self.stats["end_time"] - self.stats["start_time"]).total_seconds()
                                                                               ^
src/data_sources/tdx_importer.py:304:15: F541 f-string is missing placeholders
        print(f"  ✓ 示例最新日期:")
              ^
src/data_sources/tdx_importer.py:320:11: F541 f-string is missing placeholders
    print(f"\n  ✓ 测试完成:")
          ^
src/database/database_service.py:1:1: D205 1 blank line required between summary line and description
"""
通用数据库服务模块
为所有路由提供真实数据库查询服务，确保与Mock数据接口一致

作者: MyStocks项目组
创建日期: 2025-11-15
"""
^
src/database/database_service.py:1:1: D400 First line should end with a period
"""
通用数据库服务模块
为所有路由提供真实数据库查询服务，确保与Mock数据接口一致

作者: MyStocks项目组
创建日期: 2025-11-15
"""
^
src/database/database_service.py:14:1: E402 module level import not at top of file
import logging
^
src/database/database_service.py:15:1: E402 module level import not at top of file
import pandas as pd
^
src/database/database_service.py:16:1: E402 module level import not at top of file
from typing import Dict, List, Optional, Union
^
src/database/database_service.py:17:1: E402 module level import not at top of file
from datetime import datetime
^
src/database/database_service.py:20:1: E402 module level import not at top of file
from src.data_access import PostgreSQLDataAccess
^
src/database/database_service.py:29:1: D400 First line should end with a period
    """通用数据库服务类"""
^
src/database/database_service.py:32:1: D400 First line should end with a period
        """初始化数据库服务"""
^
src/database/database_service.py:38:1: D400 First line should end with a period
        """获取股票列表（支持按交易所筛选，支持分页）

        Args:
            params: Dict - 查询参数：
                    exchange: Optional[str] - 交易所筛选（sh=上交所，sz=深交所）
                    limit: int - 每页数量，默认20
                    offset: int - 偏移量，默认0

        Returns:
            List[Dict]: 股票列表数据，与Mock数据格式一致
        """
^
src/database/database_service.py:97:80: E501 line too long (80 > 79 characters)
            total_count = total_df.iloc[0]["total"] if not total_df.empty else 0
                                                                               ^
src/database/database_service.py:126:1: D400 First line should end with a period
        """获取股票详细信息

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 股票详细信息，与Mock数据格式一致
        """
^
src/database/database_service.py:168:1: D400 First line should end with a period
        """获取实时行情

        Args:
            symbols: List[str] - 股票代码列表

        Returns:
            List[Dict]: 实时行情数据列表，与Mock数据格式一致
        """
^
src/database/database_service.py:209:80: E501 line too long (84 > 79 characters)
                            "change_percent": float(row.get("change_percent", 0.0)),
                                                                               ^
src/database/database_service.py:217:80: E501 line too long (86 > 79 characters)
                                row.get("timestamp", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:233:1: D400 First line should end with a period
        """执行问财查询

        Args:
            query_params: Dict - 查询参数

        Returns:
            Dict: 查询结果，与Mock数据格式一致
        """
^
src/database/database_service.py:266:80: E501 line too long (84 > 79 characters)
                            "change_percent": float(row.get("change_percent", 0.0)),
                                                                               ^
src/database/database_service.py:268:80: E501 line too long (80 > 79 characters)
                            "market_value": float(row.get("market_value", 0.0)),
                                                                               ^
src/database/database_service.py:305:1: D400 First line should end with a period
        """获取技术指标

        Args:
            params: Dict - 查询参数：
                    symbol: str - 股票代码
                    start_date: str - 开始日期
                    end_date: str - 结束日期

        Returns:
            List[Dict]: 技术指标数据列表，与Mock数据格式一致
        """
^
src/database/database_service.py:370:80: E501 line too long (84 > 79 characters)
                    if indicator_name.startswith("MA") or indicator_name.startswith(
                                                                               ^
src/database/database_service.py:376:80: E501 line too long (87 > 79 characters)
                    elif indicator_name.startswith("RSI") or indicator_name.startswith(
                                                                               ^
src/database/database_service.py:402:80: E501 line too long (81 > 79 characters)
    def get_monitoring_alerts(self, params: Optional[Dict] = None) -> List[Dict]:
                                                                               ^
src/database/database_service.py:403:1: D400 First line should end with a period
        """获取监控告警

        Args:
            params: Dict - 查询参数

        Returns:
            List[Dict]: 告警数据列表，与Mock数据格式一致
        """
^
src/database/database_service.py:459:80: E501 line too long (86 > 79 characters)
                                row.get("timestamp", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:474:1: D400 First line should end with a period
        """获取监控摘要

        Returns:
            Dict: 监控摘要数据，与Mock数据格式一致
        """
^
src/database/database_service.py:500:1: D400 First line should end with a period
        """获取趋势指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 趋势指标数据，与Mock数据格式一致
        """
^
src/database/database_service.py:530:1: D400 First line should end with a period
        """获取动量指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 动量指标数据，与Mock数据格式一致
        """
^
src/database/database_service.py:560:1: D400 First line should end with a period
        """获取波动率指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 波动率指标数据，与Mock数据格式一致
        """
^
src/database/database_service.py:590:1: D400 First line should end with a period
        """获取成交量指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 成交量指标数据，与Mock数据格式一致
        """
^
src/database/database_service.py:620:1: D400 First line should end with a period
        """获取所有技术指标

        Args:
            params: Dict - 查询参数：
                    stock_code: str - 股票代码

        Returns:
            Dict: 所有技术指标数据，包含趋势、动量、波动率、成交量等指标
        """
^
src/database/database_service.py:636:80: E501 line too long (82 > 79 characters)
            technical_data = self.get_technical_indicators({"symbol": stock_code})
                                                                               ^
src/database/database_service.py:656:1: D400 First line should end with a period
        """获取形态识别结果

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 形态识别结果
        """
^
src/database/database_service.py:685:80: E501 line too long (80 > 79 characters)
                            "target_price": float(row.get("target_price", 0.0)),
                                                                               ^
src/database/database_service.py:689:80: E501 line too long (87 > 79 characters)
                                row.get("created_at", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:707:1: D400 First line should end with a period
        """获取交易信号

        Args:
            symbol: str - 股票代码

        Returns:
            Dict: 交易信号数据
        """
^
src/database/database_service.py:751:1: D400 First line should end with a period
        """获取股票历史数据

        Args:
            params: Dict - 查询参数

        Returns:
            Dict: 股票历史数据
        """
^
src/database/database_service.py:771:80: E501 line too long (81 > 79 characters)
                f"stock_history_{period}" if period != "daily" else "daily_kline"
                                                                               ^
src/database/database_service.py:789:80: E501 line too long (84 > 79 characters)
                        row["date"].strftime("%Y-%m-%d") for _, row in df.iterrows()
                                                                               ^
src/database/database_service.py:791:80: E501 line too long (83 > 79 characters)
                    "data": df[["open", "close", "high", "low", "volume"]].to_dict(
                                                                               ^
src/database/database_service.py:811:1: D400 First line should end with a period
        """批量获取技术指标

        Args:
            symbols: List[str] - 股票代码列表

        Returns:
            Dict: 批量技术指标数据
        """
^
src/database/database_service.py:836:1: D400 First line should end with a period
        """获取策略定义列表

        Returns:
            Dict: 策略定义列表，与Mock数据格式一致
        """
^
src/database/database_service.py:860:80: E501 line too long (87 > 79 characters)
                                row.get("created_at", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:865:80: E501 line too long (87 > 79 characters)
                                row.get("updated_at", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:880:1: D400 First line should end with a period
        """获取策略执行结果

        Args:
            params: Dict - 查询参数

        Returns:
            Dict: 策略结果数据，与Mock数据格式一致
        """
^
src/database/database_service.py:918:80: E501 line too long (87 > 79 characters)
                                row.get("created_at", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:938:1: D400 First line should end with a period
        """获取策略性能统计

        Returns:
            Dict: 策略性能数据，与Mock数据格式一致
        """
^
src/database/database_service.py:965:80: E501 line too long (88 > 79 characters)
                        latest_row.get("last_updated", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:978:1: D400 First line should end with a period
        """获取监控状态

        Returns:
            Dict: 监控状态信息，与Mock数据格式一致
        """
^
src/database/database_service.py:986:80: E501 line too long (86 > 79 characters)
            df = self.postgresql_access.query(table_name="monitoring_status", limit=1)
                                                                               ^
src/database/database_service.py:1001:80: E501 line too long (80 > 79 characters)
                        row.get("last_update", "").strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/database_service.py:1005:80: E501 line too long (80 > 79 characters)
                    "monitored_symbols": int(row.get("monitored_symbols", 100)),
                                                                               ^
src/database/database_service.py:1015:80: E501 line too long (80 > 79 characters)
                "start_time": (datetime.now() - pd.Timedelta(hours=8)).strftime(
                                                                               ^
src/database/database_service.py:1031:80: E501 line too long (80 > 79 characters)
                "start_time": (datetime.now() - pd.Timedelta(hours=8)).strftime(
                                                                               ^
src/database/database_service.py:1041:1: D400 First line should end with a period
        """获取市场监控数据

        Returns:
            Dict: 市场监控数据，与Mock数据格式一致
        """
^
src/database/database_service.py:1049:80: E501 line too long (81 > 79 characters)
                table_name="monitoring_logs", limit=100, order_by="log_time DESC"
                                                                               ^
src/database/database_service.py:1087:1: D400 First line should end with a period
        """从指定适配器获取数据

        Args:
            adapter_type: str - 适配器类型 (akshare, tdx, baostock, tushare等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/database/database_service.py:1090:1: RST210 Inline strong start-string without end-string.
        """从指定适配器获取数据

        Args:
            adapter_type: str - 适配器类型 (akshare, tdx, baostock, tushare等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/database/database_service.py:1153:1: D400 First line should end with a period
        """使用故障转移机制获取数据

        Args:
            data_type: str - 数据类型 (realtime_quote, daily_kline等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/database/database_service.py:1156:1: RST210 Inline strong start-string without end-string.
        """使用故障转移机制获取数据

        Args:
            data_type: str - 数据类型 (realtime_quote, daily_kline等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/database/database_service.py:1200:80: E501 line too long (87 > 79 characters)
                    result = self.get_data_from_adapter(adapter_type, method, **kwargs)
                                                                               ^
src/database/database_service.py:1234:1: D400 First line should end with a period
        """检查适配器返回结果是否有效

        Args:
            result: 适配器返回的结果

        Returns:
            bool: 结果是否有效
        """
^
src/database/database_service.py:1256:1: D400 First line should end with a period
        """获取指标数据表格

        Args:
            indicator_id: str - 指标ID
            symbol: str - 股票代码
            days: int - 天数

        Returns:
            pd.DataFrame: 指标数据表格
        """
^
src/database/database_service.py:1268:80: E501 line too long (87 > 79 characters)
            where_clause = f"symbol = '{symbol}' AND indicator_name = '{indicator_id}'"
                                                                               ^
src/database/database_service.py:1279:80: E501 line too long (82 > 79 characters)
                    columns={"calc_date": "date", "indicator_value": indicator_id}
                                                                               ^
src/database/database_service.py:1291:1: D400 First line should end with a period
        """获取分钟K线数据

        Args:
            symbol: str - 股票代码
            period: str - 周期 (1m/5m/15m/30m/60m)
            start_date: str - 开始日期
            end_date: str - 结束日期

        Returns:
            pd.DataFrame: 分钟K线数据
        """
^
src/database/database_service.py:1308:80: E501 line too long (86 > 79 characters)
                f"symbol = '{symbol}' AND ts >= '{start_date}' AND ts <= '{end_date}'"
                                                                               ^
src/database/database_service.py:1329:80: E501 line too long (87 > 79 characters)
                return df[["date", "open", "high", "low", "close", "volume", "amount"]]
                                                                               ^
src/database/database_service.py:1338:1: D400 First line should end with a period
        """获取行业分类数据

        Returns:
            pd.DataFrame: 行业分类数据
        """
^
src/database/database_service.py:1346:80: E501 line too long (83 > 79 characters)
                table_name="industry_classifications", order_by="industry_code ASC"
                                                                               ^
src/database/database_service.py:1378:1: D400 First line should end with a period
        """获取概念分类数据

        Returns:
            pd.DataFrame: 概念分类数据
        """
^
src/database/database_service.py:1386:80: E501 line too long (81 > 79 characters)
                table_name="concept_classifications", order_by="concept_code ASC"
                                                                               ^
src/database/database_service.py:1418:1: D400 First line should end with a period
        """获取个股的行业和概念分类信息

        Args:
            symbol: str - 股票代码

        Returns:
            Dict: 个股行业和概念信息
        """
^
src/database/database_service.py:1446:80: E501 line too long (85 > 79 characters)
            return {"symbol": symbol, "industries": industries, "concepts": concepts}
                                                                               ^
src/database/mock_data_storage.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据存储层
模拟真实数据库的存储逻辑，用于测试数据落地功能
"""
^
src/database/mock_data_storage.py:1:1: D400 First line should end with a period
"""
Mock数据存储层
模拟真实数据库的存储逻辑，用于测试数据落地功能
"""
^
src/database/mock_data_storage.py:14:1: D205 1 blank line required between summary line and description
    """
    Mock数据存储层
    模拟真实数据库的存储逻辑，用于测试数据落地功能
    """
^
src/database/mock_data_storage.py:14:1: D400 First line should end with a period
    """
    Mock数据存储层
    模拟真实数据库的存储逻辑，用于测试数据落地功能
    """
^
src/database/mock_data_storage.py:20:1: D400 First line should end with a period
        """
        初始化Mock数据存储

        Args:
            storage_path: 存储路径
        """
^
src/database/mock_data_storage.py:31:1: D400 First line should end with a period
        """初始化存储结构"""
^
src/database/mock_data_storage.py:40:1: D400 First line should end with a period
        """创建模拟表"""
^
src/database/mock_data_storage.py:110:1: D400 First line should end with a period
        """
        插入技术指标数据

        Args:
            data: 技术指标数据列表

        Returns:
            bool: 操作是否成功
        """
^
src/database/mock_data_storage.py:132:49: W291 trailing whitespace
                    """
                INSERT INTO technical_indicators
                (symbol, calc_date, indicator_name, indicator_value, indicator_params)
                VALUES (?, ?, ?, ?, ?)
                """,

                        ^
src/database/mock_data_storage.py:133:80: E501 line too long (86 > 79 characters)
                    """
                INSERT INTO technical_indicators
                (symbol, calc_date, indicator_name, indicator_value, indicator_params)
                VALUES (?, ?, ?, ?, ?)
                """,


     ^
src/database/mock_data_storage.py:152:1: D400 First line should end with a period
        """
        插入实时行情数据

        Args:
            data: 实时行情数据列表

        Returns:
            bool: 操作是否成功
        """
^
src/database/mock_data_storage.py:167:44: W291 trailing whitespace
                    """
                INSERT INTO realtime_quotes
                (symbol, trade_time, open, high, low, close, volume, amount, pre_close,
                 change, change_pct, turnover_rate, pe_ratio, pb_ratio)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,

                   ^
src/database/mock_data_storage.py:168:80: E501 line too long (87 > 79 characters)
                    """
                INSERT INTO realtime_quotes
                (symbol, trade_time, open, high, low, close, volume, amount, pre_close,
                 change, change_pct, turnover_rate, pe_ratio, pb_ratio)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,


          ^
src/database/mock_data_storage.py:168:88: W291 trailing whitespace
                    """
                INSERT INTO realtime_quotes
                (symbol, trade_time, open, high, low, close, volume, amount, pre_close,
                 change, change_pct, turnover_rate, pe_ratio, pb_ratio)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,


                  ^
src/database/mock_data_storage.py:197:1: D400 First line should end with a period
        """
        插入股票信息数据

        Args:
            data: 股票信息数据列表

        Returns:
            bool: 操作是否成功
        """
^
src/database/mock_data_storage.py:212:50: W291 trailing whitespace
                    """
                INSERT OR REPLACE INTO stock_info
                (symbol, name, exchange, security_type, list_date, delist_date, status,
                 listing_board, market_cap, circulating_market_cap, total_shares,
                 circulating_shares, created_at, updated_at)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,

                         ^
src/database/mock_data_storage.py:213:80: E501 line too long (87 > 79 characters)
                    """
                INSERT OR REPLACE INTO stock_info
                (symbol, name, exchange, security_type, list_date, delist_date, status,
                 listing_board, market_cap, circulating_market_cap, total_shares,
                 circulating_shares, created_at, updated_at)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,


    ^
src/database/mock_data_storage.py:213:88: W291 trailing whitespace
                    """
                INSERT OR REPLACE INTO stock_info
                (symbol, name, exchange, security_type, list_date, delist_date, status,
                 listing_board, market_cap, circulating_market_cap, total_shares,
                 circulating_shares, created_at, updated_at)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,


            ^
src/database/mock_data_storage.py:214:80: E501 line too long (81 > 79 characters)
                    """
                INSERT OR REPLACE INTO stock_info
                (symbol, name, exchange, security_type, list_date, delist_date, status,
                 listing_board, market_cap, circulating_market_cap, total_shares,
                 circulating_shares, created_at, updated_at)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,


    ^
src/database/mock_data_storage.py:214:82: W291 trailing whitespace
                    """
                INSERT OR REPLACE INTO stock_info
                (symbol, name, exchange, security_type, list_date, delist_date, status,
                 listing_board, market_cap, circulating_market_cap, total_shares,
                 circulating_shares, created_at, updated_at)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
                """,


      ^
src/database/mock_data_storage.py:232:80: E501 line too long (86 > 79 characters)
                            "created_at", datetime.now().strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/mock_data_storage.py:235:80: E501 line too long (86 > 79 characters)
                            "updated_at", datetime.now().strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/database/mock_data_storage.py:249:1: D400 First line should end with a period
        """
        查询技术指标数据

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            List[Dict]: 查询结果
        """
^
src/database/mock_data_storage.py:280:1: S608 Possible SQL injection vector through string-based query construction.
            query = f"""
            SELECT symbol, calc_date, indicator_name, indicator_value, indicator_params
            FROM technical_indicators
            {where_clause}
            ORDER BY calc_date DESC
            """
^
src/database/mock_data_storage.py:281:80: E501 line too long (87 > 79 characters)
            query = f"""
            SELECT symbol, calc_date, indicator_name, indicator_value, indicator_params
            FROM technical_indicators
            {where_clause}
            ORDER BY calc_date DESC
            """

                                                      ^
src/database/mock_data_storage.py:298:80: E501 line too long (81 > 79 characters)
                        "indicator_params": json.loads(row[4]) if row[4] else {},
                                                                               ^
src/database/mock_data_storage.py:308:1: D400 First line should end with a period
        """
        查询实时行情数据

        Args:
            symbol: 股票代码

        Returns:
            List[Dict]: 查询结果
        """
^
src/database/mock_data_storage.py:327:1: S608 Possible SQL injection vector through string-based query construction.
            query = f"""
            SELECT symbol, trade_time, open, high, low, close, volume, amount,
                   pre_close, change, change_pct, turnover_rate, pe_ratio, pb_ratio
            FROM realtime_quotes
            {where_clause}
            ORDER BY trade_time DESC
            LIMIT 100
            """
^
src/database/mock_data_storage.py:329:80: E501 line too long (83 > 79 characters)
            query = f"""
            SELECT symbol, trade_time, open, high, low, close, volume, amount,
                   pre_close, change, change_pct, turnover_rate, pe_ratio, pb_ratio
            FROM realtime_quotes
            {where_clause}
            ORDER BY trade_time DESC
            LIMIT 100
            """

                                                      ^
src/database/mock_data_storage.py:366:1: D400 First line should end with a period
        """
        查询股票信息数据

        Args:
            symbol: 股票代码

        Returns:
            List[Dict]: 查询结果
        """
^
src/database/mock_data_storage.py:385:1: S608 Possible SQL injection vector through string-based query construction.
            query = f"""
            SELECT symbol, name, exchange, security_type, list_date, delist_date, status,
                   listing_board, market_cap, circulating_market_cap, total_shares,
                   circulating_shares, created_at, updated_at
            FROM stock_info
            {where_clause}
            LIMIT 100
            """
^
src/database/mock_data_storage.py:386:80: E501 line too long (89 > 79 characters)
            query = f"""
            SELECT symbol, name, exchange, security_type, list_date, delist_date, status,
                   listing_board, market_cap, circulating_market_cap, total_shares,
                   circulating_shares, created_at, updated_at
            FROM stock_info
            {where_clause}
            LIMIT 100
            """

                                                      ^
src/database/mock_data_storage.py:387:80: E501 line too long (83 > 79 characters)
            query = f"""
            SELECT symbol, name, exchange, security_type, list_date, delist_date, status,
                   listing_board, market_cap, circulating_market_cap, total_shares,
                   circulating_shares, created_at, updated_at
            FROM stock_info
            {where_clause}
            LIMIT 100
            """

                                                      ^
src/database/mock_data_storage.py:424:1: D400 First line should end with a period
        """关闭数据库连接"""
^
src/database/stocks_db_service.py:1:1: D205 1 blank line required between summary line and description
"""
真实数据库查询服务
实现与Mock数据一致的接口格式

作者: MyStocks项目组
创建日期: 2025-11-15
"""
^
src/database/stocks_db_service.py:1:1: D400 First line should end with a period
"""
真实数据库查询服务
实现与Mock数据一致的接口格式

作者: MyStocks项目组
创建日期: 2025-11-15
"""
^
src/database/stocks_db_service.py:24:1: D400 First line should end with a period
    """获取股票列表（支持按交易所筛选，支持分页）

    Args:
        params: Dict - 查询参数：
                exchange: Optional[str] - 交易所筛选（sh=上交所，sz=深交所）
                limit: int - 每页数量，默认20
                offset: int - 偏移量，默认0

    Returns:
        List[Dict]: 股票列表数据，与Mock数据格式一致：
                   - symbol: 股票代码
                   - name: 股票名称
                   - industry: 所属行业
                   - area: 地区
                   - market: 市场
                   - list_date: 上市日期
                   - total: 总数量（用于分页）
    """
^
src/database/stocks_db_service.py:60:80: E501 line too long (82 > 79 characters)
            table_name="symbols_info", filters=filters, limit=limit, offset=offset
                                                                               ^
src/database/stocks_db_service.py:65:80: E501 line too long (85 > 79 characters)
            table_name="symbols_info", filters=filters, columns=["COUNT(*) as total"]
                                                                               ^
src/database/stocks_db_service.py:98:1: D400 First line should end with a period
    """获取实时行情（必填参数：股票代码）

    Args:
        code: str - 股票代码（必填）

    Returns:
        Dict: 实时行情数据，与Mock数据格式一致
    """
^
src/database/stocks_db_service.py:146:1: D400 First line should end with a period
    """获取历史收益（默认30天，返回DataFrame）

    Args:
        params: Dict - 查询参数：
                symbol: str - 股票代码（必填）
                days: int - 天数，默认30

    Returns:
        pd.DataFrame: 历史收益数据
    """
^
src/database_optimization/__init__.py:1:1: D400 First line should end with a period
"""
数据库索引优化模块

提供TDengine和PostgreSQL的索引优化、慢查询分析和性能监控功能
"""
^
src/database_optimization/performance_monitor.py:1:1: D400 First line should end with a period
"""
索引性能监控

监控查询时间、索引使用率和性能基准测试
"""
^
src/database_optimization/performance_monitor.py:16:1: D400 First line should end with a period
    """索引性能监控管理器"""
^
src/database_optimization/performance_monitor.py:19:1: D400 First line should end with a period
        """初始化性能监控"""
^
src/database_optimization/performance_monitor.py:29:1: D400 First line should end with a period
        """
        记录查询执行时间

        Args:
            query_name: 查询标识
            execution_time_ms: 执行时间（毫秒）
            table_name: 表名
        """
^
src/database_optimization/performance_monitor.py:43:80: E501 line too long (86 > 79 characters)
                "is_very_slow": execution_time_ms > self.very_slow_query_threshold_ms,
                                                                               ^
src/database_optimization/performance_monitor.py:48:1: D400 First line should end with a period
        """
        分析查询性能

        Args:
            query_name: 查询标识，None表示分析所有查询

        Returns:
            {
                "query_name": "...",
                "avg_execution_time_ms": ...,
                "min_execution_time_ms": ...,
                "max_execution_time_ms": ...,
                "slow_query_percentage": ...,
                "execution_count": ...
            }
        """
^
src/database_optimization/performance_monitor.py:61:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析查询性能

        Args:
            query_name: 查询标识，None表示分析所有查询

        Returns:
            {
                "query_name": "...",
                "avg_execution_time_ms": ...,
                "min_execution_time_ms": ...,
                "max_execution_time_ms": ...,
                "slow_query_percentage": ...,
                "execution_count": ...
            }
        """
^
src/database_optimization/performance_monitor.py:64:80: E501 line too long (88 > 79 characters)
        logger.info(f"Analyzing query performance for {query_name or 'all queries'}...")
                                                                               ^
src/database_optimization/performance_monitor.py:92:80: E501 line too long (87 > 79 characters)
                "slow_query_percentage": round((slow_queries / len(metrics)) * 100, 2),
                                                                               ^
src/database_optimization/performance_monitor.py:104:1: D400 First line should end with a period
        """
        跟踪索引使用情况

        Args:
            index_name: 索引名称
            used: 是否被使用
        """
^
src/database_optimization/performance_monitor.py:120:80: E501 line too long (88 > 79 characters)
            self.index_usage_stats[index_name]["last_used"] = datetime.now().isoformat()
                                                                               ^
src/database_optimization/performance_monitor.py:123:1: D400 First line should end with a period
        """
        获取索引使用报告

        Returns:
            {
                "total_indexes": ...,
                "actively_used": ...,
                "unused_indexes": [...],
                "recommendations": [...]
            }
        """
^
src/database_optimization/performance_monitor.py:131:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取索引使用报告

        Returns:
            {
                "total_indexes": ...,
                "actively_used": ...,
                "unused_indexes": [...],
                "recommendations": [...]
            }
        """
^
src/database_optimization/performance_monitor.py:163:80: E501 line too long (113 > 79 characters)
                    "benefit": f"Free up {len(unused_indexes) * 5}MB+ disk space, reduce INSERT/UPDATE overhead",
                                                                               ^
src/database_optimization/performance_monitor.py:171:80: E501 line too long (88 > 79 characters)
    def establish_performance_baseline(self, baseline_name: str, metrics: Dict) -> None:
                                                                               ^
src/database_optimization/performance_monitor.py:172:1: D400 First line should end with a period
        """
        建立性能基准

        Args:
            baseline_name: 基准名称
            metrics: 性能指标
        """
^
src/database_optimization/performance_monitor.py:185:1: D400 First line should end with a period
        """
        进行查询性能基准测试

        Returns:
            {
                "baseline_name": "...",
                "test_results": [...],
                "overall_performance": "..."
            }
        """
^
src/database_optimization/performance_monitor.py:192:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        进行查询性能基准测试

        Returns:
            {
                "baseline_name": "...",
                "test_results": [...],
                "overall_performance": "..."
            }
        """
^
src/database_optimization/performance_monitor.py:200:80: E501 line too long (81 > 79 characters)
                "description": "SELECT * FROM daily_kline WHERE symbol = 'AAPL'",
                                                                               ^
src/database_optimization/performance_monitor.py:208:80: E501 line too long (114 > 79 characters)
                "description": "SELECT * FROM daily_kline WHERE trade_date BETWEEN '2025-01-01' AND '2025-12-31'",
                                                                               ^
src/database_optimization/performance_monitor.py:216:80: E501 line too long (111 > 79 characters)
                "description": "SELECT * FROM daily_kline WHERE symbol = 'AAPL' AND trade_date = '2025-01-01'",
                                                                               ^
src/database_optimization/performance_monitor.py:224:80: E501 line too long (120 > 79 characters)
                "description": "SELECT INTERVAL(ts, 1m), FIRST(close), MAX(high), MIN(low), LAST(close) FROM tick_data",
                                                                               ^
src/database_optimization/performance_monitor.py:227:80: E501 line too long (83 > 79 characters)
                "optimization": "Enable time-based partitioning + timestamp index",
                                                                               ^
src/database_optimization/performance_monitor.py:232:80: E501 line too long (126 > 79 characters)
                "description": "SELECT * FROM order_records WHERE user_id = 123 AND symbol = 'AAPL' ORDER BY created_at DESC",
                                                                               ^
src/database_optimization/performance_monitor.py:235:80: E501 line too long (82 > 79 characters)
                "optimization": "CREATE INDEX idx_order_records_user_symbol_date",
                                                                               ^
src/database_optimization/performance_monitor.py:241:80: E501 line too long (88 > 79 characters)
            (test["baseline_time_ms"] / test["target_time_ms"]) for test in test_results
                                                                               ^
src/database_optimization/performance_monitor.py:252:80: E501 line too long (86 > 79 characters)
                "A" if achieved_speedup > 10 else "B" if achieved_speedup > 5 else "C"
                                                                               ^
src/database_optimization/performance_monitor.py:262:1: D400 First line should end with a period
        """
        生成性能报告

        Returns:
            {
                "timestamp": "...",
                "query_performance": {...},
                "index_usage": {...},
                "benchmarks": {...},
                "recommendations": [...]
            }
        """
^
src/database_optimization/performance_monitor.py:271:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        生成性能报告

        Returns:
            {
                "timestamp": "...",
                "query_performance": {...},
                "index_usage": {...},
                "benchmarks": {...},
                "recommendations": [...]
            }
        """
^
src/database_optimization/performance_monitor.py:283:80: E501 line too long (85 > 79 characters)
                "action": "Create missing indexes identified in slow query analysis",
                                                                               ^
src/database_optimization/performance_monitor.py:289:80: E501 line too long (82 > 79 characters)
                "action": "Enable time-based partitioning for time-series tables",
                                                                               ^
src/database_optimization/performance_monitor.py:295:80: E501 line too long (81 > 79 characters)
                "action": "Remove unused indexes to reduce maintenance overhead",
                                                                               ^
src/database_optimization/performance_monitor.py:296:80: E501 line too long (81 > 79 characters)
                "expected_improvement": "10-20% faster INSERT/UPDATE operations",
                                                                               ^
src/database_optimization/performance_monitor.py:308:80: E501 line too long (84 > 79 characters)
                        sum(q["avg_execution_time_ms"] for q in query_perf.values())
                                                                               ^
src/database_optimization/performance_monitor.py:317:80: E501 line too long (84 > 79 characters)
                        sum(q["slow_query_percentage"] for q in query_perf.values())
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:1:1: D400 First line should end with a period
"""
PostgreSQL 索引优化器

优化PostgreSQL的单列索引、复合索引、部分索引和BRIN索引
"""
^
src/database_optimization/postgresql_index_optimizer.py:16:1: D400 First line should end with a period
    """PostgreSQL索引优化管理器"""
^
src/database_optimization/postgresql_index_optimizer.py:19:1: D400 First line should end with a period
        """初始化PostgreSQL索引优化器"""
^
src/database_optimization/postgresql_index_optimizer.py:25:80: E501 line too long (84 > 79 characters)
            raise ValueError("POSTGRESQL_PASSWORD environment variable is required")
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:36:1: D400 First line should end with a period
        """
        设计单列索引

        Returns:
            {
                "indexes": [
                    {"column": "...", "table": "...", "reason": "...", "type": "BTREE/HASH"}
                ],
                "implementation": "..."
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:42:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        设计单列索引

        Returns:
            {
                "indexes": [
                    {"column": "...", "table": "...", "reason": "...", "type": "BTREE/HASH"}
                ],
                "implementation": "..."
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:42:80: E501 line too long (92 > 79 characters)
        """
        设计单列索引

        Returns:
            {
                "indexes": [
                    {"column": "...", "table": "...", "reason": "...", "type": "BTREE/HASH"}
                ],
                "implementation": "..."
            }
        """





                    ^
src/database_optimization/postgresql_index_optimizer.py:44:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        设计单列索引

        Returns:
            {
                "indexes": [
                    {"column": "...", "table": "...", "reason": "...", "type": "BTREE/HASH"}
                ],
                "implementation": "..."
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:56:80: E501 line too long (85 > 79 characters)
                "sql": "CREATE INDEX idx_daily_kline_symbol ON daily_kline(symbol);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:65:80: E501 line too long (87 > 79 characters)
                "sql": "CREATE INDEX idx_daily_kline_date ON daily_kline(trade_date);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:74:80: E501 line too long (98 > 79 characters)
                "sql": "CREATE INDEX idx_tech_indicators_symbol ON technical_indicators(symbol);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:83:80: E501 line too long (114 > 79 characters)
                "sql": "CREATE INDEX idx_tech_indicators_created ON technical_indicators USING BRIN(created_at);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:84:80: E501 line too long (85 > 79 characters)
                "estimated_improvement": "2-5x faster with minimal storage overhead",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:92:80: E501 line too long (88 > 79 characters)
                "sql": "CREATE INDEX idx_order_records_user ON order_records(user_id);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:101:80: E501 line too long (89 > 79 characters)
                "sql": "CREATE INDEX idx_order_records_symbol ON order_records(symbol);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:110:80: E501 line too long (100 > 79 characters)
                "sql": "CREATE INDEX idx_transaction_records_user ON transaction_records(user_id);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:124:1: D400 First line should end with a period
        """
        设计复合索引

        Returns:
            {
                "composite_indexes": [
                    {"columns": [...], "reason": "...", "selectivity": "..."}
                ]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:130:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        设计复合索引

        Returns:
            {
                "composite_indexes": [
                    {"columns": [...], "reason": "...", "selectivity": "..."}
                ]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:131:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        设计复合索引

        Returns:
            {
                "composite_indexes": [
                    {"columns": [...], "reason": "...", "selectivity": "..."}
                ]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:141:80: E501 line too long (101 > 79 characters)
                "reason": "Most common query: find daily candle for specific stock on specific date",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:143:80: E501 line too long (107 > 79 characters)
                "sql": "CREATE INDEX idx_daily_kline_symbol_date ON daily_kline(symbol, trade_date DESC);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:153:80: E501 line too long (123 > 79 characters)
                "sql": "CREATE INDEX idx_tech_indicators_symbol_created ON technical_indicators(symbol, created_at DESC);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:161:80: E501 line too long (86 > 79 characters)
                "reason": "Find user's orders for specific symbol, sorted by recency",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:163:80: E501 line too long (125 > 79 characters)
                "sql": "CREATE INDEX idx_order_records_user_symbol_date ON order_records(user_id, symbol, created_at DESC);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:173:80: E501 line too long (122 > 79 characters)
                "sql": "CREATE INDEX idx_transaction_records_user_date ON transaction_records(user_id, created_at DESC);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:187:1: D400 First line should end with a period
        """
        设计部分索引（有条件的索引）

        Returns:
            {
                "partial_indexes": [...]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:192:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        设计部分索引（有条件的索引）

        Returns:
            {
                "partial_indexes": [...]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:204:80: E501 line too long (136 > 79 characters)
                "sql": "CREATE INDEX idx_order_records_active ON order_records(user_id, symbol) WHERE status IN ('ACTIVE', 'PENDING');",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:211:80: E501 line too long (81 > 79 characters)
                "where_clause": "trade_date >= CURRENT_DATE - INTERVAL '1 year'",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:212:80: E501 line too long (84 > 79 characters)
                "reason": "Index only recent 1-year data (most frequently queried)",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:214:80: E501 line too long (138 > 79 characters)
                "sql": "CREATE INDEX idx_daily_kline_recent ON daily_kline(symbol) WHERE trade_date >= CURRENT_DATE - INTERVAL '1 year';",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:224:80: E501 line too long (145 > 79 characters)
                "sql": "CREATE INDEX idx_tech_indicators_popular ON technical_indicators(symbol) WHERE indicator_type IN ('MA', 'MACD', 'RSI');",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:225:80: E501 line too long (83 > 79 characters)
                "estimated_improvement": "25-50% faster popular indicator lookups",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:233:80: E501 line too long (82 > 79 characters)
            "key_benefit": "Reduced index size + faster queries on filtered data",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:238:1: D400 First line should end with a period
        """
        设计BRIN索引（块范围索引，适合大型有序表）

        Returns:
            {
                "brin_indexes": [...]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:243:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        设计BRIN索引（块范围索引，适合大型有序表）

        Returns:
            {
                "brin_indexes": [...]
            }
        """
^
src/database_optimization/postgresql_index_optimizer.py:254:80: E501 line too long (103 > 79 characters)
                "sql": "CREATE INDEX idx_daily_kline_date_brin ON daily_kline USING BRIN(trade_date);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:256:80: E501 line too long (87 > 79 characters)
                "estimated_improvement": "80% smaller index + 2-5x faster range scans",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:264:80: E501 line too long (119 > 79 characters)
                "sql": "CREATE INDEX idx_tech_indicators_created_brin ON technical_indicators USING BRIN(created_at);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:266:80: E501 line too long (92 > 79 characters)
                "estimated_improvement": "90% smaller index + minimal maintenance overhead",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:274:80: E501 line too long (110 > 79 characters)
                "sql": "CREATE INDEX idx_order_records_created_brin ON order_records USING BRIN(created_at);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:276:80: E501 line too long (88 > 79 characters)
                "estimated_improvement": "90% smaller + minimal INSERT/UPDATE overhead",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:284:80: E501 line too long (122 > 79 characters)
                "sql": "CREATE INDEX idx_transaction_records_created_brin ON transaction_records USING BRIN(created_at);",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:286:80: E501 line too long (88 > 79 characters)
                "estimated_improvement": "90% smaller + efficient for time-series data",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:295:80: E501 line too long (83 > 79 characters)
            "key_benefit": "Minimal storage overhead for large time-series tables",
                                                                               ^
src/database_optimization/postgresql_index_optimizer.py:301:1: D400 First line should end with a period
        """获取索引优化总结"""
^
src/database_optimization/slow_query_analyzer.py:1:1: D400 First line should end with a period
"""
慢查询分析器

识别和分析慢查询，提供优化建议
"""
^
src/database_optimization/slow_query_analyzer.py:15:1: D400 First line should end with a period
    """慢查询分析管理器"""
^
src/database_optimization/slow_query_analyzer.py:22:1: D400 First line should end with a period
        """初始化慢查询分析器"""
^
src/database_optimization/slow_query_analyzer.py:27:1: D400 First line should end with a period
        """
        分析PostgreSQL慢查询

        Returns:
            {
                "slow_queries": [...],
                "recommendations": [...]
            }
        """
^
src/database_optimization/slow_query_analyzer.py:33:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析PostgreSQL慢查询

        Returns:
            {
                "slow_queries": [...],
                "recommendations": [...]
            }
        """
^
src/database_optimization/slow_query_analyzer.py:42:80: E501 line too long (87 > 79 characters)
                "query": """
                    SELECT symbol, COUNT(*) as order_count, SUM(volume) as total_volume
                    FROM order_records
                    WHERE created_at >= NOW() - INTERVAL '30 days'
                    GROUP BY symbol
                    ORDER BY total_volume DESC
                """,

                                                  ^
src/database_optimization/slow_query_analyzer.py:50:80: E501 line too long (97 > 79 characters)
                "root_cause": "Missing index on (user_id, created_at); requires full table scan",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:52:80: E501 line too long (118 > 79 characters)
                "optimization": "CREATE INDEX idx_order_records_user_date ON order_records(user_id, created_at DESC)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:68:80: E501 line too long (105 > 79 characters)
                "root_cause": "Missing indexes on join columns; nested loop join scanning entire tables",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:69:80: E501 line too long (82 > 79 characters)
                "explain_plan_issue": "Nested Loop with Seq Scans on both tables",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:71:80: E501 line too long (103 > 79 characters)
                    "CREATE INDEX idx_daily_kline_symbol_date ON daily_kline(symbol, trade_date DESC)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:72:80: E501 line too long (119 > 79 characters)
                    "CREATE INDEX idx_tech_indicators_symbol_created ON technical_indicators(symbol, created_at DESC)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:80:80: E501 line too long (92 > 79 characters)
                "query": """
                    SELECT user_id, symbol, AVG(price) as avg_price, COUNT(*) as trade_count
                    FROM transaction_records
                    WHERE created_at >= NOW() - INTERVAL '90 days'
                    GROUP BY user_id, symbol
                    HAVING COUNT(*) > 10
                """,

                                                  ^
src/database_optimization/slow_query_analyzer.py:88:80: E501 line too long (104 > 79 characters)
                "root_cause": "No index on (user_id, symbol); requires full table scan for aggregation",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:90:80: E501 line too long (123 > 79 characters)
                "optimization": "CREATE INDEX idx_transaction_records_user_symbol ON transaction_records(user_id, symbol)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:99:80: E501 line too long (96 > 79 characters)
                "recommendation": "Add composite index on (symbol, trade_date) for daily_kline",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:101:80: E501 line too long (118 > 79 characters)
                "implementation": "CREATE INDEX idx_daily_kline_symbol_date ON daily_kline(symbol, trade_date DESC);",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:106:80: E501 line too long (92 > 79 characters)
                "recommendation": "Create index on (user_id, created_at) for order_records",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:107:80: E501 line too long (81 > 79 characters)
                "impact": "Reduce aggregation query time from 1200ms to 50-80ms",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:108:80: E501 line too long (121 > 79 characters)
                "implementation": "CREATE INDEX idx_order_records_user_date ON order_records(user_id, created_at DESC);",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:113:80: E501 line too long (88 > 79 characters)
                "recommendation": "Add BRIN index on created_at for time-series tables",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:114:80: E501 line too long (84 > 79 characters)
                "impact": "Faster date range queries with minimal storage overhead",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:115:80: E501 line too long (110 > 79 characters)
                "implementation": "CREATE INDEX idx_table_created_brin ON table_name USING BRIN(created_at);",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:137:1: D400 First line should end with a period
        """
        分析TDengine慢查询

        Returns:
            {
                "slow_queries": [...],
                "recommendations": [...]
            }
        """
^
src/database_optimization/slow_query_analyzer.py:143:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析TDengine慢查询

        Returns:
            {
                "slow_queries": [...],
                "recommendations": [...]
            }
        """
^
src/database_optimization/slow_query_analyzer.py:153:80: E501 line too long (94 > 79 characters)
                "query": """
                    SELECT INTERVAL(ts, 1m) as time_bucket,
                           FIRST(close) as open, MAX(high), MIN(low), LAST(close), SUM(volume)
                    FROM tick_data
                    WHERE ts >= now - 1d AND symbol = 'AAPL'
                    GROUP BY time_bucket
                """,

                                                  ^
src/database_optimization/slow_query_analyzer.py:160:80: E501 line too long (80 > 79 characters)
                "root_cause": "Missing timestamp index; full scan of tick data",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:161:80: E501 line too long (81 > 79 characters)
                "optimization": "CREATE INDEX idx_tick_data_ts ON tick_data(ts)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:162:80: E501 line too long (84 > 79 characters)
                "expected_speedup": "5-10x faster (via index seek instead of scan)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:175:80: E501 line too long (85 > 79 characters)
                "root_cause": "No partition strategy; scanning 30 days of tick data",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:176:80: E501 line too long (84 > 79 characters)
                "optimization": "Enable time-based partitioning (PARTITION BY DAY)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:198:80: E501 line too long (86 > 79 characters)
                "recommendation": "Enable time-based partitioning (PARTITION BY DAY)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:199:80: E501 line too long (91 > 79 characters)
                "impact": "Reduce scan time from 1500ms to 50-100ms via partition pruning",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:200:80: E501 line too long (92 > 79 characters)
                "implementation": "ALTER SUPERTABLE tick_data PARTITION BY ts INTERVAL(1d)",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:205:80: E501 line too long (82 > 79 characters)
                "recommendation": "Create timestamp index for time-range queries",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:207:80: E501 line too long (93 > 79 characters)
                "implementation": "Ensure timestamp is PRIMARY KEY in SUPERTABLE definition",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:213:80: E501 line too long (83 > 79 characters)
                "impact": "Reduce K-line aggregation time from 800ms to 100-200ms",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:214:80: E501 line too long (103 > 79 characters)
                "implementation": "Use indexed timestamp + INTERVAL(ts, 1m) with WHERE ts >= now - 1d",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:238:1: D400 First line should end with a period
        """
        生成EXPLAIN分析

        Args:
            query: SQL查询语句
            database: 数据库类型 (postgresql | tdengine)

        Returns:
            {
                "query": "...",
                "execution_plan": "...",
                "bottlenecks": [...],
                "optimization_suggestions": [...]
            }
        """
^
src/database_optimization/slow_query_analyzer.py:250:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        生成EXPLAIN分析

        Args:
            query: SQL查询语句
            database: 数据库类型 (postgresql | tdengine)

        Returns:
            {
                "query": "...",
                "execution_plan": "...",
                "bottlenecks": [...],
                "optimization_suggestions": [...]
            }
        """
^
src/database_optimization/slow_query_analyzer.py:263:80: E501 line too long (90 > 79 characters)
                    "description": "Query performs sequential scan instead of index seek",
                                                                               ^
src/database_optimization/slow_query_analyzer.py:302:1: D400 First line should end with a period
        """获取分析总结"""
^
src/database_optimization/slow_query_analyzer.py:328:80: E501 line too long (81 > 79 characters)
                "Create composite index on (symbol, trade_date) for daily_kline",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:1:1: D400 First line should end with a period
"""
TDengine 索引优化器

优化TDengine的时间索引、标签索引和查询性能
"""
^
src/database_optimization/tdengine_index_optimizer.py:16:1: D400 First line should end with a period
    """TDengine索引优化管理器"""
^
src/database_optimization/tdengine_index_optimizer.py:19:1: D400 First line should end with a period
        """初始化TDengine索引优化器"""
^
src/database_optimization/tdengine_index_optimizer.py:25:80: E501 line too long (82 > 79 characters)
            raise ValueError("TDENGINE_PASSWORD environment variable is required")
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:37:1: D400 First line should end with a period
        """
        分析时间索引策略

        Returns:
            {
                "current_strategy": "...",
                "recommendations": [...],
                "estimated_improvement": "..."
            }
        """
^
src/database_optimization/tdengine_index_optimizer.py:44:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析时间索引策略

        Returns:
            {
                "current_strategy": "...",
                "recommendations": [...],
                "estimated_improvement": "..."
            }
        """
^
src/database_optimization/tdengine_index_optimizer.py:55:80: E501 line too long (93 > 79 characters)
                "recommendation": "Ensure timestamp is primary key in SUPERTABLE definition",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:57:80: E501 line too long (102 > 79 characters)
                "implementation": "ALTER SUPERTABLE tick_data MODIFY COLUMN ts TIMESTAMP PRIMARY KEY",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:67:80: E501 line too long (89 > 79 characters)
                "implementation": "Configure PARTITION BY DAY for high-frequency tables",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:77:80: E501 line too long (180 > 79 characters)
                "implementation": "SELECT INTERVAL(ts, 1m) as time_bucket, first(close) as open, max(high), min(low), last(close), sum(volume) FROM tick_data GROUP BY time_bucket",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:82:80: E501 line too long (90 > 79 characters)
            "current_strategy": "Time-range indexed SuperTable with INTERVAL aggregation",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:84:80: E501 line too long (82 > 79 characters)
            "estimated_improvement": "60-80% reduction in aggregation query time",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:88:1: D400 First line should end with a period
        """
        分析标签索引策略

        Returns:
            {
                "tag_optimization_plan": [...],
                "index_structure": "...",
                "query_performance_impact": "..."
            }
        """
^
src/database_optimization/tdengine_index_optimizer.py:95:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析标签索引策略

        Returns:
            {
                "tag_optimization_plan": [...],
                "index_structure": "...",
                "query_performance_impact": "..."
            }
        """
^
src/database_optimization/tdengine_index_optimizer.py:115:80: E501 line too long (87 > 79 characters)
                "estimated_filter_efficiency": "80%+ (reduces cross-exchange queries)",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:123:80: E501 line too long (85 > 79 characters)
                "estimated_filter_efficiency": "100% (eliminates irrelevant tables)",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:129:80: E501 line too long (112 > 79 characters)
            "index_structure": "Multi-level: symbol (primary) -> exchange (secondary) -> data_type (partition)",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:134:1: D400 First line should end with a period
        """
        优化时间范围查询

        Returns:
            {
                "query_patterns": [...],
                "optimization_techniques": [...],
                "expected_speedup": "..."
            }
        """
^
src/database_optimization/tdengine_index_optimizer.py:141:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        优化时间范围查询

        Returns:
            {
                "query_patterns": [...],
                "optimization_techniques": [...],
                "expected_speedup": "..."
            }
        """
^
src/database_optimization/tdengine_index_optimizer.py:149:80: E501 line too long (83 > 79 characters)
                "current_approach": "SELECT * FROM table ORDER BY ts DESC LIMIT N",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:150:80: E501 line too long (87 > 79 characters)
                "optimized_approach": "Use index seek to latest timestamp, then LIMIT",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:155:80: E501 line too long (90 > 79 characters)
                "current_approach": "SELECT * FROM table WHERE ts >= start AND ts <= end",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:156:80: E501 line too long (96 > 79 characters)
                "optimized_approach": "Leverage time-based partitioning with partition pruning",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:157:80: E501 line too long (80 > 79 characters)
                "speedup": "50-100x faster (eliminated unnecessary partitions)",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:161:80: E501 line too long (88 > 79 characters)
                "current_approach": "SELECT INTERVAL(ts, 1m) GROUP BY symbol, interval",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:162:80: E501 line too long (92 > 79 characters)
                "optimized_approach": "Use INTERVAL with indexed timestamp + tag filtering",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:167:80: E501 line too long (112 > 79 characters)
                "current_approach": "SELECT ts, close, AVG(close) OVER (PARTITION BY symbol ORDER BY ts) as ma",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:168:80: E501 line too long (82 > 79 characters)
                "optimized_approach": "Use WINDOW functions with timestamp index",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:174:80: E501 line too long (86 > 79 characters)
            "Enable timestamp index on all tables (CREATE INDEX idx_ts ON table(ts))",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:175:80: E501 line too long (94 > 79 characters)
            "Use column compression for historical data (COMPRESSION=2 in column definition)",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:177:80: E501 line too long (91 > 79 characters)
            "Use batch inserts (INSERT ... VALUES (...), (...)) instead of single inserts",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:178:80: E501 line too long (87 > 79 characters)
            "Configure appropriate retention policies (TTL) to limit query scan range",
                                                                               ^
src/database_optimization/tdengine_index_optimizer.py:194:1: D400 First line should end with a period
        """获取索引优化总结"""
^
src/db_manager/__init__.py:1:1: D205 1 blank line required between summary line and description
"""
Compatibility module for db_manager imports.
This module re-exports from src.storage.database for backward compatibility.
"""
^
src/db_manager/__init__.py:13:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/factories/data_source_factory.py:1:1: D205 1 blank line required between summary line and description
"""
数据源工厂类
通过配置动态切换数据源（Mock / 真实数据）
"""
^
src/factories/data_source_factory.py:1:1: D400 First line should end with a period
"""
数据源工厂类
通过配置动态切换数据源（Mock / 真实数据）
"""
^
src/factories/data_source_factory.py:14:1: D205 1 blank line required between summary line and description
    """
    数据源工厂类
    通过配置动态切换数据源（Mock / 真实数据）
    """
^
src/factories/data_source_factory.py:14:1: D400 First line should end with a period
    """
    数据源工厂类
    通过配置动态切换数据源（Mock / 真实数据）
    """
^
src/factories/data_source_factory.py:22:1: D102 Missing docstring in public method
    def __new__(cls) -> "DataSourceFactory":
^
src/factories/data_source_factory.py:27:1: D107 Missing docstring in __init__
    def __init__(self) -> None:
^
src/factories/data_source_factory.py:32:1: D205 1 blank line required between summary line and description
        """
        初始化数据源
        根据环境变量USE_MOCK_DATA决定使用Mock数据还是真实数据
        """
^
src/factories/data_source_factory.py:32:1: D400 First line should end with a period
        """
        初始化数据源
        根据环境变量USE_MOCK_DATA决定使用Mock数据还是真实数据
        """
^
src/factories/data_source_factory.py:44:1: D400 First line should end with a period
        """
        获取数据源实例

        Returns:
            DataSourceInterface: 数据源实例
        """
^
src/factories/data_source_factory.py:55:1: D200 One-line docstring should fit on one line with quotes
        """
        切换到Mock数据源
        """
^
src/factories/data_source_factory.py:55:1: D400 First line should end with a period
        """
        切换到Mock数据源
        """
^
src/factories/data_source_factory.py:61:1: D200 One-line docstring should fit on one line with quotes
        """
        切换到真实数据源
        """
^
src/factories/data_source_factory.py:61:1: D400 First line should end with a period
        """
        切换到真实数据源
        """
^
src/factories/data_source_factory.py:67:1: D400 First line should end with a period
        """
        检查当前是否使用Mock数据源

        Returns:
            bool: 是否使用Mock数据源
        """
^
src/factories/data_source_factory.py:81:1: D400 First line should end with a period
    """
    获取数据源实例的便捷函数

    Returns:
        DataSourceInterface: 数据源实例
    """
^
src/gpu/accelerated/cpu_data_processor.py:1:1: D100 Missing docstring in public module
import pandas as pd
^
src/gpu/accelerated/cpu_data_processor.py:10:1: E302 expected 2 blank lines, found 1
@dataclass
^
src/gpu/accelerated/cpu_data_processor.py:12:1: D400 First line should end with a period
    """数据处理结果"""
^
src/gpu/accelerated/cpu_data_processor.py:23:1: D205 1 blank line required between summary line and description
    """
    CPU数据处理器
    实现IDataProcessor接口，使用Pandas/Numpy进行数据处理
    """
^
src/gpu/accelerated/cpu_data_processor.py:23:1: D400 First line should end with a period
    """
    CPU数据处理器
    实现IDataProcessor接口，使用Pandas/Numpy进行数据处理
    """
^
src/gpu/accelerated/cpu_data_processor.py:28:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/accelerated/cpu_data_processor.py:34:1: D400 First line should end with a period
        """加载和预处理数据 (CPU实现)"""
^
src/gpu/accelerated/cpu_data_processor.py:59:80: E501 line too long (97 > 79 characters)
                data.memory_usage(deep=True).sum() / processed_data.memory_usage(deep=True).sum()
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:74:80: E501 line too long (86 > 79 characters)
    def process_batch(self, batch_data: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:75:1: D205 1 blank line required between summary line and description
        """
        CPU批量处理数据
        Args:
            batch_data: 包含数据点（字典）的列表，每个字典应包含 'stock_code', 'price', 'volume', 'timestamp' 等键
        Returns:
            处理后的数据字典列表，包含 'price_change', 'volume_ma' 等
        """
^
src/gpu/accelerated/cpu_data_processor.py:75:1: D400 First line should end with a period
        """
        CPU批量处理数据
        Args:
            batch_data: 包含数据点（字典）的列表，每个字典应包含 'stock_code', 'price', 'volume', 'timestamp' 等键
        Returns:
            处理后的数据字典列表，包含 'price_change', 'volume_ma' 等
        """
^
src/gpu/accelerated/cpu_data_processor.py:78:80: E501 line too long (92 > 79 characters)
        """
        CPU批量处理数据
        Args:
            batch_data: 包含数据点（字典）的列表，每个字典应包含 'stock_code', 'price', 'volume', 'timestamp' 等键
        Returns:
            处理后的数据字典列表，包含 'price_change', 'volume_ma' 等
        """



                                   ^
src/gpu/accelerated/cpu_data_processor.py:91:37: E261 at least two spaces before inline comment
                "price_change": 0.0, # 需历史数据计算
                                    ^
src/gpu/accelerated/cpu_data_processor.py:96:80: E501 line too long (106 > 79 characters)
    def compute_features(self, historical_data: List[Dict], feature_types: List[str]) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:97:1: D200 One-line docstring should fit on one line with quotes
        """
        CPU计算技术特征
        """
^
src/gpu/accelerated/cpu_data_processor.py:97:1: D400 First line should end with a period
        """
        CPU计算技术特征
        """
^
src/gpu/accelerated/cpu_data_processor.py:103:66: E261 at least two spaces before inline comment
        if df.empty or 'price' not in df.columns or len(df) < 20: # 至少20个数据点
                                                                 ^
src/gpu/accelerated/cpu_data_processor.py:104:80: E501 line too long (95 > 79 characters)
            logger.warning("Historical data is insufficient or empty for feature calculation.")
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:108:80: E501 line too long (90 > 79 characters)
        volumes = df["volume"] if "volume" in df.columns else pd.Series(0, index=df.index)
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:112:80: E501 line too long (85 > 79 characters)
                features["sma_20"] = float(prices.rolling(window=20).mean().iloc[-1])
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:115:80: E501 line too long (89 > 79 characters)
                    features["sma_50"] = float(prices.rolling(window=50).mean().iloc[-1])
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:129:80: E501 line too long (102 > 79 characters)
                features["volume_ratio"] = float(current_volume / volume_ma) if volume_ma > 0 else 0.0
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:135:1: D400 First line should end with a period
        """检查数据质量"""
^
src/gpu/accelerated/cpu_data_processor.py:157:1: D400 First line should end with a period
        """处理缺失值"""
^
src/gpu/accelerated/cpu_data_processor.py:172:1: D400 First line should end with a period
        """优化数据类型"""
^
src/gpu/accelerated/cpu_data_processor.py:180:80: E501 line too long (88 > 79 characters)
    def _handle_outliers(self, data: pd.DataFrame, method: str = "iqr") -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:181:1: D400 First line should end with a period
        """处理异常值"""
^
src/gpu/accelerated/cpu_data_processor.py:187:18: N806 variable 'Q1' in function should be lowercase
                Q1 = data[col].quantile(0.25)
                 ^
src/gpu/accelerated/cpu_data_processor.py:188:18: N806 variable 'Q3' in function should be lowercase
                Q3 = data[col].quantile(0.75)
                 ^
src/gpu/accelerated/cpu_data_processor.py:189:18: N806 variable 'IQR' in function should be lowercase
                IQR = Q3 - Q1
                 ^
src/gpu/accelerated/cpu_data_processor.py:196:80: E501 line too long (90 > 79 characters)
                data[col] = data[col].clip(mean_val - 3 * std_val, mean_val + 3 * std_val)
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:200:1: D400 First line should end with a period
        """特征标准化"""
^
src/gpu/accelerated/cpu_data_processor.py:201:57: E261 at least two spaces before inline comment
        from sklearn.preprocessing import StandardScaler # 从CPU版本导入
                                                        ^
src/gpu/accelerated/cpu_data_processor.py:211:80: E501 line too long (105 > 79 characters)
        normalized_df = pd.DataFrame(normalized_features, columns=feature_data.columns, index=data.index)
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:221:1: D400 First line should end with a period
        """CPU计算RSI"""
^
src/gpu/accelerated/cpu_data_processor.py:226:74: E261 at least two spaces before inline comment
        avg_gain = gain.rolling(window=14, min_periods=1).mean().iloc[-1] # Ensure min_periods
                                                                         ^
src/gpu/accelerated/cpu_data_processor.py:226:80: E501 line too long (94 > 79 characters)
        avg_gain = gain.rolling(window=14, min_periods=1).mean().iloc[-1] # Ensure min_periods
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:227:74: E261 at least two spaces before inline comment
        avg_loss = loss.rolling(window=14, min_periods=1).mean().iloc[-1] # Ensure min_periods
                                                                         ^
src/gpu/accelerated/cpu_data_processor.py:227:80: E501 line too long (94 > 79 characters)
        avg_loss = loss.rolling(window=14, min_periods=1).mean().iloc[-1] # Ensure min_periods
                                                                               ^
src/gpu/accelerated/cpu_data_processor.py:236:1: D400 First line should end with a period
        """CPU计算MACD"""
^
src/gpu/accelerated/cpu_data_processor.py:249:1: D400 First line should end with a period
        """CPU计算布林带"""
^
src/gpu/accelerated/cpu_data_processor.py:260:10: W292 no newline at end of file
        }         ^
src/gpu/accelerated/cpu_fallback.py:2:1: D205 1 blank line required between summary line and description
"""
CPU回退版本模块
为GPU加速组件提供完全的CPU替代实现
确保在GPU不可用时，系统仍能正常工作
"""
^
src/gpu/accelerated/cpu_fallback.py:2:1: D400 First line should end with a period
"""
CPU回退版本模块
为GPU加速组件提供完全的CPU替代实现
确保在GPU不可用时，系统仍能正常工作
"""
^
src/gpu/accelerated/cpu_fallback.py:17:80: E501 line too long (80 > 79 characters)
from sklearn.model_selection import train_test_split as sklearn_train_test_split
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:27:1: D400 First line should end with a period
    """CPU版本的处理配置"""
^
src/gpu/accelerated/cpu_fallback.py:38:1: D400 First line should end with a period
    """CPU版本的价格预测器 - GPU版本的完整回退实现"""
^
src/gpu/accelerated/cpu_fallback.py:40:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = False):
^
src/gpu/accelerated/cpu_fallback.py:46:80: E501 line too long (86 > 79 characters)
            "random_forest": RandomForestRegressor(n_estimators=100, random_state=42),
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:66:1: D400 First line should end with a period
        """准备CPU数据"""
^
src/gpu/accelerated/cpu_fallback.py:72:10: N806 variable 'X' in function should be lowercase
        X = data[feature_cols].values
         ^
src/gpu/accelerated/cpu_fallback.py:76:10: N806 variable 'X_scaled' in function should be lowercase
        X_scaled = self.scaler.fit_transform(X)
         ^
src/gpu/accelerated/cpu_fallback.py:81:53: B006 Do not use mutable data structures for argument defaults.  They are created during function definition time. All calls to the function reuse this one instance of that data structure, persisting changes between them.
        self, data: pd.DataFrame, lags: List[int] = [1, 2, 3, 5, 10]
                                                    ^
src/gpu/accelerated/cpu_fallback.py:83:1: D400 First line should end with a period
        """创建滞后特征"""
^
src/gpu/accelerated/cpu_fallback.py:104:1: D400 First line should end with a period
        """计算RSI指标"""
^
src/gpu/accelerated/cpu_fallback.py:113:80: E501 line too long (80 > 79 characters)
        self, prices: pd.Series, fast: int = 12, slow: int = 26, signal: int = 9
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:115:1: D400 First line should end with a period
        """计算MACD指标"""
^
src/gpu/accelerated/cpu_fallback.py:125:1: D400 First line should end with a period
        """准备特征数据"""
^
src/gpu/accelerated/cpu_fallback.py:133:80: E501 line too long (81 > 79 characters)
        feature_data["target"] = feature_data["close"].shift(-prediction_horizon)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:143:1: D400 First line should end with a period
        """训练多个模型"""
^
src/gpu/accelerated/cpu_fallback.py:150:10: N806 variable 'X' in function should be lowercase
        X, y = self._prepare_data_cpu(feature_data)
         ^
src/gpu/accelerated/cpu_fallback.py:151:10: N806 variable 'X_train' in function should be lowercase
        X_train, X_test, y_train, y_test = sklearn_train_test_split(
         ^
src/gpu/accelerated/cpu_fallback.py:151:10: N806 variable 'X_test' in function should be lowercase
        X_train, X_test, y_train, y_test = sklearn_train_test_split(
         ^
src/gpu/accelerated/cpu_fallback.py:192:80: E501 line too long (81 > 79 characters)
                self.performance_stats["best_model"] = (model_name, r2_score_val)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:203:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, model_name: str = None, prediction_horizon: int = 1
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:205:1: D400 First line should end with a period
        """预测价格"""
^
src/gpu/accelerated/cpu_fallback.py:228:10: N806 variable 'X' in function should be lowercase
        X = self.scaler.transform(last_row)
         ^
src/gpu/accelerated/cpu_fallback.py:244:80: E501 line too long (80 > 79 characters)
            prediction_date=datetime.now() + timedelta(days=prediction_horizon),
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:249:80: E501 line too long (81 > 79 characters)
                "mse": self.performance_stats["model_scores"].get(model_name, 0),
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:251:80: E501 line too long (86 > 79 characters)
                "r2_score": self.performance_stats["model_scores"].get(model_name, 0),
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:264:1: D400 First line should end with a period
        """计算预测置信度"""
^
src/gpu/accelerated/cpu_fallback.py:265:80: E501 line too long (85 > 79 characters)
        base_confidence = self.performance_stats["model_scores"].get(model_name, 0.5)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:286:1: D400 First line should end with a period
        """批量预测"""
^
src/gpu/accelerated/cpu_fallback.py:291:80: E501 line too long (81 > 79 characters)
                result = self.predict_price(data, model_name, prediction_horizon)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:300:1: D400 First line should end with a period
        """获取性能总结"""
^
src/gpu/accelerated/cpu_fallback.py:301:80: E501 line too long (84 > 79 characters)
        avg_prediction_time = self.performance_stats["total_prediction_time"] / max(
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:308:80: E501 line too long (81 > 79 characters)
            "total_training_time": self.performance_stats["total_training_time"],
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:318:1: D400 First line should end with a period
        """优化超参数"""
^
src/gpu/accelerated/cpu_fallback.py:324:10: N806 variable 'X' in function should be lowercase
        X, y = self._prepare_data_cpu(feature_data)
         ^
src/gpu/accelerated/cpu_fallback.py:326:80: E501 line too long (86 > 79 characters)
        grid_search = GridSearchCV(Ridge(), param_grid, cv=5, scoring="r2", n_jobs=-1)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:337:1: D400 First line should end with a period
        """保存模型"""
^
src/gpu/accelerated/cpu_fallback.py:352:1: D400 First line should end with a period
        """加载模型"""
^
src/gpu/accelerated/cpu_fallback.py:368:1: D400 First line should end with a period
    """CPU版本的数据处理器 - GPU版本的完整回退实现"""
^
src/gpu/accelerated/cpu_fallback.py:370:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/accelerated/cpu_fallback.py:371:80: E501 line too long (81 > 79 characters)
        self, gpu_enabled: bool = False, n_jobs: int = 1, chunk_size: int = 10000
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:386:1: D400 First line should end with a period
        """数据预处理"""
^
src/gpu/accelerated/cpu_fallback.py:411:1: D400 First line should end with a period
        """去除异常值"""
^
src/gpu/accelerated/cpu_fallback.py:415:14: N806 variable 'Q1' in function should be lowercase
            Q1 = data[col].quantile(0.25)
             ^
src/gpu/accelerated/cpu_fallback.py:416:14: N806 variable 'Q3' in function should be lowercase
            Q3 = data[col].quantile(0.75)
             ^
src/gpu/accelerated/cpu_fallback.py:417:14: N806 variable 'IQR' in function should be lowercase
            IQR = Q3 - Q1
             ^
src/gpu/accelerated/cpu_fallback.py:422:80: E501 line too long (80 > 79 characters)
            data = data[(data[col] >= lower_bound) & (data[col] <= upper_bound)]
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:427:1: D400 First line should end with a period
        """处理缺失值"""
^
src/gpu/accelerated/cpu_fallback.py:441:1: D400 First line should end with a period
        """添加技术指标"""
^
src/gpu/accelerated/cpu_fallback.py:465:1: D400 First line should end with a period
        """特征标准化"""
^
src/gpu/accelerated/cpu_fallback.py:470:80: E501 line too long (87 > 79 characters)
        normalized_df = pd.DataFrame(normalized_features, columns=feature_data.columns)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:480:1: D400 First line should end with a period
        """计算RSI"""
^
src/gpu/accelerated/cpu_fallback.py:488:80: E501 line too long (80 > 79 characters)
    def _calculate_macd(self, prices: pd.Series) -> Tuple[pd.Series, pd.Series]:
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:489:1: D400 First line should end with a period
        """计算MACD"""
^
src/gpu/accelerated/cpu_fallback.py:496:80: E501 line too long (84 > 79 characters)
    def parallel_process(self, data_list: List[pd.DataFrame]) -> List[pd.DataFrame]:
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:497:1: D400 First line should end with a period
        """并行处理多个数据集"""
^
src/gpu/accelerated/cpu_fallback.py:515:1: D400 First line should end with a period
        """获取性能总结"""
^
src/gpu/accelerated/cpu_fallback.py:527:1: D400 First line should end with a period
    """CPU版本的特征生成器 - GPU版本的完整回退实现"""
^
src/gpu/accelerated/cpu_fallback.py:529:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = False):
^
src/gpu/accelerated/cpu_fallback.py:537:1: D400 First line should end with a period
        """生成特征"""
^
src/gpu/accelerated/cpu_fallback.py:551:80: E501 line too long (80 > 79 characters)
                feature_data = self._generate_statistical_features(feature_data)
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:561:1: D400 First line should end with a period
        """生成技术特征"""
^
src/gpu/accelerated/cpu_fallback.py:579:80: E501 line too long (81 > 79 characters)
    def _generate_statistical_features(self, data: pd.DataFrame) -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:580:1: D400 First line should end with a period
        """生成统计特征"""
^
src/gpu/accelerated/cpu_fallback.py:595:1: D400 First line should end with a period
        """生成动量特征"""
^
src/gpu/accelerated/cpu_fallback.py:603:80: E501 line too long (88 > 79 characters)
            data[f"momentum_{period}"] = data["close"] / data["close"].shift(period) - 1
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:607:80: E501 line too long (80 > 79 characters)
    def _generate_volatility_features(self, data: pd.DataFrame) -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:608:1: D400 First line should end with a period
        """生成波动率特征"""
^
src/gpu/accelerated/cpu_fallback.py:625:1: D400 First line should end with a period
        """获取性能总结"""
^
src/gpu/accelerated/cpu_fallback.py:634:1: D400 First line should end with a period
    """智能组件选择器 - 根据环境自动选择GPU或CPU版本"""
^
src/gpu/accelerated/cpu_fallback.py:636:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/accelerated/cpu_fallback.py:641:1: D400 First line should end with a period
        """检查GPU是否可用"""
^
src/gpu/accelerated/cpu_fallback.py:652:1: D400 First line should end with a period
        """获取价格预测器"""
^
src/gpu/accelerated/cpu_fallback.py:672:1: D400 First line should end with a period
        """获取数据处理器"""
^
src/gpu/accelerated/cpu_fallback.py:689:1: D400 First line should end with a period
        """获取特征生成器"""
^
src/gpu/accelerated/cpu_fallback.py:706:1: D400 First line should end with a period
        """获取环境信息"""
^
src/gpu/accelerated/cpu_fallback.py:719:1: D400 First line should end with a period
    """获取全局组件选择器"""
^
src/gpu/accelerated/cpu_fallback.py:723:80: E501 line too long (83 > 79 characters)
def auto_select_component(component_type: str, gpu_enabled: Optional[bool] = None):
                                                                               ^
src/gpu/accelerated/cpu_fallback.py:724:1: D400 First line should end with a period
    """自动选择组件"""
^
src/gpu/accelerated/cpu_fallback.py:738:1: D400 First line should end with a period
    """主函数 - CPU版本测试"""
^
src/gpu/accelerated/cpu_fallback.py:758:5: F841 local variable 'training_results' is assigned to but never used
    training_results = predictor.train_models(test_data[:200])  # 使用小样本
    ^
src/gpu/accelerated/data_processor_gpu.py:1:1: D100 Missing docstring in public module
import time
^
src/gpu/accelerated/data_processor_gpu.py:7:1: F401 'cuml.feature_selection.SelectKBest' imported but unused
from cuml.feature_selection import SelectKBest
^
src/gpu/accelerated/data_processor_gpu.py:8:1: F401 'cuml.decomposition.PCA' imported but unused
from cuml.decomposition import PCA
^
src/gpu/accelerated/data_processor_gpu.py:9:1: F401 'typing.Tuple' imported but unused
from typing import Dict, List, Tuple, Callable, Any
^
src/gpu/accelerated/data_processor_gpu.py:9:1: F401 'typing.Callable' imported but unused
from typing import Dict, List, Tuple, Callable, Any
^
src/gpu/accelerated/data_processor_gpu.py:11:1: F401 'concurrent.futures.ThreadPoolExecutor' imported but unused
from concurrent.futures import ThreadPoolExecutor, as_completed
^
src/gpu/accelerated/data_processor_gpu.py:11:1: F401 'concurrent.futures.as_completed' imported but unused
from concurrent.futures import ThreadPoolExecutor, as_completed
^
src/gpu/accelerated/data_processor_gpu.py:12:80: E501 line too long (80 > 79 characters)
# import dask.dataframe as dd # Dask not directly used in IDataProcessor methods
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:13:80: E501 line too long (88 > 79 characters)
# from dask.distributed import Client # Dask not directly used in IDataProcessor methods
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:19:1: E302 expected 2 blank lines, found 1
class GPUDataProcessorImpl(IDataProcessor):
^
src/gpu/accelerated/data_processor_gpu.py:20:1: D205 1 blank line required between summary line and description
    """
    GPU加速的数据处理器实现
    实现IDataProcessor接口，使用cuDF和cuPy实现高性能数据处理
    支持大规模金融数据的并行处理和实时分析
    """
^
src/gpu/accelerated/data_processor_gpu.py:20:1: D400 First line should end with a period
    """
    GPU加速的数据处理器实现
    实现IDataProcessor接口，使用cuDF和cuPy实现高性能数据处理
    支持大规模金融数据的并行处理和实时分析
    """
^
src/gpu/accelerated/data_processor_gpu.py:26:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = True):
^
src/gpu/accelerated/data_processor_gpu.py:35:80: E501 line too long (88 > 79 characters)
        logger.info(f"GPUDataProcessorImpl initialized with gpu_enabled={gpu_enabled}.")
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:38:1: D400 First line should end with a period
        """加载和预处理数据 (GPU实现)"""
^
src/gpu/accelerated/data_processor_gpu.py:40:80: E501 line too long (85 > 79 characters)
            raise RuntimeError("GPU acceleration is not enabled for this processor.")
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:77:58: E261 at least two spaces before inline comment
            "processed_data": processed_data.to_pandas(), # 返回Pandas DataFrame
                                                         ^
src/gpu/accelerated/data_processor_gpu.py:85:80: E501 line too long (86 > 79 characters)
    def process_batch(self, batch_data: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:86:1: D205 1 blank line required between summary line and description
        """
        GPU批量处理数据
        Args:
            batch_data: 包含数据点（字典）的列表，每个字典应包含 'stock_code', 'price', 'volume', 'timestamp' 等键
        Returns:
            处理后的数据字典列表，包含 'price_change', 'volume_ma' 等
        """
^
src/gpu/accelerated/data_processor_gpu.py:86:1: D400 First line should end with a period
        """
        GPU批量处理数据
        Args:
            batch_data: 包含数据点（字典）的列表，每个字典应包含 'stock_code', 'price', 'volume', 'timestamp' 等键
        Returns:
            处理后的数据字典列表，包含 'price_change', 'volume_ma' 等
        """
^
src/gpu/accelerated/data_processor_gpu.py:89:80: E501 line too long (92 > 79 characters)
        """
        GPU批量处理数据
        Args:
            batch_data: 包含数据点（字典）的列表，每个字典应包含 'stock_code', 'price', 'volume', 'timestamp' 等键
        Returns:
            处理后的数据字典列表，包含 'price_change', 'volume_ma' 等
        """



                                   ^
src/gpu/accelerated/data_processor_gpu.py:94:80: E501 line too long (85 > 79 characters)
            raise RuntimeError("GPU acceleration is not enabled for this processor.")
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:106:1: W293 blank line contains whitespace

^
src/gpu/accelerated/data_processor_gpu.py:108:53: E261 at least two spaces before inline comment
        if 'volume' in df.columns and len(df) >= 20: # 至少20个数据点才能计算20日均线
                                                    ^
src/gpu/accelerated/data_processor_gpu.py:109:80: E501 line too long (83 > 79 characters)
            df['volume_ma'] = df['volume'].rolling(window=20, min_periods=1).mean()
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:121:51: E261 at least two spaces before inline comment
                "timestamp": row.get("timestamp"), # 假设timestamp存在
                                                  ^
src/gpu/accelerated/data_processor_gpu.py:122:80: E501 line too long (94 > 79 characters)
                "price_change": row["price_change"] if pd.notna(row["price_change"]) else 0.0,
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:123:80: E501 line too long (85 > 79 characters)
                "volume_ma": row["volume_ma"] if pd.notna(row["volume_ma"]) else 0.0,
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:127:80: E501 line too long (106 > 79 characters)
    def compute_features(self, historical_data: List[Dict], feature_types: List[str]) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:128:1: D200 One-line docstring should fit on one line with quotes
        """
        GPU计算技术特征
        """
^
src/gpu/accelerated/data_processor_gpu.py:128:1: D400 First line should end with a period
        """
        GPU计算技术特征
        """
^
src/gpu/accelerated/data_processor_gpu.py:132:80: E501 line too long (85 > 79 characters)
            raise RuntimeError("GPU acceleration is not enabled for this processor.")
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:134:43: E261 at least two spaces before inline comment
        df = pd.DataFrame(historical_data) # 先转为Pandas，再转cudf
                                          ^
src/gpu/accelerated/data_processor_gpu.py:137:66: E261 at least two spaces before inline comment
        if df.empty or 'price' not in df.columns or len(df) < 20: # 至少20个数据点
                                                                 ^
src/gpu/accelerated/data_processor_gpu.py:138:80: E501 line too long (104 > 79 characters)
            self.logger.warning("Historical data is insufficient or empty for GPU feature calculation.")
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:143:80: E501 line too long (104 > 79 characters)
        volumes = df_gpu["volume"] if "volume" in df_gpu.columns else cudf.Series(0, index=df_gpu.index)
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:147:80: E501 line too long (85 > 79 characters)
                features["sma_20"] = float(prices.rolling(window=20).mean().iloc[-1])
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:150:80: E501 line too long (89 > 79 characters)
                    features["sma_50"] = float(prices.rolling(window=50).mean().iloc[-1])
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:164:80: E501 line too long (102 > 79 characters)
                features["volume_ratio"] = float(current_volume / volume_ma) if volume_ma > 0 else 0.0
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:168:5: E303 too many blank lines (2)
    # --- 辅助方法 ---
    ^
src/gpu/accelerated/data_processor_gpu.py:170:5: E301 expected 1 blank line, found 0
    def _check_data_quality(self, data: cudf.DataFrame) -> Dict[str, float]:
    ^
src/gpu/accelerated/data_processor_gpu.py:171:1: D400 First line should end with a period
        """检查数据质量"""
^
src/gpu/accelerated/data_processor_gpu.py:177:80: E501 line too long (155 > 79 characters)
        quality_metrics["missing_ratio"] = missing_ratio.item() if hasattr(missing_ratio, 'item') else missing_ratio # Convert cupy scalar to python scalar
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:177:117: E261 at least two spaces before inline comment
        quality_metrics["missing_ratio"] = missing_ratio.item() if hasattr(missing_ratio, 'item') else missing_ratio # Convert cupy scalar to python scalar
                                                                                                                    ^
src/gpu/accelerated/data_processor_gpu.py:180:80: E501 line too long (124 > 79 characters)
        quality_metrics["duplicate_ratio"] = duplicate_ratio.item() if hasattr(duplicate_ratio, 'item') else duplicate_ratio
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:182:79: E261 at least two spaces before inline comment
        numeric_columns = data.select_dtypes(include=["float", "int"]).columns # cudf uses "float", "int"
                                                                              ^
src/gpu/accelerated/data_processor_gpu.py:182:80: E501 line too long (105 > 79 characters)
        numeric_columns = data.select_dtypes(include=["float", "int"]).columns # cudf uses "float", "int"
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:185:80: E501 line too long (86 > 79 characters)
            # inf_count = cudf.Series(cp.isinf(data[numeric_columns].to_cupy()).sum())
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:186:80: E501 line too long (82 > 79 characters)
            # For simplicity, convert to pandas and back or use cudf's own methods
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:187:80: E501 line too long (105 > 79 characters)
            inf_count = data[numeric_columns].applymap(lambda x: x == cp.inf or x == -cp.inf).sum().sum()
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:189:80: E501 line too long (104 > 79 characters)
            quality_metrics["inf_ratio"] = inf_ratio.item() if hasattr(inf_ratio, 'item') else inf_ratio
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:193:80: E501 line too long (97 > 79 characters)
        quality_metrics["dtype_distribution"] = {str(k): int(v) for k, v in dtype_counts.items()}
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:198:1: D400 First line should end with a period
        """处理缺失值"""
^
src/gpu/accelerated/data_processor_gpu.py:202:80: E501 line too long (104 > 79 characters)
        numeric_columns = df_gpu.select_dtypes(include=["float64", "int64", "float32", "int32"]).columns
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:209:80: E501 line too long (90 > 79 characters)
        categorical_columns = df_gpu.select_dtypes(include=["object", "category"]).columns
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:213:39: E261 at least two spaces before inline comment
                if not mode_val.empty: # mode() can return empty if all are NaN
                                      ^
src/gpu/accelerated/data_processor_gpu.py:218:1: D400 First line should end with a period
        """优化数据类型"""
^
src/gpu/accelerated/data_processor_gpu.py:227:1: W293 blank line contains whitespace

^
src/gpu/accelerated/data_processor_gpu.py:233:62: E261 at least two spaces before inline comment
            if len(df_gpu[col].unique()) / len(df_gpu) < 0.5: # Example threshold
                                                             ^
src/gpu/accelerated/data_processor_gpu.py:233:80: E501 line too long (81 > 79 characters)
            if len(df_gpu[col].unique()) / len(df_gpu) < 0.5: # Example threshold
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:238:80: E501 line too long (92 > 79 characters)
    def _handle_outliers(self, data: cudf.DataFrame, method: str = "iqr") -> cudf.DataFrame:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:239:1: D400 First line should end with a period
        """处理异常值"""
^
src/gpu/accelerated/data_processor_gpu.py:241:80: E501 line too long (104 > 79 characters)
        numeric_columns = df_gpu.select_dtypes(include=["float32", "int32", "float64", "int64"]).columns
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:248:18: N806 variable 'Q1' in function should be lowercase
                Q1 = df_gpu[col].quantile(0.25)
                 ^
src/gpu/accelerated/data_processor_gpu.py:249:18: N806 variable 'Q3' in function should be lowercase
                Q3 = df_gpu[col].quantile(0.75)
                 ^
src/gpu/accelerated/data_processor_gpu.py:250:18: N806 variable 'IQR' in function should be lowercase
                IQR = Q3 - Q1
                 ^
src/gpu/accelerated/data_processor_gpu.py:259:80: E501 line too long (94 > 79 characters)
                # Need to handle potential division by zero for std_val if all values are same
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:267:1: D400 First line should end with a period
        """特征标准化"""
^
src/gpu/accelerated/data_processor_gpu.py:268:74: E261 at least two spaces before inline comment
        numeric_columns = data.select_dtypes(include=[np.number]).columns # Use np.number as cudf dtypes can vary but map to numpy
                                                                         ^
src/gpu/accelerated/data_processor_gpu.py:268:80: E501 line too long (130 > 79 characters)
        numeric_columns = data.select_dtypes(include=[np.number]).columns # Use np.number as cudf dtypes can vary but map to numpy
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:276:80: E501 line too long (107 > 79 characters)
        normalized_df = cudf.DataFrame(normalized_features, columns=feature_data.columns, index=data.index)
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:287:1: D400 First line should end with a period
        """GPU计算RSI"""
^
src/gpu/accelerated/data_processor_gpu.py:297:25: E261 at least two spaces before inline comment
            return 100.0 # Or handle as NaN / Inf based on desired behavior
                        ^
src/gpu/accelerated/data_processor_gpu.py:298:1: W293 blank line contains whitespace

^
src/gpu/accelerated/data_processor_gpu.py:304:1: D400 First line should end with a period
        """GPU计算MACD"""
^
src/gpu/accelerated/data_processor_gpu.py:316:80: E501 line too long (80 > 79 characters)
    def _calculate_bollinger_gpu(self, prices: cudf.Series) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:317:1: D400 First line should end with a period
        """GPU计算布林带"""
^
src/gpu/accelerated/data_processor_gpu.py:330:80: E501 line too long (93 > 79 characters)
    # The following methods from the original GPUDataProcessor are not part of IDataProcessor
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:331:80: E501 line too long (91 > 79 characters)
    # and would need to be moved to other specialized GPU engine implementations or removed
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:335:80: E501 line too long (92 > 79 characters)
    # def parallel_processing(self, data_list: List[pd.DataFrame]) -> BatchProcessingResult:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:343:80: E501 line too long (127 > 79 characters)
    # def real_time_data_streaming(self, data_stream: Callable[[], pd.DataFrame], window_size: int = 1000) -> ProcessingResult:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:347:80: E501 line too long (85 > 79 characters)
    # def feature_engineering_pipeline(self, data: pd.DataFrame) -> ProcessingResult:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:351:80: E501 line too long (80 > 79 characters)
    # def feature_selection(self, data: pd.DataFrame, k: int = 50) -> List[str]:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:355:80: E501 line too long (101 > 79 characters)
    # def dimensionality_reduction(self, data: pd.DataFrame, n_components: int = 20) -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:359:80: E501 line too long (84 > 79 characters)
    # def feature_importance_analysis(self, data: pd.DataFrame) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:363:80: E501 line too long (101 > 79 characters)
    # def time_series_processing(self, data: pd.DataFrame, frequency: str = "D") -> ProcessingResult:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:367:80: E501 line too long (104 > 79 characters)
    # def anomaly_detection(self, data: pd.DataFrame, method: str = "isolation_forest") -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:383:80: E501 line too long (86 > 79 characters)
    # The BatchDataProcessor and benchmark_data_processing sections should be external
                                                                               ^
src/gpu/accelerated/data_processor_gpu.py:384:80: E501 line too long (96 > 79 characters)
    # or moved to a higher-level orchestration class, not part of IDataProcessor implementation.
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:2:1: D205 1 blank line required between summary line and description
"""
GPU加速的特征生成器
使用cuDF和cuPy实现高性能特征工程
支持大规模金融数据的并行特征计算
"""
^
src/gpu/accelerated/feature_generator_gpu.py:2:1: D400 First line should end with a period
"""
GPU加速的特征生成器
使用cuDF和cuPy实现高性能特征工程
支持大规模金融数据的并行特征计算
"""
^
src/gpu/accelerated/feature_generator_gpu.py:22:1: D400 First line should end with a period
    """特征计算结果"""
^
src/gpu/accelerated/feature_generator_gpu.py:34:1: D400 First line should end with a period
    """批量特征计算结果"""
^
src/gpu/accelerated/feature_generator_gpu.py:43:1: D400 First line should end with a period
    """GPU加速的特征生成器"""
^
src/gpu/accelerated/feature_generator_gpu.py:45:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = True, n_jobs: int = 1):
^
src/gpu/accelerated/feature_generator_gpu.py:54:80: E501 line too long (87 > 79 characters)
                "indicators": ["sma", "ema", "rsi", "macd", "bollinger", "stochastic"],
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:66:80: E501 line too long (80 > 79 characters)
                "indicators": ["atr", "standard_deviation", "volatility_ratio"],
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:71:80: E501 line too long (80 > 79 characters)
    def generate_technical_indicators(self, data: pd.DataFrame) -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:72:1: D400 First line should end with a period
        """生成技术指标特征（GPU加速）"""
^
src/gpu/accelerated/feature_generator_gpu.py:113:80: E501 line too long (80 > 79 characters)
        df_gpu["stochastic_d"] = df_gpu["stochastic_k"].rolling(window=3).mean()
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:129:80: E501 line too long (87 > 79 characters)
    def _calculate_rsi_gpu(self, prices: cudf.Series, period: int = 14) -> cudf.Series:
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:130:1: D400 First line should end with a period
        """GPU加速的RSI计算"""
^
src/gpu/accelerated/feature_generator_gpu.py:138:80: E501 line too long (80 > 79 characters)
    def generate_statistical_features(self, data: pd.DataFrame) -> pd.DataFrame:
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:139:1: D400 First line should end with a period
        """生成统计特征（GPU加速）"""
^
src/gpu/accelerated/feature_generator_gpu.py:153:80: E501 line too long (80 > 79 characters)
            df_gpu[f"percentile_{window}"] = prices.rolling(window=window).rank(
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:178:1: D400 First line should end with a period
        """生成动量特征（GPU加速）"""
^
src/gpu/accelerated/feature_generator_gpu.py:201:80: E501 line too long (80 > 79 characters)
        mad = tp.rolling(window=20).apply(lambda x: np.abs(x - x.mean()).mean())
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:213:1: D400 First line should end with a period
        """生成波动率特征（GPU加速）"""
^
src/gpu/accelerated/feature_generator_gpu.py:243:80: E501 line too long (86 > 79 characters)
        df_gpu["volatility_ratio"] = df_gpu["volatility_10"] / df_gpu["volatility_20"]
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:247:80: E501 line too long (82 > 79 characters)
            cp.sqrt((1 / (4 * cp.log(2))) * cp.sum(cp.square(cp.log(high / low))))
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:249:80: E501 line too long (87 > 79 characters)
            else np.sqrt((1 / (4 * np.log(2))) * np.sum(np.square(np.log(high / low))))
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:251:80: E501 line too long (80 > 79 characters)
        df_gpu["parkinson_volatility"] = parkinson_vol.rolling(window=20).mean()
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:262:1: D400 First line should end with a period
        """生成形态学特征（GPU加速）"""
^
src/gpu/accelerated/feature_generator_gpu.py:277:80: E501 line too long (82 > 79 characters)
        df_gpu["is_shooting_star"] = self._detect_shooting_star(prices, high, low)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:305:1: D400 First line should end with a period
        """识别十字星形态"""
^
src/gpu/accelerated/feature_generator_gpu.py:313:1: D400 First line should end with a period
        """识别锤子形态"""
^
src/gpu/accelerated/feature_generator_gpu.py:322:1: D400 First line should end with a period
        """识别射击之星形态"""
^
src/gpu/accelerated/feature_generator_gpu.py:329:1: D400 First line should end with a period
        """生成所有特征"""
^
src/gpu/accelerated/feature_generator_gpu.py:336:80: E501 line too long (83 > 79 characters)
        data_with_features = self.generate_statistical_features(data_with_features)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:339:80: E501 line too long (80 > 79 characters)
        data_with_features = self.generate_momentum_features(data_with_features)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:342:80: E501 line too long (82 > 79 characters)
        data_with_features = self.generate_volatility_features(data_with_features)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:368:80: E501 line too long (80 > 79 characters)
    def _evaluate_feature_quality(self, data: pd.DataFrame) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:369:1: D400 First line should end with a period
        """评估特征质量"""
^
src/gpu/accelerated/feature_generator_gpu.py:401:1: D400 First line should end with a period
        """批量特征生成"""
^
src/gpu/accelerated/feature_generator_gpu.py:420:80: E501 line too long (80 > 79 characters)
        avg_features_per_stock = total_features / len(results) if results else 0
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:435:31: F821 undefined name 'pdDataFrame'
        self, data_list: List[pdDataFrame], batch_size: int = 10
                              ^
src/gpu/accelerated/feature_generator_gpu.py:437:1: D400 First line should end with a period
        """并行特征生成"""
^
src/gpu/accelerated/feature_generator_gpu.py:448:28: E203 whitespace before ':'
                data_list[i : i + batch_size]
                           ^
src/gpu/accelerated/feature_generator_gpu.py:454:80: E501 line too long (80 > 79 characters)
                executor.submit(self.batch_feature_generation, batch): batch_idx
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:471:80: E501 line too long (82 > 79 characters)
                np.mean([len(r.feature_names) for r in results]) if results else 0
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:479:1: D400 First line should end with a period
        """特征选择"""
^
src/gpu/accelerated/feature_generator_gpu.py:496:14: N806 variable 'X' in function should be lowercase
            X = data.select_dtypes(include=[np.number]).drop(
             ^
src/gpu/accelerated/feature_generator_gpu.py:502:18: N806 variable 'X_gpu' in function should be lowercase
                X_gpu = cudf.DataFrame(X)
                 ^
src/gpu/accelerated/feature_generator_gpu.py:522:1: D400 First line should end with a period
        """特征标准化"""
^
src/gpu/accelerated/feature_generator_gpu.py:554:1: D400 First line should end with a period
        """保存特征缓存"""
^
src/gpu/accelerated/feature_generator_gpu.py:565:1: D400 First line should end with a period
        """加载特征缓存"""
^
src/gpu/accelerated/feature_generator_gpu.py:575:1: D400 First line should end with a period
    """多股票特征生成器"""
^
src/gpu/accelerated/feature_generator_gpu.py:577:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = True, max_stocks: int = 1000):
^
src/gpu/accelerated/feature_generator_gpu.py:585:1: D400 First line should end with a period
        """为多只股票生成特征"""
^
src/gpu/accelerated/feature_generator_gpu.py:593:40: E203 whitespace before ':'
            batch_codes = stock_codes[i : i + batch_size]
                                       ^
src/gpu/accelerated/feature_generator_gpu.py:597:80: E501 line too long (84 > 79 characters)
            batch_results = self.base_generator.batch_feature_generation(batch_data)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:609:1: D400 First line should end with a period
        """生成横截面特征"""
^
src/gpu/accelerated/feature_generator_gpu.py:619:80: E501 line too long (80 > 79 characters)
        cross_sectional_df = pd.DataFrame.from_dict(latest_data, orient="index")
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:626:80: E501 line too long (80 > 79 characters)
            features["market_cap_rank"] = cross_sectional_df["market_cap"].rank(
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:632:80: E501 line too long (80 > 79 characters)
            col for col in cross_sectional_df.columns if "return" in col.lower()
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:635:80: E501 line too long (83 > 79 characters)
            features[f"{col}_rank"] = cross_sectional_df[col].rank(ascending=False)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:639:80: E501 line too long (84 > 79 characters)
            col for col in cross_sectional_df.columns if "volatility" in col.lower()
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:642:80: E501 line too long (82 > 79 characters)
            features[f"{col}_rank"] = cross_sectional_df[col].rank(ascending=True)
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:655:1: D400 First line should end with a period
    """特征生成性能基准测试"""
^
src/gpu/accelerated/feature_generator_gpu.py:671:11: F541 f-string is missing placeholders
    print(f"\n📊 特征生成性能对比:")
          ^
src/gpu/accelerated/feature_generator_gpu.py:677:80: E501 line too long (81 > 79 characters)
    print(f"GPU内存使用: {gpu_result.memory_usage['total_memory']/1024/1024:.2f} MB")
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:704:80: E501 line too long (80 > 79 characters)
    batch_result = generator.batch_feature_generation(list(stock_data.values()))
                                                                               ^
src/gpu/accelerated/feature_generator_gpu.py:706:11: F541 f-string is missing placeholders
    print(f"批量处理完成:")
          ^
src/gpu/accelerated/feature_generator_gpu.py:712:80: E501 line too long (82 > 79 characters)
    benchmark_results = benchmark_feature_generation(list(stock_data.values())[0])
                                                                               ^
src/gpu/accelerated/gpu_manager.py:2:1: D205 1 blank line required between summary line and description
"""
GPU加速统一管理器
集成GPU组件到MyStocks项目的统一管理系统中
支持自动检测GPU环境并提供统一的GPU加速接口
"""
^
src/gpu/accelerated/gpu_manager.py:2:1: D400 First line should end with a period
"""
GPU加速统一管理器
集成GPU组件到MyStocks项目的统一管理系统中
支持自动检测GPU环境并提供统一的GPU加速接口
"""
^
src/gpu/accelerated/gpu_manager.py:22:1: D400 First line should end with a period
    """GPU配置"""
^
src/gpu/accelerated/gpu_manager.py:35:1: D400 First line should end with a period
    """GPU处理结果"""
^
src/gpu/accelerated/gpu_manager.py:47:1: D400 First line should end with a period
    """GPU加速统一管理器"""
^
src/gpu/accelerated/gpu_manager.py:50:1: D400 First line should end with a period
        """初始化GPU统一管理器"""
^
src/gpu/accelerated/gpu_manager.py:61:80: E501 line too long (82 > 79 characters)
        self.feature_generator = GPUFeatureGenerator(gpu_enabled=self.gpu_enabled)
                                                                               ^
src/gpu/accelerated/gpu_manager.py:76:1: D400 First line should end with a period
        """检测GPU环境是否可用"""
^
src/gpu/accelerated/gpu_manager.py:89:80: E501 line too long (86 > 79 characters)
        self, data: pd.DataFrame, processing_config: Optional[ProcessingConfig] = None
                                                                               ^
src/gpu/accelerated/gpu_manager.py:91:1: D400 First line should end with a period
        """使用GPU处理数据"""
^
src/gpu/accelerated/gpu_manager.py:101:80: E501 line too long (83 > 79 characters)
            feature_data = self.feature_generator.generate_features(processed_data)
                                                                               ^
src/gpu/accelerated/gpu_manager.py:112:80: E501 line too long (84 > 79 characters)
                        cp.cuda.get_default_memory_pool().used_bytes() / 1024 / 1024
                                                                               ^
src/gpu/accelerated/gpu_manager.py:121:80: E501 line too long (85 > 79 characters)
                speedup_factor=self._calculate_speedup_factor(data, processing_time),
                                                                               ^
src/gpu/accelerated/gpu_manager.py:157:1: D400 First line should end with a period
        """使用GPU生成预测"""
^
src/gpu/accelerated/gpu_manager.py:164:80: E501 line too long (82 > 79 characters)
                    data if training_horizon is None else data[-training_horizon:]
                                                                               ^
src/gpu/accelerated/gpu_manager.py:167:17: F841 local variable 'training_results' is assigned to but never used
                training_results = self.price_predictor.train_models(training_data)
                ^
src/gpu/accelerated/gpu_manager.py:167:80: E501 line too long (83 > 79 characters)
                training_results = self.price_predictor.train_models(training_data)
                                                                               ^
src/gpu/accelerated/gpu_manager.py:172:80: E501 line too long (87 > 79 characters)
                data=data, model_name=model_type, prediction_horizon=prediction_horizon
                                                                               ^
src/gpu/accelerated/gpu_manager.py:181:80: E501 line too long (85 > 79 characters)
                speedup_factor=self._calculate_speedup_factor(data, processing_time),
                                                                               ^
src/gpu/accelerated/gpu_manager.py:188:80: E501 line too long (83 > 79 characters)
                    "r2_score": prediction_result.error_metrics.get("r2_score", 0),
                                                                               ^
src/gpu/accelerated/gpu_manager.py:195:80: E501 line too long (92 > 79 characters)
                f"GPU预测完成 - 模型: {model_type}, 预测价格: {prediction_result.predicted_price:.2f}"
                                                                               ^
src/gpu/accelerated/gpu_manager.py:218:1: D400 First line should end with a period
        """批量GPU处理"""
^
src/gpu/accelerated/gpu_manager.py:255:80: E501 line too long (91 > 79 characters)
            f"批量GPU处理完成 - 成功: {len([r for r in results if not r.errors])}/{len(data_list)}"
                                                                               ^
src/gpu/accelerated/gpu_manager.py:262:1: D400 First line should end with a period
        """使用GPU优化超参数"""
^
src/gpu/accelerated/gpu_manager.py:266:80: E501 line too long (80 > 79 characters)
            optimization_result = self.price_predictor.optimize_hyperparameters(
                                                                               ^
src/gpu/accelerated/gpu_manager.py:276:80: E501 line too long (85 > 79 characters)
                speedup_factor=self._calculate_speedup_factor(data, processing_time),
                                                                               ^
src/gpu/accelerated/gpu_manager.py:289:80: E501 line too long (102 > 79 characters)
                f"GPU超参数优化完成 - 模型: {model_type}, 最佳分数: {optimization_result.get('best_score', 0):.4f}"
                                                                               ^
src/gpu/accelerated/gpu_manager.py:312:1: D400 First line should end with a period
        """GPU与CPU性能对比"""
^
src/gpu/accelerated/gpu_manager.py:384:80: E501 line too long (87 > 79 characters)
            f"性能对比完成 - GPU: {gpu_time:.4f}s, CPU: {cpu_time:.4f}s, 加速比: {speedup:.2f}x"
                                                                               ^
src/gpu/accelerated/gpu_manager.py:391:1: D400 First line should end with a period
        """计算加速因子"""
^
src/gpu/accelerated/gpu_manager.py:401:1: D400 First line should end with a period
        """获取GPU内存使用情况"""
^
src/gpu/accelerated/gpu_manager.py:413:1: D400 First line should end with a period
        """收集性能指标"""
^
src/gpu/accelerated/gpu_manager.py:428:1: D400 First line should end with a period
        """更新性能统计"""
^
src/gpu/accelerated/gpu_manager.py:429:80: E501 line too long (81 > 79 characters)
        self.performance_stats["total_processing_time"] += result.processing_time
                                                                               ^
src/gpu/accelerated/gpu_manager.py:448:1: D400 First line should end with a period
        """获取性能总结"""
^
src/gpu/accelerated/gpu_manager.py:467:80: E501 line too long (80 > 79 characters)
                    "total_predictions": self.price_predictor.performance_stats[
                                                                               ^
src/gpu/accelerated/gpu_manager.py:481:1: D400 First line should end with a period
        """保存GPU模型"""
^
src/gpu/accelerated/gpu_manager.py:489:1: D400 First line should end with a period
        """加载GPU模型"""
^
src/gpu/accelerated/gpu_manager.py:497:1: D400 First line should end with a period
        """生成GPU使用报告"""
^
src/gpu/accelerated/gpu_manager.py:514:80: E501 line too long (96 > 79 characters)
        report = f"""
MyStocks GPU加速使用报告
==========================

🚀 GPU环境状态: {'✅ 启用' if self.gpu_enabled else '❌ 禁用'}

📊 性能统计:
  • 总处理时间: {summary['total_processing_time']:.2f}秒
  • 总处理数据量: {summary['total_data_processed']}行
  • GPU操作次数: {summary['gpu_enabled_operations']}
  • CPU回退次数: {summary['cpu_fallback_operations']}
  • 平均加速比: {summary['average_speedup']:.2f}x

🔧 GPU组件状态:
  • 数据处理器: {'✅ 启用' if summary['gpu_components_status']['data_processor']['enabled'] else '❌ 禁用'}
  • 特征生成器: {'✅ 启用' if summary['gpu_components_status']['feature_generator']['enabled'] else '❌ 禁用'}
  • 价格预测器: {'✅ 启用' if summary['gpu_components_status']['price_predictor']['enabled'] else '❌ 禁用'}
  • 模型训练状态: {'✅ 已训练' if summary['gpu_components_status']['price_predictor']['is_fitted'] else '❌ 未训练'}
  • 总预测次数: {summary['gpu_components_status']['price_predictor']['total_predictions']}

⚙️  配置信息:
  • 并行任务数: {summary['configuration']['n_jobs']}
  • 块大小: {summary['configuration']['chunk_size']}
  • 内存限制: {summary['configuration']['memory_limit_gb']}GB

💡 使用建议:
  • 如果GPU操作失败频繁增加，建议检查GPU内存使用情况
  • 对于大数据集，适当增加chunk_size可以提高处理效率
  • 定期保存训练好的模型以避免重复训练

"""




          ^
src/gpu/accelerated/gpu_manager.py:515:80: E501 line too long (99 > 79 characters)
        report = f"""
MyStocks GPU加速使用报告
==========================

🚀 GPU环境状态: {'✅ 启用' if self.gpu_enabled else '❌ 禁用'}

📊 性能统计:
  • 总处理时间: {summary['total_processing_time']:.2f}秒
  • 总处理数据量: {summary['total_data_processed']}行
  • GPU操作次数: {summary['gpu_enabled_operations']}
  • CPU回退次数: {summary['cpu_fallback_operations']}
  • 平均加速比: {summary['average_speedup']:.2f}x

🔧 GPU组件状态:
  • 数据处理器: {'✅ 启用' if summary['gpu_components_status']['data_processor']['enabled'] else '❌ 禁用'}
  • 特征生成器: {'✅ 启用' if summary['gpu_components_status']['feature_generator']['enabled'] else '❌ 禁用'}
  • 价格预测器: {'✅ 启用' if summary['gpu_components_status']['price_predictor']['enabled'] else '❌ 禁用'}
  • 模型训练状态: {'✅ 已训练' if summary['gpu_components_status']['price_predictor']['is_fitted'] else '❌ 未训练'}
  • 总预测次数: {summary['gpu_components_status']['price_predictor']['total_predictions']}

⚙️  配置信息:
  • 并行任务数: {summary['configuration']['n_jobs']}
  • 块大小: {summary['configuration']['chunk_size']}
  • 内存限制: {summary['configuration']['memory_limit_gb']}GB

💡 使用建议:
  • 如果GPU操作失败频繁增加，建议检查GPU内存使用情况
  • 对于大数据集，适当增加chunk_size可以提高处理效率
  • 定期保存训练好的模型以避免重复训练

"""




          ^
src/gpu/accelerated/gpu_manager.py:516:80: E501 line too long (97 > 79 characters)
        report = f"""
MyStocks GPU加速使用报告
==========================

🚀 GPU环境状态: {'✅ 启用' if self.gpu_enabled else '❌ 禁用'}

📊 性能统计:
  • 总处理时间: {summary['total_processing_time']:.2f}秒
  • 总处理数据量: {summary['total_data_processed']}行
  • GPU操作次数: {summary['gpu_enabled_operations']}
  • CPU回退次数: {summary['cpu_fallback_operations']}
  • 平均加速比: {summary['average_speedup']:.2f}x

🔧 GPU组件状态:
  • 数据处理器: {'✅ 启用' if summary['gpu_components_status']['data_processor']['enabled'] else '❌ 禁用'}
  • 特征生成器: {'✅ 启用' if summary['gpu_components_status']['feature_generator']['enabled'] else '❌ 禁用'}
  • 价格预测器: {'✅ 启用' if summary['gpu_components_status']['price_predictor']['enabled'] else '❌ 禁用'}
  • 模型训练状态: {'✅ 已训练' if summary['gpu_components_status']['price_predictor']['is_fitted'] else '❌ 未训练'}
  • 总预测次数: {summary['gpu_components_status']['price_predictor']['total_predictions']}

⚙️  配置信息:
  • 并行任务数: {summary['configuration']['n_jobs']}
  • 块大小: {summary['configuration']['chunk_size']}
  • 内存限制: {summary['configuration']['memory_limit_gb']}GB

💡 使用建议:
  • 如果GPU操作失败频繁增加，建议检查GPU内存使用情况
  • 对于大数据集，适当增加chunk_size可以提高处理效率
  • 定期保存训练好的模型以避免重复训练

"""




          ^
src/gpu/accelerated/gpu_manager.py:517:80: E501 line too long (102 > 79 characters)
        report = f"""
MyStocks GPU加速使用报告
==========================

🚀 GPU环境状态: {'✅ 启用' if self.gpu_enabled else '❌ 禁用'}

📊 性能统计:
  • 总处理时间: {summary['total_processing_time']:.2f}秒
  • 总处理数据量: {summary['total_data_processed']}行
  • GPU操作次数: {summary['gpu_enabled_operations']}
  • CPU回退次数: {summary['cpu_fallback_operations']}
  • 平均加速比: {summary['average_speedup']:.2f}x

🔧 GPU组件状态:
  • 数据处理器: {'✅ 启用' if summary['gpu_components_status']['data_processor']['enabled'] else '❌ 禁用'}
  • 特征生成器: {'✅ 启用' if summary['gpu_components_status']['feature_generator']['enabled'] else '❌ 禁用'}
  • 价格预测器: {'✅ 启用' if summary['gpu_components_status']['price_predictor']['enabled'] else '❌ 禁用'}
  • 模型训练状态: {'✅ 已训练' if summary['gpu_components_status']['price_predictor']['is_fitted'] else '❌ 未训练'}
  • 总预测次数: {summary['gpu_components_status']['price_predictor']['total_predictions']}

⚙️  配置信息:
  • 并行任务数: {summary['configuration']['n_jobs']}
  • 块大小: {summary['configuration']['chunk_size']}
  • 内存限制: {summary['configuration']['memory_limit_gb']}GB

💡 使用建议:
  • 如果GPU操作失败频繁增加，建议检查GPU内存使用情况
  • 对于大数据集，适当增加chunk_size可以提高处理效率
  • 定期保存训练好的模型以避免重复训练

"""




          ^
src/gpu/accelerated/gpu_manager.py:518:80: E501 line too long (85 > 79 characters)
        report = f"""
MyStocks GPU加速使用报告
==========================

🚀 GPU环境状态: {'✅ 启用' if self.gpu_enabled else '❌ 禁用'}

📊 性能统计:
  • 总处理时间: {summary['total_processing_time']:.2f}秒
  • 总处理数据量: {summary['total_data_processed']}行
  • GPU操作次数: {summary['gpu_enabled_operations']}
  • CPU回退次数: {summary['cpu_fallback_operations']}
  • 平均加速比: {summary['average_speedup']:.2f}x

🔧 GPU组件状态:
  • 数据处理器: {'✅ 启用' if summary['gpu_components_status']['data_processor']['enabled'] else '❌ 禁用'}
  • 特征生成器: {'✅ 启用' if summary['gpu_components_status']['feature_generator']['enabled'] else '❌ 禁用'}
  • 价格预测器: {'✅ 启用' if summary['gpu_components_status']['price_predictor']['enabled'] else '❌ 禁用'}
  • 模型训练状态: {'✅ 已训练' if summary['gpu_components_status']['price_predictor']['is_fitted'] else '❌ 未训练'}
  • 总预测次数: {summary['gpu_components_status']['price_predictor']['total_predictions']}

⚙️  配置信息:
  • 并行任务数: {summary['configuration']['n_jobs']}
  • 块大小: {summary['configuration']['chunk_size']}
  • 内存限制: {summary['configuration']['memory_limit_gb']}GB

💡 使用建议:
  • 如果GPU操作失败频繁增加，建议检查GPU内存使用情况
  • 对于大数据集，适当增加chunk_size可以提高处理效率
  • 定期保存训练好的模型以避免重复训练

"""




          ^
src/gpu/accelerated/gpu_manager.py:536:1: D400 First line should end with a period
    """MyStocks项目GPU适配器"""
^
src/gpu/accelerated/gpu_manager.py:538:1: D107 Missing docstring in __init__
    def __init__(self, unified_manager=None):
^
src/gpu/accelerated/gpu_manager.py:543:1: D400 First line should end with a period
        """启用GPU加速"""
^
src/gpu/accelerated/gpu_manager.py:549:1: D400 First line should end with a period
        """禁用GPU加速"""
^
src/gpu/accelerated/gpu_manager.py:555:1: D400 First line should end with a period
        """检查GPU是否可用"""
^
src/gpu/accelerated/gpu_manager.py:559:1: D400 First line should end with a period
        """获取GPU状态"""
^
src/gpu/accelerated/gpu_manager.py:568:1: D400 First line should end with a period
    """主函数 - 示例用法"""
^
src/gpu/accelerated/integration_interface.py:2:1: D205 1 blank line required between summary line and description
"""
GPU加速集成接口
将GPU组件集成到MyStocks项目的统一管理系统中
提供与传统MyStocksUnifiedManager的无缝集成
"""
^
src/gpu/accelerated/integration_interface.py:2:1: D400 First line should end with a period
"""
GPU加速集成接口
将GPU组件集成到MyStocks项目的统一管理系统中
提供与传统MyStocksUnifiedManager的无缝集成
"""
^
src/gpu/accelerated/integration_interface.py:22:1: D400 First line should end with a period
    """GPU集成配置"""
^
src/gpu/accelerated/integration_interface.py:33:1: D400 First line should end with a period
    """GPU增强的统一管理器 - 继承自原有的统一管理器"""
^
src/gpu/accelerated/integration_interface.py:35:1: D107 Missing docstring in __init__
    def __init__(self, config: Optional[GPUIntegrationConfig] = None):
^
src/gpu/accelerated/integration_interface.py:62:1: D202 No blank lines allowed after function docstring
        """使用GPU保存分类数据 - 覆盖原方法"""
^
src/gpu/accelerated/integration_interface.py:62:1: D400 First line should end with a period
        """使用GPU保存分类数据 - 覆盖原方法"""
^
src/gpu/accelerated/integration_interface.py:97:80: E501 line too long (87 > 79 characters)
                result = super().save_data_by_classification(data, data_classification)
                                                                               ^
src/gpu/accelerated/integration_interface.py:119:80: E501 line too long (80 > 79 characters)
            self.gpu_usage_stats["performance_history"].append(performance_data)
                                                                               ^
src/gpu/accelerated/integration_interface.py:129:80: E501 line too long (87 > 79 characters)
                result = super().save_data_by_classification(data, data_classification)
                                                                               ^
src/gpu/accelerated/integration_interface.py:140:1: D202 No blank lines allowed after function docstring
        """使用GPU加载分类数据 - 覆盖原方法"""
^
src/gpu/accelerated/integration_interface.py:140:1: D400 First line should end with a period
        """使用GPU加载分类数据 - 覆盖原方法"""
^
src/gpu/accelerated/integration_interface.py:214:1: D202 No blank lines allowed after function docstring
        """使用GPU生成价格预测 - 新增方法"""
^
src/gpu/accelerated/integration_interface.py:214:1: D400 First line should end with a period
        """使用GPU生成价格预测 - 新增方法"""
^
src/gpu/accelerated/integration_interface.py:218:80: E501 line too long (81 > 79 characters)
            stock_data if isinstance(stock_data, pd.DataFrame) else None, use_gpu
                                                                               ^
src/gpu/accelerated/integration_interface.py:226:80: E501 line too long (81 > 79 characters)
                from ..data_adapters.financial_adapter import FinancialDataSource
                                                                               ^
src/gpu/accelerated/integration_interface.py:237:80: E501 line too long (83 > 79 characters)
                prediction_result = self.gpu_manager.generate_predictions_with_gpu(
                                                                               ^
src/gpu/accelerated/integration_interface.py:251:80: E501 line too long (81 > 79 characters)
                    "performance_metrics": prediction_result.performance_metrics,
                                                                               ^
src/gpu/accelerated/integration_interface.py:275:80: E501 line too long (83 > 79 characters)
                from ..gpu_accelerated.price_predictor_gpu import PricePredictorCPU
                                                                               ^
src/gpu/accelerated/integration_interface.py:340:1: D202 No blank lines allowed after function docstring
        """判断是否应该使用GPU"""
^
src/gpu/accelerated/integration_interface.py:340:1: D400 First line should end with a period
        """判断是否应该使用GPU"""
^
src/gpu/accelerated/integration_interface.py:380:1: D400 First line should end with a period
        """运行性能基准测试"""
^
src/gpu/accelerated/integration_interface.py:414:1: D400 First line should end with a period
        """获取GPU集成状态"""
^
src/gpu/accelerated/integration_interface.py:420:80: E501 line too long (82 > 79 characters)
            "gpu_performance_summary": self.gpu_manager.get_performance_summary(),
                                                                               ^
src/gpu/accelerated/integration_interface.py:424:80: E501 line too long (83 > 79 characters)
                "gpu_memory_threshold_mb": self.gpu_config.gpu_memory_threshold_mb,
                                                                               ^
src/gpu/accelerated/integration_interface.py:431:1: D400 First line should end with a period
        """保存GPU模型"""
^
src/gpu/accelerated/integration_interface.py:435:1: D400 First line should end with a period
        """加载GPU模型"""
^
src/gpu/accelerated/integration_interface.py:439:1: D400 First line should end with a period
        """生成GPU集成报告"""
^
src/gpu/accelerated/integration_interface.py:458:80: E501 line too long (126 > 79 characters)
        report = f"""
MyStocks GPU集成状态报告
==========================

🔗 集成配置:
  • 自动启用GPU: {'✅ 是' if status['auto_enable_gpu'] else '❌ 否'}
  • CPU回退功能: {'✅ 是' if status['fallback_to_cpu'] else '❌ 否'}
  • 性能阈值: {status['gpu_config']['performance_threshold']}秒/万行
  • GPU内存限制: {status['gpu_config']['gpu_memory_threshold_mb']}MB
  • 启用基准测试: {'✅ 是' if status['gpu_config']['enable_benchmarking'] else '❌ 否'}

📊 GPU使用统计:
  • 总操作次数: {status['gpu_usage_stats']['total_operations']}
  • GPU操作次数: {status['gpu_usage_stats']['gpu_operations']}
  • CPU回退次数: {status['gpu_usage_stats']['cpu_fallback_operations']}
  • GPU使用率: {(status['gpu_usage_stats']['gpu_operations'] / max(1, status['gpu_usage_stats']['total_operations']) * 100):.1f}%

⚡ GPU组件状态:
  • GPU环境: {'✅ 可用' if status['gpu_available'] else '❌ 不可用'}
  • 数据处理器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['data_processor']['enabled'] else '❌ 已禁用'}
  • 特征生成器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['feature_generator']['enabled'] else '❌ 已禁用'}
  • 价格预测器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['price_predictor']['enabled'] else '❌ 已禁用'}

🏆 性能基准测试:
"""





  ^
src/gpu/accelerated/integration_interface.py:462:80: E501 line too long (124 > 79 characters)
        report = f"""
MyStocks GPU集成状态报告
==========================

🔗 集成配置:
  • 自动启用GPU: {'✅ 是' if status['auto_enable_gpu'] else '❌ 否'}
  • CPU回退功能: {'✅ 是' if status['fallback_to_cpu'] else '❌ 否'}
  • 性能阈值: {status['gpu_config']['performance_threshold']}秒/万行
  • GPU内存限制: {status['gpu_config']['gpu_memory_threshold_mb']}MB
  • 启用基准测试: {'✅ 是' if status['gpu_config']['enable_benchmarking'] else '❌ 否'}

📊 GPU使用统计:
  • 总操作次数: {status['gpu_usage_stats']['total_operations']}
  • GPU操作次数: {status['gpu_usage_stats']['gpu_operations']}
  • CPU回退次数: {status['gpu_usage_stats']['cpu_fallback_operations']}
  • GPU使用率: {(status['gpu_usage_stats']['gpu_operations'] / max(1, status['gpu_usage_stats']['total_operations']) * 100):.1f}%

⚡ GPU组件状态:
  • GPU环境: {'✅ 可用' if status['gpu_available'] else '❌ 不可用'}
  • 数据处理器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['data_processor']['enabled'] else '❌ 已禁用'}
  • 特征生成器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['feature_generator']['enabled'] else '❌ 已禁用'}
  • 价格预测器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['price_predictor']['enabled'] else '❌ 已禁用'}

🏆 性能基准测试:
"""





  ^
src/gpu/accelerated/integration_interface.py:463:80: E501 line too long (127 > 79 characters)
        report = f"""
MyStocks GPU集成状态报告
==========================

🔗 集成配置:
  • 自动启用GPU: {'✅ 是' if status['auto_enable_gpu'] else '❌ 否'}
  • CPU回退功能: {'✅ 是' if status['fallback_to_cpu'] else '❌ 否'}
  • 性能阈值: {status['gpu_config']['performance_threshold']}秒/万行
  • GPU内存限制: {status['gpu_config']['gpu_memory_threshold_mb']}MB
  • 启用基准测试: {'✅ 是' if status['gpu_config']['enable_benchmarking'] else '❌ 否'}

📊 GPU使用统计:
  • 总操作次数: {status['gpu_usage_stats']['total_operations']}
  • GPU操作次数: {status['gpu_usage_stats']['gpu_operations']}
  • CPU回退次数: {status['gpu_usage_stats']['cpu_fallback_operations']}
  • GPU使用率: {(status['gpu_usage_stats']['gpu_operations'] / max(1, status['gpu_usage_stats']['total_operations']) * 100):.1f}%

⚡ GPU组件状态:
  • GPU环境: {'✅ 可用' if status['gpu_available'] else '❌ 不可用'}
  • 数据处理器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['data_processor']['enabled'] else '❌ 已禁用'}
  • 特征生成器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['feature_generator']['enabled'] else '❌ 已禁用'}
  • 价格预测器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['price_predictor']['enabled'] else '❌ 已禁用'}

🏆 性能基准测试:
"""





  ^
src/gpu/accelerated/integration_interface.py:464:80: E501 line too long (125 > 79 characters)
        report = f"""
MyStocks GPU集成状态报告
==========================

🔗 集成配置:
  • 自动启用GPU: {'✅ 是' if status['auto_enable_gpu'] else '❌ 否'}
  • CPU回退功能: {'✅ 是' if status['fallback_to_cpu'] else '❌ 否'}
  • 性能阈值: {status['gpu_config']['performance_threshold']}秒/万行
  • GPU内存限制: {status['gpu_config']['gpu_memory_threshold_mb']}MB
  • 启用基准测试: {'✅ 是' if status['gpu_config']['enable_benchmarking'] else '❌ 否'}

📊 GPU使用统计:
  • 总操作次数: {status['gpu_usage_stats']['total_operations']}
  • GPU操作次数: {status['gpu_usage_stats']['gpu_operations']}
  • CPU回退次数: {status['gpu_usage_stats']['cpu_fallback_operations']}
  • GPU使用率: {(status['gpu_usage_stats']['gpu_operations'] / max(1, status['gpu_usage_stats']['total_operations']) * 100):.1f}%

⚡ GPU组件状态:
  • GPU环境: {'✅ 可用' if status['gpu_available'] else '❌ 不可用'}
  • 数据处理器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['data_processor']['enabled'] else '❌ 已禁用'}
  • 特征生成器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['feature_generator']['enabled'] else '❌ 已禁用'}
  • 价格预测器: {'✅ 已启用' if status['gpu_performance_summary']['gpu_components_status']['price_predictor']['enabled'] else '❌ 已禁用'}

🏆 性能基准测试:
"""





  ^
src/gpu/accelerated/integration_interface.py:472:80: E501 line too long (88 > 79 characters)
            report += f"""
  • 最后测试时间: {time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(benchmark['timestamp']))}
  • GPU处理时间: {benchmark['gpu_time']:.4f}秒
  • CPU处理时间: {benchmark['cpu_time']:.4f}秒
  • 加速比: {benchmark['speedup']:.2f}x
"""

                                                    ^
src/gpu/accelerated/integration_interface.py:497:1: D400 First line should end with a period
    """创建GPU增强统一管理器的工厂函数"""
^
src/gpu/accelerated/integration_interface.py:503:1: D400 First line should end with a period
    """获取GPU启用版本的统一管理器"""
^
src/gpu/accelerated/integration_interface.py:508:1: D400 First line should end with a period
    """主函数 - 示例用法"""
^
src/gpu/accelerated/integration_interface.py:533:80: E501 line too long (81 > 79 characters)
    loaded_data = gpu_manager.load_data_by_classification_with_gpu("market_data")
                                                                               ^
src/gpu/accelerated/integration_interface.py:535:80: E501 line too long (130 > 79 characters)
        f"加载完成 - GPU: {hasattr(loaded_data, 'gpu_processing_info') and loaded_data.gpu_processing_info.get('gpu_enabled', False)}"
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:2:1: D205 1 blank line required between summary line and description
"""
GPU性能基准测试系统
全面测试GPU加速组件的性能对比和优化效果
适用于MyStocks量化交易系统的GPU加速效果评估
"""
^
src/gpu/accelerated/performance_benchmark.py:2:1: D400 First line should end with a period
"""
GPU性能基准测试系统
全面测试GPU加速组件的性能对比和优化效果
适用于MyStocks量化交易系统的GPU加速效果评估
"""
^
src/gpu/accelerated/performance_benchmark.py:37:1: D400 First line should end with a period
    """基准测试配置"""
^
src/gpu/accelerated/performance_benchmark.py:49:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/gpu/accelerated/performance_benchmark.py:58:1: D400 First line should end with a period
    """基准测试结果"""
^
src/gpu/accelerated/performance_benchmark.py:74:1: D400 First line should end with a period
    """GPU性能基准测试器"""
^
src/gpu/accelerated/performance_benchmark.py:76:1: D107 Missing docstring in __init__
    def __init__(self, config: BenchmarkConfig = None):
^
src/gpu/accelerated/performance_benchmark.py:99:1: D400 First line should end with a period
        """内存分析上下文管理器"""
^
src/gpu/accelerated/performance_benchmark.py:122:1: D400 First line should end with a period
        """生成测试数据"""
^
src/gpu/accelerated/performance_benchmark.py:150:80: E501 line too long (80 > 79 characters)
            missing_indices = np.random.choice(size, size // 100, replace=False)
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:155:80: E501 line too long (81 > 79 characters)
    def _benchmark_data_processing(self, data: pd.DataFrame) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:156:1: D400 First line should end with a period
        """基准测试数据处理器"""
^
src/gpu/accelerated/performance_benchmark.py:165:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/gpu/accelerated/performance_benchmark.py:192:17: F841 local variable 'result' is assigned to but never used
                result = cpu_processor.preprocess(data)
                ^
src/gpu/accelerated/performance_benchmark.py:197:80: E501 line too long (80 > 79 characters)
            "gpu_time": np.mean(times["gpu"]) if times["gpu"] else float("inf"),
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:203:80: E501 line too long (84 > 79 characters)
    def _benchmark_feature_generation(self, data: pd.DataFrame) -> Dict[str, float]:
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:204:1: D400 First line should end with a period
        """基准测试特征生成器"""
^
src/gpu/accelerated/performance_benchmark.py:213:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/gpu/accelerated/performance_benchmark.py:240:17: F841 local variable 'result' is assigned to but never used
                result = cpu_generator.generate_features(data)
                ^
src/gpu/accelerated/performance_benchmark.py:245:80: E501 line too long (80 > 79 characters)
            "gpu_time": np.mean(times["gpu"]) if times["gpu"] else float("inf"),
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:254:1: D400 First line should end with a period
        """基准测试价格预测器"""
^
src/gpu/accelerated/performance_benchmark.py:264:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/gpu/accelerated/performance_benchmark.py:284:80: E501 line too long (82 > 79 characters)
                        gpu_accs.append(performance.get("avg_prediction_time", 0))
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:307:80: E501 line too long (80 > 79 characters)
            "gpu_time": np.mean(times["gpu"]) if times["gpu"] else float("inf"),
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:309:80: E501 line too long (83 > 79 characters)
            "gpu_accuracy": np.mean(accuracies["gpu"]) if accuracies["gpu"] else 0,
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:316:1: D400 First line should end with a period
        """获取GPU内存使用情况"""
^
src/gpu/accelerated/performance_benchmark.py:325:1: D400 First line should end with a period
        """运行综合基准测试"""
^
src/gpu/accelerated/performance_benchmark.py:419:23: F541 f-string is missing placeholders
                print(f"\n📈 价格预测性能测试:")
                      ^
src/gpu/accelerated/performance_benchmark.py:422:80: E501 line too long (84 > 79 characters)
                    result = self._benchmark_price_prediction(test_data, model_type)
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:475:1: D400 First line should end with a period
        """打印基准测试结果"""
^
src/gpu/accelerated/performance_benchmark.py:479:80: E501 line too long (88 > 79 characters)
            f"    GPU时间: {gpu_time:.4f}s | CPU时间: {cpu_time:.4f}s | 加速比: {speedup:.2f}x"
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:487:1: D400 First line should end with a period
        """更新统计信息"""
^
src/gpu/accelerated/performance_benchmark.py:501:1: D400 First line should end with a period
        """打印总结报告"""
^
src/gpu/accelerated/performance_benchmark.py:515:80: E501 line too long (81 > 79 characters)
            self.stats["average_speedup"] = self.stats["average_speedup"] / total
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:536:1: D400 First line should end with a period
        """生成优化建议"""
^
src/gpu/accelerated/performance_benchmark.py:553:80: E501 line too long (83 > 79 characters)
        if self.stats["successful_gpu_tests"] > self.stats["successful_cpu_tests"]:
                                                                               ^
src/gpu/accelerated/performance_benchmark.py:560:1: D400 First line should end with a period
        """保存基准测试结果"""
^
src/gpu/accelerated/performance_benchmark.py:589:1: D400 First line should end with a period
        """生成性能报告"""
^
src/gpu/accelerated/performance_benchmark.py:628:1: D400 First line should end with a period
    """主函数 - 基准测试示例"""
^
src/gpu/accelerated/price_predictor_gpu.py:2:1: D205 1 blank line required between summary line and description
"""
GPU加速的价格预测器
基于cuML机器学习库实现高性能价格预测
支持RTX 2080 GPU加速，提供实时预测能力
"""
^
src/gpu/accelerated/price_predictor_gpu.py:2:1: D400 First line should end with a period
"""
GPU加速的价格预测器
基于cuML机器学习库实现高性能价格预测
支持RTX 2080 GPU加速，提供实时预测能力
"""
^
src/gpu/accelerated/price_predictor_gpu.py:24:1: D400 First line should end with a period
    """预测结果"""
^
src/gpu/accelerated/price_predictor_gpu.py:37:1: D400 First line should end with a period
    """模型性能指标"""
^
src/gpu/accelerated/price_predictor_gpu.py:49:1: D400 First line should end with a period
    """GPU加速的价格预测器"""
^
src/gpu/accelerated/price_predictor_gpu.py:51:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = True):
^
src/gpu/accelerated/price_predictor_gpu.py:77:1: D400 First line should end with a period
        """准备GPU数据"""
^
src/gpu/accelerated/price_predictor_gpu.py:79:18: F821 undefined name 'cudf'
        df_gpu = cudf.DataFrame(data) if self.gpu_enabled else data
                 ^
src/gpu/accelerated/price_predictor_gpu.py:86:10: N806 variable 'X' in function should be lowercase
        X = df_gpu[feature_cols]
         ^
src/gpu/accelerated/price_predictor_gpu.py:90:10: N806 variable 'X_scaled' in function should be lowercase
        X_scaled = (
         ^
src/gpu/accelerated/price_predictor_gpu.py:99:53: B006 Do not use mutable data structures for argument defaults.  They are created during function definition time. All calls to the function reuse this one instance of that data structure, persisting changes between them.
        self, data: pd.DataFrame, lags: List[int] = [1, 2, 3, 5, 10]
                                                    ^
src/gpu/accelerated/price_predictor_gpu.py:101:1: D400 First line should end with a period
        """创建滞后特征"""
^
src/gpu/accelerated/price_predictor_gpu.py:122:1: D400 First line should end with a period
        """计算RSI指标"""
^
src/gpu/accelerated/price_predictor_gpu.py:131:80: E501 line too long (80 > 79 characters)
        self, prices: pd.Series, fast: int = 12, slow: int = 26, signal: int = 9
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:133:1: D400 First line should end with a period
        """计算MACD指标"""
^
src/gpu/accelerated/price_predictor_gpu.py:143:1: D400 First line should end with a period
        """准备特征数据"""
^
src/gpu/accelerated/price_predictor_gpu.py:151:80: E501 line too long (81 > 79 characters)
        feature_data["target"] = feature_data["close"].shift(-prediction_horizon)
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:161:1: D400 First line should end with a period
        """训练多个模型"""
^
src/gpu/accelerated/price_predictor_gpu.py:168:10: N806 variable 'X' in function should be lowercase
        X, y = self._prepare_data_gpu(feature_data)
         ^
src/gpu/accelerated/price_predictor_gpu.py:169:10: N806 variable 'X_train' in function should be lowercase
        X_train, X_test, y_train, y_test = gpu_train_test_split(
         ^
src/gpu/accelerated/price_predictor_gpu.py:169:10: N806 variable 'X_test' in function should be lowercase
        X_train, X_test, y_train, y_test = gpu_train_test_split(
         ^
src/gpu/accelerated/price_predictor_gpu.py:231:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, model_name: str = None, prediction_horizon: int = 1
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:233:1: D400 First line should end with a period
        """预测价格"""
^
src/gpu/accelerated/price_predictor_gpu.py:256:10: N806 variable 'X' in function should be lowercase
        X = self.scaler.transform(last_row)
         ^
src/gpu/accelerated/price_predictor_gpu.py:260:14: N806 variable 'X_gpu' in function should be lowercase
            X_gpu = cp.array(X)
             ^
src/gpu/accelerated/price_predictor_gpu.py:277:80: E501 line too long (80 > 79 characters)
            prediction_date=datetime.now() + timedelta(days=prediction_horizon),
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:282:80: E501 line too long (81 > 79 characters)
                "mse": self.performance_stats["model_scores"].get(model_name, 0),
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:284:80: E501 line too long (86 > 79 characters)
                "r2_score": self.performance_stats["model_scores"].get(model_name, 0),
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:297:1: D400 First line should end with a period
        """计算预测置信度"""
^
src/gpu/accelerated/price_predictor_gpu.py:298:80: E501 line too long (85 > 79 characters)
        base_confidence = self.performance_stats["model_scores"].get(model_name, 0.5)
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:319:1: D400 First line should end with a period
        """批量预测"""
^
src/gpu/accelerated/price_predictor_gpu.py:324:80: E501 line too long (81 > 79 characters)
                result = self.predict_price(data, model_name, prediction_horizon)
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:333:1: D400 First line should end with a period
        """获取性能总结"""
^
src/gpu/accelerated/price_predictor_gpu.py:334:80: E501 line too long (84 > 79 characters)
        avg_prediction_time = self.performance_stats["total_prediction_time"] / max(
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:341:80: E501 line too long (81 > 79 characters)
            "total_training_time": self.performance_stats["total_training_time"],
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:351:1: D400 First line should end with a period
        """优化超参数"""
^
src/gpu/accelerated/price_predictor_gpu.py:361:14: N806 variable 'X' in function should be lowercase
            X, y = self._prepare_data_gpu(feature_data)
             ^
src/gpu/accelerated/price_predictor_gpu.py:386:14: N806 variable 'X' in function should be lowercase
            X, y = self._prepare_data_gpu(feature_data)
             ^
src/gpu/accelerated/price_predictor_gpu.py:401:1: D400 First line should end with a period
        """保存模型"""
^
src/gpu/accelerated/price_predictor_gpu.py:416:1: D400 First line should end with a period
        """加载模型"""
^
src/gpu/accelerated/price_predictor_gpu.py:431:1: D400 First line should end with a period
    """GPU预测流水线"""
^
src/gpu/accelerated/price_predictor_gpu.py:433:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = True):
^
src/gpu/accelerated/price_predictor_gpu.py:440:1: D400 First line should end with a period
        """运行完整的预测流水线"""
^
src/gpu/accelerated/price_predictor_gpu.py:464:1: D400 First line should end with a period
    """GPU数据预处理器"""
^
src/gpu/accelerated/price_predictor_gpu.py:466:1: D107 Missing docstring in __init__
    def __init__(self, gpu_enabled: bool = True):
^
src/gpu/accelerated/price_predictor_gpu.py:471:1: D400 First line should end with a period
        """数据预处理"""
^
src/gpu/accelerated/price_predictor_gpu.py:484:1: D400 First line should end with a period
        """去除异常值"""
^
src/gpu/accelerated/price_predictor_gpu.py:488:14: N806 variable 'Q1' in function should be lowercase
            Q1 = data[col].quantile(0.25)
             ^
src/gpu/accelerated/price_predictor_gpu.py:489:14: N806 variable 'Q3' in function should be lowercase
            Q3 = data[col].quantile(0.75)
             ^
src/gpu/accelerated/price_predictor_gpu.py:490:14: N806 variable 'IQR' in function should be lowercase
            IQR = Q3 - Q1
             ^
src/gpu/accelerated/price_predictor_gpu.py:495:80: E501 line too long (80 > 79 characters)
            data = data[(data[col] >= lower_bound) & (data[col] <= upper_bound)]
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:500:1: D400 First line should end with a period
        """添加技术指标"""
^
src/gpu/accelerated/price_predictor_gpu.py:514:1: D400 First line should end with a period
        """特征标准化"""
^
src/gpu/accelerated/price_predictor_gpu.py:519:27: F821 undefined name 'cudf'
            feature_gpu = cudf.DataFrame(feature_data)
                          ^
src/gpu/accelerated/price_predictor_gpu.py:521:29: F821 undefined name 'cudf'
            normalized_df = cudf.DataFrame(
                            ^
src/gpu/accelerated/price_predictor_gpu.py:538:1: D400 First line should end with a period
        """计算RSI"""
^
src/gpu/accelerated/price_predictor_gpu.py:546:80: E501 line too long (80 > 79 characters)
    def _calculate_macd(self, prices: pd.Series) -> Tuple[pd.Series, pd.Series]:
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:547:1: D400 First line should end with a period
        """计算MACD"""
^
src/gpu/accelerated/price_predictor_gpu.py:556:1: D400 First line should end with a period
    """GPU vs CPU性能对比"""
^
src/gpu/accelerated/price_predictor_gpu.py:572:11: F541 f-string is missing placeholders
    print(f"\n📊 性能对比结果:")
          ^
src/gpu/accelerated/price_predictor_gpu.py:579:80: E501 line too long (113 > 79 characters)
        f"预测差异: {abs(gpu_results['prediction'].predicted_price - cpu_results['prediction'].predicted_price):.2f}"
                                                                               ^
src/gpu/accelerated/price_predictor_gpu.py:614:11: F541 f-string is missing placeholders
    print(f"\n性能总结:")
          ^
src/gpu/accelerated/real_time_performance_monitor.py:2:1: D205 1 blank line required between summary line and description
"""
实时性能监控器
监控GPU和CPU的实时性能表现，提供动态负载均衡建议
适用于MyStocks量化交易系统的实时性能监控
"""
^
src/gpu/accelerated/real_time_performance_monitor.py:2:1: D400 First line should end with a period
"""
实时性能监控器
监控GPU和CPU的实时性能表现，提供动态负载均衡建议
适用于MyStocks量化交易系统的实时性能监控
"""
^
src/gpu/accelerated/real_time_performance_monitor.py:23:1: D400 First line should end with a period
    """性能指标"""
^
src/gpu/accelerated/real_time_performance_monitor.py:39:1: D400 First line should end with a period
    """工作负载信息"""
^
src/gpu/accelerated/real_time_performance_monitor.py:50:1: D400 First line should end with a period
    """实时性能监控器"""
^
src/gpu/accelerated/real_time_performance_monitor.py:52:1: D107 Missing docstring in __init__
    def __init__(self, monitoring_interval: float = 1.0, history_size: int = 300):
^
src/gpu/accelerated/real_time_performance_monitor.py:52:80: E501 line too long (82 > 79 characters)
    def __init__(self, monitoring_interval: float = 1.0, history_size: int = 300):
                                                                               ^
src/gpu/accelerated/real_time_performance_monitor.py:92:1: D400 First line should end with a period
        """开始监控"""
^
src/gpu/accelerated/real_time_performance_monitor.py:104:1: D400 First line should end with a period
        """停止监控"""
^
src/gpu/accelerated/real_time_performance_monitor.py:112:1: D400 First line should end with a period
        """监控循环"""
^
src/gpu/accelerated/real_time_performance_monitor.py:135:1: D400 First line should end with a period
        """收集性能指标"""
^
src/gpu/accelerated/real_time_performance_monitor.py:141:9: F841 local variable 'cpu_freq' is assigned to but never used
        cpu_freq = psutil.cpu_freq()
        ^
src/gpu/accelerated/real_time_performance_monitor.py:151:1: S404 Consider possible security implications associated with the subprocess module.
                import subprocess
^
src/gpu/accelerated/real_time_performance_monitor.py:154:1: S607 Starting a process with a partial executable path
                result = subprocess.run(
^
src/gpu/accelerated/real_time_performance_monitor.py:154:1: S603 subprocess call - check for execution of untrusted input.
                result = subprocess.run(
^
src/gpu/accelerated/real_time_performance_monitor.py:157:80: E501 line too long (93 > 79 characters)
                        "--query-gpu=utilization.gpu,memory.used,temperature.gpu,power.draw",
                                                                               ^
src/gpu/accelerated/real_time_performance_monitor.py:199:1: D400 First line should end with a period
        """获取最近的处理时间"""
^
src/gpu/accelerated/real_time_performance_monitor.py:205:1: D400 First line should end with a period
        """计算吞吐量"""
^
src/gpu/accelerated/real_time_performance_monitor.py:214:1: D400 First line should end with a period
        """计算错误率"""
^
src/gpu/accelerated/real_time_performance_monitor.py:221:1: D400 First line should end with a period
        """更新统计信息"""
^
src/gpu/accelerated/real_time_performance_monitor.py:231:80: E501 line too long (84 > 79 characters)
            self.stats["avg_processing_time"] * (self.stats["total_operations"] - 1)
                                                                               ^
src/gpu/accelerated/real_time_performance_monitor.py:240:1: D400 First line should end with a period
        """检查警报"""
^
src/gpu/accelerated/real_time_performance_monitor.py:260:1: D400 First line should end with a period
        """记录性能日志"""
^
src/gpu/accelerated/real_time_performance_monitor.py:271:1: D400 First line should end with a period
        """注册警报回调函数"""
^
src/gpu/accelerated/real_time_performance_monitor.py:275:1: D400 First line should end with a period
        """获取当前性能指标"""
^
src/gpu/accelerated/real_time_performance_monitor.py:278:80: E501 line too long (84 > 79 characters)
    def get_performance_history(self, last_n: int = 60) -> List[PerformanceMetrics]:
                                                                               ^
src/gpu/accelerated/real_time_performance_monitor.py:279:1: D400 First line should end with a period
        """获取性能历史"""
^
src/gpu/accelerated/real_time_performance_monitor.py:283:1: D400 First line should end with a period
        """获取性能总结"""
^
src/gpu/accelerated/real_time_performance_monitor.py:308:1: D400 First line should end with a period
        """获取工作负载建议"""
^
src/gpu/accelerated/real_time_performance_monitor.py:352:1: D400 First line should end with a period
        """预测性能表现"""
^
src/gpu/accelerated/real_time_performance_monitor.py:370:80: E501 line too long (86 > 79 characters)
        predicted_gpu_time = workload.estimated_gpu_time * (1 + gpu_load_factor * 0.5)
                                                                               ^
src/gpu/accelerated/real_time_performance_monitor.py:371:80: E501 line too long (86 > 79 characters)
        predicted_cpu_time = workload.estimated_cpu_time * (1 + cpu_load_factor * 0.3)
                                                                               ^
src/gpu/accelerated/real_time_performance_monitor.py:398:1: D400 First line should end with a period
        """获取最优的任务分配方案"""
^
src/gpu/accelerated/real_time_performance_monitor.py:420:1: D400 First line should end with a period
        """生成性能报告"""
^
src/gpu/accelerated/real_time_performance_monitor.py:431:80: E501 line too long (105 > 79 characters)
        report = f"""
MyStocks 实时性能监控报告
========================

监控时间: {time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time()))}

📊 当前性能状态:
  GPU使用率: {summary.get('gpu_utilization_avg', 0):.1f}% (最高: {summary.get('gpu_utilization_max', 0):.1f}%)
  CPU使用率: {summary.get('cpu_utilization_avg', 0):.1f}% (最高: {summary.get('cpu_utilization_max', 0):.1f}%)
  GPU内存: {summary.get('gpu_memory_avg', 0):.1f}MB (最高: {summary.get('gpu_memory_max', 0):.1f}MB)
  平均处理时间: {summary.get('processing_time_avg', 0):.3f}秒
  总操作次数: {summary.get('total_operations', 0)}
  GPU操作次数: {summary.get('gpu_operations', 0)}
  CPU操作次数: {summary.get('cpu_operations', 0)}
  错误率: {summary.get('error_rate', 0):.2%}

💡 优化建议:
"""




             ^
src/gpu/accelerated/real_time_performance_monitor.py:432:80: E501 line too long (105 > 79 characters)
        report = f"""
MyStocks 实时性能监控报告
========================

监控时间: {time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time()))}

📊 当前性能状态:
  GPU使用率: {summary.get('gpu_utilization_avg', 0):.1f}% (最高: {summary.get('gpu_utilization_max', 0):.1f}%)
  CPU使用率: {summary.get('cpu_utilization_avg', 0):.1f}% (最高: {summary.get('cpu_utilization_max', 0):.1f}%)
  GPU内存: {summary.get('gpu_memory_avg', 0):.1f}MB (最高: {summary.get('gpu_memory_max', 0):.1f}MB)
  平均处理时间: {summary.get('processing_time_avg', 0):.3f}秒
  总操作次数: {summary.get('total_operations', 0)}
  GPU操作次数: {summary.get('gpu_operations', 0)}
  CPU操作次数: {summary.get('cpu_operations', 0)}
  错误率: {summary.get('error_rate', 0):.2%}

💡 优化建议:
"""




             ^
src/gpu/accelerated/real_time_performance_monitor.py:433:80: E501 line too long (96 > 79 characters)
        report = f"""
MyStocks 实时性能监控报告
========================

监控时间: {time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(time.time()))}

📊 当前性能状态:
  GPU使用率: {summary.get('gpu_utilization_avg', 0):.1f}% (最高: {summary.get('gpu_utilization_max', 0):.1f}%)
  CPU使用率: {summary.get('cpu_utilization_avg', 0):.1f}% (最高: {summary.get('cpu_utilization_max', 0):.1f}%)
  GPU内存: {summary.get('gpu_memory_avg', 0):.1f}MB (最高: {summary.get('gpu_memory_max', 0):.1f}MB)
  平均处理时间: {summary.get('processing_time_avg', 0):.3f}秒
  总操作次数: {summary.get('total_operations', 0)}
  GPU操作次数: {summary.get('gpu_operations', 0)}
  CPU操作次数: {summary.get('cpu_operations', 0)}
  错误率: {summary.get('error_rate', 0):.2%}

💡 优化建议:
"""




             ^
src/gpu/accelerated/real_time_performance_monitor.py:458:1: D400 First line should end with a period
    """主函数 - 实时监控示例"""
^
src/gpu/api_system/generate_test_report.py:2:1: D205 1 blank line required between summary line and description
"""
测试报告生成工具
生成综合测试报告包括覆盖率、性能和质量指标
"""
^
src/gpu/api_system/generate_test_report.py:2:1: D400 First line should end with a period
"""
测试报告生成工具
生成综合测试报告包括覆盖率、性能和质量指标
"""
^
src/gpu/api_system/generate_test_report.py:8:1: S405 Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
import xml.etree.ElementTree as ET
^
src/gpu/api_system/generate_test_report.py:8:2: N817 camelcase 'xml.etree.ElementTree' imported as acronym 'ET'
import xml.etree.ElementTree as ET
 ^
src/gpu/api_system/generate_test_report.py:14:1: D400 First line should end with a period
    """测试报告生成器"""
^
src/gpu/api_system/generate_test_report.py:16:1: D107 Missing docstring in __init__
    def __init__(self, report_dir="test_reports"):
^
src/gpu/api_system/generate_test_report.py:28:1: D400 First line should end with a period
        """解析JUnit XML报告"""
^
src/gpu/api_system/generate_test_report.py:33:1: S314 Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
            tree = ET.parse(xml_file)
^
src/gpu/api_system/generate_test_report.py:52:1: D400 First line should end with a period
        """解析覆盖率XML报告"""
^
src/gpu/api_system/generate_test_report.py:57:1: S314 Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
            tree = ET.parse(xml_file)
^
src/gpu/api_system/generate_test_report.py:64:80: E501 line too long (81 > 79 characters)
                branch_rate = float(coverage_elem.attrib.get("branch-rate", 0.0))
                                                                               ^
src/gpu/api_system/generate_test_report.py:78:1: D400 First line should end with a period
        """收集所有测试结果"""
^
src/gpu/api_system/generate_test_report.py:101:80: E501 line too long (80 > 79 characters)
            self.report_data["coverage"] = self.parse_coverage_xml(coverage_xml)
                                                                               ^
src/gpu/api_system/generate_test_report.py:104:1: D400 First line should end with a period
        """计算总体摘要"""
^
src/gpu/api_system/generate_test_report.py:110:80: E501 line too long (82 > 79 characters)
        for test_type in ["unit_tests", "integration_tests", "performance_tests"]:
                                                                               ^
src/gpu/api_system/generate_test_report.py:128:1: D400 First line should end with a period
        """生成Markdown格式报告"""
^
src/gpu/api_system/generate_test_report.py:174:80: E501 line too long (83 > 79 characters)
            report.append(f"- **行覆盖率**: {coverage.get('line_coverage', 0):.2f}%\n")
                                                                               ^
src/gpu/api_system/generate_test_report.py:211:1: D400 First line should end with a period
        """保存JSON格式报告"""
^
src/gpu/api_system/generate_test_report.py:218:1: D400 First line should end with a period
        """保存Markdown格式报告"""
^
src/gpu/api_system/generate_test_report.py:226:1: D400 First line should end with a period
        """生成所有格式的报告"""
^
src/gpu/api_system/generate_test_report.py:245:1: D400 First line should end with a period
    """主函数"""
^
src/gpu/api_system/main_server.py:1:1: D205 1 blank line required between summary line and description
"""
GPU API 系统主服务器
GPU API System Main Server
"""
^
src/gpu/api_system/main_server.py:1:1: D400 First line should end with a period
"""
GPU API 系统主服务器
GPU API System Main Server
"""
^
src/gpu/api_system/main_server.py:37:1: D400 First line should end with a period
    """GPU API 系统主服务器"""
^
src/gpu/api_system/main_server.py:39:1: D107 Missing docstring in __init__
    def __init__(self, config: SystemConfig):
^
src/gpu/api_system/main_server.py:57:1: D400 First line should end with a period
        """初始化服务器"""
^
src/gpu/api_system/main_server.py:77:1: D400 First line should end with a period
        """初始化核心组件"""
^
src/gpu/api_system/main_server.py:99:1: D400 First line should end with a period
        """初始化集成服务"""
^
src/gpu/api_system/main_server.py:124:1: D400 First line should end with a period
        """创建gRPC服务器"""
^
src/gpu/api_system/main_server.py:151:80: E501 line too long (85 > 79 characters)
        from api_proto.backtest_pb2_grpc import add_BacktestServiceServicer_to_server
                                                                               ^
src/gpu/api_system/main_server.py:152:80: E501 line too long (85 > 79 characters)
        from api_proto.realtime_pb2_grpc import add_RealTimeServiceServicer_to_server
                                                                               ^
src/gpu/api_system/main_server.py:155:80: E501 line too long (81 > 79 characters)
        add_BacktestServiceServicer_to_server(self.backtest_service, self.server)
                                                                               ^
src/gpu/api_system/main_server.py:156:80: E501 line too long (81 > 79 characters)
        add_RealTimeServiceServicer_to_server(self.realtime_service, self.server)
                                                                               ^
src/gpu/api_system/main_server.py:161:80: E501 line too long (82 > 79 characters)
            f"{self.config.grpc_config['host']}:{self.config.grpc_config['port']}"
                                                                               ^
src/gpu/api_system/main_server.py:168:1: D400 First line should end with a period
        """启动服务器"""
^
src/gpu/api_system/main_server.py:197:1: D400 First line should end with a period
        """信号处理"""
^
src/gpu/api_system/main_server.py:203:1: D400 First line should end with a period
        """打印服务器状态"""
^
src/gpu/api_system/main_server.py:214:21: F541 f-string is missing placeholders
        logger.info(f"  - 回测服务: 已启动")
                    ^
src/gpu/api_system/main_server.py:215:21: F541 f-string is missing placeholders
        logger.info(f"  - 实时数据处理服务: 已启动")
                    ^
src/gpu/api_system/main_server.py:216:21: F541 f-string is missing placeholders
        logger.info(f"  - ML训练服务: 已启动")
                    ^
src/gpu/api_system/main_server.py:223:80: E501 line too long (97 > 79 characters)
            f"  - Redis地址: {self.config.redis_config['host']}:{self.config.redis_config['port']}"
                                                                               ^
src/gpu/api_system/main_server.py:229:1: D400 First line should end with a period
        """停止服务器"""
^
src/gpu/api_system/main_server.py:263:1: D400 First line should end with a period
    """主函数"""
^
src/gpu/api_system/services/backtest_service.py:1:1: D205 1 blank line required between summary line and description
"""
回测服务
Backtest Service
"""
^
src/gpu/api_system/services/backtest_service.py:1:1: D400 First line should end with a period
"""
回测服务
Backtest Service
"""
^
src/gpu/api_system/services/backtest_service.py:38:1: D400 First line should end with a period
    """回测引擎"""
^
src/gpu/api_system/services/backtest_service.py:40:1: D107 Missing docstring in __init__
    def __init__(self, gpu_manager: GPUResourceManager):
^
src/gpu/api_system/services/backtest_service.py:48:1: D400 First line should end with a period
        """执行回测"""
^
src/gpu/api_system/services/backtest_service.py:63:80: E501 line too long (80 > 79 characters)
                results = self._run_backtest_gpu(market_data, strategy, request)
                                                                               ^
src/gpu/api_system/services/backtest_service.py:65:80: E501 line too long (80 > 79 characters)
                results = self._run_backtest_cpu(market_data, strategy, request)
                                                                               ^
src/gpu/api_system/services/backtest_service.py:68:80: E501 line too long (87 > 79 characters)
            performance_metrics = self._calculate_performance_metrics(results, request)
                                                                               ^
src/gpu/api_system/services/backtest_service.py:102:1: D400 First line should end with a period
        """准备市场数据"""
^
src/gpu/api_system/services/backtest_service.py:105:80: E501 line too long (87 > 79 characters)
        dates = pd.date_range(start=request.start_date, end=request.end_date, freq="D")
                                                                               ^
src/gpu/api_system/services/backtest_service.py:129:1: D400 First line should end with a period
        """加载策略"""
^
src/gpu/api_system/services/backtest_service.py:131:80: E501 line too long (82 > 79 characters)
            f"{strategy_type}_{hash(json.dumps(strategy_config, sort_keys=True))}"
                                                                               ^
src/gpu/api_system/services/backtest_service.py:153:80: E501 line too long (80 > 79 characters)
        self, market_data: pd.DataFrame, strategy: Any, request: BacktestRequest
                                                                               ^
src/gpu/api_system/services/backtest_service.py:155:1: D400 First line should end with a period
        """GPU加速回测"""
^
src/gpu/api_system/services/backtest_service.py:183:80: E501 line too long (80 > 79 characters)
        self, market_data: pd.DataFrame, strategy: Any, request: BacktestRequest
                                                                               ^
src/gpu/api_system/services/backtest_service.py:185:1: D400 First line should end with a period
        """CPU回测"""
^
src/gpu/api_system/services/backtest_service.py:193:1: D400 First line should end with a period
        """计算性能指标"""
^
src/gpu/api_system/services/backtest_service.py:235:1: D400 First line should end with a period
        """生成回测报告"""
^
src/gpu/api_system/services/backtest_service.py:264:1: D400 First line should end with a period
    """趋势跟踪策略"""
^
src/gpu/api_system/services/backtest_service.py:266:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict):
^
src/gpu/api_system/services/backtest_service.py:274:1: D400 First line should end with a period
        """执行趋势跟踪策略回测"""
^
src/gpu/api_system/services/backtest_service.py:285:80: E501 line too long (81 > 79 characters)
        df.loc[df["close"] > df["ma"] * (1 + self.entry_threshold), "signal"] = 1
                                                                               ^
src/gpu/api_system/services/backtest_service.py:286:80: E501 line too long (81 > 79 characters)
        df.loc[df["close"] < df["ma"] * (1 - self.exit_threshold), "signal"] = -1
                                                                               ^
src/gpu/api_system/services/backtest_service.py:311:1: D400 First line should end with a period
        """计算RSI指标"""
^
src/gpu/api_system/services/backtest_service.py:323:1: D400 First line should end with a period
    """动量策略"""
^
src/gpu/api_system/services/backtest_service.py:325:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict):
^
src/gpu/api_system/services/backtest_service.py:332:1: D400 First line should end with a period
        """执行动量策略回测"""
^
src/gpu/api_system/services/backtest_service.py:367:1: D400 First line should end with a period
    """均值回归策略"""
^
src/gpu/api_system/services/backtest_service.py:369:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict):
^
src/gpu/api_system/services/backtest_service.py:377:1: D400 First line should end with a period
        """执行均值回归策略回测"""
^
src/gpu/api_system/services/backtest_service.py:419:1: D400 First line should end with a period
    """套利策略"""
^
src/gpu/api_system/services/backtest_service.py:421:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict):
^
src/gpu/api_system/services/backtest_service.py:427:1: D400 First line should end with a period
        """执行套利策略回测"""
^
src/gpu/api_system/services/backtest_service.py:432:80: E501 line too long (88 > 79 characters)
        df["spread_ma"] = df["spread"].rolling(window=self.mean_reversion_window).mean()
                                                                               ^
src/gpu/api_system/services/backtest_service.py:433:80: E501 line too long (88 > 79 characters)
        df["spread_std"] = df["spread"].rolling(window=self.mean_reversion_window).std()
                                                                               ^
src/gpu/api_system/services/backtest_service.py:438:80: E501 line too long (80 > 79 characters)
        df.loc[df["spread"] > df["spread_ma"] + df["spread_std"], "signal"] = -1
                                                                               ^
src/gpu/api_system/services/backtest_service.py:464:1: D400 First line should end with a period
    """回测服务实现"""
^
src/gpu/api_system/services/backtest_service.py:466:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/backtest_service.py:490:1: D400 First line should end with a period
        """初始化服务"""
^
src/gpu/api_system/services/backtest_service.py:495:10: N802 function name 'SubmitBacktest' should be lowercase
    def SubmitBacktest(
         ^
src/gpu/api_system/services/backtest_service.py:498:1: D400 First line should end with a period
        """提交回测任务"""
^
src/gpu/api_system/services/backtest_service.py:507:80: E501 line too long (112 > 79 characters)
            task_id = f"backtest_{int(time.time())}_{hash(json.dumps(request.strategy_config, sort_keys=True))}"
                                                                               ^
src/gpu/api_system/services/backtest_service.py:562:10: N802 function name 'QueryBacktest' should be lowercase
    def QueryBacktest(
         ^
src/gpu/api_system/services/backtest_service.py:565:1: D400 First line should end with a period
        """查询回测状态"""
^
src/gpu/api_system/services/backtest_service.py:570:17: B007 Loop control variable 'cache_key' not used within the loop body. If this is intended, start the name with an underscore.
            for cache_key, task in self.active_tasks.items():
                ^
src/gpu/api_system/services/backtest_service.py:590:80: E501 line too long (88 > 79 characters)
                    updated_at=task_status.get("updated_at", task_status["created_at"]),
                                                                               ^
src/gpu/api_system/services/backtest_service.py:602:80: E501 line too long (80 > 79 characters)
                        updated_at=task.get("completed_at", task["created_at"]),
                                                                               ^
src/gpu/api_system/services/backtest_service.py:615:10: N802 function name 'GetBacktestHistory' should be lowercase
    def GetBacktestHistory(self, request, context) -> HistoryResponse:
         ^
src/gpu/api_system/services/backtest_service.py:616:1: D400 First line should end with a period
        """获取回测历史"""
^
src/gpu/api_system/services/backtest_service.py:635:10: N802 function name 'SubmitBatchBacktest' should be lowercase
    def SubmitBatchBacktest(
         ^
src/gpu/api_system/services/backtest_service.py:638:1: D400 First line should end with a period
        """批量提交回测任务"""
^
src/gpu/api_system/services/backtest_service.py:649:80: E501 line too long (108 > 79 characters)
                    cache_key = f"{batch_task_id}_{backtest_request.start_date}_{backtest_request.end_date}"
                                                                               ^
src/gpu/api_system/services/backtest_service.py:699:10: N802 function name 'RunOptimization' should be lowercase
    def RunOptimization(
         ^
src/gpu/api_system/services/backtest_service.py:700:80: E501 line too long (82 > 79 characters)
        self, request: ParameterOptimizationRequest, context: grpc.ServicerContext
                                                                               ^
src/gpu/api_system/services/backtest_service.py:702:1: D400 First line should end with a period
        """运行参数优化"""
^
src/gpu/api_system/services/backtest_service.py:737:1: D400 First line should end with a period
        """网格搜索优化"""
^
src/gpu/api_system/services/backtest_service.py:794:1: D400 First line should end with a period
        """随机搜索优化"""
^
src/gpu/api_system/services/backtest_service.py:801:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(request.max_iterations):
            ^
src/gpu/api_system/services/backtest_service.py:809:80: E501 line too long (85 > 79 characters)
                    value = np.random.uniform(param_range["min"], param_range["max"])
                                                                               ^
src/gpu/api_system/services/backtest_service.py:863:1: D400 First line should end with a period
        """贝叶斯优化"""
^
src/gpu/api_system/services/backtest_service.py:868:1: D400 First line should end with a period
        """生成参数网格"""
^
src/gpu/api_system/services/backtest_service.py:874:13: B007 Loop control variable 'param_name' not used within the loop body. If this is intended, start the name with an underscore.
        for param_name, param_range in parameter_ranges.items():
            ^
src/gpu/api_system/services/backtest_service.py:876:80: E501 line too long (80 > 79 characters)
                values = list(range(param_range["min"], param_range["max"] + 1))
                                                                               ^
src/gpu/api_system/services/backtest_service.py:878:80: E501 line too long (80 > 79 characters)
                values = np.linspace(param_range["min"], param_range["max"], 10)
                                                                               ^
src/gpu/api_system/services/backtest_service.py:897:1: D400 First line should end with a period
        """获取回测统计信息"""
^
src/gpu/api_system/services/backtest_service.py:916:1: D400 First line should end with a period
        """停止服务"""
^
src/gpu/api_system/services/gpu_api_server.py:2:1: D205 1 blank line required between summary line and description
"""
MyStocks GPU API系统 - 主服务
MyStocks GPU API System - Main Service
"""
^
src/gpu/api_system/services/gpu_api_server.py:2:1: D400 First line should end with a period
"""
MyStocks GPU API系统 - 主服务
MyStocks GPU API System - Main Service
"""
^
src/gpu/api_system/services/gpu_api_server.py:44:80: E501 line too long (84 > 79 characters)
REQUEST_DURATION = Histogram("api_request_duration_seconds", "API request duration")
                                                                               ^
src/gpu/api_system/services/gpu_api_server.py:45:80: E501 line too long (80 > 79 characters)
ACTIVE_CONNECTIONS = Gauge("active_connections", "Number of active connections")
                                                                               ^
src/gpu/api_system/services/gpu_api_server.py:51:1: D101 Missing docstring in public class
class GPUServer:
^
src/gpu/api_system/services/gpu_api_server.py:52:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/services/gpu_api_server.py:67:1: D400 First line should end with a period
        """初始化服务器"""
^
src/gpu/api_system/services/gpu_api_server.py:90:1: D400 First line should end with a period
        """创建gRPC服务器"""
^
src/gpu/api_system/services/gpu_api_server.py:115:1: D400 First line should end with a period
        """启动服务器"""
^
src/gpu/api_system/services/gpu_api_server.py:128:80: E501 line too long (80 > 79 characters)
            logger.info("gRPC端口: 50051 (实时数据), 50052 (WebSocket), 50053 (REST)")
                                                                               ^
src/gpu/api_system/services/gpu_api_server.py:139:1: D400 First line should end with a period
        """启动监控线程"""
^
src/gpu/api_system/services/gpu_api_server.py:155:80: E501 line too long (88 > 79 characters)
                    active_connections = self.metrics_collector.get_active_connections()
                                                                               ^
src/gpu/api_system/services/gpu_api_server.py:171:1: D400 First line should end with a period
        """停止服务器"""
^
src/gpu/api_system/services/gpu_api_server.py:185:1: D400 First line should end with a period
        """设置信号处理器"""
^
src/gpu/api_system/services/gpu_api_server.py:196:1: D400 First line should end with a period
        """运行服务器"""
^
src/gpu/api_system/services/gpu_api_server.py:215:1: D400 First line should end with a period
    """主函数"""
^
src/gpu/api_system/services/integrated_backtest_service.py:1:1: D205 1 blank line required between summary line and description
"""
集成回测服务
Integrated Backtest Service
"""
^
src/gpu/api_system/services/integrated_backtest_service.py:1:1: D400 First line should end with a period
"""
集成回测服务
Integrated Backtest Service
"""
^
src/gpu/api_system/services/integrated_backtest_service.py:33:1: D400 First line should end with a period
    """集成回测服务实现"""
^
src/gpu/api_system/services/integrated_backtest_service.py:35:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/integrated_backtest_service.py:67:1: D400 First line should end with a period
        """初始化服务"""
^
src/gpu/api_system/services/integrated_backtest_service.py:82:1: D400 First line should end with a period
        """预热缓存"""
^
src/gpu/api_system/services/integrated_backtest_service.py:111:1: D400 First line should end with a period
        """获取默认策略参数"""
^
src/gpu/api_system/services/integrated_backtest_service.py:154:1: D400 First line should end with a period
        """启动后台任务"""
^
src/gpu/api_system/services/integrated_backtest_service.py:156:80: E501 line too long (86 > 79 characters)
        monitor_thread = threading.Thread(target=self._monitor_backtests, daemon=True)
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:160:80: E501 line too long (88 > 79 characters)
        cleanup_thread = threading.Thread(target=self._cleanup_old_results, daemon=True)
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:166:1: D400 First line should end with a period
        """监控运行中的回测"""
^
src/gpu/api_system/services/integrated_backtest_service.py:175:80: E501 line too long (85 > 79 characters)
                    for backtest_id, backtest_info in self.running_backtests.items():
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:177:80: E501 line too long (88 > 79 characters)
                        start_time = datetime.fromisoformat(backtest_info["start_time"])
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:190:80: E501 line too long (80 > 79 characters)
                            if gpu_stats.get("utilization", 0) < 10:  # GPU利用率过低
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:192:80: E501 line too long (93 > 79 characters)
                                    f"回测 {backtest_id} GPU利用率过低: {gpu_stats['utilization']}%"
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:204:1: D400 First line should end with a period
        """清理旧结果"""
^
src/gpu/api_system/services/integrated_backtest_service.py:209:17: F841 local variable 'cutoff_time' is assigned to but never used
                cutoff_time = datetime.now() - timedelta(
                ^
src/gpu/api_system/services/integrated_backtest_service.py:220:10: N802 function name 'IntegratedBacktest' should be lowercase
    def IntegratedBacktest(
         ^
src/gpu/api_system/services/integrated_backtest_service.py:223:1: D400 First line should end with a period
        """集成回测接口"""
^
src/gpu/api_system/services/integrated_backtest_service.py:224:9: F841 local variable 'start_time' is assigned to but never used
        start_time = time.time()
        ^
src/gpu/api_system/services/integrated_backtest_service.py:226:80: E501 line too long (81 > 79 characters)
            f"integrated_{int(time.time())}_{hash(str(request.strategy_config))}"
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:244:80: E501 line too long (86 > 79 characters)
            if len(self.running_backtests) >= self.config["max_concurrent_backtests"]:
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:264:13: F841 local variable 'future' is assigned to but never used
            future = self.executor.submit(
            ^
src/gpu/api_system/services/integrated_backtest_service.py:291:1: D400 First line should end with a period
        """验证请求参数"""
^
src/gpu/api_system/services/integrated_backtest_service.py:318:80: E501 line too long (87 > 79 characters)
    def _execute_integrated_backtest(self, backtest_id: str, request: BacktestRequest):
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:319:1: D400 First line should end with a period
        """执行集成回测"""
^
src/gpu/api_system/services/integrated_backtest_service.py:328:13: F841 local variable 'strategy_type' is assigned to but never used
            strategy_type = strategy_config.get("strategy_type", "trend_following")
            ^
src/gpu/api_system/services/integrated_backtest_service.py:328:80: E501 line too long (83 > 79 characters)
            strategy_type = strategy_config.get("strategy_type", "trend_following")
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:347:80: E501 line too long (84 > 79 characters)
                    f"backtest_{backtest_id}", priority="high", memory_required=1024
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:351:80: E501 line too long (81 > 79 characters)
                    self.running_backtests[backtest_id]["gpu_accelerated"] = True
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:373:80: E501 line too long (83 > 79 characters)
                        cache_key, backtest_result, data_type="computation_results"
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:378:80: E501 line too long (87 > 79 characters)
                    optimization_suggestions = self._generate_optimization_suggestions(
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:390:80: E501 line too long (83 > 79 characters)
                    self.gpu_manager.release_gpu(f"backtest_{backtest_id}", gpu_id)
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:404:1: D400 First line should end with a period
        """检查缓存中是否有结果"""
^
src/gpu/api_system/services/integrated_backtest_service.py:421:1: D400 First line should end with a period
        """生成缓存键"""
^
src/gpu/api_system/services/integrated_backtest_service.py:431:1: S324 Use of weak MD5 hash for security. Consider usedforsecurity=False
        return hashlib.md5("|".join(key_components).encode()).hexdigest()
^
src/gpu/api_system/services/integrated_backtest_service.py:431:16: F821 undefined name 'hashlib'
        return hashlib.md5("|".join(key_components).encode()).hexdigest()
               ^
src/gpu/api_system/services/integrated_backtest_service.py:440:1: D400 First line should end with a period
        """执行GPU加速回测"""
^
src/gpu/api_system/services/integrated_backtest_service.py:469:80: E501 line too long (84 > 79 characters)
            return self._execute_cpu_backtest(backtest_id, request, strategy_config)
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:474:1: D400 First line should end with a period
        """执行CPU回测"""
^
src/gpu/api_system/services/integrated_backtest_service.py:497:80: E501 line too long (80 > 79 characters)
        self, backtest_id: str, result: Dict[str, Any], from_cache: bool = False
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:499:1: D400 First line should end with a period
        """保存回测结果"""
^
src/gpu/api_system/services/integrated_backtest_service.py:519:80: E501 line too long (83 > 79 characters)
    def _update_backtest_status(self, backtest_id: str, status: str, message: str):
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:520:1: D400 First line should end with a period
        """更新回测状态"""
^
src/gpu/api_system/services/integrated_backtest_service.py:538:1: D400 First line should end with a period
        """生成优化建议"""
^
src/gpu/api_system/services/integrated_backtest_service.py:613:10: N802 function name 'GetBacktestStatus' should be lowercase
    def GetBacktestStatus(self, request, context) -> BacktestStatus:
         ^
src/gpu/api_system/services/integrated_backtest_service.py:614:1: D400 First line should end with a period
        """获取回测状态"""
^
src/gpu/api_system/services/integrated_backtest_service.py:628:80: E501 line too long (84 > 79 characters)
                        gpu_accelerated=backtest_info.get("gpu_accelerated", False),
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:644:80: E501 line too long (81 > 79 characters)
                            gpu_accelerated=result.get("gpu_accelerated", False),
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:657:10: N802 function name 'GetBacktestResult' should be lowercase
    def GetBacktestResult(self, request, context) -> BacktestResult:
         ^
src/gpu/api_system/services/integrated_backtest_service.py:658:1: D400 First line should end with a period
        """获取回测结果"""
^
src/gpu/api_system/services/integrated_backtest_service.py:668:80: E501 line too long (84 > 79 characters)
                        return self._convert_to_backtest_result(backtest_id, result)
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:687:1: D400 First line should end with a period
        """转换为回测结果消息"""
^
src/gpu/api_system/services/integrated_backtest_service.py:700:80: E501 line too long (84 > 79 characters)
                max_consecutive_losses=performance.get("max_consecutive_losses", 0),
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:711:80: E501 line too long (81 > 79 characters)
            optimization_suggestions = result.get("optimization_suggestions", [])
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:729:10: N802 function name 'GetIntegratedBacktestStats' should be lowercase
    def GetIntegratedBacktestStats(self, request, context):
         ^
src/gpu/api_system/services/integrated_backtest_service.py:730:1: D400 First line should end with a period
        """获取集成回测统计信息"""
^
src/gpu/api_system/services/integrated_backtest_service.py:748:80: E501 line too long (83 > 79 characters)
                "cache_hit_rate": self.cache_manager.get_cache_performance_report()
                                                                               ^
src/gpu/api_system/services/integrated_backtest_service.py:767:1: D400 First line should end with a period
        """停止服务"""
^
src/gpu/api_system/services/integrated_backtest_service.py:774:80: E501 line too long (82 > 79 characters)
                    self._update_backtest_status(backtest_id, "cancelled", "服务停止")
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:1:1: D205 1 blank line required between summary line and description
"""
集成机器学习训练服务
Integrated Machine Learning Training Service
"""
^
src/gpu/api_system/services/integrated_ml_service.py:1:1: D400 First line should end with a period
"""
集成机器学习训练服务
Integrated Machine Learning Training Service
"""
^
src/gpu/api_system/services/integrated_ml_service.py:9:1: S403 Consider possible security implications associated with pickle module.
import pickle
^
src/gpu/api_system/services/integrated_ml_service.py:38:1: D400 First line should end with a period
    """集成机器学习训练服务实现"""
^
src/gpu/api_system/services/integrated_ml_service.py:40:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/integrated_ml_service.py:69:80: E501 line too long (81 > 79 characters)
            "model_save_path": "/opt/claude/mystocks_spec/gpu_api_system/models",
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:93:1: D400 First line should end with a period
        """初始化服务"""
^
src/gpu/api_system/services/integrated_ml_service.py:111:1: D400 First line should end with a period
        """启动后台任务"""
^
src/gpu/api_system/services/integrated_ml_service.py:119:80: E501 line too long (87 > 79 characters)
        cleanup_thread = threading.Thread(target=self._cleanup_old_models, daemon=True)
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:123:80: E501 line too long (80 > 79 characters)
        stats_thread = threading.Thread(target=self._collect_stats, daemon=True)
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:129:1: D400 First line should end with a period
        """监控训练任务"""
^
src/gpu/api_system/services/integrated_ml_service.py:141:80: E501 line too long (88 > 79 characters)
                            start_time = datetime.fromisoformat(task_info["start_time"])
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:157:1: D400 First line should end with a period
        """清理旧模型"""
^
src/gpu/api_system/services/integrated_ml_service.py:170:80: E501 line too long (87 > 79 characters)
                        created_time = datetime.fromisoformat(model_info["created_at"])
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:178:80: E501 line too long (84 > 79 characters)
                            Path(self.config["model_save_path"]) / f"{model_id}.pkl"
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:192:1: D400 First line should end with a period
        """收集性能统计"""
^
src/gpu/api_system/services/integrated_ml_service.py:207:80: E501 line too long (87 > 79 characters)
                    self.stats["gpu_training_count"] + self.stats["cpu_training_count"]
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:210:80: E501 line too long (87 > 79 characters)
                    gpu_ratio = self.stats["gpu_training_count"] / total_training * 100
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:219:1: D400 First line should end with a period
        """加载已保存的模型"""
^
src/gpu/api_system/services/integrated_ml_service.py:228:1: S301 Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
                        model_data = pickle.load(f)
^
src/gpu/api_system/services/integrated_ml_service.py:237:80: E501 line too long (82 > 79 characters)
                            "model_type": model_data.get("model_type", "unknown"),
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:250:10: N802 function name 'TrainModel' should be lowercase
    def TrainModel(
         ^
src/gpu/api_system/services/integrated_ml_service.py:253:1: D400 First line should end with a period
        """训练模型"""
^
src/gpu/api_system/services/integrated_ml_service.py:278:80: E501 line too long (83 > 79 characters)
                if active_training_count >= self.config["max_concurrent_training"]:
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:297:13: F841 local variable 'future' is assigned to but never used
            future = self.executor.submit(self._execute_training, task_id, request)
            ^
src/gpu/api_system/services/integrated_ml_service.py:297:80: E501 line too long (83 > 79 characters)
            future = self.executor.submit(self._execute_training, task_id, request)
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:315:80: E501 line too long (83 > 79 characters)
                task_id=task_id, status=TrainingStatus.FAILED, message=f"训练失败: {e}"
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:318:80: E501 line too long (87 > 79 characters)
    def _validate_training_request(self, request: TrainModelRequest) -> Dict[str, Any]:
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:319:1: D400 First line should end with a period
        """验证训练请求"""
^
src/gpu/api_system/services/integrated_ml_service.py:343:1: D400 First line should end with a period
        """执行训练任务"""
^
src/gpu/api_system/services/integrated_ml_service.py:354:14: N806 variable 'X' in function should be lowercase
            X = df[list(request.feature_columns)]
             ^
src/gpu/api_system/services/integrated_ml_service.py:360:80: E501 line too long (80 > 79 characters)
                    f"ml_train_{task_id}", priority="high", memory_required=2048
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:372:80: E501 line too long (85 > 79 characters)
                    json.loads(request.model_params) if request.model_params else {},
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:380:80: E501 line too long (85 > 79 characters)
                    json.loads(request.model_params) if request.model_params else {},
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:416:16: N803 argument name 'X' should be lowercase
        self, X: pd.DataFrame, y: pd.Series, model_type: str, params: Dict
               ^
src/gpu/api_system/services/integrated_ml_service.py:418:1: D400 First line should end with a period
        """GPU训练模型"""
^
src/gpu/api_system/services/integrated_ml_service.py:423:14: N806 variable 'X_gpu' in function should be lowercase
            X_gpu = cudf.DataFrame.from_pandas(X)
             ^
src/gpu/api_system/services/integrated_ml_service.py:458:80: E501 line too long (86 > 79 characters)
            if model_type in ["linear_regression", "ridge", "lasso", "random_forest"]:
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:493:16: N803 argument name 'X' should be lowercase
        self, X: pd.DataFrame, y: pd.Series, model_type: str, params: Dict
               ^
src/gpu/api_system/services/integrated_ml_service.py:495:1: D400 First line should end with a period
        """CPU训练模型"""
^
src/gpu/api_system/services/integrated_ml_service.py:504:80: E501 line too long (84 > 79 characters)
            from sklearn.metrics import r2_score, mean_squared_error, accuracy_score
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:528:80: E501 line too long (86 > 79 characters)
            if model_type in ["linear_regression", "ridge", "lasso", "random_forest"]:
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:558:80: E501 line too long (85 > 79 characters)
    def _save_model(self, model_id: str, model: Any, model_type: str, metrics: Dict):
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:559:1: D400 First line should end with a period
        """保存模型"""
^
src/gpu/api_system/services/integrated_ml_service.py:575:80: E501 line too long (81 > 79 characters)
            model_path = Path(self.config["model_save_path"]) / f"{model_id}.pkl"
                                                                               ^
src/gpu/api_system/services/integrated_ml_service.py:597:10: N802 function name 'Predict' should be lowercase
    def Predict(
         ^
src/gpu/api_system/services/integrated_ml_service.py:600:1: D400 First line should end with a period
        """预测"""
^
src/gpu/api_system/services/integrated_ml_service.py:616:14: N806 variable 'X' in function should be lowercase
            X = pd.DataFrame(input_data)
             ^
src/gpu/api_system/services/integrated_ml_service.py:626:18: N806 variable 'X_gpu' in function should be lowercase
                X_gpu = cudf.DataFrame.from_pandas(X)
                 ^
src/gpu/api_system/services/integrated_ml_service.py:650:10: N802 function name 'GetTrainingStatus' should be lowercase
    def GetTrainingStatus(self, request, context) -> TrainingStatus:
         ^
src/gpu/api_system/services/integrated_ml_service.py:651:1: D400 First line should end with a period
        """获取训练状态"""
^
src/gpu/api_system/services/integrated_ml_service.py:679:10: N802 function name 'GetModelMetrics' should be lowercase
    def GetModelMetrics(self, request, context) -> ModelMetrics:
         ^
src/gpu/api_system/services/integrated_ml_service.py:680:1: D400 First line should end with a period
        """获取模型指标"""
^
src/gpu/api_system/services/integrated_ml_service.py:708:10: N802 function name 'GetMLStats' should be lowercase
    def GetMLStats(self, request, context):
         ^
src/gpu/api_system/services/integrated_ml_service.py:709:1: D400 First line should end with a period
        """获取ML统计信息"""
^
src/gpu/api_system/services/integrated_ml_service.py:752:1: D400 First line should end with a period
        """停止服务"""
^
src/gpu/api_system/services/integrated_realtime_service.py:1:1: D100 Missing docstring in public module
import logging
^
src/gpu/api_system/services/integrated_realtime_service.py:4:1: F401 'typing.Dict' imported but unused
from typing import Dict, List, Any, Iterator
^
src/gpu/api_system/services/integrated_realtime_service.py:4:1: F401 'typing.Any' imported but unused
from typing import Dict, List, Any, Iterator
^
src/gpu/api_system/services/integrated_realtime_service.py:8:1: F401 'pandas as pd' imported but unused
import pandas as pd
^
src/gpu/api_system/services/integrated_realtime_service.py:14:80: E501 line too long (108 > 79 characters)
# Removed direct import of GPUAccelerationEngine as it's no longer directly instantiated for data processing
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:16:62: E261 at least two spaces before inline comment
from src.gpu.data_processing_interfaces import IDataProcessor # New import for the interface
                                                             ^
src/gpu/api_system/services/integrated_realtime_service.py:16:80: E501 line too long (92 > 79 characters)
from src.gpu.data_processing_interfaces import IDataProcessor # New import for the interface
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:17:64: E261 at least two spaces before inline comment
from src.gpu.data_processor_factory import DataProcessorFactory # New import for the factory
                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:17:80: E501 line too long (92 > 79 characters)
from src.gpu.data_processor_factory import DataProcessorFactory # New import for the factory
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:32:1: D400 First line should end with a period
    """集成实时数据处理服务实现"""
^
src/gpu/api_system/services/integrated_realtime_service.py:34:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/integrated_realtime_service.py:39:46: E261 at least two spaces before inline comment
        data_processor: IDataProcessor = None # Dependency Injection for IDataProcessor
                                             ^
src/gpu/api_system/services/integrated_realtime_service.py:39:80: E501 line too long (87 > 79 characters)
        data_processor: IDataProcessor = None # Dependency Injection for IDataProcessor
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:41:80: E501 line too long (140 > 79 characters)
        # Removed super().__init__(gpu_manager, redis_queue, metrics_collector) as RealTimeServiceServicer likely does not expect these args
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:48:80: E501 line too long (104 > 79 characters)
        self.data_processor = data_processor if data_processor else DataProcessorFactory.get_processor()
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:52:80: E501 line too long (112 > 79 characters)
        # Removed direct instantiation of GPUAccelerationEngine as its data processing aspects are now delegated
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:53:80: E501 line too long (81 > 79 characters)
        # self.gpu_engine = GPUAccelerationEngine(gpu_manager, metrics_collector)
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:72:42: E261 at least two spaces before inline comment
            "batch_processing_size": 100, # Renamed from gpu_batch_size for generality
                                         ^
src/gpu/api_system/services/integrated_realtime_service.py:72:80: E501 line too long (86 > 79 characters)
            "batch_processing_size": 100, # Renamed from gpu_batch_size for generality
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:75:80: E501 line too long (100 > 79 characters)
            # This flag now controls which processor is instantiated by the factory, if not injected
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:76:80: E501 line too long (119 > 79 characters)
            "enable_gpu_acceleration": isinstance(self.data_processor, DataProcessorFactory.get_processor_type("gpu")),
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:92:1: D400 First line should end with a period
        """初始化服务"""
^
src/gpu/api_system/services/integrated_realtime_service.py:107:1: D400 First line should end with a period
        """启动后台任务"""
^
src/gpu/api_system/services/integrated_realtime_service.py:109:80: E501 line too long (84 > 79 characters)
        monitor_thread = threading.Thread(target=self._monitor_streams, daemon=True)
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:119:80: E501 line too long (80 > 79 characters)
        stats_thread = threading.Thread(target=self._collect_stats, daemon=True)
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:125:1: D400 First line should end with a period
        """监控活动的数据流"""
^
src/gpu/api_system/services/integrated_realtime_service.py:158:1: D400 First line should end with a period
        """清理过期的特征缓存"""
^
src/gpu/api_system/services/integrated_realtime_service.py:184:1: D400 First line should end with a period
        """收集性能统计"""
^
src/gpu/api_system/services/integrated_realtime_service.py:194:80: E501 line too long (87 > 79 characters)
                    "realtime_features_computed", self.stats["total_features_computed"]
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:198:80: E501 line too long (86 > 79 characters)
                total_requests = self.stats["cache_hits"] + self.stats["cache_misses"]
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:206:80: E501 line too long (99 > 79 characters)
                if isinstance(self.data_processor, DataProcessorFactory.get_processor_type("gpu")):
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:208:55: E261 at least two spaces before inline comment
                        "gpu_computation_ratio", 100.0 # Heuristic: if GPU processor is active, assume 100% of its computations are GPU
                                                      ^
src/gpu/api_system/services/integrated_realtime_service.py:208:80: E501 line too long (135 > 79 characters)
                        "gpu_computation_ratio", 100.0 # Heuristic: if GPU processor is active, assume 100% of its computations are GPU
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:218:10: N802 function name 'StreamMarketData' should be lowercase
    def StreamMarketData(
         ^
src/gpu/api_system/services/integrated_realtime_service.py:223:1: D400 First line should end with a period
        """流式处理市场数据"""
^
src/gpu/api_system/services/integrated_realtime_service.py:259:80: E501 line too long (85 > 79 characters)
                        responses = self._process_data_batch(batch_buffer, stream_id)
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:293:1: D400 First line should end with a period
        """批量处理数据"""
^
src/gpu/api_system/services/integrated_realtime_service.py:304:48: E261 at least two spaces before inline comment
                    "timestamp": req.timestamp, # Pass timestamp for potential use in processor
                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:304:80: E501 line too long (95 > 79 characters)
                    "timestamp": req.timestamp, # Pass timestamp for potential use in processor
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:317:1: W293 blank line contains whitespace

^
src/gpu/api_system/services/integrated_realtime_service.py:323:80: E501 line too long (83 > 79 characters)
                    # Assuming item is already a dictionary that can be serialized.
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:331:80: E501 line too long (95 > 79 characters)
            if isinstance(self.data_processor, DataProcessorFactory.get_processor_type("gpu")):
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:337:9: E303 too many blank lines (2)
        except Exception as e:
        ^
src/gpu/api_system/services/integrated_realtime_service.py:339:80: E501 line too long (98 > 79 characters)
            # If batch processing fails, return empty list of responses and let the client handle.
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:351:1: D400 First line should end with a period
        """更新数据缓冲区"""
^
src/gpu/api_system/services/integrated_realtime_service.py:365:10: N802 function name 'ComputeFeatures' should be lowercase
    def ComputeFeatures(
         ^
src/gpu/api_system/services/integrated_realtime_service.py:368:1: D400 First line should end with a period
        """计算技术特征"""
^
src/gpu/api_system/services/integrated_realtime_service.py:374:80: E501 line too long (83 > 79 characters)
            cache_key = self._generate_feature_cache_key(stock_code, feature_types)
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:408:80: E501 line too long (91 > 79 characters)
            features = self.data_processor.compute_features(historical_data, feature_types)
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:409:1: W293 blank line contains whitespace

^
src/gpu/api_system/services/integrated_realtime_service.py:411:80: E501 line too long (95 > 79 characters)
            if isinstance(self.data_processor, DataProcessorFactory.get_processor_type("gpu")):
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:419:35: E261 at least two spaces before inline comment
                features=features, # Assuming 'features' is already a map<string, float> as expected by proto
                                  ^
src/gpu/api_system/services/integrated_realtime_service.py:419:80: E501 line too long (109 > 79 characters)
                features=features, # Assuming 'features' is already a map<string, float> as expected by proto
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:443:1: D400 First line should end with a period
        """生成特征缓存键"""
^
src/gpu/api_system/services/integrated_realtime_service.py:447:1: S324 Use of weak MD5 hash for security. Consider usedforsecurity=False
        return hashlib.md5(key_str.encode()).hexdigest()
^
src/gpu/api_system/services/integrated_realtime_service.py:449:80: E501 line too long (107 > 79 characters)
    # Removed _gpu_process_batch and _cpu_process_batch methods as they are now delegated to data_processor
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:450:80: E501 line too long (113 > 79 characters)
    # Removed _compute_features_gpu and _compute_features_cpu methods as they are now delegated to data_processor
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:453:1: D400 First line should end with a period
        """关闭数据流"""
^
src/gpu/api_system/services/integrated_realtime_service.py:459:80: E501 line too long (82 > 79 characters)
                        f"关闭数据流 {stream_id}, 处理了 {stream_info['data_count']} 个数据点"
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:465:10: N802 function name 'GetStreamStats' should be lowercase
    def GetStreamStats(self, request, context):
         ^
src/gpu/api_system/services/integrated_realtime_service.py:466:1: D400 First line should end with a period
        """获取流统计信息"""
^
src/gpu/api_system/services/integrated_realtime_service.py:470:80: E501 line too long (83 > 79 characters)
                # Removed total_data_processed as it's not directly stream-specific
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:476:80: E501 line too long (81 > 79 characters)
                "total_features_computed": self.stats["total_features_computed"],
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:481:80: E501 line too long (82 > 79 characters)
                    if (self.stats["cache_hits"] + self.stats["cache_misses"]) > 0
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:486:80: E501 line too long (87 > 79 characters)
                    / (self.stats["gpu_computations"] + self.stats["cpu_computations"])
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:488:80: E501 line too long (88 > 79 characters)
                    if (self.stats["gpu_computations"] + self.stats["cpu_computations"])
                                                                               ^
src/gpu/api_system/services/integrated_realtime_service.py:505:1: D400 First line should end with a period
        """停止服务"""
^
src/gpu/api_system/services/realtime_service.py:1:1: D205 1 blank line required between summary line and description
"""
实时数据服务
Real-time Data Service
"""
^
src/gpu/api_system/services/realtime_service.py:1:1: D400 First line should end with a period
"""
实时数据服务
Real-time Data Service
"""
^
src/gpu/api_system/services/realtime_service.py:31:1: D400 First line should end with a period
    """实时数据服务实现"""
^
src/gpu/api_system/services/realtime_service.py:33:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/realtime_service.py:57:1: D400 First line should end with a period
        """初始化服务"""
^
src/gpu/api_system/services/realtime_service.py:70:1: D400 First line should end with a period
        """数据处理主循环"""
^
src/gpu/api_system/services/realtime_service.py:94:1: D400 First line should end with a period
        """处理数据缓冲区"""
^
src/gpu/api_system/services/realtime_service.py:96:13: F841 local variable 'current_time' is assigned to but never used
            current_time = datetime.now()
            ^
src/gpu/api_system/services/realtime_service.py:106:40: E203 whitespace before ':'
                    batch = data_list[i : i + batch_size]
                                       ^
src/gpu/api_system/services/realtime_service.py:118:1: D400 First line should end with a period
        """使用GPU批量处理数据"""
^
src/gpu/api_system/services/realtime_service.py:122:80: E501 line too long (80 > 79 characters)
                f"realtime_{stock_code}", priority="medium", memory_required=512
                                                                               ^
src/gpu/api_system/services/realtime_service.py:150:1: D400 First line should end with a period
        """使用CPU批量处理数据"""
^
src/gpu/api_system/services/realtime_service.py:169:80: E501 line too long (82 > 79 characters)
    def _update_processed_data(self, stock_code: str, processed_data: List[Dict]):
                                                                               ^
src/gpu/api_system/services/realtime_service.py:170:1: D400 First line should end with a period
        """更新处理后的数据"""
^
src/gpu/api_system/services/realtime_service.py:180:44: E203 whitespace before ':'
                -self.config["buffer_size"] :
                                           ^
src/gpu/api_system/services/realtime_service.py:184:1: D400 First line should end with a period
        """计算特征"""
^
src/gpu/api_system/services/realtime_service.py:229:1: D400 First line should end with a period
        """计算技术指标"""
^
src/gpu/api_system/services/realtime_service.py:292:80: E501 line too long (88 > 79 characters)
                    (prices[-1] - prices[0]) / prices[0] * 100 if len(prices) > 1 else 0
                                                                               ^
src/gpu/api_system/services/realtime_service.py:301:1: D400 First line should end with a period
        """计算指数移动平均"""
^
src/gpu/api_system/services/realtime_service.py:314:1: D400 First line should end with a period
        """计算相对强弱指数"""
^
src/gpu/api_system/services/realtime_service.py:337:1: D400 First line should end with a period
        """更新统计信息"""
^
src/gpu/api_system/services/realtime_service.py:339:80: E501 line too long (80 > 79 characters)
            total_records = sum(len(data) for data in self.data_buffer.values())
                                                                               ^
src/gpu/api_system/services/realtime_service.py:343:13: F841 local variable 'statistics' is assigned to but never used
            statistics = {
            ^
src/gpu/api_system/services/realtime_service.py:361:1: D400 First line should end with a period
        """清理过期数据"""
^
src/gpu/api_system/services/realtime_service.py:369:80: E501 line too long (82 > 79 characters)
                if (current_time - cache_time).seconds > self.config["cache_ttl"]:
                                                                               ^
src/gpu/api_system/services/realtime_service.py:379:80: E501 line too long (82 > 79 characters)
                if len(self.data_buffer[stock_code]) > self.config["buffer_size"]:
                                                                               ^
src/gpu/api_system/services/realtime_service.py:380:80: E501 line too long (80 > 79 characters)
                    self.data_buffer[stock_code] = self.data_buffer[stock_code][
                                                                               ^
src/gpu/api_system/services/realtime_service.py:381:52: E203 whitespace before ':'
                        -self.config["buffer_size"] :
                                                   ^
src/gpu/api_system/services/realtime_service.py:388:10: N802 function name 'GetMarketData' should be lowercase
    def GetMarketData(
         ^
src/gpu/api_system/services/realtime_service.py:391:1: D400 First line should end with a period
        """获取实时行情数据"""
^
src/gpu/api_system/services/realtime_service.py:451:10: N802 function name 'CalculateFeatures' should be lowercase
    def CalculateFeatures(
         ^
src/gpu/api_system/services/realtime_service.py:454:1: D400 First line should end with a period
        """计算特征"""
^
src/gpu/api_system/services/realtime_service.py:494:80: E501 line too long (83 > 79 characters)
                            k: v for k, v in features.items() if k in feature_types
                                                                               ^
src/gpu/api_system/services/realtime_service.py:514:10: N802 function name 'GetRealtimeStatistics' should be lowercase
    def GetRealtimeStatistics(self, request, context) -> RealtimeStatistics:
         ^
src/gpu/api_system/services/realtime_service.py:515:1: D400 First line should end with a period
        """获取实时统计信息"""
^
src/gpu/api_system/services/realtime_service.py:517:80: E501 line too long (80 > 79 characters)
            total_records = sum(len(data) for data in self.data_buffer.values())
                                                                               ^
src/gpu/api_system/services/realtime_service.py:541:10: N802 function name 'StreamMarketData' should be lowercase
    def StreamMarketData(
         ^
src/gpu/api_system/services/realtime_service.py:544:1: D400 First line should end with a period
        """流式市场数据"""
^
src/gpu/api_system/services/realtime_service.py:563:80: E501 line too long (81 > 79 characters)
                        latest_data = self.data_buffer[stock_code][-1:]  # 最近一条数据
                                                                               ^
src/gpu/api_system/services/realtime_service.py:567:80: E501 line too long (80 > 79 characters)
                                stock_code=latest_data[0].get("stock_code", ""),
                                                                               ^
src/gpu/api_system/services/realtime_service.py:602:1: D400 First line should end with a period
        """添加市场数据"""
^
src/gpu/api_system/services/realtime_service.py:615:1: D400 First line should end with a period
        """停止服务"""
^
src/gpu/api_system/services/resource_scheduler.py:1:1: D205 1 blank line required between summary line and description
"""
资源调度器
Resource Scheduler
"""
^
src/gpu/api_system/services/resource_scheduler.py:1:1: D400 First line should end with a period
"""
资源调度器
Resource Scheduler
"""
^
src/gpu/api_system/services/resource_scheduler.py:22:1: D400 First line should end with a period
    """任务优先级"""
^
src/gpu/api_system/services/resource_scheduler.py:32:1: D400 First line should end with a period
    """任务状态"""
^
src/gpu/api_system/services/resource_scheduler.py:43:1: D400 First line should end with a period
    """任务类型"""
^
src/gpu/api_system/services/resource_scheduler.py:54:1: D400 First line should end with a period
    """任务类"""
^
src/gpu/api_system/services/resource_scheduler.py:56:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/resource_scheduler.py:83:1: D400 First line should end with a period
        """用于优先级队列排序"""
^
src/gpu/api_system/services/resource_scheduler.py:87:1: D400 First line should end with a period
        """转换为字典"""
^
src/gpu/api_system/services/resource_scheduler.py:96:80: E501 line too long (83 > 79 characters)
            "started_at": self.started_at.isoformat() if self.started_at else None,
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:110:1: D400 First line should end with a period
    """资源调度器"""
^
src/gpu/api_system/services/resource_scheduler.py:112:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/services/resource_scheduler.py:137:1: D400 First line should end with a period
        """初始化调度器"""
^
src/gpu/api_system/services/resource_scheduler.py:154:1: D400 First line should end with a period
        """调度器主循环"""
^
src/gpu/api_system/services/resource_scheduler.py:179:80: E501 line too long (82 > 79 characters)
    def _create_task_from_data(self, task_data: Dict[str, Any]) -> Optional[Task]:
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:180:1: D400 First line should end with a period
        """从任务数据创建Task对象"""
^
src/gpu/api_system/services/resource_scheduler.py:215:1: D400 First line should end with a period
        """添加任务到调度器"""
^
src/gpu/api_system/services/resource_scheduler.py:223:1: D400 First line should end with a period
        """检查运行中的任务"""
^
src/gpu/api_system/services/resource_scheduler.py:253:1: D400 First line should end with a period
        """清理完成的任务"""
^
src/gpu/api_system/services/resource_scheduler.py:268:1: D400 First line should end with a period
        """健康检查"""
^
src/gpu/api_system/services/resource_scheduler.py:275:80: E501 line too long (95 > 79 characters)
                    f"总={gpu_stats['total_gpus']}, 利用率={gpu_stats['average_utilization']:.1f}%"
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:289:80: E501 line too long (89 > 79 characters)
                    f"运行中任务数量接近上限: {running_count}/{self.config['max_concurrent_tasks']}"
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:296:1: D400 First line should end with a period
        """调度任务执行"""
^
src/gpu/api_system/services/resource_scheduler.py:334:1: D400 First line should end with a period
        """执行任务"""
^
src/gpu/api_system/services/resource_scheduler.py:373:80: E501 line too long (87 > 79 characters)
                    f"任务 {task.task_id} 将在 {retry_delay} 秒后重试 (第 {task.retry_count} 次)"
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:392:1: D400 First line should end with a period
        """执行回测任务"""
^
src/gpu/api_system/services/resource_scheduler.py:409:1: D400 First line should end with a period
        """执行实时数据处理任务"""
^
src/gpu/api_system/services/resource_scheduler.py:422:1: D400 First line should end with a period
        """执行机器学习训练任务"""
^
src/gpu/api_system/services/resource_scheduler.py:436:1: D400 First line should end with a period
        """执行优化任务"""
^
src/gpu/api_system/services/resource_scheduler.py:449:1: D400 First line should end with a period
        """执行风险控制任务"""
^
src/gpu/api_system/services/resource_scheduler.py:463:1: D400 First line should end with a period
        """执行高频交易任务"""
^
src/gpu/api_system/services/resource_scheduler.py:477:1: D400 First line should end with a period
        """取消任务"""
^
src/gpu/api_system/services/resource_scheduler.py:491:1: D400 First line should end with a period
        """获取任务状态"""
^
src/gpu/api_system/services/resource_scheduler.py:507:1: D400 First line should end with a period
        """获取调度器统计信息"""
^
src/gpu/api_system/services/resource_scheduler.py:539:1: D400 First line should end with a period
        """停止调度器"""
^
src/gpu/api_system/services/resource_scheduler.py:553:1: D400 First line should end with a period
        """获取队列可视化信息"""
^
src/gpu/api_system/services/resource_scheduler.py:590:10: F821 undefined name 'Union'
    ) -> Union[Dict[str, Any], List[Dict[str, Any]]]:
         ^
src/gpu/api_system/services/resource_scheduler.py:591:1: D400 First line should end with a period
        """获取详细任务信息"""
^
src/gpu/api_system/services/resource_scheduler.py:604:80: E501 line too long (84 > 79 characters)
                            task.started_at.isoformat() if task.started_at else None
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:615:80: E501 line too long (88 > 79 characters)
                        "estimated_remaining_time": self._estimate_remaining_time(task),
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:633:80: E501 line too long (88 > 79 characters)
                                task.started_at.isoformat() if task.started_at else None
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:637:80: E501 line too long (82 > 79 characters)
                                (datetime.now() - task.created_at).total_seconds()
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:656:80: E501 line too long (88 > 79 characters)
                                "estimated_start_time": self._estimate_start_time(task),
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:660:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/gpu/api_system/services/resource_scheduler.py:666:1: D400 First line should end with a period
        """获取性能指标"""
^
src/gpu/api_system/services/resource_scheduler.py:669:13: F841 local variable 'queue_stats' is assigned to but never used
            queue_stats = self.redis_queue.get_queue_statistics()
            ^
src/gpu/api_system/services/resource_scheduler.py:686:80: E501 line too long (81 > 79 characters)
                "average_task_duration": self._calculate_average_task_duration(),
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:691:80: E501 line too long (80 > 79 characters)
                    "memory_efficiency": system_efficiency["memory_efficiency"],
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:700:1: D400 First line should end with a period
        """获取效率分析报告"""
^
src/gpu/api_system/services/resource_scheduler.py:705:80: E501 line too long (84 > 79 characters)
            gpu_utilization = self.gpu_manager.get_gpu_stats().get("utilization", 0)
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:712:80: E501 line too long (81 > 79 characters)
                "overall_efficiency_score": self._calculate_overall_efficiency(),
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:718:80: E501 line too long (94 > 79 characters)
                "optimization_recommendations": self._generate_optimization_recommendations(),
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:726:1: D400 First line should end with a period
        """计算预估等待时间"""
^
src/gpu/api_system/services/resource_scheduler.py:747:1: D400 First line should end with a period
        """评估队列健康状态"""
^
src/gpu/api_system/services/resource_scheduler.py:764:1: D400 First line should end with a period
        """估算任务剩余时间"""
^
src/gpu/api_system/services/resource_scheduler.py:780:1: D400 First line should end with a period
        """估算任务开始时间"""
^
src/gpu/api_system/services/resource_scheduler.py:791:1: D400 First line should end with a period
        """计算系统效率"""
^
src/gpu/api_system/services/resource_scheduler.py:792:80: E501 line too long (80 > 79 characters)
        gpu_utilization = self.gpu_manager.get_gpu_stats().get("utilization", 0)
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:812:1: D400 First line should end with a period
        """计算任务吞吐量"""
^
src/gpu/api_system/services/resource_scheduler.py:814:80: E501 line too long (81 > 79 characters)
            [t for t in self.completed_tasks if t.status == TaskStatus.COMPLETED]
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:834:80: E501 line too long (87 > 79 characters)
                round(completed_count / total_count * 100, 2) if total_count > 0 else 0
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:837:80: E501 line too long (86 > 79 characters)
                self.task_queue.qsize() / self.config["max_concurrent_tasks"] * 100, 2
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:844:1: D400 First line should end with a period
        """计算GPU效率"""
^
src/gpu/api_system/services/resource_scheduler.py:854:1: D400 First line should end with a period
        """计算平均任务执行时间"""
^
src/gpu/api_system/services/resource_scheduler.py:858:80: E501 line too long (83 > 79 characters)
            if t.status == TaskStatus.COMPLETED and t.started_at and t.completed_at
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:872:1: D400 First line should end with a period
        """计算任务成功率"""
^
src/gpu/api_system/services/resource_scheduler.py:877:80: E501 line too long (81 > 79 characters)
            [t for t in self.completed_tasks if t.status == TaskStatus.COMPLETED]
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:884:1: D400 First line should end with a period
        """识别系统瓶颈"""
^
src/gpu/api_system/services/resource_scheduler.py:888:80: E501 line too long (80 > 79 characters)
        gpu_utilization = self.gpu_manager.get_gpu_stats().get("utilization", 0)
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:908:1: D400 First line should end with a period
        """计算队列处理效率"""
^
src/gpu/api_system/services/resource_scheduler.py:919:1: D400 First line should end with a period
        """计算任务执行效率"""
^
src/gpu/api_system/services/resource_scheduler.py:931:80: E501 line too long (80 > 79 characters)
                duration = (task.completed_at - task.started_at).total_seconds()
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:938:1: D400 First line should end with a period
        """计算资源分配效率"""
^
src/gpu/api_system/services/resource_scheduler.py:939:80: E501 line too long (80 > 79 characters)
        gpu_utilization = self.gpu_manager.get_gpu_stats().get("utilization", 0)
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:940:9: F841 local variable 'running_tasks' is assigned to but never used
        running_tasks = len(self.running_tasks)
        ^
src/gpu/api_system/services/resource_scheduler.py:941:9: F841 local variable 'max_concurrent' is assigned to but never used
        max_concurrent = self.config["max_concurrent_tasks"]
        ^
src/gpu/api_system/services/resource_scheduler.py:950:1: D400 First line should end with a period
        """计算整体效率得分"""
^
src/gpu/api_system/services/resource_scheduler.py:967:1: D400 First line should end with a period
        """计算效率趋势"""
^
src/gpu/api_system/services/resource_scheduler.py:978:1: D400 First line should end with a period
        """生成优化建议"""
^
src/gpu/api_system/services/resource_scheduler.py:982:80: E501 line too long (80 > 79 characters)
        gpu_utilization = self.gpu_manager.get_gpu_stats().get("utilization", 0)
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:999:1: D400 First line should end with a period
        """分析容量利用率"""
^
src/gpu/api_system/services/resource_scheduler.py:1018:80: E501 line too long (88 > 79 characters)
                (gpu_stats.get("utilization", 0) + running_tasks / max_concurrent * 100)
                                                                               ^
src/gpu/api_system/services/resource_scheduler.py:1027:1: D400 First line should end with a period
        """获取性能基准"""
^
src/gpu/api_system/tests/__init__.py:1:1: D205 1 blank line required between summary line and description
"""
GPU API System Test Suite
测试套件入口文件
"""
^
src/gpu/api_system/tests/__init__.py:1:1: D400 First line should end with a period
"""
GPU API System Test Suite
测试套件入口文件
"""
^
src/gpu/api_system/tests/conftest.py:1:1: D205 1 blank line required between summary line and description
"""
Pytest配置文件
定义共享的fixtures和测试配置
"""
^
src/gpu/api_system/tests/conftest.py:1:1: D400 First line should end with a period
"""
Pytest配置文件
定义共享的fixtures和测试配置
"""
^
src/gpu/api_system/tests/conftest.py:18:1: D400 First line should end with a period
    """检查GPU是否可用，并在WSL2环境下初始化GPU"""
^
src/gpu/api_system/tests/conftest.py:35:9: F841 local variable 'df' is assigned to but never used
        df = cudf.DataFrame({"a": [1, 2, 3]})
        ^
src/gpu/api_system/tests/conftest.py:44:1: D400 First line should end with a period
    """检查Redis是否可用"""
^
src/gpu/api_system/tests/conftest.py:61:1: D400 First line should end with a period
    """模拟GPU资源管理器"""
^
src/gpu/api_system/tests/conftest.py:75:1: D400 First line should end with a period
    """模拟Redis队列"""
^
src/gpu/api_system/tests/conftest.py:89:1: D400 First line should end with a period
    """模拟指标收集器"""
^
src/gpu/api_system/tests/conftest.py:102:1: D400 First line should end with a period
    """生成样本市场数据"""
^
src/gpu/api_system/tests/conftest.py:124:1: D400 First line should end with a period
    """样本策略配置"""
^
src/gpu/api_system/tests/conftest.py:137:1: D400 First line should end with a period
    """生成ML训练样本数据"""
^
src/gpu/api_system/tests/conftest.py:157:1: D400 First line should end with a period
    """测试配置"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:1:1: D205 1 blank line required between summary line and description
"""
端到端集成测试
测试完整的API工作流和服务集成
"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:1:1: D400 First line should end with a period
"""
端到端集成测试
测试完整的API工作流和服务集成
"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:14:1: D400 First line should end with a period
    """回测服务端到端测试"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:18:1: D400 First line should end with a period
        """创建gRPC通道"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:30:1: D400 First line should end with a period
        """创建回测服务stub"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:41:1: D400 First line should end with a period
        """测试完整的回测工作流"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:58:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert submit_result.backtest_id is not None
^
src/gpu/api_system/tests/integration/test_end_to_end.py:69:80: E501 line too long (85 > 79 characters)
            status_response.status = "COMPLETED" if i == max_polls - 1 else "RUNNING"
                                                                               ^
src/gpu/api_system/tests/integration/test_end_to_end.py:81:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert status.status == "COMPLETED"
^
src/gpu/api_system/tests/integration/test_end_to_end.py:98:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "COMPLETED"
^
src/gpu/api_system/tests/integration/test_end_to_end.py:99:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.performance_metrics.total_return > 0
^
src/gpu/api_system/tests/integration/test_end_to_end.py:102:1: D400 First line should end with a period
        """测试并发回测"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:119:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(backtest_ids) == 5
^
src/gpu/api_system/tests/integration/test_end_to_end.py:120:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert all(bid is not None for bid in backtest_ids)
^
src/gpu/api_system/tests/integration/test_end_to_end.py:124:1: D400 First line should end with a period
    """实时流处理端到端测试"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:128:1: D400 First line should end with a period
        """创建实时处理服务stub"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:133:1: D202 No blank lines allowed after function docstring
        """测试流式数据处理"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:133:1: D400 First line should end with a period
        """测试流式数据处理"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:157:80: E501 line too long (80 > 79 characters)
        response_stream = realtime_stub.StreamMarketData(generate_market_data())
                                                                               ^
src/gpu/api_system/tests/integration/test_end_to_end.py:162:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(received) == 100
^
src/gpu/api_system/tests/integration/test_end_to_end.py:163:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert all(r.stream_id == "stream_integration_001" for r in received)
^
src/gpu/api_system/tests/integration/test_end_to_end.py:166:1: D400 First line should end with a period
        """测试特征计算流水线"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:177:80: E501 line too long (87 > 79 characters)
        response.features = {"sma_20": 10.5, "sma_50": 10.3, "rsi": 65.2, "macd": 0.15}
                                                                               ^
src/gpu/api_system/tests/integration/test_end_to_end.py:183:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(result.features) == 4
^
src/gpu/api_system/tests/integration/test_end_to_end.py:184:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "sma_20" in result.features
^
src/gpu/api_system/tests/integration/test_end_to_end.py:188:1: D400 First line should end with a period
    """ML训练端到端测试"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:192:1: D400 First line should end with a period
        """创建ML服务stub"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:197:1: D400 First line should end with a period
        """测试完整的ML工作流"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:231:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert status.status == "COMPLETED"
^
src/gpu/api_system/tests/integration/test_end_to_end.py:238:80: E501 line too long (81 > 79 characters)
            {"price": [11.5], "volume": [1400000], "sma_20": [10.7], "rsi": [65]}
                                                                               ^
src/gpu/api_system/tests/integration/test_end_to_end.py:249:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(predict_result.predictions) > 0
^
src/gpu/api_system/tests/integration/test_end_to_end.py:263:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert metrics.accuracy > 0.8
^
src/gpu/api_system/tests/integration/test_end_to_end.py:267:1: D400 First line should end with a period
    """跨服务集成测试"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:270:1: D400 First line should end with a period
        """测试实时数据到ML训练的流水线"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:276:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert True
^
src/gpu/api_system/tests/integration/test_end_to_end.py:279:1: D400 First line should end with a period
        """测试ML模型到回测验证的流水线"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:285:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert True
^
src/gpu/api_system/tests/integration/test_end_to_end.py:288:1: D400 First line should end with a period
        """测试完整交易系统工作流"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:296:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert True
^
src/gpu/api_system/tests/integration/test_end_to_end.py:300:1: D400 First line should end with a period
    """服务弹性测试"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:303:1: D400 First line should end with a period
        """测试GPU故障时的CPU降级"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:304:62: N806 variable 'MockManager' in function should be lowercase
        with patch("utils.gpu_utils.GPUResourceManager") as MockManager:
                                                             ^
src/gpu/api_system/tests/integration/test_end_to_end.py:312:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert use_cpu is True
^
src/gpu/api_system/tests/integration/test_end_to_end.py:315:1: D400 First line should end with a period
        """测试服务失败重试"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:318:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/integration/test_end_to_end.py:332:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
                    assert result.status == "SUBMITTED"
^
src/gpu/api_system/tests/integration/test_end_to_end.py:340:1: D400 First line should end with a period
        """测试超时处理"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:343:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/integration/test_end_to_end.py:347:80: E501 line too long (87 > 79 characters)
            service.IntegratedBacktest.side_effect = grpc.RpcError("Deadline exceeded")
                                                                               ^
src/gpu/api_system/tests/integration/test_end_to_end.py:353:1: D400 First line should end with a period
        """测试连接池管理"""
^
src/gpu/api_system/tests/integration/test_end_to_end.py:358:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(15):
            ^
src/gpu/api_system/tests/integration/test_end_to_end.py:364:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(active_connections) == max_connections
^
src/gpu/api_system/tests/performance/test_performance.py:1:1: D205 1 blank line required between summary line and description
"""
性能测试
测试GPU加速性能、吞吐量和延迟
"""
^
src/gpu/api_system/tests/performance/test_performance.py:1:1: D400 First line should end with a period
"""
性能测试
测试GPU加速性能、吞吐量和延迟
"""
^
src/gpu/api_system/tests/performance/test_performance.py:14:1: D400 First line should end with a period
    """回测性能测试"""
^
src/gpu/api_system/tests/performance/test_performance.py:16:80: E501 line too long (86 > 79 characters)
    def test_gpu_vs_cpu_performance(self, sample_market_data, sample_strategy_config):
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:17:1: D400 First line should end with a period
        """测试GPU vs CPU性能对比"""
^
src/gpu/api_system/tests/performance/test_performance.py:19:75: N806 variable 'MockGPUEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockGPUEngine:
                                                                          ^
src/gpu/api_system/tests/performance/test_performance.py:19:80: E501 line too long (87 > 79 characters)
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockGPUEngine:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:34:75: N806 variable 'MockCPUEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.BacktestEngineCPU") as MockCPUEngine:
                                                                          ^
src/gpu/api_system/tests/performance/test_performance.py:34:80: E501 line too long (87 > 79 characters)
        with patch("utils.gpu_acceleration_engine.BacktestEngineCPU") as MockCPUEngine:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:52:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert speedup >= 10, f"Expected speedup >= 10x, got {speedup:.2f}x"
^
src/gpu/api_system/tests/performance/test_performance.py:55:1: D400 First line should end with a period
        """测试回测吞吐量"""
^
src/gpu/api_system/tests/performance/test_performance.py:59:75: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                          ^
src/gpu/api_system/tests/performance/test_performance.py:59:80: E501 line too long (84 > 79 characters)
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:62:17: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
            for i in range(n_backtests):
                ^
src/gpu/api_system/tests/performance/test_performance.py:74:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert throughput >= 0.3, f"Throughput too low: {throughput:.2f} backtests/sec"
^
src/gpu/api_system/tests/performance/test_performance.py:74:80: E501 line too long (87 > 79 characters)
        assert throughput >= 0.3, f"Throughput too low: {throughput:.2f} backtests/sec"
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:77:1: D400 First line should end with a period
        """测试并发回测性能"""
^
src/gpu/api_system/tests/performance/test_performance.py:84:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(max_concurrent):
            ^
src/gpu/api_system/tests/performance/test_performance.py:96:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert duration < 60, f"Concurrent execution too slow: {duration:.2f}s"
^
src/gpu/api_system/tests/performance/test_performance.py:100:1: D400 First line should end with a period
        """测试回测延迟百分位数"""
^
src/gpu/api_system/tests/performance/test_performance.py:104:75: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                          ^
src/gpu/api_system/tests/performance/test_performance.py:104:80: E501 line too long (84 > 79 characters)
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:122:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert p50 < 5000, f"P50 latency too high: {p50:.2f}ms"
^
src/gpu/api_system/tests/performance/test_performance.py:123:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert p95 < 10000, f"P95 latency too high: {p95:.2f}ms"
^
src/gpu/api_system/tests/performance/test_performance.py:124:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert p99 < 15000, f"P99 latency too high: {p99:.2f}ms"
^
src/gpu/api_system/tests/performance/test_performance.py:128:1: D400 First line should end with a period
    """实时处理性能测试"""
^
src/gpu/api_system/tests/performance/test_performance.py:131:1: D400 First line should end with a period
        """测试流式处理吞吐量"""
^
src/gpu/api_system/tests/performance/test_performance.py:137:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/performance/test_performance.py:143:17: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
            for i in range(n_messages):
                ^
src/gpu/api_system/tests/performance/test_performance.py:149:80: E501 line too long (83 > 79 characters)
        actual_throughput = n_messages / duration if duration > 0 else float("inf")
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:152:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert (
^
src/gpu/api_system/tests/performance/test_performance.py:154:80: E501 line too long (100 > 79 characters)
        ), f"Throughput too low: {actual_throughput:.0f} messages/sec (target: {target_throughput})"
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:157:1: D400 First line should end with a period
        """测试特征计算延迟"""
^
src/gpu/api_system/tests/performance/test_performance.py:161:79: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.FeatureCalculationGPU") as MockEngine:
                                                                              ^
src/gpu/api_system/tests/performance/test_performance.py:161:80: E501 line too long (88 > 79 characters)
        with patch("utils.gpu_acceleration_engine.FeatureCalculationGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:174:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert avg_latency < 50, f"Feature calculation too slow: {avg_latency:.2f}ms"
^
src/gpu/api_system/tests/performance/test_performance.py:174:80: E501 line too long (85 > 79 characters)
        assert avg_latency < 50, f"Feature calculation too slow: {avg_latency:.2f}ms"
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:177:1: D400 First line should end with a period
        """测试批量处理效率"""
^
src/gpu/api_system/tests/performance/test_performance.py:181:79: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.FeatureCalculationGPU") as MockEngine:
                                                                              ^
src/gpu/api_system/tests/performance/test_performance.py:181:80: E501 line too long (88 > 79 characters)
        with patch("utils.gpu_acceleration_engine.FeatureCalculationGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:190:80: E501 line too long (84 > 79 characters)
                throughput = batch_size / duration if duration > 0 else float("inf")
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:194:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert throughputs[-1] > throughputs[0], "Batch processing not scaling properly"
^
src/gpu/api_system/tests/performance/test_performance.py:194:80: E501 line too long (88 > 79 characters)
        assert throughputs[-1] > throughputs[0], "Batch processing not scaling properly"
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:198:1: D400 First line should end with a period
    """ML训练性能测试"""
^
src/gpu/api_system/tests/performance/test_performance.py:201:1: D400 First line should end with a period
        """测试训练加速比"""
^
src/gpu/api_system/tests/performance/test_performance.py:202:10: N806 variable 'X' in function should be lowercase
        X = sample_ml_training_data[["price", "volume", "sma_20", "rsi"]]
         ^
src/gpu/api_system/tests/performance/test_performance.py:206:71: N806 variable 'MockGPU' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.MLTrainingGPU") as MockGPU:
                                                                      ^
src/gpu/api_system/tests/performance/test_performance.py:209:13: F841 local variable 'start_gpu' is assigned to but never used
            start_gpu = time.time()
            ^
src/gpu/api_system/tests/performance/test_performance.py:210:80: E501 line too long (83 > 79 characters)
            gpu_trainer.train_model.return_value = (Mock(), {"training_time": 8.0})
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:211:80: E501 line too long (87 > 79 characters)
            model_gpu, metrics_gpu = gpu_trainer.train_model(X, y, "random_forest", {})
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:215:71: N806 variable 'MockCPU' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.MLTrainingCPU") as MockCPU:
                                                                      ^
src/gpu/api_system/tests/performance/test_performance.py:218:13: F841 local variable 'start_cpu' is assigned to but never used
            start_cpu = time.time()
            ^
src/gpu/api_system/tests/performance/test_performance.py:219:80: E501 line too long (85 > 79 characters)
            cpu_trainer.train_model.return_value = (Mock(), {"training_time": 120.0})
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:220:80: E501 line too long (87 > 79 characters)
            model_cpu, metrics_cpu = cpu_trainer.train_model(X, y, "random_forest", {})
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:227:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert speedup >= 10, f"Training speedup insufficient: {speedup:.2f}x"
^
src/gpu/api_system/tests/performance/test_performance.py:230:1: D400 First line should end with a period
        """测试预测吞吐量"""
^
src/gpu/api_system/tests/performance/test_performance.py:234:71: N806 variable 'MockGPU' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.MLTrainingGPU") as MockGPU:
                                                                      ^
src/gpu/api_system/tests/performance/test_performance.py:245:80: E501 line too long (86 > 79 characters)
        actual_throughput = n_predictions / duration if duration > 0 else float("inf")
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:248:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert (
^
src/gpu/api_system/tests/performance/test_performance.py:250:80: E501 line too long (84 > 79 characters)
        ), f"Prediction throughput too low: {actual_throughput:.0f} predictions/sec"
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:253:1: D400 First line should end with a period
        """测试模型加载时间"""
^
src/gpu/api_system/tests/performance/test_performance.py:257:78: N806 variable 'MockService' in function should be lowercase
        with patch("services.integrated_ml_service.IntegratedMLService") as MockService:
                                                                             ^
src/gpu/api_system/tests/performance/test_performance.py:257:80: E501 line too long (88 > 79 characters)
        with patch("services.integrated_ml_service.IntegratedMLService") as MockService:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:270:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert avg_load_time < 100, f"Model loading too slow: {avg_load_time:.2f}ms"
^
src/gpu/api_system/tests/performance/test_performance.py:270:80: E501 line too long (84 > 79 characters)
        assert avg_load_time < 100, f"Model loading too slow: {avg_load_time:.2f}ms"
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:274:1: D400 First line should end with a period
    """缓存性能测试"""
^
src/gpu/api_system/tests/performance/test_performance.py:277:1: D400 First line should end with a period
        """测试缓存命中率"""
^
src/gpu/api_system/tests/performance/test_performance.py:281:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/performance/test_performance.py:300:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert hit_rate >= 0.8, f"Cache hit rate too low: {hit_rate:.2%}"
^
src/gpu/api_system/tests/performance/test_performance.py:303:1: D400 First line should end with a period
        """测试缓存访问延迟"""
^
src/gpu/api_system/tests/performance/test_performance.py:307:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/performance/test_performance.py:320:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert avg_l1 < 1, f"L1 cache too slow: {avg_l1:.2f}ms"
^
src/gpu/api_system/tests/performance/test_performance.py:324:1: D400 First line should end with a period
    """资源利用率测试"""
^
src/gpu/api_system/tests/performance/test_performance.py:327:1: D400 First line should end with a period
        """测试GPU利用率"""
^
src/gpu/api_system/tests/performance/test_performance.py:328:65: N806 variable 'MockMonitor' in function should be lowercase
        with patch("utils.gpu_utils.GPUUtilizationMonitor") as MockMonitor:
                                                                ^
src/gpu/api_system/tests/performance/test_performance.py:340:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert (
^
src/gpu/api_system/tests/performance/test_performance.py:345:1: D400 First line should end with a period
        """测试内存效率"""
^
src/gpu/api_system/tests/performance/test_performance.py:346:65: N806 variable 'MockMonitor' in function should be lowercase
        with patch("utils.gpu_utils.GPUUtilizationMonitor") as MockMonitor:
                                                                ^
src/gpu/api_system/tests/performance/test_performance.py:358:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert (
^
src/gpu/api_system/tests/performance/test_performance.py:363:1: D400 First line should end with a period
        """测试并发任务上限"""
^
src/gpu/api_system/tests/performance/test_performance.py:366:70: N806 variable 'MockScheduler' in function should be lowercase
        with patch("utils.resource_scheduler.ResourceScheduler") as MockScheduler:
                                                                     ^
src/gpu/api_system/tests/performance/test_performance.py:366:80: E501 line too long (82 > 79 characters)
        with patch("utils.resource_scheduler.ResourceScheduler") as MockScheduler:
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:379:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert (
^
src/gpu/api_system/tests/performance/test_performance.py:385:1: D400 First line should end with a period
    """压力测试"""
^
src/gpu/api_system/tests/performance/test_performance.py:389:1: D400 First line should end with a period
        """测试持续负载"""
^
src/gpu/api_system/tests/performance/test_performance.py:395:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/performance/test_performance.py:403:80: E501 line too long (86 > 79 characters)
                    service.IntegratedBacktest.return_value = Mock(status="SUBMITTED")
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:412:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert success_rate > 0.95, f"Success rate too low: {success_rate:.2%}"
^
src/gpu/api_system/tests/performance/test_performance.py:416:1: D400 First line should end with a period
        """测试峰值负载处理"""
^
src/gpu/api_system/tests/performance/test_performance.py:421:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/performance/test_performance.py:428:80: E501 line too long (82 > 79 characters)
                service.IntegratedBacktest.return_value = Mock(status="SUBMITTED")
                                                                               ^
src/gpu/api_system/tests/performance/test_performance.py:434:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert duration < 30, f"Peak load handling too slow: {duration:.2f}s"
^
src/gpu/api_system/tests/test_real_gpu.py:2:1: D205 1 blank line required between summary line and description
"""
真实GPU测试示例
演示如何使用真实GPU而不是Mock进行测试
"""
^
src/gpu/api_system/tests/test_real_gpu.py:2:1: D400 First line should end with a period
"""
真实GPU测试示例
演示如何使用真实GPU而不是Mock进行测试
"""
^
src/gpu/api_system/tests/test_real_gpu.py:17:80: E501 line too long (83 > 79 characters)
    sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/gpu/api_system/tests/test_real_gpu.py:28:1: D400 First line should end with a period
    """真实GPU加速测试"""
^
src/gpu/api_system/tests/test_real_gpu.py:32:1: D400 First line should end with a period
        """测试真实GPU DataFrame操作"""
^
src/gpu/api_system/tests/test_real_gpu.py:54:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(cpu_result) == len(gpu_result)
^
src/gpu/api_system/tests/test_real_gpu.py:58:15: F541 f-string is missing placeholders
        print(f"\n真实GPU DataFrame操作测试结果:")
              ^
src/gpu/api_system/tests/test_real_gpu.py:65:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_time > 0, "GPU处理失败"
^
src/gpu/api_system/tests/test_real_gpu.py:69:1: D400 First line should end with a period
        """测试真实GPU机器学习训练"""
^
src/gpu/api_system/tests/test_real_gpu.py:77:10: N806 variable 'X' in function should be lowercase
        X, y = make_classification(
         ^
src/gpu/api_system/tests/test_real_gpu.py:88:10: N806 variable 'X_gpu' in function should be lowercase
        X_gpu = cudf.DataFrame(X)
         ^
src/gpu/api_system/tests/test_real_gpu.py:97:15: F541 f-string is missing placeholders
        print(f"\n真实GPU ML训练测试结果:")
              ^
src/gpu/api_system/tests/test_real_gpu.py:105:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert speedup > 5.0, f"GPU ML训练加速比不足: {speedup:.2f}x"
^
src/gpu/api_system/tests/test_real_gpu.py:110:1: D400 First line should end with a period
        """测试真实GPU内存使用"""
^
src/gpu/api_system/tests/test_real_gpu.py:116:9: F841 local variable 'initial_used' is assigned to but never used
        initial_used = mempool.used_bytes()
        ^
src/gpu/api_system/tests/test_real_gpu.py:129:15: F541 f-string is missing placeholders
        print(f"\n真实GPU内存测试结果:")
              ^
src/gpu/api_system/tests/test_real_gpu.py:137:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_array.shape[0] == n_elements, "GPU数组创建失败"
^
src/gpu/api_system/tests/test_real_gpu.py:138:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result > 0, "GPU计算结果异常"
^
src/gpu/api_system/tests/test_real_gpu.py:146:1: D400 First line should end with a period
        """测试真实GPU回测性能"""
^
src/gpu/api_system/tests/test_real_gpu.py:195:80: E501 line too long (84 > 79 characters)
        gpu_df["price_mean"] = gpu_df.groupby("stock_id")["close"].transform("mean")
                                                                               ^
src/gpu/api_system/tests/test_real_gpu.py:196:80: E501 line too long (84 > 79 characters)
        gpu_df["volume_sum"] = gpu_df.groupby("stock_id")["volume"].transform("sum")
                                                                               ^
src/gpu/api_system/tests/test_real_gpu.py:197:80: E501 line too long (83 > 79 characters)
        gpu_df["signal"] = (gpu_df["close"] > gpu_df["price_mean"]).astype("int32")
                                                                               ^
src/gpu/api_system/tests/test_real_gpu.py:203:15: F541 f-string is missing placeholders
        print(f"\n真实GPU回测测试结果:")
              ^
src/gpu/api_system/tests/test_real_gpu.py:210:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_time > 0, "GPU处理失败"
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:1:1: D205 1 blank line required between summary line and description
"""
缓存优化系统单元测试
测试三级缓存系统的功能
"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:1:1: D400 First line should end with a period
"""
缓存优化系统单元测试
测试三级缓存系统的功能
"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:12:1: D400 First line should end with a period
    """缓存管理器测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:16:1: D400 First line should end with a period
        """创建缓存管理器实例"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:17:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:24:1: D400 First line should end with a period
        """测试缓存初始化"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:25:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert cache_manager is not None
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:26:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert hasattr(cache_manager, "l1_cache")
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:27:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert hasattr(cache_manager, "l2_cache")
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:30:1: D400 First line should end with a period
        """测试缓存设置和获取"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:37:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:42:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert cached_value == value
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:45:1: D400 First line should end with a period
        """测试缓存过期"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:57:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result == value
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:63:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is None
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:66:1: D400 First line should end with a period
        """测试缓存删除"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:77:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:82:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert cached is None
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:85:1: D400 First line should end with a period
        """测试清空缓存"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:95:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:99:1: D400 First line should end with a period
    """L1内存缓存测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:103:1: D400 First line should end with a period
        """创建L1缓存实例"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:104:60: N806 variable 'MockL1' in function should be lowercase
        with patch("utils.cache_optimization.L1Cache") as MockL1:
                                                           ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:110:1: D400 First line should end with a period
        """测试L1缓存设置和获取"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:119:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result == value
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:122:1: D400 First line should end with a period
        """测试L1缓存大小限制"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:132:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert l1_cache.size() <= max_size
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:135:1: D400 First line should end with a period
        """测试L1缓存LRU淘汰"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:149:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is None
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:153:1: D400 First line should end with a period
    """L2本地缓存测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:157:1: D400 First line should end with a period
        """创建L2缓存实例"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:158:60: N806 variable 'MockL2' in function should be lowercase
        with patch("utils.cache_optimization.L2Cache") as MockL2:
                                                           ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:159:1: S108 Probable insecure usage of temp file/directory.
            cache = MockL2(cache_dir="/tmp/gpu_api_cache", ttl=300)
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:163:1: D400 First line should end with a period
        """测试L2缓存持久化"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:174:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result == value
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:177:1: D400 First line should end with a period
        """测试L2缓存文件操作"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:184:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:188:1: D400 First line should end with a period
    """Redis缓存测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:192:1: D400 First line should end with a period
        """创建Redis缓存实例"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:196:63: N806 variable 'MockRedis' in function should be lowercase
        with patch("utils.cache_optimization.RedisCache") as MockRedis:
                                                              ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:201:1: D400 First line should end with a period
        """测试Redis连接"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:203:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert redis_cache.ping() is True
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:206:1: D400 First line should end with a period
        """测试Redis设置和获取"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:213:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:218:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert cached == value
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:221:1: D400 First line should end with a period
        """测试Redis哈希操作"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:223:80: E501 line too long (83 > 79 characters)
        hash_data = {"name": "Test User", "email": "test@example.com", "age": "30"}
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:233:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result == hash_data
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:236:1: D400 First line should end with a period
        """测试Redis列表操作"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:248:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result == "task1"
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:252:1: D400 First line should end with a period
    """缓存策略测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:255:1: D400 First line should end with a period
        """测试read-through策略"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:256:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:268:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result is not None
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:269:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result["value"] == "loaded_value"
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:272:1: D400 First line should end with a period
        """测试write-through策略"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:273:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:287:1: D400 First line should end with a period
        """测试write-behind策略"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:288:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:303:1: D400 First line should end with a period
    """缓存性能测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:306:1: D400 First line should end with a period
        """测试缓存命中率"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:307:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:317:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert hit_rate >= 0.8  # 命中率应该≥80%
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:320:1: D400 First line should end with a period
        """测试缓存延迟"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:321:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:331:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert l1_latency < 1 or True  # Mock不会有真实延迟
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:334:1: D400 First line should end with a period
        """测试缓存吞吐量"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:335:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:348:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert throughput > 0
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:352:1: D400 First line should end with a period
    """缓存监控测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:355:1: D400 First line should end with a period
        """测试缓存指标收集"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:356:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:371:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result["hit_rate"] >= 0.8
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:372:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result["avg_latency_ms"] < 10
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:375:1: D400 First line should end with a period
        """测试缓存告警触发"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:376:65: N806 variable 'MockCache' in function should be lowercase
        with patch("utils.cache_optimization.CacheManager") as MockCache:
                                                                ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:385:80: E501 line too long (85 > 79 characters)
                alert = {"type": "low_hit_rate", "value": hit_rate, "threshold": 0.7}
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization.py:386:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
                assert alert["type"] == "low_hit_rate"
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:1:1: D205 1 blank line required between summary line and description
"""
增强缓存优化测试
Test Enhanced Cache Optimization

测试目标: 验证缓存命中率从80%提升到90%+
"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:1:1: D400 First line should end with a period
"""
增强缓存优化测试
Test Enhanced Cache Optimization

测试目标: 验证缓存命中率从80%提升到90%+
"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:18:80: E501 line too long (84 > 79 characters)
        os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:22:1: E402 module level import not at top of file
from src.utils.cache_optimization_enhanced import (
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:33:1: D400 First line should end with a period
    """测试访问模式学习器"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:35:1: D102 Missing docstring in public method
    def setUp(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:39:1: D400 First line should end with a period
        """测试访问记录和预测"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:56:1: D400 First line should end with a period
        """测试获取需要预加载的键"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:69:80: E501 line too long (83 > 79 characters)
        keys = self.learner.get_keys_to_preload(current_time, threshold_seconds=60)
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:77:1: D400 First line should end with a period
        """测试键关联"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:78:80: E501 line too long (82 > 79 characters)
        self.learner.record_key_correlation("daily:600000", "indicator:600000:MA")
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:79:80: E501 line too long (84 > 79 characters)
        self.learner.record_key_correlation("daily:600000", "indicator:600000:MACD")
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:88:1: D400 First line should end with a period
        """测试热点键检测"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:90:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(100):
            ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:93:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(50):
            ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:96:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(10):
            ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:106:1: D400 First line should end with a period
    """测试查询结果缓存"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:108:1: D102 Missing docstring in public method
    def setUp(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:115:1: D400 First line should end with a period
        """测试查询指纹生成"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:116:80: E501 line too long (82 > 79 characters)
        params1 = {"symbol": "600000", "start": "2024-01-01", "end": "2024-12-31"}
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:130:1: D400 First line should end with a period
        """测试缓存和检索查询结果"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:144:1: D400 First line should end with a period
        """测试部分结果缓存"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:159:1: D400 First line should end with a period
    """测试负缓存"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:161:1: D102 Missing docstring in public method
    def setUp(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:168:1: D400 First line should end with a period
        """测试标记和检查负结果"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:178:1: D400 First line should end with a period
        """测试带负缓存的获取"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:198:1: D400 First line should end with a period
    """测试自适应TTL管理器"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:200:1: D102 Missing docstring in public method
    def setUp(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:204:1: D400 First line should end with a period
        """测试自适应TTL计算"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:233:1: D400 First line should end with a period
        """测试热度分区"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:251:80: E501 line too long (86 > 79 characters)
        self.assertEqual(self.ttl_manager.get_partition("ultra_hot_key"), "ultra_hot")
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:255:1: D400 First line should end with a period
    """测试智能压缩器"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:257:1: D102 Missing docstring in public method
    def setUp(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:263:1: D400 First line should end with a period
        """测试小对象不压缩"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:272:1: D400 First line should end with a period
        """测试大对象高压缩率"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:283:1: D400 First line should end with a period
        """测试压缩解压缩循环"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:292:1: D400 First line should end with a period
        """测试压缩统计"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:306:1: D400 First line should end with a period
    """测试增强缓存管理器 - 整体性能测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:308:1: D102 Missing docstring in public method
    def setUp(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:312:1: D102 Missing docstring in public method
    def tearDown(self):
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:316:1: D400 First line should end with a period
        """测试基本获取和设置"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:330:1: D400 First line should end with a period
        """测试查询结果缓存"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:344:1: D400 First line should end with a period
        """测试自适应TTL与访问模式"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:360:80: E501 line too long (80 > 79 characters)
        adaptive_ttl = self.cache_manager.ttl_manager.get_adaptive_ttl(key, 100)
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:364:1: D400 First line should end with a period
        """测试缓存命中率提升 - 核心性能测试"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:375:1: D400 First line should end with a period
            """模拟从数据源获取"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:384:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            access_pattern.append(random.choice(hot_keys))
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:389:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            access_pattern.append(random.choice(warm_keys))
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:394:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            access_pattern.append(random.choice(cold_keys))
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:424:15: F541 f-string is missing placeholders
        print(f"\n缓存性能:")
              ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:432:15: F541 f-string is missing placeholders
        print(f"\n优化统计:")
              ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:437:80: E501 line too long (83 > 79 characters)
            f"  估算命中率: {stats['optimization_estimate']['estimated_hit_rate']:.2f}%"
                                                                               ^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:452:1: D400 First line should end with a period
        """测试预热效果"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:469:1: D400 First line should end with a period
        """测试综合统计"""
^
src/gpu/api_system/tests/unit/test_cache/test_cache_optimization_enhanced.py:490:80: E501 line too long (85 > 79 characters)
        self.assertGreater(estimate["estimated_hit_rate"], estimate["base_hit_rate"])
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:1:1: D205 1 blank line required between summary line and description
"""
GPU加速引擎单元测试
测试GPU加速引擎的核心功能
"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:1:1: D400 First line should end with a period
"""
GPU加速引擎单元测试
测试GPU加速引擎的核心功能
"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:13:1: D400 First line should end with a period
    """回测引擎GPU加速测试"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:17:1: D400 First line should end with a period
        """创建回测引擎实例"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:19:75: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                          ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:19:80: E501 line too long (84 > 79 characters)
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:24:1: D400 First line should end with a period
        """测试引擎初始化"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:25:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert engine is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:31:1: D400 First line should end with a period
        """测试GPU回测执行"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:48:80: E501 line too long (80 > 79 characters)
        result = engine.run_backtest(sample_market_data, sample_strategy_config)
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:51:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:52:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "total_return" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:53:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "sharpe_ratio" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:54:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result["total_return"] == 0.25
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:56:80: E501 line too long (84 > 79 characters)
    def test_cpu_fallback(self, engine, sample_market_data, sample_strategy_config):
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:57:1: D400 First line should end with a period
        """测试CPU降级功能"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:65:1: D400 First line should end with a period
        """测试性能提升（仅在GPU可用时）"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:75:1: D400 First line should end with a period
    """ML训练GPU加速测试"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:79:1: D400 First line should end with a period
        """创建ML训练引擎实例"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:80:71: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.MLTrainingGPU") as MockEngine:
                                                                      ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:80:80: E501 line too long (80 > 79 characters)
        with patch("utils.gpu_acceleration_engine.MLTrainingGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:85:1: D400 First line should end with a period
        """测试GPU随机森林训练"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:86:10: N806 variable 'X' in function should be lowercase
        X = sample_ml_training_data[["price", "volume", "sma_20", "rsi", "macd"]]
         ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:86:80: E501 line too long (81 > 79 characters)
        X = sample_ml_training_data[["price", "volume", "sma_20", "rsi", "macd"]]
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:105:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert model is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:106:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "accuracy" in metrics
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:107:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert metrics["training_time"] < 20  # 应该比CPU快
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:109:80: E501 line too long (80 > 79 characters)
    def test_train_linear_regression_gpu(self, engine, sample_ml_training_data):
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:110:1: D400 First line should end with a period
        """测试GPU线性回归训练"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:111:10: N806 variable 'X' in function should be lowercase
        X = sample_ml_training_data[["price", "volume", "sma_20"]]
         ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:121:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert model is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:122:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "mse" in metrics
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:123:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert metrics["r2_score"] > 0.8
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:127:1: D400 First line should end with a period
    """特征计算GPU加速测试"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:131:1: D400 First line should end with a period
        """创建特征计算引擎实例"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:132:79: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.FeatureCalculationGPU") as MockEngine:
                                                                              ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:132:80: E501 line too long (88 > 79 characters)
        with patch("utils.gpu_acceleration_engine.FeatureCalculationGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:137:1: D400 First line should end with a period
        """测试SMA计算"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:143:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:144:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(result) == len(sample_market_data)
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:147:1: D400 First line should end with a period
        """测试RSI计算"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:148:80: E501 line too long (80 > 79 characters)
        mock_rsi = pd.Series(np.random.uniform(0, 100, len(sample_market_data)))
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:153:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:154:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert all(0 <= x <= 100 for x in result.dropna())
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:157:1: D400 First line should end with a period
        """测试MACD计算"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:159:80: E501 line too long (81 > 79 characters)
            "macd": pd.Series(np.random.uniform(-1, 1, len(sample_market_data))),
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:160:80: E501 line too long (83 > 79 characters)
            "signal": pd.Series(np.random.uniform(-1, 1, len(sample_market_data))),
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:169:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "macd" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:170:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "signal" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:171:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "histogram" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:174:1: D400 First line should end with a period
        """测试批量特征计算"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:178:80: E501 line too long (84 > 79 characters)
            "sma_20": pd.Series(np.random.uniform(10, 20, len(sample_market_data))),
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:179:80: E501 line too long (84 > 79 characters)
            "sma_50": pd.Series(np.random.uniform(10, 20, len(sample_market_data))),
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:180:80: E501 line too long (81 > 79 characters)
            "rsi": pd.Series(np.random.uniform(0, 100, len(sample_market_data))),
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:181:80: E501 line too long (81 > 79 characters)
            "macd": pd.Series(np.random.uniform(-1, 1, len(sample_market_data))),
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:187:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(result) == len(features)
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:189:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert feature in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:193:1: D400 First line should end with a period
    """参数优化GPU加速测试"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:197:1: D400 First line should end with a period
        """创建优化引擎实例"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:198:73: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.OptimizationGPU") as MockEngine:
                                                                        ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:198:80: E501 line too long (82 > 79 characters)
        with patch("utils.gpu_acceleration_engine.OptimizationGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:203:1: D400 First line should end with a period
        """测试网格搜索优化"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:220:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "lookback_period" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:221:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "score" in result
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:222:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result["score"] > 0
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:225:1: D400 First line should end with a period
        """测试贝叶斯优化"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:242:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:243:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result["score"] > 0
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:247:1: D400 First line should end with a period
    """GPU内存管理测试"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:250:1: D400 First line should end with a period
        """测试内存分配"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:252:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_id is not None
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:253:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert isinstance(gpu_id, int)
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:256:1: D400 First line should end with a period
        """测试内存释放"""
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:259:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_gpu/test_acceleration_engine.py:262:1: D400 First line should end with a period
        """测试内存溢出处理"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:1:1: D205 1 blank line required between summary line and description
"""
集成服务单元测试
测试回测、实时处理和ML训练三大集成服务
"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:1:1: D400 First line should end with a period
"""
集成服务单元测试
测试回测、实时处理和ML训练三大集成服务
"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:13:1: D400 First line should end with a period
    """集成回测服务测试"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:19:1: D400 First line should end with a period
        """创建回测服务实例"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:22:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:29:1: D400 First line should end with a period
        """测试提交回测任务"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:48:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.backtest_id is not None
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:49:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "SUBMITTED"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:52:1: D400 First line should end with a period
        """测试查询回测状态"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:66:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.backtest_id == "bt_12345"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:67:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "RUNNING"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:68:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert 0 <= result.progress <= 100
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:71:1: D400 First line should end with a period
        """测试获取回测结果"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:87:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "COMPLETED"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:88:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.performance_metrics.total_return > 0
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:91:1: D400 First line should end with a period
        """测试缓存命中"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:105:80: E501 line too long (80 > 79 characters)
        backtest_service.IntegratedBacktest.return_value = Mock(**cached_result)
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:109:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.from_cache is True
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:112:1: D400 First line should end with a period
        """测试GPU加速"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:125:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.execution_time < 10  # 应该很快
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:126:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.acceleration_ratio > 10  # 有明显加速
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:130:1: D400 First line should end with a period
    """集成实时处理服务测试"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:136:1: D400 First line should end with a period
        """创建实时处理服务实例"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:139:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:146:1: D202 No blank lines allowed after function docstring
        """测试流式市场数据处理"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:146:1: D400 First line should end with a period
        """测试流式市场数据处理"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:168:80: E501 line too long (80 > 79 characters)
        result_stream = realtime_service.StreamMarketData(generate_data(), None)
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:171:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(results) == 10
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:172:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert all(r.stream_id == "stream_001" for r in results)
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:175:1: D400 First line should end with a period
        """测试计算技术特征"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:182:80: E501 line too long (87 > 79 characters)
        response.features = {"sma_20": 10.5, "sma_50": 10.3, "rsi": 65.2, "macd": 0.15}
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:189:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(result.features) == 4
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:190:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.computation_time < 1.0  # GPU加速应该很快
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:193:1: D400 First line should end with a period
        """测试批量处理"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:208:80: E501 line too long (81 > 79 characters)
        result_stream = realtime_service.StreamMarketData(generate_batch(), None)
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:211:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(results) == batch_size
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:214:1: D400 First line should end with a period
        """测试并发流处理"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:220:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert active_streams < max_streams
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:223:1: D400 First line should end with a period
        """测试特征缓存"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:243:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result1.from_cache is False
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:244:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result2.from_cache is True
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:245:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result2.computation_time < result1.computation_time
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:249:1: D400 First line should end with a period
    """集成ML服务测试"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:252:80: E501 line too long (85 > 79 characters)
    def ml_service(self, mock_gpu_manager, mock_redis_queue, mock_metrics_collector):
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:253:1: D400 First line should end with a period
        """创建ML服务实例"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:254:78: N806 variable 'MockService' in function should be lowercase
        with patch("services.integrated_ml_service.IntegratedMLService") as MockService:
                                                                             ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:254:80: E501 line too long (88 > 79 characters)
        with patch("services.integrated_ml_service.IntegratedMLService") as MockService:
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:261:1: D400 First line should end with a period
        """测试模型训练"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:278:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.task_id is not None
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:279:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "SUBMITTED"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:282:1: D400 First line should end with a period
        """测试查询训练状态"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:297:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "TRAINING"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:298:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert 0 <= result.progress <= 100
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:301:1: D400 First line should end with a period
        """测试模型预测"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:305:80: E501 line too long (81 > 79 characters)
            {"price": [11.5], "volume": [1400000], "sma_20": [10.7], "rsi": [65]}
                                                                               ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:317:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(result.predictions) > 0
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:318:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.prediction_time < 0.1  # 预测应该很快
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:321:1: D400 First line should end with a period
        """测试获取模型指标"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:336:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.accuracy > 0.8
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:337:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.f1_score > 0.8
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:340:1: D400 First line should end with a period
        """测试GPU训练加速"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:353:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.training_time < 20  # GPU应该很快
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:354:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.acceleration_ratio > 10
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:357:1: D400 First line should end with a period
        """测试模型持久化"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:381:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(predict_result.predictions) > 0
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:384:1: D400 First line should end with a period
        """测试并发训练"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:390:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert count < max_concurrent
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:393:1: D400 First line should end with a period
        """测试CPU降级训练"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:408:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.status == "COMPLETED"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:409:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result.mode == "cpu"
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:413:1: D400 First line should end with a period
    """服务集成测试"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:418:1: D400 First line should end with a period
        """测试多服务工作流"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:424:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert True
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:427:1: D400 First line should end with a period
        """测试资源共享"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:437:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_id_backtest is not None
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:438:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_id_ml is not None
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:441:1: D400 First line should end with a period
        """测试错误处理"""
^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:444:15: N806 variable 'MockService' in function should be lowercase
        ) as MockService:
              ^
src/gpu/api_system/tests/unit/test_services/test_integrated_services.py:448:80: E501 line too long (87 > 79 characters)
            service.IntegratedBacktest.side_effect = grpc.RpcError("Connection failed")
                                                                               ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:1:1: D205 1 blank line required between summary line and description
"""
GPU资源管理器单元测试
测试GPU资源分配、调度和监控
"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:1:1: D400 First line should end with a period
"""
GPU资源管理器单元测试
测试GPU资源分配、调度和监控
"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:12:1: D400 First line should end with a period
    """GPU资源管理器测试"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:16:1: D400 First line should end with a period
        """创建GPU资源管理器实例"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:17:62: N806 variable 'MockManager' in function should be lowercase
        with patch("utils.gpu_utils.GPUResourceManager") as MockManager:
                                                             ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:24:1: D400 First line should end with a period
        """测试管理器初始化"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:25:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_manager is not None
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:28:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(available) > 0
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:31:1: D400 First line should end with a period
        """测试GPU分配"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:38:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_id is not None
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:39:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert isinstance(gpu_id, int)
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:40:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_id >= 0
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:43:1: D400 First line should end with a period
        """测试GPU释放"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:48:9: F841 local variable 'gpu_id' is assigned to but never used
        gpu_id = gpu_manager.allocate_gpu(task_id, 1)
        ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:54:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:57:1: D400 First line should end with a period
        """测试GPU不可用情况"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:62:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_id is None
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:65:1: D400 First line should end with a period
        """测试优先级调度"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:75:9: F841 local variable 'gpu_low' is assigned to but never used
        gpu_low = gpu_manager.allocate_gpu(low_priority_task, priority=2)
        ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:78:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert gpu_high is not None
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:82:1: D400 First line should end with a period
    """GPU利用率监控测试"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:86:1: D400 First line should end with a period
        """创建监控器实例"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:87:65: N806 variable 'MockMonitor' in function should be lowercase
        with patch("utils.gpu_utils.GPUUtilizationMonitor") as MockMonitor:
                                                                ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:92:1: D400 First line should end with a period
        """测试获取GPU利用率"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:103:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "utilization" in stats
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:104:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert 0 <= stats["utilization"] <= 100
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:105:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert stats["memory_used"] <= stats["memory_total"]
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:108:1: D400 First line should end with a period
        """测试获取所有GPU状态"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:121:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert isinstance(all_stats, list)
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:122:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert len(all_stats) > 0
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:125:1: D400 First line should end with a period
        """测试高利用率告警"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:128:80: E501 line too long (81 > 79 characters)
        monitor.get_utilization.return_value = {"gpu_id": 0, "utilization": 98.5}
                                                                               ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:139:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert alert["type"] == "high_utilization"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:142:1: D400 First line should end with a period
        """测试内存使用跟踪"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:151:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "used_mb" in memory
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:152:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "total_mb" in memory
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:153:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert memory["used_mb"] <= memory["total_mb"]
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:157:1: D400 First line should end with a period
    """GPU任务队列测试"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:161:1: D400 First line should end with a period
        """创建任务队列实例"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:162:56: N806 variable 'MockQueue' in function should be lowercase
        with patch("utils.gpu_utils.GPUTaskQueue") as MockQueue:
                                                       ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:168:1: D400 First line should end with a period
        """测试任务入队"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:179:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result is True
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:182:1: D400 First line should end with a period
        """测试任务出队"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:192:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert dequeued is not None
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:193:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert dequeued["task_id"] == "task_002"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:196:1: D400 First line should end with a period
        """测试优先级队列排序"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:210:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert first["priority"] == 0
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:213:1: D400 First line should end with a period
        """测试队列大小限制"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:219:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert task_queue.size() < max_size
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:220:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert not task_queue.is_full()
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:223:1: D400 First line should end with a period
        """测试空队列"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:225:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert task_queue.is_empty()
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:229:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert task is None
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:233:1: D400 First line should end with a period
    """资源调度器测试"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:237:1: D400 First line should end with a period
        """创建调度器实例"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:238:70: N806 variable 'MockScheduler' in function should be lowercase
        with patch("utils.resource_scheduler.ResourceScheduler") as MockScheduler:
                                                                     ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:238:80: E501 line too long (82 > 79 characters)
        with patch("utils.resource_scheduler.ResourceScheduler") as MockScheduler:
                                                                               ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:243:1: D400 First line should end with a period
        """测试任务调度"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:259:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert result["status"] == "scheduled"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:260:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "gpu_id" in result
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:263:1: D400 First line should end with a period
        """测试并发任务限制"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:269:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert current_count < max_concurrent
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:272:1: D400 First line should end with a period
        """测试公平调度"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:285:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result["status"] == "scheduled"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:288:1: D400 First line should end with a period
        """测试资源抢占"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:290:80: E501 line too long (87 > 79 characters)
        low_priority_task = {"task_id": "low_task", "priority": 2, "preemptible": True}
                                                                               ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:305:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert can_preempt is True
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:309:1: D400 First line should end with a period
    """GPU健康监控测试"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:313:1: D400 First line should end with a period
        """创建健康监控器实例"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:314:60: N806 variable 'MockMonitor' in function should be lowercase
        with patch("utils.gpu_utils.GPUHealthMonitor") as MockMonitor:
                                                           ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:319:1: D400 First line should end with a period
        """测试GPU健康检查"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:330:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert health["status"] == "healthy"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:331:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert health["temperature"] < 85  # 安全温度
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:334:1: D400 First line should end with a period
        """测试温度告警"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:345:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert health["status"] == "warning"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:348:1: D400 First line should end with a period
        """测试GPU故障检测"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:356:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert health["status"] == "failed"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:357:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert "error" in health
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:360:1: D400 First line should end with a period
        """测试自动恢复"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:372:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
        assert recovery["status"] == "recovered"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:376:1: D400 First line should end with a period
    """CPU降级测试"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:379:1: D400 First line should end with a period
        """测试GPU不可用时降级到CPU"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:380:62: N806 variable 'MockManager' in function should be lowercase
        with patch("utils.gpu_utils.GPUResourceManager") as MockManager:
                                                             ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:387:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
                assert use_cpu is True
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:390:1: D400 First line should end with a period
        """测试降级性能"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:392:75: N806 variable 'MockEngine' in function should be lowercase
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                          ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:392:80: E501 line too long (84 > 79 characters)
        with patch("utils.gpu_acceleration_engine.BacktestEngineGPU") as MockEngine:
                                                                               ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:404:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result["mode"] == "cpu"
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:405:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert result["execution_time"] > 0
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:408:1: D400 First line should end with a period
        """测试自动降级切换"""
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:409:62: N806 variable 'MockManager' in function should be lowercase
        with patch("utils.gpu_utils.GPUResourceManager") as MockManager:
                                                             ^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:414:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert manager.is_gpu_available()
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:418:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert not manager.is_gpu_available()
^
src/gpu/api_system/tests/unit/test_utils/test_gpu_resource_manager.py:423:1: S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
            assert fallback is True
^
src/gpu/api_system/utils/cache_optimization.py:1:1: D205 1 blank line required between summary line and description
"""
缓存优化组件
Cache Optimization Component
"""
^
src/gpu/api_system/utils/cache_optimization.py:1:1: D400 First line should end with a period
"""
缓存优化组件
Cache Optimization Component
"""
^
src/gpu/api_system/utils/cache_optimization.py:13:1: S403 Consider possible security implications associated with pickle module.
import pickle
^
src/gpu/api_system/utils/cache_optimization.py:23:1: D400 First line should end with a period
    """缓存指标"""
^
src/gpu/api_system/utils/cache_optimization.py:33:1: D400 First line should end with a period
        """计算命中率"""
^
src/gpu/api_system/utils/cache_optimization.py:40:1: D400 First line should end with a period
    """缓存条目"""
^
src/gpu/api_system/utils/cache_optimization.py:53:1: D400 First line should end with a period
        """检查是否过期"""
^
src/gpu/api_system/utils/cache_optimization.py:59:1: D400 First line should end with a period
        """检查是否应该淘汰"""
^
src/gpu/api_system/utils/cache_optimization.py:64:1: D400 First line should end with a period
    """缓存层基类"""
^
src/gpu/api_system/utils/cache_optimization.py:66:1: D107 Missing docstring in __init__
    def __init__(self, name: str, max_size: int = 1000, ttl: int = 300):
^
src/gpu/api_system/utils/cache_optimization.py:76:1: D400 First line should end with a period
        """获取缓存值"""
^
src/gpu/api_system/utils/cache_optimization.py:107:1: D400 First line should end with a period
        """设置缓存值"""
^
src/gpu/api_system/utils/cache_optimization.py:136:1: D400 First line should end with a period
        """删除缓存值"""
^
src/gpu/api_system/utils/cache_optimization.py:146:1: D400 First line should end with a period
        """清空缓存"""
^
src/gpu/api_system/utils/cache_optimization.py:152:1: D400 First line should end with a period
        """获取缓存统计信息"""
^
src/gpu/api_system/utils/cache_optimization.py:169:1: D400 First line should end with a period
        """检查内存限制"""
^
src/gpu/api_system/utils/cache_optimization.py:173:1: D400 First line should end with a period
        """淘汰过期条目"""
^
src/gpu/api_system/utils/cache_optimization.py:185:1: D400 First line should end with a period
        """淘汰最少使用的条目"""
^
src/gpu/api_system/utils/cache_optimization.py:190:80: E501 line too long (83 > 79 characters)
        lru_key = min(self.cache.keys(), key=lambda k: self.cache[k].last_accessed)
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:199:1: D400 First line should end with a period
        """获取热点键"""
^
src/gpu/api_system/utils/cache_optimization.py:210:1: D400 First line should end with a period
    """多级缓存系统"""
^
src/gpu/api_system/utils/cache_optimization.py:212:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/utils/cache_optimization.py:241:80: E501 line too long (80 > 79 characters)
    def initialize(self, redis_host: str = "localhost", redis_port: int = 6379):
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:242:1: D400 First line should end with a period
        """初始化缓存系统"""
^
src/gpu/api_system/utils/cache_optimization.py:260:1: D400 First line should end with a period
        """启动后台任务"""
^
src/gpu/api_system/utils/cache_optimization.py:262:80: E501 line too long (86 > 79 characters)
        self.cleanup_thread = threading.Thread(target=self._cleanup_loop, daemon=True)
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:267:1: D400 First line should end with a period
        """停止后台任务"""
^
src/gpu/api_system/utils/cache_optimization.py:274:1: D400 First line should end with a period
        """多级缓存获取"""
^
src/gpu/api_system/utils/cache_optimization.py:294:80: E501 line too long (85 > 79 characters)
                redis_value = self.redis_client.get(f"{self.redis_cache_name}:{key}")
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:310:1: D400 First line should end with a period
        """多级缓存设置"""
^
src/gpu/api_system/utils/cache_optimization.py:332:1: D400 First line should end with a period
        """删除缓存"""
^
src/gpu/api_system/utils/cache_optimization.py:344:1: D400 First line should end with a period
        """清空所有缓存"""
^
src/gpu/api_system/utils/cache_optimization.py:358:1: D400 First line should end with a period
        """生成复合键"""
^
src/gpu/api_system/utils/cache_optimization.py:360:1: S324 Use of weak MD5 hash for security. Consider usedforsecurity=False
        return hashlib.md5(key_str.encode()).hexdigest()
^
src/gpu/api_system/utils/cache_optimization.py:363:1: D400 First line should end with a period
        """批量获取"""
^
src/gpu/api_system/utils/cache_optimization.py:374:1: D400 First line should end with a period
        """批量设置"""
^
src/gpu/api_system/utils/cache_optimization.py:379:1: D400 First line should end with a period
        """获取缓存统计信息"""
^
src/gpu/api_system/utils/cache_optimization.py:383:80: E501 line too long (80 > 79 characters)
            "redis_cache": "connected" if self.redis_client else "disconnected",
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:390:80: E501 line too long (86 > 79 characters)
        total_hits = self.l1_cache.metrics.hit_count + self.l2_cache.metrics.hit_count
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:400:1: D400 First line should end with a period
        """清理循环"""
^
src/gpu/api_system/utils/cache_optimization.py:420:1: D400 First line should end with a period
        """预热缓存"""
^
src/gpu/api_system/utils/cache_optimization.py:434:1: D400 First line should end with a period
        """优化缓存性能"""
^
src/gpu/api_system/utils/cache_optimization.py:445:80: E501 line too long (81 > 79 characters)
            optimization_report["actions_taken"].append("Increase L1 cache size")
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:461:80: E501 line too long (84 > 79 characters)
            optimization_report["actions_taken"].append("Reduce cache memory usage")
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:470:1: D400 First line should end with a period
    """缓存管理器"""
^
src/gpu/api_system/utils/cache_optimization.py:472:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/utils/cache_optimization.py:484:1: D400 First line should end with a period
        """设置默认缓存策略"""
^
src/gpu/api_system/utils/cache_optimization.py:508:80: E501 line too long (80 > 79 characters)
    def initialize(self, redis_host: str = "localhost", redis_port: int = 6379):
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:509:1: D400 First line should end with a period
        """初始化缓存管理器"""
^
src/gpu/api_system/utils/cache_optimization.py:515:1: D400 First line should end with a period
        """获取数据"""
^
src/gpu/api_system/utils/cache_optimization.py:527:80: E501 line too long (81 > 79 characters)
    def set_data(self, key: str, value: Any, data_type: str = "general") -> bool:
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:528:1: D400 First line should end with a period
        """设置数据"""
^
src/gpu/api_system/utils/cache_optimization.py:544:1: D400 First line should end with a period
        """读穿透获取"""
^
src/gpu/api_system/utils/cache_optimization.py:564:1: D400 First line should end with a period
        """写穿透设置"""
^
src/gpu/api_system/utils/cache_optimization.py:579:1: D400 First line should end with a period
        """写回设置"""
^
src/gpu/api_system/utils/cache_optimization.py:587:1: D400 First line should end with a period
        """获取缓存性能报告"""
^
src/gpu/api_system/utils/cache_optimization.py:603:80: E501 line too long (92 > 79 characters)
            "optimization_suggestions": self.multi_level_cache.optimize_cache_performance(),
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:610:1: D400 First line should end with a period
        """按类型清空缓存"""
^
src/gpu/api_system/utils/cache_optimization.py:617:1: D400 First line should end with a period
        """监控缓存性能"""
^
src/gpu/api_system/utils/cache_optimization.py:626:80: E501 line too long (82 > 79 characters)
                f"Cache hit rate low: {stats['cache_stats']['overall_hit_rate']}%"
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:634:80: E501 line too long (94 > 79 characters)
                f"Cache memory usage high: {stats['cache_stats']['total_memory_usage']} bytes"
                                                                               ^
src/gpu/api_system/utils/cache_optimization.py:640:1: D400 First line should end with a period
        """关闭缓存管理器"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:1:1: D205 1 blank line required between summary line and description
"""
增强的缓存优化组件 - 实现90%+命中率
Enhanced Cache Optimization Component - Achieving 90%+ Hit Rate

优化策略:
1. 查询结果缓存 (10-15%提升)
2. 访问模式学习 (8-12%提升)
3. 智能预热策略 (5-10%提升)
4. 预测性预加载 (6-10%提升)
5. 负缓存 (2-5%提升)
6. 分级TTL (3-5%提升)
7. 智能压缩 (3-5%提升)
8. 缓存合并 (5-8%提升)
9. 多版本缓存 (4-7%提升)
10. 分区缓存 (5-8%提升)

目标: 从80%命中率提升到90-95%
"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:1:1: D400 First line should end with a period
"""
增强的缓存优化组件 - 实现90%+命中率
Enhanced Cache Optimization Component - Achieving 90%+ Hit Rate

优化策略:
1. 查询结果缓存 (10-15%提升)
2. 访问模式学习 (8-12%提升)
3. 智能预热策略 (5-10%提升)
4. 预测性预加载 (6-10%提升)
5. 负缓存 (2-5%提升)
6. 分级TTL (3-5%提升)
7. 智能压缩 (3-5%提升)
8. 缓存合并 (5-8%提升)
9. 多版本缓存 (4-7%提升)
10. 分区缓存 (5-8%提升)

目标: 从80%命中率提升到90-95%
"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:25:1: S403 Consider possible security implications associated with pickle module.
import pickle
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:41:1: D400 First line should end with a period
    """访问模式学习器 - 学习用户访问模式并预测"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:43:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:54:1: D400 First line should end with a period
        """记录访问"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:76:1: D400 First line should end with a period
        """预测下次访问时间"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:78:80: E501 line too long (87 > 79 characters)
            if key not in self.access_sequences or len(self.access_sequences[key]) < 2:
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:100:1: D400 First line should end with a period
        """获取应该预加载的键(未来threshold_seconds秒内可能访问)"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:117:1: D400 First line should end with a period
        """记录键关联(如果访问key1后经常访问key2)"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:122:1: D400 First line should end with a period
        """获取相关联的键"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:127:1: D400 First line should end with a period
        """获取最热门的键"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:140:1: D400 First line should end with a period
    """查询结果缓存 - 缓存完整查询结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:142:1: D107 Missing docstring in __init__
    def __init__(self, cache: MultiLevelCache):
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:150:1: D400 First line should end with a period
        """生成查询指纹"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:153:1: S324 Use of weak MD5 hash for security. Consider usedforsecurity=False
        return hashlib.md5(normalized.encode()).hexdigest()
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:155:80: E501 line too long (82 > 79 characters)
    def cache_query_result(self, query_params: dict, result: Any, ttl: int = 300):
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:156:1: D400 First line should end with a period
        """缓存查询结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:166:80: E501 line too long (84 > 79 characters)
                partial_key = f"{self.partial_namespace}:{symbol}:{fingerprint[:8]}"
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:172:1: D400 First line should end with a period
        """获取查询结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:178:1: D400 First line should end with a period
        """获取部分结果(某个股票的所有相关查询)"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:195:1: D400 First line should end with a period
    """负缓存 - 缓存不存在的数据,避免重复查询"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:197:1: D107 Missing docstring in __init__
    def __init__(self, cache: MultiLevelCache):
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:205:1: D400 First line should end with a period
        """标记为负结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:215:1: D400 First line should end with a period
        """检查是否为负结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:219:80: E501 line too long (82 > 79 characters)
    def get_with_negative_check(self, key: str, fetch_func=None) -> Optional[Any]:
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:220:1: D400 First line should end with a period
        """带负缓存检查的获取"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:239:1: D400 First line should end with a period
    """自适应TTL管理器 - 根据访问频率动态调整TTL"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:241:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:256:1: D400 First line should end with a period
        """记录访问"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:261:1: D400 First line should end with a period
        """获取自适应TTL"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:277:1: D400 First line should end with a period
        """获取热度分区"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:292:1: D400 First line should end with a period
    """智能压缩器 - 只对大对象且压缩率高的数据压缩"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:294:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:295:80: E501 line too long (83 > 79 characters)
        self, size_threshold: int = 10240, compression_ratio_threshold: float = 0.7
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:299:80: E501 line too long (88 > 79 characters)
        self.compression_stats = {"attempts": 0, "successes": 0, "total_saved_bytes": 0}
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:304:1: D400 First line should end with a period
        """智能压缩"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:316:80: E501 line too long (83 > 79 characters)
                {"original_size": original_size, "compressed_size": original_size},
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:349:1: D400 First line should end with a period
        """解压缩"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:352:1: S301 Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
            return pickle.loads(decompressed)
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:354:1: S301 Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
            return pickle.loads(data)
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:357:1: D400 First line should end with a period
        """获取压缩统计"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:363:80: E501 line too long (82 > 79 characters)
            "success_rate": (successes / attempts * 100) if attempts > 0 else 0.0,
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:365:80: E501 line too long (88 > 79 characters)
            "total_saved_mb": self.compression_stats["total_saved_bytes"] / 1024 / 1024,
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:370:1: D400 First line should end with a period
    """预测性预加载器 - 基于访问模式预加载数据"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:372:1: D107 Missing docstring in __init__
    def __init__(self, cache: MultiLevelCache, pattern_learner: AccessPatternLearner):
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:372:80: E501 line too long (86 > 79 characters)
    def __init__(self, cache: MultiLevelCache, pattern_learner: AccessPatternLearner):
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:375:80: E501 line too long (85 > 79 characters)
        self.prefetch_executor = concurrent.futures.ThreadPoolExecutor(max_workers=5)
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:385:1: D400 First line should end with a period
        """预加载相关键"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:395:80: E501 line too long (83 > 79 characters)
        logger.debug(f"Prefetching {len(all_keys)} related keys for {current_key}")
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:411:1: D400 First line should end with a period
        """预加载单个键"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:432:1: D400 First line should end with a period
        """获取相关键(基于业务逻辑)"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:460:1: D400 First line should end with a period
        """获取预加载统计"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:473:1: D400 First line should end with a period
    """增强的缓存管理器 - 整合所有优化策略"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:475:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:506:80: E501 line too long (80 > 79 characters)
    def initialize(self, redis_host: str = "localhost", redis_port: int = 6379):
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:507:1: D400 First line should end with a period
        """初始化"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:512:1: D400 First line should end with a period
        """启动后台任务"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:525:1: D400 First line should end with a period
        """停止后台任务"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:535:1: D400 First line should end with a period
        """增强的获取方法"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:578:1: D400 First line should end with a period
        """增强的设置方法"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:586:80: E501 line too long (85 > 79 characters)
        compressed_value, is_compressed, compression_info = self.compressor.compress(
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:594:80: E501 line too long (81 > 79 characters)
            f"Cache put: {key} (TTL={adaptive_ttl}s, compressed={is_compressed})"
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:597:80: E501 line too long (82 > 79 characters)
    def cache_query_result(self, query_params: dict, result: Any, ttl: int = 300):
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:598:1: D400 First line should end with a period
        """缓存查询结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:602:1: D400 First line should end with a period
        """获取查询结果"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:606:1: D400 First line should end with a period
        """智能缓存预热"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:619:17: F841 local variable 'key' is assigned to but never used
                key = f"{symbol}:indicator:{indicator}"
                ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:626:1: D400 First line should end with a period
        """后台循环 - 执行预测性预加载"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:635:80: E501 line too long (84 > 79 characters)
                    logger.info(f"Predictive prefetch: {len(keys_to_preload)} keys")
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:643:1: D400 First line should end with a period
        """获取综合统计信息"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:673:1: D400 First line should end with a period
        """估算优化影响"""
^
src/gpu/api_system/utils/cache_optimization_enhanced.py:689:80: E501 line too long (82 > 79 characters)
        estimated_hit_rate = min(base_hit_rate + total_improvement, 98.0)  # 最高98%
                                                                               ^
src/gpu/api_system/utils/cache_optimization_enhanced.py:711:1: D400 First line should end with a period
    """获取全局缓存管理器实例"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1:1: D205 1 blank line required between summary line and description
"""
GPU加速引擎
GPU Acceleration Engine
"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1:1: D400 First line should end with a period
"""
GPU加速引擎
GPU Acceleration Engine
"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:26:1: D400 First line should end with a period
    """GPU加速回测引擎"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:28:1: D107 Missing docstring in __init__
    def __init__(self, gpu_manager: GPUResourceManager):
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:39:1: D400 First line should end with a period
        """运行GPU加速回测"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:54:80: E501 line too long (83 > 79 characters)
            signals = self._apply_strategy_gpu(gpu_df, indicators, strategy_config)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:65:80: E501 line too long (81 > 79 characters)
                "processing_time": time.time() - gpu_start - gpu_conversion_time,
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:89:1: D400 First line should end with a period
        """将数据转换为GPU DataFrame"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:97:80: E501 line too long (89 > 79 characters)
                    f"GPU内存不足: 需要 {required_mem/1e6:.1f}MB, 可用 {available_mem/1e6:.1f}MB"
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:109:80: E501 line too long (82 > 79 characters)
    def _calculate_gpu_indicators(self, gpu_df: cudf.DataFrame) -> cudf.DataFrame:
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:110:1: D400 First line should end with a period
        """计算技术指标（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:141:80: E501 line too long (83 > 79 characters)
            indicators["bb_upper"] = sma_20 + 2 * gpu_df["close"].rolling(20).std()
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:143:80: E501 line too long (83 > 79 characters)
            indicators["bb_lower"] = sma_20 - 2 * gpu_df["close"].rolling(20).std()
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:161:1: D400 First line should end with a period
        """GPU计算指数移动平均"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:177:1: D400 First line should end with a period
        """GPU计算相对强弱指数"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:200:80: E501 line too long (87 > 79 characters)
        self, gpu_df: cudf.DataFrame, indicators: cudf.DataFrame, strategy_config: Dict
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:202:1: D400 First line should end with a period
        """应用交易策略（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:207:80: E501 line too long (88 > 79 characters)
                signals = self._trend_following_gpu(gpu_df, indicators, strategy_config)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:213:80: E501 line too long (87 > 79 characters)
                signals = self._mean_reversion_gpu(gpu_df, indicators, strategy_config)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:230:1: D400 First line should end with a period
        """趋势跟踪策略（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:236:9: F841 local variable 'rsi_period' is assigned to but never used
        rsi_period = config.get("rsi_period", 14)
        ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:264:1: D400 First line should end with a period
        """动量策略（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:289:1: D400 First line should end with a period
        """均值回归策略（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:293:9: F841 local variable 'bb_period' is assigned to but never used
        bb_period = config.get("bb_period", 20)
        ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:294:9: F841 local variable 'bb_std' is assigned to but never used
        bb_std = config.get("bb_std", 2)
        ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:295:9: F841 local variable 'rsi_period' is assigned to but never used
        rsi_period = config.get("rsi_period", 14)
        ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:328:1: D400 First line should end with a period
        """套利策略（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:333:9: F841 local variable 'reversion_speed' is assigned to but never used
        reversion_speed = config.get("reversion_speed", 0.1)
        ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:355:1: D400 First line should end with a period
        """模拟交易执行（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:414:1: D400 First line should end with a period
        """计算性能指标（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:437:80: E501 line too long (88 > 79 characters)
            calmar_ratio = annual_return / abs(max_drawdown) if max_drawdown != 0 else 0
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:463:1: D400 First line should end with a period
        """GPU计算最大回撤"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:473:1: D400 First line should end with a period
        """GPU计算回撤期间"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:484:1: D400 First line should end with a period
        """空性能指标"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:499:1: D400 First line should end with a period
    """GPU加速机器学习训练引擎"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:501:1: D107 Missing docstring in __init__
    def __init__(self, gpu_manager: GPUResourceManager):
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:508:10: N803 argument name 'X_train' should be lowercase
        X_train: pd.DataFrame,
         ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:513:1: D400 First line should end with a period
        """GPU加速模型训练"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:519:14: N806 variable 'X_train_gpu' in function should be lowercase
            X_train_gpu = self._convert_to_gpu(X_train)
             ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:524:14: N806 variable 'X_train_scaled' in function should be lowercase
            X_train_scaled = scaler.fit_transform(X_train_gpu)
             ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:551:80: E501 line too long (84 > 79 characters)
                feature_importance = model.feature_importances_.to_pandas().tolist()
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:571:43: N803 argument name 'X_test' should be lowercase
    def predict_gpu(self, model_id: str, X_test: pd.DataFrame) -> np.ndarray:
                                          ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:572:1: D400 First line should end with a period
        """GPU加速预测"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:582:14: N806 variable 'X_test_gpu' in function should be lowercase
            X_test_gpu = self._convert_to_gpu(X_test)
             ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:585:14: N806 variable 'X_test_scaled' in function should be lowercase
            X_test_scaled = scaler.transform(X_test_gpu)
             ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:600:1: D400 First line should end with a period
        """将数据转换为GPU格式"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:610:1: D400 First line should end with a period
    """GPU加速特征计算引擎"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:612:1: D107 Missing docstring in __init__
    def __init__(self, gpu_manager: GPUResourceManager):
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:619:1: D400 First line should end with a period
        """GPU加速特征计算"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:631:80: E501 line too long (82 > 79 characters)
                features["technical"] = self._calculate_technical_features(gpu_df)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:635:80: E501 line too long (86 > 79 characters)
                features["statistical"] = self._calculate_statistical_features(gpu_df)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:639:80: E501 line too long (84 > 79 characters)
                features["volatility"] = self._calculate_volatility_features(gpu_df)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:643:80: E501 line too long (88 > 79 characters)
                features["volume_price"] = self._calculate_volume_price_features(gpu_df)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:662:80: E501 line too long (86 > 79 characters)
    def _calculate_technical_features(self, gpu_df: cudf.DataFrame) -> Dict[str, Any]:
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:663:1: D400 First line should end with a period
        """计算技术指标"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:671:80: E501 line too long (80 > 79 characters)
            features["sma_5"] = close.rolling(5).mean().to_pandas().tolist()[-1]
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:672:80: E501 line too long (82 > 79 characters)
            features["sma_10"] = close.rolling(10).mean().to_pandas().tolist()[-1]
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:673:80: E501 line too long (82 > 79 characters)
            features["sma_20"] = close.rolling(20).mean().to_pandas().tolist()[-1]
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:674:80: E501 line too long (82 > 79 characters)
            features["sma_50"] = close.rolling(50).mean().to_pandas().tolist()[-1]
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:683:80: E501 line too long (86 > 79 characters)
            features["macd_signal"] = self._gpu_ema(cp.array([macd] * len(close)), 9)[
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:704:80: E501 line too long (88 > 79 characters)
    def _calculate_statistical_features(self, gpu_df: cudf.DataFrame) -> Dict[str, Any]:
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:705:1: D400 First line should end with a period
        """计算统计特征"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:732:80: E501 line too long (87 > 79 characters)
    def _calculate_volatility_features(self, gpu_df: cudf.DataFrame) -> Dict[str, Any]:
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:733:1: D400 First line should end with a period
        """计算波动率特征"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:742:80: E501 line too long (83 > 79 characters)
            features["volatility_60d"] = cp.std(returns.rolling(60)) * cp.sqrt(252)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:745:80: E501 line too long (86 > 79 characters)
            features["volatility_clustering"] = self._calculate_volatility_clustering(
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:758:1: D400 First line should end with a period
        """计算量价特征"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:791:1: D400 First line should end with a period
        """计算波动率聚类"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:808:1: D400 First line should end with a period
        """计算OBV (On Balance Volume)"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:827:1: D400 First line should end with a period
        """GPU计算指数移动平均"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:838:1: D400 First line should end with a period
        """GPU计算相对强弱指数"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:857:1: D400 First line should end with a period
    """GPU加速优化引擎"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:859:1: D107 Missing docstring in __init__
    def __init__(self, gpu_manager: GPUResourceManager):
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:870:1: D400 First line should end with a period
        """GPU加速参数优化"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:879:80: E501 line too long (87 > 79 characters)
                result = self._random_search_gpu(objective_func, param_space, n_trials)
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:890:80: E501 line too long (82 > 79 characters)
            result["gpu_memory_used_mb"] = self.gpu_manager.get_gpu_memory_usage()
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:900:80: E501 line too long (84 > 79 characters)
    def _grid_search_gpu(self, objective_func, param_space: Dict) -> Dict[str, Any]:
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:901:1: D400 First line should end with a period
        """网格搜索优化（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:931:1: D400 First line should end with a period
        """随机搜索优化（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:959:1: D400 First line should end with a period
        """贝叶斯优化（GPU加速）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:986:1: D400 First line should end with a period
        """生成参数网格"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1004:1: D400 First line should end with a period
        """随机采样参数"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1011:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                params[param_name] = random.choice(param_range)
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1014:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                params[param_name] = random.uniform(param_range[0], param_range[1])
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1014:80: E501 line too long (83 > 79 characters)
                params[param_name] = random.uniform(param_range[0], param_range[1])
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1019:1: D400 First line should end with a period
        """从高斯过程采样参数"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1036:80: E501 line too long (86 > 79 characters)
                params[param_name] = max(param_range[0], min(param_range[1], sampled))
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1042:1: D400 First line should end with a period
    """GPU加速引擎主类"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1044:1: D107 Missing docstring in __init__
    def __init__(
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1045:80: E501 line too long (82 > 79 characters)
        self, gpu_manager: GPUResourceManager, metrics_collector: MetricsCollector
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1062:1: D400 First line should end with a period
        """批量处理任务（并发执行）"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1090:1: D400 First line should end with a period
        """处理单个任务"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1134:80: E501 line too long (82 > 79 characters)
            result["gpu_memory_used_mb"] = self.gpu_manager.get_gpu_memory_usage()
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1156:1: D400 First line should end with a period
        """获取引擎统计信息"""
^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1163:80: E501 line too long (83 > 79 characters)
                    "gpu_memory_usage_mb": self.gpu_manager.get_gpu_memory_usage(),
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1168:80: E501 line too long (83 > 79 characters)
                    "gpu_memory_usage_mb": self.gpu_manager.get_gpu_memory_usage(),
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1171:80: E501 line too long (81 > 79 characters)
                    "total_calculations": len(self.feature_engine.feature_cache),
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1172:80: E501 line too long (83 > 79 characters)
                    "gpu_memory_usage_mb": self.gpu_manager.get_gpu_memory_usage(),
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1178:80: E501 line too long (83 > 79 characters)
                    "gpu_memory_usage_mb": self.gpu_manager.get_gpu_memory_usage(),
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1189:80: E501 line too long (83 > 79 characters)
                    "gpu_memory_usage_mb": self.gpu_manager.get_gpu_memory_usage(),
                                                                               ^
src/gpu/api_system/utils/gpu_acceleration_engine.py:1203:1: D400 First line should end with a period
        """清理资源"""
^
src/gpu/api_system/utils/gpu_utils.py:1:1: D205 1 blank line required between summary line and description
"""
GPU工具模块
GPU Utility Module
"""
^
src/gpu/api_system/utils/gpu_utils.py:1:1: D400 First line should end with a period
"""
GPU工具模块
GPU Utility Module
"""
^
src/gpu/api_system/utils/gpu_utils.py:19:5: F401 'cupy as cp' imported but unused
    import cupy as cp
    ^
src/gpu/api_system/utils/gpu_utils.py:26:5: F401 'cudf' imported but unused
    import cudf
    ^
src/gpu/api_system/utils/gpu_utils.py:36:1: D400 First line should end with a period
    """GPU资源管理器"""
^
src/gpu/api_system/utils/gpu_utils.py:38:1: D107 Missing docstring in __init__
    def __init__(self, gpu_ids: List[int] = None):
^
src/gpu/api_system/utils/gpu_utils.py:56:1: D400 First line should end with a period
        """初始化GPU管理器"""
^
src/gpu/api_system/utils/gpu_utils.py:88:1: D400 First line should end with a period
        """获取GPU数量"""
^
src/gpu/api_system/utils/gpu_utils.py:99:80: E501 line too long (82 > 79 characters)
                self.logger.warning(f"NVIDIA library not properly installed: {e}")
                                                                               ^
src/gpu/api_system/utils/gpu_utils.py:103:1: D400 First line should end with a period
        """获取GPU总内存(MB)"""
^
src/gpu/api_system/utils/gpu_utils.py:108:80: E501 line too long (80 > 79 characters)
            return pynvml.nvmlDeviceGetMemoryInfo(handle).total // (1024 * 1024)
                                                                               ^
src/gpu/api_system/utils/gpu_utils.py:113:1: D400 First line should end with a period
        """获取GPU可用内存(MB)"""
^
src/gpu/api_system/utils/gpu_utils.py:123:1: D400 First line should end with a period
        """获取GPU已用内存(MB)"""
^
src/gpu/api_system/utils/gpu_utils.py:133:1: D400 First line should end with a period
        """获取GPU利用率(%)"""
^
src/gpu/api_system/utils/gpu_utils.py:143:1: D400 First line should end with a period
        """获取GPU温度(°C)"""
^
src/gpu/api_system/utils/gpu_utils.py:148:80: E501 line too long (87 > 79 characters)
            return pynvml.nvmlDeviceGetTemperature(handle, pynvml.NVML_TEMPERATURE_GPU)
                                                                               ^
src/gpu/api_system/utils/gpu_utils.py:153:1: D400 First line should end with a period
        """获取GPU功耗(W)"""
^
src/gpu/api_system/utils/gpu_utils.py:163:1: D400 First line should end with a period
        """获取GPU风扇转速(RPM)"""
^
src/gpu/api_system/utils/gpu_utils.py:173:1: D400 First line should end with a period
        """获取GPU PCIE带宽(GB/s)"""
^
src/gpu/api_system/utils/gpu_utils.py:187:1: D400 First line should end with a period
        """获取GPU内存错误计数"""
^
src/gpu/api_system/utils/gpu_utils.py:199:1: D400 First line should end with a period
        """根据GPU性能分类优先级"""
^
src/gpu/api_system/utils/gpu_utils.py:214:1: D400 First line should end with a period
        """获取GPU统计信息"""
^
src/gpu/api_system/utils/gpu_utils.py:235:1: D400 First line should end with a period
        """分配GPU资源"""
^
src/gpu/api_system/utils/gpu_utils.py:271:1: D400 First line should end with a period
        """释放GPU资源"""
^
src/gpu/api_system/utils/gpu_utils.py:291:80: E501 line too long (82 > 79 characters)
                        f"已为任务 {task_id} 释放GPU {gpu_id}，释放内存: {memory_released}MB"
                                                                               ^
src/gpu/api_system/utils/gpu_utils.py:296:1: D400 First line should end with a period
        """更新GPU状态"""
^
src/gpu/api_system/utils/gpu_utils.py:309:80: E501 line too long (84 > 79 characters)
                        "ecc_memory_errors": self.get_gpu_ecc_memory_errors(gpu_id),
                                                                               ^
src/gpu/api_system/utils/gpu_utils.py:315:1: D400 First line should end with a period
        """获取可用GPU数量"""
^
src/gpu/api_system/utils/gpu_utils.py:319:1: D400 First line should end with a period
        """获取GPU使用摘要"""
^
src/gpu/api_system/utils/gpu_utils.py:355:1: D400 First line should end with a period
        """清理资源"""
^
src/gpu/api_system/utils/monitoring.py:1:1: D205 1 blank line required between summary line and description
"""
监控指标收集器
Metrics Collector
"""
^
src/gpu/api_system/utils/monitoring.py:1:1: D400 First line should end with a period
"""
监控指标收集器
Metrics Collector
"""
^
src/gpu/api_system/utils/monitoring.py:17:1: D400 First line should end with a period
    """指标收集器"""
^
src/gpu/api_system/utils/monitoring.py:19:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/gpu/api_system/utils/monitoring.py:29:1: D400 First line should end with a period
        """初始化Prometheus指标"""
^
src/gpu/api_system/utils/monitoring.py:32:80: E501 line too long (87 > 79 characters)
            "api_requests_total", "Total API requests", ["method", "service", "status"]
                                                                               ^
src/gpu/api_system/utils/monitoring.py:68:80: E501 line too long (86 > 79 characters)
            "tasks_completed_total", "Total tasks completed", ["queue_type", "status"]
                                                                               ^
src/gpu/api_system/utils/monitoring.py:76:80: E501 line too long (85 > 79 characters)
        self.gauges["cpu_usage"] = Gauge("cpu_usage_percent", "CPU usage percentage")
                                                                               ^
src/gpu/api_system/utils/monitoring.py:82:80: E501 line too long (88 > 79 characters)
        self.gauges["disk_usage"] = Gauge("disk_usage_percent", "Disk usage percentage")
                                                                               ^
src/gpu/api_system/utils/monitoring.py:94:1: D400 First line should end with a period
        """记录API请求"""
^
src/gpu/api_system/utils/monitoring.py:105:80: E501 line too long (86 > 79 characters)
        self, gpu_id: int, utilization: float, memory_usage: float, temperature: float
                                                                               ^
src/gpu/api_system/utils/monitoring.py:107:1: D400 First line should end with a period
        """记录GPU指标"""
^
src/gpu/api_system/utils/monitoring.py:117:80: E501 line too long (86 > 79 characters)
            self.gauges["gpu_temperature"].labels(gpu_id=str(gpu_id)).set(temperature)
                                                                               ^
src/gpu/api_system/utils/monitoring.py:119:80: E501 line too long (81 > 79 characters)
    def record_task_metrics(self, queue_type: str, status: str, duration: float):
                                                                               ^
src/gpu/api_system/utils/monitoring.py:120:1: D400 First line should end with a period
        """记录任务指标"""
^
src/gpu/api_system/utils/monitoring.py:126:80: E501 line too long (83 > 79 characters)
            self.histograms["task_duration"].labels(queue_type=queue_type).observe(
                                                                               ^
src/gpu/api_system/utils/monitoring.py:131:1: D400 First line should end with a period
        """记录队列长度"""
^
src/gpu/api_system/utils/monitoring.py:133:80: E501 line too long (81 > 79 characters)
            self.gauges["queue_length"].labels(queue_type=queue_type).set(length)
                                                                               ^
src/gpu/api_system/utils/monitoring.py:136:1: D400 First line should end with a period
        """记录活跃连接数"""
^
src/gpu/api_system/utils/monitoring.py:138:80: E501 line too long (80 > 79 characters)
            self.gauges["active_connections"].labels(service=service).set(count)
                                                                               ^
src/gpu/api_system/utils/monitoring.py:141:1: D400 First line should end with a period
        """记录系统指标"""
^
src/gpu/api_system/utils/monitoring.py:158:80: E501 line too long (85 > 79 characters)
    def record_query_performance(self, query_type: str, table: str, duration: float):
                                                                               ^
src/gpu/api_system/utils/monitoring.py:159:1: D400 First line should end with a period
        """记录查询性能"""
^
src/gpu/api_system/utils/monitoring.py:166:1: D400 First line should end with a period
        """获取指标摘要"""
^
src/gpu/api_system/utils/monitoring.py:178:1: D400 First line should end with a period
        """获取系统指标"""
^
src/gpu/api_system/utils/monitoring.py:202:1: D400 First line should end with a period
        """获取GPU指标"""
^
src/gpu/api_system/utils/monitoring.py:222:1: D400 First line should end with a period
        """获取API指标"""
^
src/gpu/api_system/utils/monitoring.py:241:1: D400 First line should end with a period
        """获取任务指标"""
^
src/gpu/api_system/utils/monitoring.py:260:1: D400 First line should end with a period
        """导出所有指标"""
^
src/gpu/api_system/utils/monitoring.py:285:80: E501 line too long (85 > 79 characters)
                        gauge._value._value if hasattr(gauge._value, "_value") else 0
                                                                               ^
src/gpu/api_system/utils/monitoring.py:315:80: E501 line too long (85 > 79 characters)
                        summary._sum._value if hasattr(summary._sum, "_value") else 0
                                                                               ^
src/gpu/api_system/utils/monitoring.py:323:1: D400 First line should end with a period
        """清理旧指标"""
^
src/gpu/api_system/utils/monitoring.py:324:9: F841 local variable 'cutoff_time' is assigned to but never used
        cutoff_time = datetime.now() - timedelta(days=days)
        ^
src/gpu/api_system/utils/monitoring.py:324:40: F821 undefined name 'timedelta'
        cutoff_time = datetime.now() - timedelta(days=days)
                                       ^
src/gpu/api_system/utils/monitoring.py:332:1: D400 First line should end with a period
    """性能监控器"""
^
src/gpu/api_system/utils/monitoring.py:334:1: D107 Missing docstring in __init__
    def __init__(self, metrics_collector: MetricsCollector):
^
src/gpu/api_system/utils/monitoring.py:345:80: E501 line too long (82 > 79 characters)
    def monitor_api_performance(self, method: str, service: str, duration: float):
                                                                               ^
src/gpu/api_system/utils/monitoring.py:346:1: D400 First line should end with a period
        """监控API性能"""
^
src/gpu/api_system/utils/monitoring.py:357:80: E501 line too long (82 > 79 characters)
                    "threshold": self.performance_thresholds["api_response_time"],
                                                                               ^
src/gpu/api_system/utils/monitoring.py:363:80: E501 line too long (86 > 79 characters)
    def monitor_query_performance(self, query_type: str, table: str, duration: float):
                                                                               ^
src/gpu/api_system/utils/monitoring.py:364:1: D400 First line should end with a period
        """监控查询性能"""
^
src/gpu/api_system/utils/monitoring.py:369:80: E501 line too long (81 > 79 characters)
                "message": f"查询 {query_type} on {table} 执行时间过长: {duration:.2f}s",
                                                                               ^
src/gpu/api_system/utils/monitoring.py:382:1: D400 First line should end with a period
        """监控系统健康状态"""
^
src/gpu/api_system/utils/monitoring.py:417:1: D400 First line should end with a period
        """获取告警信息"""
^
src/gpu/api_system/utils/monitoring.py:421:1: D400 First line should end with a period
        """清理旧告警"""
^
src/gpu/api_system/utils/monitoring.py:422:40: F821 undefined name 'timedelta'
        cutoff_time = datetime.now() - timedelta(hours=older_than_hours)
                                       ^
src/gpu/api_system/utils/redis_utils.py:1:1: D205 1 blank line required between summary line and description
"""
Redis队列工具模块
Redis Queue Utility Module
"""
^
src/gpu/api_system/utils/redis_utils.py:1:1: D400 First line should end with a period
"""
Redis队列工具模块
Redis Queue Utility Module
"""
^
src/gpu/api_system/utils/redis_utils.py:17:1: D400 First line should end with a period
    """Redis队列管理器"""
^
src/gpu/api_system/utils/redis_utils.py:19:1: D107 Missing docstring in __init__
    def __init__(self, host: str = "localhost", port: int = 6379, db: int = 0):
^
src/gpu/api_system/utils/redis_utils.py:50:1: D400 First line should end with a period
        """连接到Redis服务器"""
^
src/gpu/api_system/utils/redis_utils.py:70:1: D400 First line should end with a period
        """断开Redis连接"""
^
src/gpu/api_system/utils/redis_utils.py:76:1: D400 First line should end with a period
        """添加任务到队列"""
^
src/gpu/api_system/utils/redis_utils.py:84:80: E501 line too long (85 > 79 characters)
            f"{queue_type}_{int(time.time())}_{hash(task_data.get('task_name', ''))}"
                                                                               ^
src/gpu/api_system/utils/redis_utils.py:120:1: D400 First line should end with a period
        """从队列中获取任务"""
^
src/gpu/api_system/utils/redis_utils.py:134:80: E501 line too long (87 > 79 characters)
                self.update_task_status(queue_type, task_data["task_id"], "processing")
                                                                               ^
src/gpu/api_system/utils/redis_utils.py:150:1: D400 First line should end with a period
        """更新任务状态"""
^
src/gpu/api_system/utils/redis_utils.py:169:80: E501 line too long (80 > 79 characters)
            self.redis_client.hset(status_key, task_id, json.dumps(status_data))
                                                                               ^
src/gpu/api_system/utils/redis_utils.py:193:1: D400 First line should end with a period
        """获取任务状态"""
^
src/gpu/api_system/utils/redis_utils.py:211:1: D400 First line should end with a period
        """获取队列长度"""
^
src/gpu/api_system/utils/redis_utils.py:231:1: D400 First line should end with a period
        """获取待处理任务列表"""
^
src/gpu/api_system/utils/redis_utils.py:242:17: B007 Loop control variable 'task_id' not used within the loop body. If this is intended, start the name with an underscore.
            for task_id, status_json in all_statuses.items():
                ^
src/gpu/api_system/utils/redis_utils.py:257:1: D400 First line should end with a period
        """获取任务结果"""
^
src/gpu/api_system/utils/redis_utils.py:276:1: D400 First line should end with a period
        """清理旧任务"""
^
src/gpu/api_system/utils/redis_utils.py:290:80: E501 line too long (80 > 79 characters)
                created_time = datetime.fromisoformat(status_data["created_at"])
                                                                               ^
src/gpu/api_system/utils/redis_utils.py:293:80: E501 line too long (80 > 79 characters)
                if created_time < cutoff_time and status_data.get("status") in [
                                                                               ^
src/gpu/api_system/utils/redis_utils.py:307:1: D400 First line should end with a period
        """获取队列统计信息"""
^
src/gpu/api_system/utils/redis_utils.py:363:1: D400 First line should end with a period
        """监控队列健康状态"""
^
src/gpu/api_system/utils/redis_utils.py:396:80: E501 line too long (88 > 79 characters)
                        created_time = datetime.fromisoformat(status_data["created_at"])
                                                                               ^
src/gpu/api_system/wsl2_gpu_init.py:2:1: D205 1 blank line required between summary line and description
"""
WSL2 GPU环境初始化脚本
解决RAPIDS在WSL2环境下的GPU访问问题
"""
^
src/gpu/api_system/wsl2_gpu_init.py:2:1: D400 First line should end with a period
"""
WSL2 GPU环境初始化脚本
解决RAPIDS在WSL2环境下的GPU访问问题
"""
^
src/gpu/api_system/wsl2_gpu_init.py:12:1: D202 No blank lines allowed after function docstring
    """初始化WSL2 GPU环境"""
^
src/gpu/api_system/wsl2_gpu_init.py:12:1: D400 First line should end with a period
    """初始化WSL2 GPU环境"""
^
src/gpu/api_system/wsl2_gpu_init.py:59:15: F541 f-string is missing placeholders
        print(f"   ✓ cuDF工作正常")
              ^
src/gpu/api_system/wsl2_gpu_init.py:73:10: N806 variable 'X' in function should be lowercase
        X = cudf.DataFrame(
         ^
src/gpu/api_system/wsl2_gpu_init.py:74:80: E501 line too long (88 > 79 characters)
            {"x": [1.0, 2.0, 3.0, 8.0, 9.0, 10.0], "y": [1.0, 2.0, 3.0, 8.0, 9.0, 10.0]}
                                                                               ^
src/gpu/api_system/wsl2_gpu_init.py:80:15: F541 f-string is missing placeholders
        print(f"   ✓ cuML工作正常")
              ^
src/gpu/api_system/wsl2_gpu_init.py:81:15: F541 f-string is missing placeholders
        print(f"   ✓ KMeans聚类完成")
              ^
src/gpu/api_system/wsl2_gpu_init.py:100:9: F841 local variable 'cpu_result' is assigned to but never used
        cpu_result = cpu_data["x"].sum()
        ^
src/gpu/api_system/wsl2_gpu_init.py:106:9: F841 local variable 'gpu_result' is assigned to but never used
        gpu_result = gpu_data["x"].sum()
        ^
src/gpu/api_system/wsl2_gpu_init.py:127:1: D202 No blank lines allowed after function docstring
    """设置必要的环境变量"""
^
src/gpu/api_system/wsl2_gpu_init.py:127:1: D400 First line should end with a period
    """设置必要的环境变量"""
^
src/gpu/data_processing_interfaces.py:1:1: D100 Missing docstring in public module
from abc import ABC, abstractmethod
^
src/gpu/data_processing_interfaces.py:5:1: E302 expected 2 blank lines, found 1
class IDataProcessor(ABC):
^
src/gpu/data_processing_interfaces.py:6:1: D205 1 blank line required between summary line and description
    """
    数据处理器接口
    定义了数据处理的核心功能，允许CPU和GPU实现共享同一接口
    """
^
src/gpu/data_processing_interfaces.py:6:1: D400 First line should end with a period
    """
    数据处理器接口
    定义了数据处理的核心功能，允许CPU和GPU实现共享同一接口
    """
^
src/gpu/data_processing_interfaces.py:12:80: E501 line too long (86 > 79 characters)
    def process_batch(self, batch_data: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
                                                                               ^
src/gpu/data_processing_interfaces.py:13:1: D205 1 blank line required between summary line and description
        """
        处理一批数据。
        Args:
            batch_data: 包含数据点的字典列表。
        Returns:
            处理后的数据字典列表。
        """
^
src/gpu/data_processing_interfaces.py:13:1: D400 First line should end with a period
        """
        处理一批数据。
        Args:
            batch_data: 包含数据点的字典列表。
        Returns:
            处理后的数据字典列表。
        """
^
src/gpu/data_processing_interfaces.py:15:1: RST301 Unexpected indentation.
        """
        处理一批数据。
        Args:
            batch_data: 包含数据点的字典列表。
        Returns:
            处理后的数据字典列表。
        """
^
src/gpu/data_processing_interfaces.py:16:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        处理一批数据。
        Args:
            batch_data: 包含数据点的字典列表。
        Returns:
            处理后的数据字典列表。
        """
^
src/gpu/data_processing_interfaces.py:23:80: E501 line too long (106 > 79 characters)
    def compute_features(self, historical_data: List[Dict], feature_types: List[str]) -> Dict[str, float]:
                                                                               ^
src/gpu/data_processing_interfaces.py:24:1: D205 1 blank line required between summary line and description
        """
        计算给定历史数据的特征。
        Args:
            historical_data: 历史数据字典列表。
            feature_types: 要计算的特征类型列表。
        Returns:
            计算出的特征字典。
        """
^
src/gpu/data_processing_interfaces.py:24:1: D400 First line should end with a period
        """
        计算给定历史数据的特征。
        Args:
            historical_data: 历史数据字典列表。
            feature_types: 要计算的特征类型列表。
        Returns:
            计算出的特征字典。
        """
^
src/gpu/data_processing_interfaces.py:26:1: RST301 Unexpected indentation.
        """
        计算给定历史数据的特征。
        Args:
            historical_data: 历史数据字典列表。
            feature_types: 要计算的特征类型列表。
        Returns:
            计算出的特征字典。
        """
^
src/gpu/data_processing_interfaces.py:28:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        计算给定历史数据的特征。
        Args:
            historical_data: 历史数据字典列表。
            feature_types: 要计算的特征类型列表。
        Returns:
            计算出的特征字典。
        """
^
src/gpu/data_processing_interfaces.py:36:1: D205 1 blank line required between summary line and description
        """
        加载并预处理数据。
        Args:
            data: 输入的Pandas DataFrame。
        Returns:
            包含处理后数据和相关元数据的字典。
        """
^
src/gpu/data_processing_interfaces.py:36:1: D400 First line should end with a period
        """
        加载并预处理数据。
        Args:
            data: 输入的Pandas DataFrame。
        Returns:
            包含处理后数据和相关元数据的字典。
        """
^
src/gpu/data_processing_interfaces.py:38:1: RST301 Unexpected indentation.
        """
        加载并预处理数据。
        Args:
            data: 输入的Pandas DataFrame。
        Returns:
            包含处理后数据和相关元数据的字典。
        """
^
src/gpu/data_processing_interfaces.py:39:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        加载并预处理数据。
        Args:
            data: 输入的Pandas DataFrame。
        Returns:
            包含处理后数据和相关元数据的字典。
        """
^
src/gpu/data_processor_factory.py:1:1: D100 Missing docstring in public module
import os
^
src/gpu/data_processor_factory.py:5:72: E261 at least two spaces before inline comment
from src.gpu.accelerated.data_processor_gpu import GPUDataProcessorImpl # Renamed class
                                                                       ^
src/gpu/data_processor_factory.py:5:80: E501 line too long (87 > 79 characters)
from src.gpu.accelerated.data_processor_gpu import GPUDataProcessorImpl # Renamed class
                                                                               ^
src/gpu/data_processor_factory.py:7:1: E302 expected 2 blank lines, found 1
class DataProcessorFactory:
^
src/gpu/data_processor_factory.py:8:1: D205 1 blank line required between summary line and description
    """
    数据处理器工厂
    根据是否启用GPU加速来创建并返回相应的数据处理器实例
    """
^
src/gpu/data_processor_factory.py:8:1: D400 First line should end with a period
    """
    数据处理器工厂
    根据是否启用GPU加速来创建并返回相应的数据处理器实例
    """
^
src/gpu/data_processor_factory.py:15:1: D205 1 blank line required between summary line and description
        """
        获取数据处理器实例。
        Args:
            gpu_enabled: 显式指定是否启用GPU。如果为None，则尝试从环境变量或系统检测。
        Returns:
            IDataProcessor 实例 (CPUDataProcessor 或 GPUDataProcessorImpl)。
        Raises:
            ImportError: 如果指定GPU但无法导入cuDF/cuPy。
        """
^
src/gpu/data_processor_factory.py:15:1: D400 First line should end with a period
        """
        获取数据处理器实例。
        Args:
            gpu_enabled: 显式指定是否启用GPU。如果为None，则尝试从环境变量或系统检测。
        Returns:
            IDataProcessor 实例 (CPUDataProcessor 或 GPUDataProcessorImpl)。
        Raises:
            ImportError: 如果指定GPU但无法导入cuDF/cuPy。
        """
^
src/gpu/data_processor_factory.py:17:1: RST301 Unexpected indentation.
        """
        获取数据处理器实例。
        Args:
            gpu_enabled: 显式指定是否启用GPU。如果为None，则尝试从环境变量或系统检测。
        Returns:
            IDataProcessor 实例 (CPUDataProcessor 或 GPUDataProcessorImpl)。
        Raises:
            ImportError: 如果指定GPU但无法导入cuDF/cuPy。
        """
^
src/gpu/data_processor_factory.py:18:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取数据处理器实例。
        Args:
            gpu_enabled: 显式指定是否启用GPU。如果为None，则尝试从环境变量或系统检测。
        Returns:
            IDataProcessor 实例 (CPUDataProcessor 或 GPUDataProcessorImpl)。
        Raises:
            ImportError: 如果指定GPU但无法导入cuDF/cuPy。
        """
^
src/gpu/data_processor_factory.py:26:80: E501 line too long (89 > 79 characters)
            gpu_enabled = os.getenv("ENABLE_GPU_ACCELERATION", "false").lower() == "true"
                                                                               ^
src/gpu/data_processor_factory.py:32:28: E261 at least two spaces before inline comment
                import cudf # noqa: F401
                           ^
src/gpu/data_processor_factory.py:33:28: E261 at least two spaces before inline comment
                import cupy # noqa: F401
                           ^
src/gpu/data_processor_factory.py:43:1: D205 1 blank line required between summary line and description
        """
        根据字符串获取数据处理器类型 (用于依赖注入配置等场景)。
        Args:
            processor_type: "cpu" 或 "gpu"。
        Returns:
            IDataProcessor 的具体实现类。
        Raises:
            ValueError: 如果提供了不支持的处理器类型。
        """
^
src/gpu/data_processor_factory.py:43:1: D400 First line should end with a period
        """
        根据字符串获取数据处理器类型 (用于依赖注入配置等场景)。
        Args:
            processor_type: "cpu" 或 "gpu"。
        Returns:
            IDataProcessor 的具体实现类。
        Raises:
            ValueError: 如果提供了不支持的处理器类型。
        """
^
src/gpu/data_processor_factory.py:45:1: RST301 Unexpected indentation.
        """
        根据字符串获取数据处理器类型 (用于依赖注入配置等场景)。
        Args:
            processor_type: "cpu" 或 "gpu"。
        Returns:
            IDataProcessor 的具体实现类。
        Raises:
            ValueError: 如果提供了不支持的处理器类型。
        """
^
src/gpu/data_processor_factory.py:46:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        根据字符串获取数据处理器类型 (用于依赖注入配置等场景)。
        Args:
            processor_type: "cpu" 或 "gpu"。
        Returns:
            IDataProcessor 的具体实现类。
        Raises:
            ValueError: 如果提供了不支持的处理器类型。
        """
^
src/gpu/data_processor_factory.py:57:80: E501 line too long (101 > 79 characters)
            raise ValueError(f"Unsupported processor type: {processor_type}. Choose 'cpu' or 'gpu'.")
                                                                               ^
src/gpu/data_processor_factory.py:58:1: W391 blank line at end of file

^
src/interfaces/__init__.py:1:1: D205 1 blank line required between summary line and description
"""
统一数据接口模块
定义了所有数据源必须实现的接口
"""
^
src/interfaces/__init__.py:1:1: D400 First line should end with a period
"""
统一数据接口模块
定义了所有数据源必须实现的接口
"""
^
src/interfaces/business_data_source.py:1:1: D400 First line should end with a period
"""
业务逻辑数据源抽象接口

本模块定义业务逻辑数据源的统一接口，用于处理复杂业务场景。
业务逻辑层通常需要混合时序数据和关系数据，执行复杂的计算和聚合操作。

适用场景: 仪表盘汇总、策略回测、风险分析、交易归因等复合业务

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/interfaces/business_data_source.py:20:1: D400 First line should end with a period
    """
    业务逻辑数据源抽象接口

    此接口封装复杂业务逻辑，内部协调时序数据源和关系数据源。
    业务层负责:
    1. 数据聚合和计算
    2. 多数据源协调
    3. 业务规则执行
    4. 性能优化（缓存、并行）

    实现类:
    - MockBusinessDataSource: Mock数据实现（开发测试）
    - BusinessDataSourceImpl: 真实业务实现（生产）
    """
^
src/interfaces/business_data_source.py:41:1: D400 First line should end with a period
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:57:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:63:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:64:80: E501 line too long (85 > 79 characters)
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """





        ^
src/interfaces/business_data_source.py:65:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:65:80: E501 line too long (85 > 79 characters)
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """





        ^
src/interfaces/business_data_source.py:66:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:70:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:73:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:77:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:79:80: E501 line too long (82 > 79 characters)
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """





        ^
src/interfaces/business_data_source.py:80:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:82:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:83:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:84:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:88:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:90:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:90:80: E501 line too long (85 > 79 characters)
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """





        ^
src/interfaces/business_data_source.py:92:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:93:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:93:80: E501 line too long (86 > 79 characters)
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """





        ^
src/interfaces/business_data_source.py:94:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:98:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:103:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:105:1: RST301 Unexpected indentation.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:107:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:108:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:109:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取仪表盘汇总数据

        Args:
            user_id: 用户ID
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 仪表盘汇总数据（混合时序+关系数据）

        示例返回:
            {
                "trade_date": "2025-11-21",
                "user_id": 1001,

                # 市场概览 (来自时序数据源)
                "market_overview": {
                    "total_stocks": 5234,
                    "up_stocks": 2845,
                    "down_stocks": 2103,
                    "limit_up": 45,
                    "limit_down": 12,
                    "indices": {
                        "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                        "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                    }
                },

                # 数据更新状态
                "data_status": {
                    "last_update": "2025-11-21 15:05:00",
                    "realtime_delay_seconds": 5,
                    "data_completeness": 98.5
                },

                # 市场热度 (板块+资金流)
                "market_hotspots": {
                    "top_industries": [
                        {"name": "计算机", "change": 3.2, "fund_inflow": 1250000000},
                        {"name": "电子", "change": 2.8, "fund_inflow": 980000000}
                    ],
                    "top_concepts": [
                        {"name": "人工智能", "change": 4.5, "stock_count": 123}
                    ]
                },

                # 资金流向排名
                "fund_flow_ranking": {
                    "top_inflow": [
                        {"symbol": "600000", "name": "浦发银行", "net_inflow": 125000000}
                    ],
                    "top_outflow": [
                        {"symbol": "600001", "name": "邯郸钢铁", "net_outflow": -85000000}
                    ]
                },

                # 用户自选股表现 (来自关系数据源)
                "watchlist_performance": {
                    "favorite_stocks": {
                        "total_count": 20,
                        "avg_change": 1.5,
                        "up_count": 15,
                        "down_count": 5
                    },
                    "strategy_stocks": {
                        "total_count": 35,
                        "avg_change": 2.3
                    }
                }
            }

        性能要求:
            - 总响应时间: < 1s
            - 使用并行查询优化
            - 缓存热点数据

        Raises:
            DataSourceException: 数据获取失败
        """
^
src/interfaces/business_data_source.py:124:80: E501 line too long (82 > 79 characters)
        self, sector_type: str, trade_date: Optional[date] = None, limit: int = 20
                                                                               ^
src/interfaces/business_data_source.py:126:1: D400 First line should end with a period
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:132:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:150:1: RST301 Unexpected indentation.
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:151:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:152:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:153:1: RST401 Unexpected section title.
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:154:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取板块表现

        Args:
            sector_type: 板块类型
                        - "industry": 行业板块
                        - "concept": 概念板块
            trade_date: 交易日期
            limit: 返回数量

        Returns:
            List[Dict]: 板块表现列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "stock_count": 123,
                    "avg_change": 2.3,
                    "up_count": 85,
                    "down_count": 38,
                    "total_amount": 12345678900.0,
                    "net_fund_inflow": 234567890.0,
                    "top_stocks": [
                        {"symbol": "000001", "name": "平安银行", "change": 5.2}
                    ]
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:176:1: D400 First line should end with a period
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:195:1: RST301 Unexpected indentation.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:198:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:202:1: RST301 Unexpected indentation.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:207:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:211:1: RST301 Unexpected indentation.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:216:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:220:1: RST301 Unexpected indentation.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:223:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:227:1: RST301 Unexpected indentation.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:230:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:234:1: RST301 Unexpected indentation.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:241:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:242:1: RST401 Unexpected section title.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:243:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:247:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行策略回测

        Args:
            strategy_id: 策略ID（从关系数据源获取配置）
            user_id: 用户ID（权限验证）
            start_date: 回测开始日期
            end_date: 回测结束日期
            initial_capital: 初始资金
            universe: 股票池，None表示使用全市场

        Returns:
            Dict: 回测结果

        示例返回:
            {
                "backtest_id": "BT20251121001",
                "strategy_id": 1,
                "strategy_name": "动量策略001",
                "period": {
                    "start_date": "2024-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 245
                },

                # 收益指标
                "returns": {
                    "total_return": 0.235,  # 23.5%
                    "annual_return": 0.198,
                    "sharpe_ratio": 1.45,
                    "max_drawdown": -0.125,
                    "win_rate": 0.58
                },

                # 交易统计
                "trades": {
                    "total_trades": 128,
                    "profitable_trades": 74,
                    "losing_trades": 54,
                    "avg_profit": 0.032,
                    "avg_loss": -0.018
                },

                # 持仓统计
                "positions": {
                    "avg_holding_period": 8.5,  # 天
                    "max_positions": 10,
                    "turnover_rate": 1.5
                },

                # 净值曲线
                "equity_curve": [
                    {"date": "2024-01-01", "equity": 100000.0},
                    {"date": "2024-01-02", "equity": 101250.0},
                    ...
                ],

                # 详细交易记录
                "trade_records": [
                    {
                        "date": "2024-01-05",
                        "symbol": "600000",
                        "action": "buy",
                        "price": 10.5,
                        "quantity": 1000,
                        "amount": 10500.0
                    },
                    ...
                ],

                "created_at": "2025-11-21 15:00:00",
                "execution_time_seconds": 12.5
            }

        性能要求:
            - 1年数据(50股票): < 30s
            - 使用GPU加速可降至 < 10s

        Raises:
            DataSourceException: 回测执行失败
            PermissionError: 用户无权限
            ValueError: 参数无效
        """
^
src/interfaces/business_data_source.py:269:1: D400 First line should end with a period
        """
        获取回测结果列表

        Args:
            user_id: 用户ID
            backtest_id: 回测ID，精确查询
            strategy_id: 策略ID，过滤查询
            limit: 返回数量

        Returns:
            List[Dict]: 回测结果列表（摘要版本）

        性能要求: < 200ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:294:1: D400 First line should end with a period
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:299:1: RST301 Unexpected indentation.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:311:1: RST301 Unexpected indentation.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:314:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:318:1: RST301 Unexpected indentation.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:322:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:326:1: RST301 Unexpected indentation.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:330:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:334:1: RST301 Unexpected indentation.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:338:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:339:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        计算风险指标

        Args:
            user_id: 用户ID
            portfolio: 投资组合 {"symbol": quantity}
                      None表示使用用户当前持仓

        Returns:
            Dict: 风险指标

        示例返回:
            {
                "user_id": 1001,
                "calculation_time": "2025-11-21 15:00:00",

                # VaR指标
                "var_metrics": {
                    "var_95": -12500.0,  # 95%置信度VaR
                    "var_99": -18750.0,
                    "cvar_95": -15230.0  # 条件VaR
                },

                # 波动率指标
                "volatility": {
                    "daily_volatility": 0.018,
                    "annual_volatility": 0.285,
                    "beta": 1.15,
                    "correlation_with_market": 0.72
                },

                # 集中度风险
                "concentration": {
                    "top1_weight": 0.25,
                    "top3_weight": 0.58,
                    "top5_weight": 0.75,
                    "herfindahl_index": 0.15
                },

                # 行业分布
                "industry_exposure": {
                    "金融": 0.35,
                    "科技": 0.28,
                    "消费": 0.20,
                    "其他": 0.17
                }
            }

        性能要求: < 800ms

        Raises:
            DataSourceException: 计算失败
        """
^
src/interfaces/business_data_source.py:351:1: D400 First line should end with a period
        """
        检查风险预警

        Args:
            user_id: 用户ID

        Returns:
            List[Dict]: 触发的预警列表

        示例返回:
            [
                {
                    "alert_id": 1,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "current_value": 12.5,
                    "triggered_at": "2025-11-21 14:35:00",
                    "message": "浦发银行价格达到12.5，触发预警（阈值12.0）"
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 检查失败
        """
^
src/interfaces/business_data_source.py:370:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        检查风险预警

        Args:
            user_id: 用户ID

        Returns:
            List[Dict]: 触发的预警列表

        示例返回:
            [
                {
                    "alert_id": 1,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "current_value": 12.5,
                    "triggered_at": "2025-11-21 14:35:00",
                    "message": "浦发银行价格达到12.5，触发预警（阈值12.0）"
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 检查失败
        """
^
src/interfaces/business_data_source.py:371:1: RST401 Unexpected section title.
        """
        检查风险预警

        Args:
            user_id: 用户ID

        Returns:
            List[Dict]: 触发的预警列表

        示例返回:
            [
                {
                    "alert_id": 1,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "current_value": 12.5,
                    "triggered_at": "2025-11-21 14:35:00",
                    "message": "浦发银行价格达到12.5，触发预警（阈值12.0）"
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 检查失败
        """
^
src/interfaces/business_data_source.py:372:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        检查风险预警

        Args:
            user_id: 用户ID

        Returns:
            List[Dict]: 触发的预警列表

        示例返回:
            [
                {
                    "alert_id": 1,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "current_value": 12.5,
                    "triggered_at": "2025-11-21 14:35:00",
                    "message": "浦发银行价格达到12.5，触发预警（阈值12.0）"
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 检查失败
        """
^
src/interfaces/business_data_source.py:391:1: D400 First line should end with a period
        """
        分析交易信号

        Args:
            user_id: 用户ID
            strategy_ids: 策略ID列表，None表示所有启用的策略
            trade_date: 交易日期，None表示最新交易日

        Returns:
            List[Dict]: 交易信号列表

        示例返回:
            [
                {
                    "signal_id": "SIG20251121001",
                    "strategy_id": 1,
                    "strategy_name": "动量策略001",
                    "symbol": "600000",
                    "name": "浦发银行",
                    "action": "buy",  # buy/sell/hold
                    "confidence": 0.85,
                    "price": 10.5,
                    "recommended_quantity": 1000,
                    "reason": "20日动量突破，成交量放大",
                    "generated_at": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:415:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析交易信号

        Args:
            user_id: 用户ID
            strategy_ids: 策略ID列表，None表示所有启用的策略
            trade_date: 交易日期，None表示最新交易日

        Returns:
            List[Dict]: 交易信号列表

        示例返回:
            [
                {
                    "signal_id": "SIG20251121001",
                    "strategy_id": 1,
                    "strategy_name": "动量策略001",
                    "symbol": "600000",
                    "name": "浦发银行",
                    "action": "buy",  # buy/sell/hold
                    "confidence": 0.85,
                    "price": 10.5,
                    "recommended_quantity": 1000,
                    "reason": "20日动量突破，成交量放大",
                    "generated_at": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:416:1: RST401 Unexpected section title.
        """
        分析交易信号

        Args:
            user_id: 用户ID
            strategy_ids: 策略ID列表，None表示所有启用的策略
            trade_date: 交易日期，None表示最新交易日

        Returns:
            List[Dict]: 交易信号列表

        示例返回:
            [
                {
                    "signal_id": "SIG20251121001",
                    "strategy_id": 1,
                    "strategy_name": "动量策略001",
                    "symbol": "600000",
                    "name": "浦发银行",
                    "action": "buy",  # buy/sell/hold
                    "confidence": 0.85,
                    "price": 10.5,
                    "recommended_quantity": 1000,
                    "reason": "20日动量突破，成交量放大",
                    "generated_at": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:417:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        分析交易信号

        Args:
            user_id: 用户ID
            strategy_ids: 策略ID列表，None表示所有启用的策略
            trade_date: 交易日期，None表示最新交易日

        Returns:
            List[Dict]: 交易信号列表

        示例返回:
            [
                {
                    "signal_id": "SIG20251121001",
                    "strategy_id": 1,
                    "strategy_name": "动量策略001",
                    "symbol": "600000",
                    "name": "浦发银行",
                    "action": "buy",  # buy/sell/hold
                    "confidence": 0.85,
                    "price": 10.5,
                    "recommended_quantity": 1000,
                    "reason": "20日动量突破，成交量放大",
                    "generated_at": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 500ms

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:431:1: D400 First line should end with a period
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:447:1: RST301 Unexpected indentation.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:457:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:458:1: RST401 Unexpected section title.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:459:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:463:1: RST301 Unexpected indentation.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:469:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:473:1: RST301 Unexpected indentation.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:475:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:476:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取持仓分析

        Args:
            user_id: 用户ID
            include_history: 是否包含历史持仓

        Returns:
            Dict: 持仓分析

        示例返回:
            {
                "user_id": 1001,
                "analysis_time": "2025-11-21 15:00:00",

                # 当前持仓
                "current_positions": [
                    {
                        "symbol": "600000",
                        "name": "浦发银行",
                        "quantity": 1000,
                        "cost_price": 10.0,
                        "current_price": 10.5,
                        "market_value": 10500.0,
                        "profit_loss": 500.0,
                        "profit_loss_percent": 5.0,
                        "weight": 0.15
                    },
                    ...
                ],

                # 持仓汇总
                "summary": {
                    "total_market_value": 70000.0,
                    "total_cost": 65000.0,
                    "total_profit_loss": 5000.0,
                    "total_return": 0.077,
                    "cash": 30000.0,
                    "total_assets": 100000.0
                },

                # 收益曲线（如果include_history=True）
                "equity_history": [
                    {"date": "2025-10-01", "equity": 95000.0},
                    {"date": "2025-11-21", "equity": 100000.0}
                ]
            }

        性能要求:
            - 不含历史: < 200ms
            - 含历史: < 500ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/business_data_source.py:492:1: D400 First line should end with a period
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:508:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:512:1: RST301 Unexpected indentation.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:516:1: RST301 Unexpected indentation.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:519:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:520:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:524:1: RST301 Unexpected indentation.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:528:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:532:1: RST301 Unexpected indentation.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:534:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:536:1: RST301 Unexpected indentation.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:537:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:538:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行归因分析

        Args:
            user_id: 用户ID
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 归因分析结果

        示例返回:
            {
                "period": {
                    "start_date": "2025-01-01",
                    "end_date": "2025-11-21",
                    "trading_days": 230
                },

                # 收益归因
                "return_attribution": {
                    "total_return": 0.077,
                    "market_return": 0.045,
                    "alpha": 0.032,
                    "attribution_breakdown": {
                        "sector_selection": 0.015,
                        "stock_selection": 0.020,
                        "timing": -0.003
                    }
                },

                # 行业贡献
                "sector_contribution": {
                    "金融": 0.025,
                    "科技": 0.035,
                    "消费": 0.012,
                    "其他": 0.005
                },

                # 个股贡献
                "top_contributors": [
                    {"symbol": "600000", "contribution": 0.015},
                    {"symbol": "000001", "contribution": 0.012}
                ],
                "top_detractors": [
                    {"symbol": "600001", "contribution": -0.008}
                ]
            }

        性能要求: < 1s

        Raises:
            DataSourceException: 分析失败
        """
^
src/interfaces/business_data_source.py:558:1: D400 First line should end with a period
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:563:1: RST301 Unexpected indentation.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:569:1: RST301 Unexpected indentation.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:571:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:572:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:573:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:589:1: RST301 Unexpected indentation.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:591:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:592:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:593:1: RST401 Unexpected section title.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:594:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        执行股票筛选

        Args:
            user_id: 用户ID
            criteria: 筛选条件
                     {
                         "price_range": [10.0, 50.0],
                         "change_range": [0, 10],
                         "volume_min": 1000000,
                         "industry": ["银行", "保险"],
                         "technical_indicators": {
                             "rsi": {"min": 30, "max": 70},
                             "ma5_above_ma10": True
                         }
                     }
            sort_by: 排序字段 (change_percent/volume/amount等)
            limit: 返回数量

        Returns:
            List[Dict]: 筛选结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "industry": "银行",
                    "technical_scores": {
                        "rsi": 55.2,
                        "macd": "golden_cross"
                    }
                },
                ...
            ]

        性能要求: < 1.5s

        Raises:
            DataSourceException: 筛选失败
            ValueError: 筛选条件无效
        """
^
src/interfaces/business_data_source.py:609:1: D400 First line should end with a period
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/business_data_source.py:619:1: RST301 Unexpected indentation.
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/business_data_source.py:620:80: E501 line too long (87 > 79 characters)
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """






       ^
src/interfaces/business_data_source.py:621:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/business_data_source.py:621:80: E501 line too long (86 > 79 characters)
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """






       ^
src/interfaces/business_data_source.py:623:1: RST301 Unexpected indentation.
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/business_data_source.py:626:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/business_data_source.py:628:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        业务数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "business",
                "dependencies": {
                    "timeseries_source": {"status": "healthy", "response_time_ms": 45},
                    "relational_source": {"status": "healthy", "response_time_ms": 25}
                },
                "cache_status": {
                    "enabled": True,
                    "hit_rate": 0.75,
                    "size_mb": 128
                },
                "last_calculation": "2025-11-21 14:59:55"
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/data_source.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：统一数据源接口定义，所有数据源适配器必须实现此接口
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/interfaces/data_source.py:1:1: D400 First line should end with a period
"""
# 功能：统一数据源接口定义，所有数据源适配器必须实现此接口
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/interfaces/data_source.py:18:1: D400 First line should end with a period
    """统一数据接口：定义所有数据源必须实现的方法"""
^
src/interfaces/data_source.py:24:1: D400 First line should end with a period
        """
        获取股票日线数据

        Args:
            symbol: 股票代码
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            DataFrame: 包含股票日线数据的DataFrame
                列包括: date, open, high, low, close, volume
        """
^
src/interfaces/data_source.py:42:1: D400 First line should end with a period
        """
        获取指数日线数据

        Args:
            symbol: 指数代码
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            DataFrame: 包含指数日线数据的DataFrame
                列包括: date, open, high, low, close, volume
        """
^
src/interfaces/data_source.py:58:1: D400 First line should end with a period
        """
        获取股票基本信息

        Args:
            symbol: 股票代码

        Returns:
            Dict[str, Any]: 包含股票基本信息的字典
                键包括: symbol, name, industry, market, list_date等
        """
^
src/interfaces/data_source.py:72:1: D400 First line should end with a period
        """
        获取指数成分股

        Args:
            symbol: 指数代码

        Returns:
            List[str]: 包含指数成分股代码的列表
        """
^
src/interfaces/data_source.py:85:1: D400 First line should end with a period
        """
        获取实时数据

        Args:
            symbol: 股票代码

        Returns:
            Optional[Dict[str, Any]]: 实时数据字典或None
                键包括: symbol, price, volume, timestamp等
        """
^
src/interfaces/data_source.py:98:80: E501 line too long (82 > 79 characters)
    def get_market_calendar(self, start_date: str, end_date: str) -> pd.DataFrame:
                                                                               ^
src/interfaces/data_source.py:99:1: D400 First line should end with a period
        """
        获取交易日历

        Args:
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            pd.DataFrame: 交易日历数据
                列包括: date, is_trading_day, market
        """
^
src/interfaces/data_source.py:113:80: E501 line too long (86 > 79 characters)
    def get_financial_data(self, symbol: str, period: str = "annual") -> pd.DataFrame:
                                                                               ^
src/interfaces/data_source.py:114:1: D400 First line should end with a period
        """
        获取财务数据

        Args:
            symbol: 股票代码
            period: 报告期间，"annual"或"quarterly"

        Returns:
            pd.DataFrame: 财务数据
                列包括: symbol, end_date, revenue, net_profit等
        """
^
src/interfaces/data_source.py:131:1: D400 First line should end with a period
        """
        获取新闻数据

        Args:
            symbol: 股票代码，为None时获取市场新闻
            limit: 返回数量限制

        Returns:
            List[Dict[str, Any]]: 新闻数据列表
                每个字典包含: title, content, timestamp, source等
        """
^
src/interfaces/data_source_interface.py:1:1: D205 1 blank line required between summary line and description
"""
数据源接口定义 - 统一接口标准
定义所有数据源必须实现的方法和返回格式
"""
^
src/interfaces/data_source_interface.py:1:1: D400 First line should end with a period
"""
数据源接口定义 - 统一接口标准
定义所有数据源必须实现的方法和返回格式
"""
^
src/interfaces/data_source_interface.py:12:1: D205 1 blank line required between summary line and description
    """
    数据源统一接口
    所有数据源实现类必须继承此接口并实现所有方法
    """
^
src/interfaces/data_source_interface.py:12:1: D400 First line should end with a period
    """
    数据源统一接口
    所有数据源实现类必须继承此接口并实现所有方法
    """
^
src/interfaces/data_source_interface.py:19:1: D400 First line should end with a period
        """
        获取股票列表

        Args:
            params: Dict - 查询参数：
                    exchange: Optional[str] - 交易所筛选
                    limit: int - 每页数量，默认20
                    offset: int - 偏移量，默认0

        Returns:
            List[Dict]: 股票列表数据
        """
^
src/interfaces/data_source_interface.py:35:1: D400 First line should end with a period
        """
        获取股票详细信息

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 股票详细信息
        """
^
src/interfaces/data_source_interface.py:48:1: D400 First line should end with a period
        """
        获取实时行情

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 实时行情数据
        """
^
src/interfaces/data_source_interface.py:60:80: E501 line too long (82 > 79 characters)
    def get_history_profit(self, stock_code: str, days: int = 30) -> pd.DataFrame:
                                                                               ^
src/interfaces/data_source_interface.py:61:1: D400 First line should end with a period
        """
        获取历史收益

        Args:
            stock_code: str - 股票代码
            days: int - 天数，默认30天

        Returns:
            pd.DataFrame: 历史收益数据
        """
^
src/interfaces/data_source_interface.py:77:1: D400 First line should end with a period
        """
        获取技术指标

        Args:
            stock_code: str - 股票代码
            start_date: str - 开始日期
            end_date: str - 结束日期

        Returns:
            List[Dict]: 技术指标数据列表
        """
^
src/interfaces/data_source_interface.py:92:1: D400 First line should end with a period
        """
        获取所有技术指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 所有技术指标数据
        """
^
src/interfaces/data_source_interface.py:105:1: D400 First line should end with a period
        """
        获取趋势指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 趋势指标数据
        """
^
src/interfaces/data_source_interface.py:118:1: D400 First line should end with a period
        """
        获取动量指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 动量指标数据
        """
^
src/interfaces/data_source_interface.py:131:1: D400 First line should end with a period
        """
        获取波动率指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 波动率指标数据
        """
^
src/interfaces/data_source_interface.py:144:1: D400 First line should end with a period
        """
        获取成交量指标

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 成交量指标数据
        """
^
src/interfaces/data_source_interface.py:157:1: D400 First line should end with a period
        """
        获取交易信号

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 交易信号数据
        """
^
src/interfaces/data_source_interface.py:170:1: D400 First line should end with a period
        """
        获取K线历史数据

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: K线历史数据
        """
^
src/interfaces/data_source_interface.py:183:1: D400 First line should end with a period
        """
        获取形态识别结果

        Args:
            stock_code: str - 股票代码

        Returns:
            Dict: 形态识别结果
        """
^
src/interfaces/data_source_interface.py:196:1: D400 First line should end with a period
        """
        获取实时告警

        Args:
            params: Dict - 查询参数：
                    limit: int - 返回记录数，默认50
                    offset: int - 偏移量，默认0
                    is_read: bool - 是否已读，None表示全部

        Returns:
            List[Dict]: 实时告警数据
        """
^
src/interfaces/data_source_interface.py:212:1: D400 First line should end with a period
        """
        获取监控摘要

        Returns:
            Dict: 监控摘要数据
        """
^
src/interfaces/data_source_interface.py:222:1: D400 First line should end with a period
        """
        获取监控状态

        Returns:
            Dict: 监控状态信息
        """
^
src/interfaces/data_source_interface.py:232:1: D400 First line should end with a period
        """
        获取市场监控数据

        Returns:
            Dict: 市场监控数据
        """
^
src/interfaces/data_source_interface.py:242:1: D400 First line should end with a period
        """
        获取预定义查询列表

        Returns:
            Dict: 预定义查询列表
        """
^
src/interfaces/data_source_interface.py:252:1: D400 First line should end with a period
        """
        执行预定义查询

        Args:
            request: Dict - 请求参数：
                    query_name: str - 查询名称
                    pages: int - 页数

        Returns:
            Dict: 查询执行结果
        """
^
src/interfaces/data_source_interface.py:267:1: D400 First line should end with a period
        """
        执行自定义查询

        Args:
            request: Dict - 请求参数：
                    query_text: str - 自定义查询文本
                    pages: int - 页数

        Returns:
            Dict: 自定义查询结果
        """
^
src/interfaces/data_source_interface.py:284:1: D400 First line should end with a period
        """
        获取查询结果

        Args:
            query_name: str - 查询名称
            limit: int - 每页数量
            offset: int - 偏移量

        Returns:
            Dict: 查询结果数据
        """
^
src/interfaces/data_source_interface.py:299:1: D400 First line should end with a period
        """
        获取策略定义列表

        Returns:
            Dict: 策略定义列表
        """
^
src/interfaces/data_source_interface.py:309:1: D400 First line should end with a period
        """
        单策略运行

        Args:
            request: Dict - 请求参数：
                    strategy_code: str - 策略代码
                    parameters: Dict - 策略参数
                    date_range: Dict - 日期范围

        Returns:
            Dict: 策略运行结果
        """
^
src/interfaces/data_source_interface.py:325:1: D400 First line should end with a period
        """
        批量策略运行

        Args:
            request: Dict - 请求参数：
                    strategy_codes: List[str] - 策略代码列表
                    parameters: Dict - 策略参数
                    date_range: Dict - 日期范围

        Returns:
            Dict: 批量策略运行结果
        """
^
src/interfaces/data_source_interface.py:341:1: D400 First line should end with a period
        """
        获取策略结果

        Args:
            request: Dict - 请求参数：
                    strategy_code: str - 策略代码
                    limit: int - 限制数量
                    offset: int - 偏移量

        Returns:
            Dict: 策略结果数据
        """
^
src/interfaces/data_source_interface.py:357:1: D400 First line should end with a period
        """
        获取匹配的股票

        Args:
            request: Dict - 请求参数：
                    strategy_code: str - 策略代码
                    filters: Dict - 筛选条件

        Returns:
            Dict: 匹配股票数据
        """
^
src/interfaces/data_source_interface.py:372:1: D400 First line should end with a period
        """
        获取策略统计

        Returns:
            Dict: 策略统计数据
        """
^
src/interfaces/data_source_interface.py:382:1: D400 First line should end with a period
        """
        获取指标列表

        Args:
            params: Dict - 查询参数：
                    category: Optional[str] - 指标分类
                    limit: int - 每页数量
                    offset: int - 偏移量

        Returns:
            List[Dict]: 指标列表
        """
^
src/interfaces/data_source_interface.py:398:1: D400 First line should end with a period
        """
        获取指标详情

        Args:
            indicator_id: str - 指标ID

        Returns:
            Dict: 指标详情
        """
^
src/interfaces/data_source_interface.py:413:1: D400 First line should end with a period
        """
        获取指标数据表格

        Args:
            indicator_id: str - 指标ID
            symbol: str - 股票代码
            days: int - 天数

        Returns:
            pd.DataFrame: 指标数据表格
        """
^
src/interfaces/data_source_interface.py:430:1: D400 First line should end with a period
        """
        从指定适配器获取数据（统一适配器调用入口）

        Args:
            adapter_type: str - 适配器类型 (akshare, tdx, baostock, tushare等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/interfaces/data_source_interface.py:433:1: RST210 Inline strong start-string without end-string.
        """
        从指定适配器获取数据（统一适配器调用入口）

        Args:
            adapter_type: str - 适配器类型 (akshare, tdx, baostock, tushare等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/interfaces/data_source_interface.py:447:1: D400 First line should end with a period
        """
        使用故障转移机制获取数据

        Args:
            data_type: str - 数据类型 (realtime_quote, daily_kline等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/interfaces/data_source_interface.py:450:1: RST210 Inline strong start-string without end-string.
        """
        使用故障转移机制获取数据

        Args:
            data_type: str - 数据类型 (realtime_quote, daily_kline等)
            method: str - 调用方法名
            **kwargs: 方法参数

        Returns:
            Union[Dict, List[Dict], pd.DataFrame]: 适配器返回的数据
        """
^
src/interfaces/data_source_interface.py:466:1: D400 First line should end with a period
        """
        获取分钟K线数据

        Args:
            symbol: str - 股票代码
            period: str - 周期 (1m/5m/15m/30m/60m)
            start_date: str - 开始日期
            end_date: str - 结束日期

        Returns:
            pd.DataFrame: 分钟K线数据
        """
^
src/interfaces/data_source_interface.py:482:1: D400 First line should end with a period
        """
        获取行业分类数据

        Returns:
            pd.DataFrame: 行业分类数据
        """
^
src/interfaces/data_source_interface.py:492:1: D400 First line should end with a period
        """
        获取概念分类数据

        Returns:
            pd.DataFrame: 概念分类数据
        """
^
src/interfaces/data_source_interface.py:502:1: D400 First line should end with a period
        """
        获取个股的行业和概念分类信息

        Args:
            symbol: str - 股票代码

        Returns:
            Dict: 个股行业和概念信息
        """
^
src/interfaces/refactored_interfaces.py:1:1: D205 1 blank line required between summary line and description
"""
MyStocks重构版接口定义 - 接口分离和简化
基于Interface Segregation Principle的现代化接口设计

版本: 3.0.0
创建日期: 2025-11-14
作者: Claude Code
"""
^
src/interfaces/refactored_interfaces.py:1:1: D400 First line should end with a period
"""
MyStocks重构版接口定义 - 接口分离和简化
基于Interface Segregation Principle的现代化接口设计

版本: 3.0.0
创建日期: 2025-11-14
作者: Claude Code
"""
^
src/interfaces/refactored_interfaces.py:23:1: D400 First line should end with a period
    """标准数据响应格式 - 统一所有数据源的返回格式"""
^
src/interfaces/refactored_interfaces.py:32:1: D400 First line should end with a period
        """初始化后处理"""
^
src/interfaces/refactored_interfaces.py:40:80: E501 line too long (88 > 79 characters)
        cls, data: Union[pd.DataFrame, Dict, List, str], metadata: Optional[Dict] = None
                                                                               ^
src/interfaces/refactored_interfaces.py:42:1: D400 First line should end with a period
        """创建成功响应"""
^
src/interfaces/refactored_interfaces.py:49:1: D400 First line should end with a period
        """创建错误响应"""
^
src/interfaces/refactored_interfaces.py:54:1: D400 First line should end with a period
        """创建空数据响应"""
^
src/interfaces/refactored_interfaces.py:64:1: D400 First line should end with a period
    """核心价格数据接口 - 所有数据源的基础要求

    这个接口定义了数据源必须实现的核心价格数据功能。
    所有适配器必须实现这些基础方法。
    """
^
src/interfaces/refactored_interfaces.py:74:1: D400 First line should end with a period
        """获取股票日线数据

        Args:
            symbol: 股票代码，如 '600000', '000001'
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            DataResponse: 包含日线数据的响应
                - success=True时，data为包含['date', 'symbol', 'open', 'high', 'low', 'close', 'volume', 'amount']的DataFrame
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:83:80: E501 line too long (119 > 79 characters)
        """获取股票日线数据

        Args:
            symbol: 股票代码，如 '600000', '000001'
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            DataResponse: 包含日线数据的响应
                - success=True时，data为包含['date', 'symbol', 'open', 'high', 'low', 'close', 'volume', 'amount']的DataFrame
                - success=False时，error包含错误信息
        """



                                            ^
src/interfaces/refactored_interfaces.py:90:1: D400 First line should end with a period
        """获取实时数据

        Args:
            symbol: 股票代码，如 '600000', '000001'

        Returns:
            DataResponse: 包含实时数据的响应
                - success=True时，data为包含最新价格、成交量等信息的字典
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:109:1: D400 First line should end with a period
    """指数数据接口 - 仅需要指数功能的实现

    这个接口定义了指数相关的功能。
    仅当数据源支持指数数据时才需要实现。
    """
^
src/interfaces/refactored_interfaces.py:119:1: D400 First line should end with a period
        """获取指数日线数据

        Args:
            symbol: 指数代码，如 '000001', '399001'
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            DataResponse: 包含指数日线数据的响应
        """
^
src/interfaces/refactored_interfaces.py:133:1: D400 First line should end with a period
        """获取指数成分股

        Args:
            symbol: 指数代码，如 '000001', '399001'

        Returns:
            DataResponse: 包含成分股列表的响应
                - success=True时，data为包含股票代码的List[str]
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:152:1: D400 First line should end with a period
    """基础信息接口 - 仅需要基础信息的实现

    这个接口定义了股票基本信息和市场日历等基础功能。
    仅当数据源支持基础信息时才需要实现。
    """
^
src/interfaces/refactored_interfaces.py:160:1: D400 First line should end with a period
        """获取股票基本信息

        Args:
            symbol: 股票代码，如 '600000', '000001'

        Returns:
            DataResponse: 包含股票基本信息的响应
                - success=True时，data为包含['code', 'name', 'industry', 'area']等信息的字典
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:167:80: E501 line too long (81 > 79 characters)
        """获取股票基本信息

        Args:
            symbol: 股票代码，如 '600000', '000001'

        Returns:
            DataResponse: 包含股票基本信息的响应
                - success=True时，data为包含['code', 'name', 'industry', 'area']等信息的字典
                - success=False时，error包含错误信息
        """



                                            ^
src/interfaces/refactored_interfaces.py:173:80: E501 line too long (82 > 79 characters)
    def get_market_calendar(self, start_date: str, end_date: str) -> DataResponse:
                                                                               ^
src/interfaces/refactored_interfaces.py:174:1: D400 First line should end with a period
        """获取交易日历

        Args:
            start_date: 开始日期，格式：YYYY-MM-DD
            end_date: 结束日期，格式：YYYY-MM-DD

        Returns:
            DataResponse: 包含交易日历的响应
                - success=True时，data为包含交易日信息的DataFrame
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:194:1: D400 First line should end with a period
    """高级数据接口 - 需要财务和新闻数据的实现

    这个接口定义了财务数据和新闻数据等高级功能。
    仅当数据源支持高级数据时才需要实现。
    """
^
src/interfaces/refactored_interfaces.py:201:80: E501 line too long (86 > 79 characters)
    def get_financial_data(self, symbol: str, period: str = "annual") -> DataResponse:
                                                                               ^
src/interfaces/refactored_interfaces.py:202:1: D400 First line should end with a period
        """获取财务数据

        Args:
            symbol: 股票代码，如 '600000', '000001'
            period: 报告期间，"annual"(年度)或"quarterly"(季度)

        Returns:
            DataResponse: 包含财务数据的响应
                - success=True时，data为包含财务指标的DataFrame
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:219:1: D400 First line should end with a period
        """获取新闻数据

        Args:
            symbol: 股票代码，为None时获取市场新闻
            limit: 返回数量限制，默认10条

        Returns:
            DataResponse: 包含新闻数据的响应
                - success=True时，data为包含新闻信息的List[Dict]
                - success=False时，error包含错误信息
        """
^
src/interfaces/refactored_interfaces.py:241:1: D400 First line should end with a period
    """完整数据接口 - 向后兼容的组合接口

    这个接口提供了完整的向后兼容性。
    现有代码可以继续使用这个接口，新的适配器可以选择实现特化的子接口。

    注意: 实现这个接口需要实现所有8个方法。
    建议新开发的数据源实现相应的特化接口。
    """
^
src/interfaces/refactored_interfaces.py:259:1: D400 First line should end with a period
    """数据源工厂 - 支持接口版本管理和动态适配"""
^
src/interfaces/refactored_interfaces.py:265:1: D400 First line should end with a period
        """注册数据源类"""
^
src/interfaces/refactored_interfaces.py:270:1: D400 First line should end with a period
        """创建数据源实例"""
^
src/interfaces/refactored_interfaces.py:279:1: D400 First line should end with a period
        """获取支持的数据源列表"""
^
src/interfaces/refactored_interfaces.py:289:1: D400 First line should end with a period
    """验证股票代码格式

    Args:
        symbol: 股票代码

    Returns:
        bool: 是否为有效的股票代码格式
    """
^
src/interfaces/refactored_interfaces.py:305:1: D400 First line should end with a period
    """验证日期格式

    Args:
        date_str: 日期字符串

    Returns:
        bool: 是否为有效的日期格式 (YYYY-MM-DD)
    """
^
src/interfaces/refactored_interfaces.py:328:1: D400 First line should end with a period
    """标准化响应格式

    Args:
        data: 要包装的数据
        metadata: 元数据信息

    Returns:
        DataResponse: 标准化的响应
    """
^
src/interfaces/refactored_interfaces.py:346:1: D400 First line should end with a period
    """数据源基类 - 提供通用功能"""
^
src/interfaces/refactored_interfaces.py:348:1: D107 Missing docstring in __init__
    def __init__(self, name: str):
^
src/interfaces/refactored_interfaces.py:355:1: D400 First line should end with a period
        """验证输入参数"""
^
src/interfaces/refactored_interfaces.py:368:1: D400 First line should end with a period
        """创建错误响应"""
^
src/interfaces/relational_data_source.py:1:1: D400 First line should end with a period
"""
关系数据源抽象接口

本模块定义关系数据源的统一接口，所有关系数据源（Mock、PostgreSQL等）必须实现此接口。
关系数据主要包括：自选股配置、策略参数、用户设置、风险配置等结构化关系数据。

适用数据库: PostgreSQL (关系型数据库)
适用场景: 用户配置、策略管理、系统设置

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/interfaces/relational_data_source.py:20:1: D400 First line should end with a period
    """
    关系数据源抽象接口

    所有关系数据源实现必须遵循此接口规范，确保：
    1. 方法签名一致
    2. 返回数据格式统一
    3. 支持事务操作
    4. 异常处理规范

    实现类:
    - MockRelationalDataSource: Mock数据实现（开发测试）
    - PostgreSQLRelationalDataSource: PostgreSQL数据库实现（生产）
    """
^
src/interfaces/relational_data_source.py:38:80: E501 line too long (88 > 79 characters)
        self, user_id: int, list_type: str = "favorite", include_stock_info: bool = True
                                                                               ^
src/interfaces/relational_data_source.py:40:1: D400 First line should end with a period
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:45:1: RST301 Unexpected indentation.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:49:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:64:1: RST301 Unexpected indentation.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:67:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:68:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:69:1: RST401 Unexpected section title.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:70:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取自选股列表

        Args:
            user_id: 用户ID
            list_type: 列表类型
                      - "favorite": 自选股
                      - "strategy": 策略选股
                      - "industry": 行业选股
                      - "concept": 概念选股
            include_stock_info: 是否包含股票基础信息

        Returns:
            List[Dict]: 自选股列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "list_type": "favorite",
                    "added_at": "2025-10-15 10:30:00",
                    "note": "长期持有",
                    "stock_info": {  # include_stock_info=True时包含
                        "name": "浦发银行",
                        "industry": "银行",
                        "market": "上海"
                    }
                },
                ...
            ]

        性能要求:
            - 不含股票信息: < 50ms
            - 含股票信息: < 150ms (使用joinedload避免N+1查询)

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/relational_data_source.py:90:1: D400 First line should end with a period
        """
        添加股票到自选列表

        Args:
            user_id: 用户ID
            symbol: 股票代码
            list_type: 列表类型
            note: 备注信息

        Returns:
            Dict: 添加成功的记录

        示例返回:
            {
                "id": 123,
                "user_id": 1001,
                "symbol": "600000",
                "list_type": "favorite",
                "added_at": "2025-11-21 14:30:00",
                "note": "长期持有"
            }

        性能要求: < 100ms

        Raises:
            DataSourceException: 添加失败
            ValueError: 股票代码无效或已存在
        """
^
src/interfaces/relational_data_source.py:109:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        添加股票到自选列表

        Args:
            user_id: 用户ID
            symbol: 股票代码
            list_type: 列表类型
            note: 备注信息

        Returns:
            Dict: 添加成功的记录

        示例返回:
            {
                "id": 123,
                "user_id": 1001,
                "symbol": "600000",
                "list_type": "favorite",
                "added_at": "2025-11-21 14:30:00",
                "note": "长期持有"
            }

        性能要求: < 100ms

        Raises:
            DataSourceException: 添加失败
            ValueError: 股票代码无效或已存在
        """
^
src/interfaces/relational_data_source.py:124:1: D400 First line should end with a period
        """
        从自选列表移除股票

        Args:
            user_id: 用户ID
            symbol: 股票代码
            list_type: 列表类型，None表示删除所有类型的记录

        Returns:
            bool: 是否删除成功

        性能要求: < 80ms

        Raises:
            DataSourceException: 删除失败
        """
^
src/interfaces/relational_data_source.py:146:1: D400 First line should end with a period
        """
        更新自选股备注

        Args:
            user_id: 用户ID
            symbol: 股票代码
            list_type: 列表类型
            note: 新的备注

        Returns:
            bool: 是否更新成功

        性能要求: < 80ms

        Raises:
            DataSourceException: 更新失败
        """
^
src/interfaces/relational_data_source.py:174:1: D400 First line should end with a period
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:179:1: RST301 Unexpected indentation.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:183:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:200:1: RST301 Unexpected indentation.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:203:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:207:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:208:1: RST401 Unexpected section title.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:209:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取策略配置列表

        Args:
            user_id: 用户ID
            strategy_type: 策略类型过滤
                          - "momentum": 动量策略
                          - "mean_reversion": 均值回归
                          - "grid": 网格交易
                          - "arbitrage": 套利策略
            status: 状态过滤
                   - "active": 激活
                   - "inactive": 未激活
                   - "backtesting": 回测中

        Returns:
            List[Dict]: 策略配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "name": "动量策略001",
                    "strategy_type": "momentum",
                    "status": "active",
                    "parameters": {
                        "lookback_period": 20,
                        "entry_threshold": 0.02,
                        "exit_threshold": -0.01
                    },
                    "created_at": "2025-10-01 10:00:00",
                    "updated_at": "2025-11-15 14:30:00",
                    "description": "20日动量突破策略"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:228:1: D400 First line should end with a period
        """
        保存策略配置

        Args:
            user_id: 用户ID
            name: 策略名称
            strategy_type: 策略类型
            parameters: 策略参数（JSON格式）
            description: 策略描述

        Returns:
            Dict: 保存成功的策略配置

        性能要求: < 150ms

        Raises:
            DataSourceException: 保存失败
            ValueError: 参数验证失败
        """
^
src/interfaces/relational_data_source.py:253:1: D400 First line should end with a period
        """
        更新策略状态

        Args:
            strategy_id: 策略ID
            user_id: 用户ID（权限验证）
            status: 新状态 (active/inactive/backtesting)

        Returns:
            bool: 是否更新成功

        性能要求: < 80ms

        Raises:
            DataSourceException: 更新失败
            PermissionError: 用户无权限
        """
^
src/interfaces/relational_data_source.py:274:1: D400 First line should end with a period
        """
        删除策略配置

        Args:
            strategy_id: 策略ID
            user_id: 用户ID（权限验证）

        Returns:
            bool: 是否删除成功

        性能要求: < 100ms

        Raises:
            DataSourceException: 删除失败
            PermissionError: 用户无权限
        """
^
src/interfaces/relational_data_source.py:302:1: D400 First line should end with a period
        """
        获取风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码过滤
            alert_type: 预警类型
                       - "price": 价格预警
                       - "change": 涨跌幅预警
                       - "volume": 成交量预警
                       - "position": 持仓风险
            enabled_only: 是否只返回启用的预警

        Returns:
            List[Dict]: 风险预警配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "enabled": True,
                    "notification_methods": ["email", "sms"],
                    "created_at": "2025-11-01 10:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:308:1: RST301 Unexpected indentation.
        """
        获取风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码过滤
            alert_type: 预警类型
                       - "price": 价格预警
                       - "change": 涨跌幅预警
                       - "volume": 成交量预警
                       - "position": 持仓风险
            enabled_only: 是否只返回启用的预警

        Returns:
            List[Dict]: 风险预警配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "enabled": True,
                    "notification_methods": ["email", "sms"],
                    "created_at": "2025-11-01 10:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:312:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码过滤
            alert_type: 预警类型
                       - "price": 价格预警
                       - "change": 涨跌幅预警
                       - "volume": 成交量预警
                       - "position": 持仓风险
            enabled_only: 是否只返回启用的预警

        Returns:
            List[Dict]: 风险预警配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "enabled": True,
                    "notification_methods": ["email", "sms"],
                    "created_at": "2025-11-01 10:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:329:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码过滤
            alert_type: 预警类型
                       - "price": 价格预警
                       - "change": 涨跌幅预警
                       - "volume": 成交量预警
                       - "position": 持仓风险
            enabled_only: 是否只返回启用的预警

        Returns:
            List[Dict]: 风险预警配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "enabled": True,
                    "notification_methods": ["email", "sms"],
                    "created_at": "2025-11-01 10:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:330:1: RST401 Unexpected section title.
        """
        获取风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码过滤
            alert_type: 预警类型
                       - "price": 价格预警
                       - "change": 涨跌幅预警
                       - "volume": 成交量预警
                       - "position": 持仓风险
            enabled_only: 是否只返回启用的预警

        Returns:
            List[Dict]: 风险预警配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "enabled": True,
                    "notification_methods": ["email", "sms"],
                    "created_at": "2025-11-01 10:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:331:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码过滤
            alert_type: 预警类型
                       - "price": 价格预警
                       - "change": 涨跌幅预警
                       - "volume": 成交量预警
                       - "position": 持仓风险
            enabled_only: 是否只返回启用的预警

        Returns:
            List[Dict]: 风险预警配置列表

        示例返回:
            [
                {
                    "id": 1,
                    "user_id": 1001,
                    "symbol": "600000",
                    "alert_type": "price",
                    "condition": ">=",
                    "threshold": 12.0,
                    "enabled": True,
                    "notification_methods": ["email", "sms"],
                    "created_at": "2025-11-01 10:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:352:1: D400 First line should end with a period
        """
        保存风险预警配置

        Args:
            user_id: 用户ID
            symbol: 股票代码
            alert_type: 预警类型
            condition: 条件 (>=, <=, >, <, ==)
            threshold: 阈值
            notification_methods: 通知方式 ["email", "sms", "webhook"]
            enabled: 是否启用

        Returns:
            Dict: 保存的预警配置

        性能要求: < 120ms

        Raises:
            DataSourceException: 保存失败
            ValueError: 参数验证失败
        """
^
src/interfaces/relational_data_source.py:376:80: E501 line too long (84 > 79 characters)
    def toggle_risk_alert(self, alert_id: int, user_id: int, enabled: bool) -> bool:
                                                                               ^
src/interfaces/relational_data_source.py:377:1: D400 First line should end with a period
        """
        启用/禁用风险预警

        Args:
            alert_id: 预警ID
            user_id: 用户ID（权限验证）
            enabled: 是否启用

        Returns:
            bool: 是否更新成功

        性能要求: < 80ms

        Raises:
            DataSourceException: 更新失败
            PermissionError: 用户无权限
        """
^
src/interfaces/relational_data_source.py:400:1: D400 First line should end with a period
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:412:1: RST301 Unexpected indentation.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:415:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:417:1: RST301 Unexpected indentation.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:420:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:422:1: RST301 Unexpected indentation.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:424:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:426:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取用户偏好设置

        Args:
            user_id: 用户ID

        Returns:
            Dict: 用户偏好设置

        示例返回:
            {
                "user_id": 1001,
                "display_settings": {
                    "theme": "dark",
                    "language": "zh_CN",
                    "chart_type": "candle"
                },
                "notification_settings": {
                    "email_enabled": True,
                    "sms_enabled": False,
                    "push_enabled": True
                },
                "trading_settings": {
                    "default_order_type": "limit",
                    "confirm_before_trade": True
                },
                "updated_at": "2025-11-15 10:30:00"
            }

        性能要求: < 80ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:440:1: D400 First line should end with a period
        """
        更新用户偏好设置

        Args:
            user_id: 用户ID
            preferences: 新的偏好设置（部分更新）

        Returns:
            bool: 是否更新成功

        性能要求: < 100ms

        Raises:
            DataSourceException: 更新失败
            ValueError: 设置格式无效
        """
^
src/interfaces/relational_data_source.py:467:1: D400 First line should end with a period
        """
        获取股票基础信息

        Args:
            symbols: 股票代码列表，None表示获取全部
            market: 市场过滤 (上海/深圳)
            industry: 行业过滤

        Returns:
            List[Dict]: 股票基础信息列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "market": "上海",
                    "industry": "银行",
                    "sector": "金融",
                    "list_date": "1999-11-10",
                    "total_shares": 29352000000,
                    "float_shares": 29352000000
                },
                ...
            ]

        性能要求:
            - 单个股票: < 50ms
            - 批量查询(100个): < 200ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:488:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取股票基础信息

        Args:
            symbols: 股票代码列表，None表示获取全部
            market: 市场过滤 (上海/深圳)
            industry: 行业过滤

        Returns:
            List[Dict]: 股票基础信息列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "market": "上海",
                    "industry": "银行",
                    "sector": "金融",
                    "list_date": "1999-11-10",
                    "total_shares": 29352000000,
                    "float_shares": 29352000000
                },
                ...
            ]

        性能要求:
            - 单个股票: < 50ms
            - 批量查询(100个): < 200ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:489:1: RST401 Unexpected section title.
        """
        获取股票基础信息

        Args:
            symbols: 股票代码列表，None表示获取全部
            market: 市场过滤 (上海/深圳)
            industry: 行业过滤

        Returns:
            List[Dict]: 股票基础信息列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "market": "上海",
                    "industry": "银行",
                    "sector": "金融",
                    "list_date": "1999-11-10",
                    "total_shares": 29352000000,
                    "float_shares": 29352000000
                },
                ...
            ]

        性能要求:
            - 单个股票: < 50ms
            - 批量查询(100个): < 200ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:490:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取股票基础信息

        Args:
            symbols: 股票代码列表，None表示获取全部
            market: 市场过滤 (上海/深圳)
            industry: 行业过滤

        Returns:
            List[Dict]: 股票基础信息列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "market": "上海",
                    "industry": "银行",
                    "sector": "金融",
                    "list_date": "1999-11-10",
                    "total_shares": 29352000000,
                    "float_shares": 29352000000
                },
                ...
            ]

        性能要求:
            - 单个股票: < 50ms
            - 批量查询(100个): < 200ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:503:80: E501 line too long (83 > 79 characters)
    def search_stocks(self, keyword: str, limit: int = 20) -> List[Dict[str, Any]]:
                                                                               ^
src/interfaces/relational_data_source.py:504:1: D400 First line should end with a period
        """
        搜索股票

        Args:
            keyword: 关键词（支持代码、名称、拼音首字母）
            limit: 返回数量限制

        Returns:
            List[Dict]: 搜索结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "pinyin": "PFYH",
                    "market": "上海",
                    "match_type": "name"  # code/name/pinyin
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 搜索失败
        """
^
src/interfaces/relational_data_source.py:521:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        搜索股票

        Args:
            keyword: 关键词（支持代码、名称、拼音首字母）
            limit: 返回数量限制

        Returns:
            List[Dict]: 搜索结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "pinyin": "PFYH",
                    "market": "上海",
                    "match_type": "name"  # code/name/pinyin
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 搜索失败
        """
^
src/interfaces/relational_data_source.py:522:1: RST401 Unexpected section title.
        """
        搜索股票

        Args:
            keyword: 关键词（支持代码、名称、拼音首字母）
            limit: 返回数量限制

        Returns:
            List[Dict]: 搜索结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "pinyin": "PFYH",
                    "market": "上海",
                    "match_type": "name"  # code/name/pinyin
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 搜索失败
        """
^
src/interfaces/relational_data_source.py:523:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        搜索股票

        Args:
            keyword: 关键词（支持代码、名称、拼音首字母）
            limit: 返回数量限制

        Returns:
            List[Dict]: 搜索结果

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "pinyin": "PFYH",
                    "market": "上海",
                    "match_type": "name"  # code/name/pinyin
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 搜索失败
        """
^
src/interfaces/relational_data_source.py:536:80: E501 line too long (84 > 79 characters)
    def get_industry_list(self, classification: str = "sw") -> List[Dict[str, Any]]:
                                                                               ^
src/interfaces/relational_data_source.py:537:1: D400 First line should end with a period
        """
        获取行业分类列表

        Args:
            classification: 分类标准
                           - "sw": 申万行业
                           - "csrc": 证监会行业
                           - "zjh": 中金行业

        Returns:
            List[Dict]: 行业列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "level": 1,
                    "parent_code": None,
                    "stock_count": 123
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:556:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取行业分类列表

        Args:
            classification: 分类标准
                           - "sw": 申万行业
                           - "csrc": 证监会行业
                           - "zjh": 中金行业

        Returns:
            List[Dict]: 行业列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "level": 1,
                    "parent_code": None,
                    "stock_count": 123
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:557:1: RST401 Unexpected section title.
        """
        获取行业分类列表

        Args:
            classification: 分类标准
                           - "sw": 申万行业
                           - "csrc": 证监会行业
                           - "zjh": 中金行业

        Returns:
            List[Dict]: 行业列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "level": 1,
                    "parent_code": None,
                    "stock_count": 123
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:558:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取行业分类列表

        Args:
            classification: 分类标准
                           - "sw": 申万行业
                           - "csrc": 证监会行业
                           - "zjh": 中金行业

        Returns:
            List[Dict]: 行业列表

        示例返回:
            [
                {
                    "code": "801010",
                    "name": "农林牧渔",
                    "level": 1,
                    "parent_code": None,
                    "stock_count": 123
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:570:1: D400 First line should end with a period
        """
        获取概念板块列表

        Returns:
            List[Dict]: 概念列表

        示例返回:
            [
                {
                    "code": "BK0001",
                    "name": "人工智能",
                    "stock_count": 234,
                    "updated_at": "2025-11-21"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:582:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取概念板块列表

        Returns:
            List[Dict]: 概念列表

        示例返回:
            [
                {
                    "code": "BK0001",
                    "name": "人工智能",
                    "stock_count": 234,
                    "updated_at": "2025-11-21"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:583:1: RST401 Unexpected section title.
        """
        获取概念板块列表

        Returns:
            List[Dict]: 概念列表

        示例返回:
            [
                {
                    "code": "BK0001",
                    "name": "人工智能",
                    "stock_count": 234,
                    "updated_at": "2025-11-21"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:584:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取概念板块列表

        Returns:
            List[Dict]: 概念列表

        示例返回:
            [
                {
                    "code": "BK0001",
                    "name": "人工智能",
                    "stock_count": 234,
                    "updated_at": "2025-11-21"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:596:1: D400 First line should end with a period
        """
        获取行业成分股

        Args:
            industry_code: 行业代码

        Returns:
            List[str]: 股票代码列表

        性能要求: < 120ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:614:1: D400 First line should end with a period
        """
        获取概念成分股

        Args:
            concept_code: 概念代码

        Returns:
            List[str]: 股票代码列表

        性能要求: < 120ms

        Raises:
            DataSourceException: 查询失败
        """
^
src/interfaces/relational_data_source.py:634:1: D400 First line should end with a period
        """
        开始事务

        Returns:
            事务对象

        用于需要原子性操作的场景，例如批量更新
        """
^
src/interfaces/relational_data_source.py:646:1: D400 First line should end with a period
        """
        提交事务

        Args:
            transaction: 事务对象
        """
^
src/interfaces/relational_data_source.py:656:1: D400 First line should end with a period
        """
        回滚事务

        Args:
            transaction: 事务对象
        """
^
src/interfaces/relational_data_source.py:666:1: D400 First line should end with a period
        """
        关系数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "postgresql",
                "response_time_ms": 25,
                "connection_pool": {
                    "size": 20,
                    "in_use": 5,
                    "available": 15
                },
                "last_query": "2025-11-21 14:59:58",
                "metrics": {
                    "total_queries_today": 8765,
                    "avg_response_time_ms": 32,
                    "slow_queries_count": 5
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/relational_data_source.py:677:1: RST301 Unexpected indentation.
        """
        关系数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "postgresql",
                "response_time_ms": 25,
                "connection_pool": {
                    "size": 20,
                    "in_use": 5,
                    "available": 15
                },
                "last_query": "2025-11-21 14:59:58",
                "metrics": {
                    "total_queries_today": 8765,
                    "avg_response_time_ms": 32,
                    "slow_queries_count": 5
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/relational_data_source.py:680:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        关系数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "postgresql",
                "response_time_ms": 25,
                "connection_pool": {
                    "size": 20,
                    "in_use": 5,
                    "available": 15
                },
                "last_query": "2025-11-21 14:59:58",
                "metrics": {
                    "total_queries_today": 8765,
                    "avg_response_time_ms": 32,
                    "slow_queries_count": 5
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/relational_data_source.py:683:1: RST301 Unexpected indentation.
        """
        关系数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "postgresql",
                "response_time_ms": 25,
                "connection_pool": {
                    "size": 20,
                    "in_use": 5,
                    "available": 15
                },
                "last_query": "2025-11-21 14:59:58",
                "metrics": {
                    "total_queries_today": 8765,
                    "avg_response_time_ms": 32,
                    "slow_queries_count": 5
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/relational_data_source.py:686:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        关系数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "postgresql",
                "response_time_ms": 25,
                "connection_pool": {
                    "size": 20,
                    "in_use": 5,
                    "available": 15
                },
                "last_query": "2025-11-21 14:59:58",
                "metrics": {
                    "total_queries_today": 8765,
                    "avg_response_time_ms": 32,
                    "slow_queries_count": 5
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/relational_data_source.py:687:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        关系数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",
                "data_source_type": "postgresql",
                "response_time_ms": 25,
                "connection_pool": {
                    "size": 20,
                    "in_use": 5,
                    "available": 15
                },
                "last_query": "2025-11-21 14:59:58",
                "metrics": {
                    "total_queries_today": 8765,
                    "avg_response_time_ms": 32,
                    "slow_queries_count": 5
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/timeseries_data_source.py:1:1: D400 First line should end with a period
"""
时序数据源抽象接口

本模块定义时序数据源的统一接口，所有时序数据源（Mock、TDengine、API等）必须实现此接口。
时序数据主要包括：实时行情、K线数据、分时图、资金流向等高频时序数据。

适用数据库: TDengine (时序数据库)
适用场景: 市场行情、实时数据、技术分析

作者: MyStocks Backend Team
创建日期: 2025-11-21
版本: 1.0.0
"""
^
src/interfaces/timeseries_data_source.py:22:1: D400 First line should end with a period
    """
    时序数据源抽象接口

    所有时序数据源实现必须遵循此接口规范，确保：
    1. 方法签名一致
    2. 返回数据格式统一
    3. 异常处理规范
    4. 性能要求达标

    实现类:
    - MockTimeSeriesDataSource: Mock数据实现（开发测试）
    - TDengineTimeSeriesDataSource: TDengine数据库实现（生产）
    - APITimeSeriesDataSource: 第三方API实现（备选）
    """
^
src/interfaces/timeseries_data_source.py:41:80: E501 line too long (85 > 79 characters)
        self, symbols: Optional[List[str]] = None, fields: Optional[List[str]] = None
                                                                               ^
src/interfaces/timeseries_data_source.py:43:1: D400 First line should end with a period
        """
        获取实时行情数据

        Args:
            symbols: 股票代码列表，None表示获取全市场
            fields: 需要返回的字段列表，None表示返回所有字段
                   可选字段: symbol, name, price, change, change_percent,
                            volume, amount, high, low, open, pre_close,
                            bid1_price, bid1_volume, ask1_price, ask1_volume

        Returns:
            List[Dict]: 实时行情数据列表

        示例返回格式:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change": 0.3,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "amount": 1312500000.0,
                    "high": 10.8,
                    "low": 10.2,
                    "open": 10.3,
                    "pre_close": 10.2,
                    "timestamp": "2025-11-21 14:30:00"
                },
                ...
            ]

        性能要求:
            - 单股票查询: < 50ms
            - 批量查询(10个): < 100ms
            - 全市场查询: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:48:1: RST301 Unexpected indentation.
        """
        获取实时行情数据

        Args:
            symbols: 股票代码列表，None表示获取全市场
            fields: 需要返回的字段列表，None表示返回所有字段
                   可选字段: symbol, name, price, change, change_percent,
                            volume, amount, high, low, open, pre_close,
                            bid1_price, bid1_volume, ask1_price, ask1_volume

        Returns:
            List[Dict]: 实时行情数据列表

        示例返回格式:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change": 0.3,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "amount": 1312500000.0,
                    "high": 10.8,
                    "low": 10.2,
                    "open": 10.3,
                    "pre_close": 10.2,
                    "timestamp": "2025-11-21 14:30:00"
                },
                ...
            ]

        性能要求:
            - 单股票查询: < 50ms
            - 批量查询(10个): < 100ms
            - 全市场查询: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:70:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取实时行情数据

        Args:
            symbols: 股票代码列表，None表示获取全市场
            fields: 需要返回的字段列表，None表示返回所有字段
                   可选字段: symbol, name, price, change, change_percent,
                            volume, amount, high, low, open, pre_close,
                            bid1_price, bid1_volume, ask1_price, ask1_volume

        Returns:
            List[Dict]: 实时行情数据列表

        示例返回格式:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change": 0.3,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "amount": 1312500000.0,
                    "high": 10.8,
                    "low": 10.2,
                    "open": 10.3,
                    "pre_close": 10.2,
                    "timestamp": "2025-11-21 14:30:00"
                },
                ...
            ]

        性能要求:
            - 单股票查询: < 50ms
            - 批量查询(10个): < 100ms
            - 全市场查询: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:71:1: RST401 Unexpected section title.
        """
        获取实时行情数据

        Args:
            symbols: 股票代码列表，None表示获取全市场
            fields: 需要返回的字段列表，None表示返回所有字段
                   可选字段: symbol, name, price, change, change_percent,
                            volume, amount, high, low, open, pre_close,
                            bid1_price, bid1_volume, ask1_price, ask1_volume

        Returns:
            List[Dict]: 实时行情数据列表

        示例返回格式:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change": 0.3,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "amount": 1312500000.0,
                    "high": 10.8,
                    "low": 10.2,
                    "open": 10.3,
                    "pre_close": 10.2,
                    "timestamp": "2025-11-21 14:30:00"
                },
                ...
            ]

        性能要求:
            - 单股票查询: < 50ms
            - 批量查询(10个): < 100ms
            - 全市场查询: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:72:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取实时行情数据

        Args:
            symbols: 股票代码列表，None表示获取全市场
            fields: 需要返回的字段列表，None表示返回所有字段
                   可选字段: symbol, name, price, change, change_percent,
                            volume, amount, high, low, open, pre_close,
                            bid1_price, bid1_volume, ask1_price, ask1_volume

        Returns:
            List[Dict]: 实时行情数据列表

        示例返回格式:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "price": 10.5,
                    "change": 0.3,
                    "change_percent": 2.94,
                    "volume": 125000000,
                    "amount": 1312500000.0,
                    "high": 10.8,
                    "low": 10.2,
                    "open": 10.3,
                    "pre_close": 10.2,
                    "timestamp": "2025-11-21 14:30:00"
                },
                ...
            ]

        性能要求:
            - 单股票查询: < 50ms
            - 批量查询(10个): < 100ms
            - 全市场查询: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:93:1: D400 First line should end with a period
        """
        获取K线数据

        Args:
            symbol: 股票代码
            start_time: 开始时间
            end_time: 结束时间
            interval: K线周期
                     - 分钟级: "1m", "5m", "15m", "30m", "60m"
                     - 日线级: "1d"
                     - 周月级: "1w", "1M"

        Returns:
            DataFrame: K线数据，包含以下列
                      - timestamp: 时间戳
                      - open: 开盘价
                      - high: 最高价
                      - low: 最低价
                      - close: 收盘价
                      - volume: 成交量
                      - amount: 成交额

        示例返回:
            timestamp           open    high    low     close   volume      amount
            2025-11-21 09:30   10.2    10.5    10.1    10.3    1250000     12800000
            2025-11-21 09:31   10.3    10.4    10.2    10.4    1180000     12200000
            ...

        性能要求:
            - 日线数据(250天): < 200ms
            - 分钟数据(1天): < 300ms
            - 分钟数据(5天): < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: interval参数无效
        """
^
src/interfaces/timeseries_data_source.py:100:1: RST301 Unexpected indentation.
        """
        获取K线数据

        Args:
            symbol: 股票代码
            start_time: 开始时间
            end_time: 结束时间
            interval: K线周期
                     - 分钟级: "1m", "5m", "15m", "30m", "60m"
                     - 日线级: "1d"
                     - 周月级: "1w", "1M"

        Returns:
            DataFrame: K线数据，包含以下列
                      - timestamp: 时间戳
                      - open: 开盘价
                      - high: 最高价
                      - low: 最低价
                      - close: 收盘价
                      - volume: 成交量
                      - amount: 成交额

        示例返回:
            timestamp           open    high    low     close   volume      amount
            2025-11-21 09:30   10.2    10.5    10.1    10.3    1250000     12800000
            2025-11-21 09:31   10.3    10.4    10.2    10.4    1180000     12200000
            ...

        性能要求:
            - 日线数据(250天): < 200ms
            - 分钟数据(1天): < 300ms
            - 分钟数据(5天): < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: interval参数无效
        """
^
src/interfaces/timeseries_data_source.py:116:80: E501 line too long (82 > 79 characters)
        """
        获取K线数据

        Args:
            symbol: 股票代码
            start_time: 开始时间
            end_time: 结束时间
            interval: K线周期
                     - 分钟级: "1m", "5m", "15m", "30m", "60m"
                     - 日线级: "1d"
                     - 周月级: "1w", "1M"

        Returns:
            DataFrame: K线数据，包含以下列
                      - timestamp: 时间戳
                      - open: 开盘价
                      - high: 最高价
                      - low: 最低价
                      - close: 收盘价
                      - volume: 成交量
                      - amount: 成交额

        示例返回:
            timestamp           open    high    low     close   volume      amount
            2025-11-21 09:30   10.2    10.5    10.1    10.3    1250000     12800000
            2025-11-21 09:31   10.3    10.4    10.2    10.4    1180000     12200000
            ...

        性能要求:
            - 日线数据(250天): < 200ms
            - 分钟数据(1天): < 300ms
            - 分钟数据(5天): < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: interval参数无效
        """





            ^
src/interfaces/timeseries_data_source.py:117:80: E501 line too long (83 > 79 characters)
        """
        获取K线数据

        Args:
            symbol: 股票代码
            start_time: 开始时间
            end_time: 结束时间
            interval: K线周期
                     - 分钟级: "1m", "5m", "15m", "30m", "60m"
                     - 日线级: "1d"
                     - 周月级: "1w", "1M"

        Returns:
            DataFrame: K线数据，包含以下列
                      - timestamp: 时间戳
                      - open: 开盘价
                      - high: 最高价
                      - low: 最低价
                      - close: 收盘价
                      - volume: 成交量
                      - amount: 成交额

        示例返回:
            timestamp           open    high    low     close   volume      amount
            2025-11-21 09:30   10.2    10.5    10.1    10.3    1250000     12800000
            2025-11-21 09:31   10.3    10.4    10.2    10.4    1180000     12200000
            ...

        性能要求:
            - 日线数据(250天): < 200ms
            - 分钟数据(1天): < 300ms
            - 分钟数据(5天): < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: interval参数无效
        """





            ^
src/interfaces/timeseries_data_source.py:118:80: E501 line too long (83 > 79 characters)
        """
        获取K线数据

        Args:
            symbol: 股票代码
            start_time: 开始时间
            end_time: 结束时间
            interval: K线周期
                     - 分钟级: "1m", "5m", "15m", "30m", "60m"
                     - 日线级: "1d"
                     - 周月级: "1w", "1M"

        Returns:
            DataFrame: K线数据，包含以下列
                      - timestamp: 时间戳
                      - open: 开盘价
                      - high: 最高价
                      - low: 最低价
                      - close: 收盘价
                      - volume: 成交量
                      - amount: 成交额

        示例返回:
            timestamp           open    high    low     close   volume      amount
            2025-11-21 09:30   10.2    10.5    10.1    10.3    1250000     12800000
            2025-11-21 09:31   10.3    10.4    10.2    10.4    1180000     12200000
            ...

        性能要求:
            - 日线数据(250天): < 200ms
            - 分钟数据(1天): < 300ms
            - 分钟数据(5天): < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: interval参数无效
        """





            ^
src/interfaces/timeseries_data_source.py:136:1: D400 First line should end with a period
        """
        获取分时图数据

        Args:
            symbol: 股票代码
            trade_date: 交易日期，None表示今天

        Returns:
            DataFrame: 分时数据，包含以下列
                      - time: 时间 (HH:MM格式)
                      - price: 当前价格
                      - avg_price: 均价
                      - volume: 累计成交量
                      - amount: 累计成交额

        示例返回:
            time    price   avg_price   volume      amount
            09:30   10.2    10.2        125000      1275000
            09:31   10.3    10.25       250000      2562500
            ...

        性能要求: < 150ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:168:80: E501 line too long (84 > 79 characters)
        self, symbol: str, start_date: date, end_date: date, flow_type: str = "main"
                                                                               ^
src/interfaces/timeseries_data_source.py:170:1: D400 First line should end with a period
        """
        获取资金流向数据

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期
            flow_type: 资金类型
                      - "main": 主力资金
                      - "super": 超大单
                      - "large": 大单
                      - "medium": 中单
                      - "small": 小单
                      - "all": 所有类型

        Returns:
            DataFrame: 资金流向数据，包含以下列
                      - trade_date: 交易日期
                      - main_net_inflow: 主力净流入
                      - main_net_inflow_rate: 主力净流入率(%)
                      - super_net_inflow: 超大单净流入
                      - large_net_inflow: 大单净流入
                      - medium_net_inflow: 中单净流入
                      - small_net_inflow: 小单净流入

        示例返回:
            trade_date  main_net_inflow  main_net_inflow_rate  super_net_inflow
            2025-11-20  125000000.0      8.5                   200000000.0
            2025-11-21  -35000000.0      -2.3                  -50000000.0
            ...

        性能要求:
            - 30天数据: < 200ms
            - 90天数据: < 400ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: flow_type参数无效
        """
^
src/interfaces/timeseries_data_source.py:177:1: RST301 Unexpected indentation.
        """
        获取资金流向数据

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期
            flow_type: 资金类型
                      - "main": 主力资金
                      - "super": 超大单
                      - "large": 大单
                      - "medium": 中单
                      - "small": 小单
                      - "all": 所有类型

        Returns:
            DataFrame: 资金流向数据，包含以下列
                      - trade_date: 交易日期
                      - main_net_inflow: 主力净流入
                      - main_net_inflow_rate: 主力净流入率(%)
                      - super_net_inflow: 超大单净流入
                      - large_net_inflow: 大单净流入
                      - medium_net_inflow: 中单净流入
                      - small_net_inflow: 小单净流入

        示例返回:
            trade_date  main_net_inflow  main_net_inflow_rate  super_net_inflow
            2025-11-20  125000000.0      8.5                   200000000.0
            2025-11-21  -35000000.0      -2.3                  -50000000.0
            ...

        性能要求:
            - 30天数据: < 200ms
            - 90天数据: < 400ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: flow_type参数无效
        """
^
src/interfaces/timeseries_data_source.py:219:1: D400 First line should end with a period
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期，None表示最新交易日
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向
                      - "inflow": 净流入排名
                      - "outflow": 净流出排名
            limit: 返回数量限制

        Returns:
            List[Dict]: 资金流向排名列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "main_net_inflow": 125000000.0,
                    "main_net_inflow_rate": 8.5,
                    "change_percent": 2.94,
                    "rank": 1
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:225:1: RST301 Unexpected indentation.
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期，None表示最新交易日
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向
                      - "inflow": 净流入排名
                      - "outflow": 净流出排名
            limit: 返回数量限制

        Returns:
            List[Dict]: 资金流向排名列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "main_net_inflow": 125000000.0,
                    "main_net_inflow_rate": 8.5,
                    "change_percent": 2.94,
                    "rank": 1
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:227:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期，None表示最新交易日
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向
                      - "inflow": 净流入排名
                      - "outflow": 净流出排名
            limit: 返回数量限制

        Returns:
            List[Dict]: 资金流向排名列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "main_net_inflow": 125000000.0,
                    "main_net_inflow_rate": 8.5,
                    "change_percent": 2.94,
                    "rank": 1
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:242:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期，None表示最新交易日
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向
                      - "inflow": 净流入排名
                      - "outflow": 净流出排名
            limit: 返回数量限制

        Returns:
            List[Dict]: 资金流向排名列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "main_net_inflow": 125000000.0,
                    "main_net_inflow_rate": 8.5,
                    "change_percent": 2.94,
                    "rank": 1
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:243:1: RST401 Unexpected section title.
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期，None表示最新交易日
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向
                      - "inflow": 净流入排名
                      - "outflow": 净流出排名
            limit: 返回数量限制

        Returns:
            List[Dict]: 资金流向排名列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "main_net_inflow": 125000000.0,
                    "main_net_inflow_rate": 8.5,
                    "change_percent": 2.94,
                    "rank": 1
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:244:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取资金流向排名

        Args:
            trade_date: 交易日期，None表示最新交易日
            flow_type: 资金类型 (main/super/large/medium/small)
            direction: 方向
                      - "inflow": 净流入排名
                      - "outflow": 净流出排名
            limit: 返回数量限制

        Returns:
            List[Dict]: 资金流向排名列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "main_net_inflow": 125000000.0,
                    "main_net_inflow_rate": 8.5,
                    "change_percent": 2.94,
                    "rank": 1
                },
                ...
            ]

        性能要求: < 300ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:257:80: E501 line too long (87 > 79 characters)
    def get_market_overview(self, trade_date: Optional[date] = None) -> Dict[str, Any]:
                                                                               ^
src/interfaces/timeseries_data_source.py:258:1: D400 First line should end with a period
        """
        获取市场概览数据

        Args:
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 市场概览数据

        示例返回:
            {
                "trade_date": "2025-11-21",
                "total_stocks": 5234,
                "up_stocks": 2845,
                "down_stocks": 2103,
                "flat_stocks": 286,
                "limit_up_stocks": 45,
                "limit_down_stocks": 12,
                "total_volume": 523400000000,
                "total_amount": 6234567890000.0,
                "avg_change_percent": 1.23,
                "indices": {
                    "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                    "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                }
            }

        性能要求: < 200ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:279:1: RST301 Unexpected indentation.
        """
        获取市场概览数据

        Args:
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 市场概览数据

        示例返回:
            {
                "trade_date": "2025-11-21",
                "total_stocks": 5234,
                "up_stocks": 2845,
                "down_stocks": 2103,
                "flat_stocks": 286,
                "limit_up_stocks": 45,
                "limit_down_stocks": 12,
                "total_volume": 523400000000,
                "total_amount": 6234567890000.0,
                "avg_change_percent": 1.23,
                "indices": {
                    "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                    "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                }
            }

        性能要求: < 200ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:280:80: E501 line too long (81 > 79 characters)
        """
        获取市场概览数据

        Args:
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 市场概览数据

        示例返回:
            {
                "trade_date": "2025-11-21",
                "total_stocks": 5234,
                "up_stocks": 2845,
                "down_stocks": 2103,
                "flat_stocks": 286,
                "limit_up_stocks": 45,
                "limit_down_stocks": 12,
                "total_volume": 523400000000,
                "total_amount": 6234567890000.0,
                "avg_change_percent": 1.23,
                "indices": {
                    "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                    "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                }
            }

        性能要求: < 200ms

        Raises:
            DataSourceException: 数据源查询失败
        """




                                   ^
src/interfaces/timeseries_data_source.py:281:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取市场概览数据

        Args:
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 市场概览数据

        示例返回:
            {
                "trade_date": "2025-11-21",
                "total_stocks": 5234,
                "up_stocks": 2845,
                "down_stocks": 2103,
                "flat_stocks": 286,
                "limit_up_stocks": 45,
                "limit_down_stocks": 12,
                "total_volume": 523400000000,
                "total_amount": 6234567890000.0,
                "avg_change_percent": 1.23,
                "indices": {
                    "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                    "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                }
            }

        性能要求: < 200ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:281:80: E501 line too long (81 > 79 characters)
        """
        获取市场概览数据

        Args:
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 市场概览数据

        示例返回:
            {
                "trade_date": "2025-11-21",
                "total_stocks": 5234,
                "up_stocks": 2845,
                "down_stocks": 2103,
                "flat_stocks": 286,
                "limit_up_stocks": 45,
                "limit_down_stocks": 12,
                "total_volume": 523400000000,
                "total_amount": 6234567890000.0,
                "avg_change_percent": 1.23,
                "indices": {
                    "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                    "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                }
            }

        性能要求: < 200ms

        Raises:
            DataSourceException: 数据源查询失败
        """




                                   ^
src/interfaces/timeseries_data_source.py:282:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取市场概览数据

        Args:
            trade_date: 交易日期，None表示最新交易日

        Returns:
            Dict: 市场概览数据

        示例返回:
            {
                "trade_date": "2025-11-21",
                "total_stocks": 5234,
                "up_stocks": 2845,
                "down_stocks": 2103,
                "flat_stocks": 286,
                "limit_up_stocks": 45,
                "limit_down_stocks": 12,
                "total_volume": 523400000000,
                "total_amount": 6234567890000.0,
                "avg_change_percent": 1.23,
                "indices": {
                    "sh000001": {"name": "上证指数", "close": 3250.5, "change": 1.2},
                    "sz399001": {"name": "深证成指", "close": 11234.8, "change": 0.8}
                }
            }

        性能要求: < 200ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:296:1: D400 First line should end with a period
        """
        获取指数实时数据

        Args:
            index_codes: 指数代码列表，None表示获取主要指数
                        常用指数: sh000001(上证), sz399001(深成), sz399006(创业板)

        Returns:
            List[Dict]: 指数实时数据

        示例返回:
            [
                {
                    "code": "sh000001",
                    "name": "上证指数",
                    "close": 3250.5,
                    "change": 38.2,
                    "change_percent": 1.19,
                    "high": 3268.9,
                    "low": 3242.1,
                    "open": 3245.3,
                    "pre_close": 3212.3,
                    "volume": 234500000000,
                    "amount": 2845670000000.0,
                    "timestamp": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:320:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取指数实时数据

        Args:
            index_codes: 指数代码列表，None表示获取主要指数
                        常用指数: sh000001(上证), sz399001(深成), sz399006(创业板)

        Returns:
            List[Dict]: 指数实时数据

        示例返回:
            [
                {
                    "code": "sh000001",
                    "name": "上证指数",
                    "close": 3250.5,
                    "change": 38.2,
                    "change_percent": 1.19,
                    "high": 3268.9,
                    "low": 3242.1,
                    "open": 3245.3,
                    "pre_close": 3212.3,
                    "volume": 234500000000,
                    "amount": 2845670000000.0,
                    "timestamp": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:321:1: RST401 Unexpected section title.
        """
        获取指数实时数据

        Args:
            index_codes: 指数代码列表，None表示获取主要指数
                        常用指数: sh000001(上证), sz399001(深成), sz399006(创业板)

        Returns:
            List[Dict]: 指数实时数据

        示例返回:
            [
                {
                    "code": "sh000001",
                    "name": "上证指数",
                    "close": 3250.5,
                    "change": 38.2,
                    "change_percent": 1.19,
                    "high": 3268.9,
                    "low": 3242.1,
                    "open": 3245.3,
                    "pre_close": 3212.3,
                    "volume": 234500000000,
                    "amount": 2845670000000.0,
                    "timestamp": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:322:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取指数实时数据

        Args:
            index_codes: 指数代码列表，None表示获取主要指数
                        常用指数: sh000001(上证), sz399001(深成), sz399006(创业板)

        Returns:
            List[Dict]: 指数实时数据

        示例返回:
            [
                {
                    "code": "sh000001",
                    "name": "上证指数",
                    "close": 3250.5,
                    "change": 38.2,
                    "change_percent": 1.19,
                    "high": 3268.9,
                    "low": 3242.1,
                    "open": 3245.3,
                    "pre_close": 3212.3,
                    "volume": 234500000000,
                    "amount": 2845670000000.0,
                    "timestamp": "2025-11-21 15:00:00"
                },
                ...
            ]

        性能要求: < 100ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:336:80: E501 line too long (82 > 79 characters)
        self, symbol: str, start_date: date, end_date: date, indicators: List[str]
                                                                               ^
src/interfaces/timeseries_data_source.py:338:1: D400 First line should end with a period
        """
        计算技术指标

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期
            indicators: 指标列表
                       支持的指标: MA, EMA, MACD, KDJ, RSI, BOLL, VOL,
                                  ATR, OBV, CCI, WR, BIAS等

        Returns:
            DataFrame: 包含技术指标的数据

        示例返回:
            date        close   MA5     MA10    MACD_DIF  MACD_DEA  MACD_MACD
            2025-11-20  10.2    10.1    10.0    0.15      0.12      0.03
            2025-11-21  10.5    10.2    10.1    0.18      0.14      0.04
            ...

        性能要求:
            - 单个指标: < 200ms
            - 5个指标: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: 不支持的指标类型
        """
^
src/interfaces/timeseries_data_source.py:345:1: RST301 Unexpected indentation.
        """
        计算技术指标

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期
            indicators: 指标列表
                       支持的指标: MA, EMA, MACD, KDJ, RSI, BOLL, VOL,
                                  ATR, OBV, CCI, WR, BIAS等

        Returns:
            DataFrame: 包含技术指标的数据

        示例返回:
            date        close   MA5     MA10    MACD_DIF  MACD_DEA  MACD_MACD
            2025-11-20  10.2    10.1    10.0    0.15      0.12      0.03
            2025-11-21  10.5    10.2    10.1    0.18      0.14      0.04
            ...

        性能要求:
            - 单个指标: < 200ms
            - 5个指标: < 500ms

        Raises:
            DataSourceException: 数据源查询失败
            ValueError: 不支持的指标类型
        """
^
src/interfaces/timeseries_data_source.py:378:1: D400 First line should end with a period
        """
        获取竞价抢筹数据

        Args:
            trade_date: 交易日期，None表示最新交易日
            auction_type: 竞价类型
                         - "open": 集合竞价
                         - "close": 尾盘竞价
            min_amount: 最小金额过滤（元）
            limit: 返回数量限制

        Returns:
            List[Dict]: 竞价数据列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "auction_type": "open",
                    "auction_price": 10.5,
                    "auction_volume": 1250000,
                    "auction_amount": 13125000.0,
                    "change_percent": 2.94
                },
                ...
            ]

        性能要求: < 250ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:383:1: RST301 Unexpected indentation.
        """
        获取竞价抢筹数据

        Args:
            trade_date: 交易日期，None表示最新交易日
            auction_type: 竞价类型
                         - "open": 集合竞价
                         - "close": 尾盘竞价
            min_amount: 最小金额过滤（元）
            limit: 返回数量限制

        Returns:
            List[Dict]: 竞价数据列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "auction_type": "open",
                    "auction_price": 10.5,
                    "auction_volume": 1250000,
                    "auction_amount": 13125000.0,
                    "change_percent": 2.94
                },
                ...
            ]

        性能要求: < 250ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:385:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        获取竞价抢筹数据

        Args:
            trade_date: 交易日期，None表示最新交易日
            auction_type: 竞价类型
                         - "open": 集合竞价
                         - "close": 尾盘竞价
            min_amount: 最小金额过滤（元）
            limit: 返回数量限制

        Returns:
            List[Dict]: 竞价数据列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "auction_type": "open",
                    "auction_price": 10.5,
                    "auction_volume": 1250000,
                    "auction_amount": 13125000.0,
                    "change_percent": 2.94
                },
                ...
            ]

        性能要求: < 250ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:402:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取竞价抢筹数据

        Args:
            trade_date: 交易日期，None表示最新交易日
            auction_type: 竞价类型
                         - "open": 集合竞价
                         - "close": 尾盘竞价
            min_amount: 最小金额过滤（元）
            limit: 返回数量限制

        Returns:
            List[Dict]: 竞价数据列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "auction_type": "open",
                    "auction_price": 10.5,
                    "auction_volume": 1250000,
                    "auction_amount": 13125000.0,
                    "change_percent": 2.94
                },
                ...
            ]

        性能要求: < 250ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:403:1: RST401 Unexpected section title.
        """
        获取竞价抢筹数据

        Args:
            trade_date: 交易日期，None表示最新交易日
            auction_type: 竞价类型
                         - "open": 集合竞价
                         - "close": 尾盘竞价
            min_amount: 最小金额过滤（元）
            limit: 返回数量限制

        Returns:
            List[Dict]: 竞价数据列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "auction_type": "open",
                    "auction_price": 10.5,
                    "auction_volume": 1250000,
                    "auction_amount": 13125000.0,
                    "change_percent": 2.94
                },
                ...
            ]

        性能要求: < 250ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:404:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        获取竞价抢筹数据

        Args:
            trade_date: 交易日期，None表示最新交易日
            auction_type: 竞价类型
                         - "open": 集合竞价
                         - "close": 尾盘竞价
            min_amount: 最小金额过滤（元）
            limit: 返回数量限制

        Returns:
            List[Dict]: 竞价数据列表

        示例返回:
            [
                {
                    "symbol": "600000",
                    "name": "浦发银行",
                    "trade_date": "2025-11-21",
                    "auction_type": "open",
                    "auction_price": 10.5,
                    "auction_volume": 1250000,
                    "auction_amount": 13125000.0,
                    "change_percent": 2.94
                },
                ...
            ]

        性能要求: < 250ms

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:420:1: D400 First line should end with a period
        """
        检查时序数据质量

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 数据质量报告

        示例返回:
            {
                "symbol": "600000",
                "date_range": {"start": "2025-01-01", "end": "2025-11-21"},
                "total_records": 230,
                "missing_records": 5,
                "completeness_rate": 97.8,
                "data_freshness": "2025-11-21 15:00:00",
                "quality_score": 95.5,
                "issues": [
                    {"date": "2025-10-01", "issue": "missing_data"},
                    {"date": "2025-10-15", "issue": "abnormal_volume"}
                ]
            }

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:440:1: RST301 Unexpected indentation.
        """
        检查时序数据质量

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 数据质量报告

        示例返回:
            {
                "symbol": "600000",
                "date_range": {"start": "2025-01-01", "end": "2025-11-21"},
                "total_records": 230,
                "missing_records": 5,
                "completeness_rate": 97.8,
                "data_freshness": "2025-11-21 15:00:00",
                "quality_score": 95.5,
                "issues": [
                    {"date": "2025-10-01", "issue": "missing_data"},
                    {"date": "2025-10-15", "issue": "abnormal_volume"}
                ]
            }

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:442:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        检查时序数据质量

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 数据质量报告

        示例返回:
            {
                "symbol": "600000",
                "date_range": {"start": "2025-01-01", "end": "2025-11-21"},
                "total_records": 230,
                "missing_records": 5,
                "completeness_rate": 97.8,
                "data_freshness": "2025-11-21 15:00:00",
                "quality_score": 95.5,
                "issues": [
                    {"date": "2025-10-01", "issue": "missing_data"},
                    {"date": "2025-10-15", "issue": "abnormal_volume"}
                ]
            }

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:443:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        检查时序数据质量

        Args:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期

        Returns:
            Dict: 数据质量报告

        示例返回:
            {
                "symbol": "600000",
                "date_range": {"start": "2025-01-01", "end": "2025-11-21"},
                "total_records": 230,
                "missing_records": 5,
                "completeness_rate": 97.8,
                "data_freshness": "2025-11-21 15:00:00",
                "quality_score": 95.5,
                "issues": [
                    {"date": "2025-10-01", "issue": "missing_data"},
                    {"date": "2025-10-15", "issue": "abnormal_volume"}
                ]
            }

        Raises:
            DataSourceException: 数据源查询失败
        """
^
src/interfaces/timeseries_data_source.py:453:1: D400 First line should end with a period
        """
        时序数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",  # healthy / degraded / unhealthy
                "data_source_type": "tdengine",
                "response_time_ms": 45,
                "last_update": "2025-11-21 15:00:00",
                "connection_status": "connected",
                "metrics": {
                    "total_queries_today": 12345,
                    "avg_response_time_ms": 52,
                    "error_rate_percent": 0.05
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/timeseries_data_source.py:466:1: RST301 Unexpected indentation.
        """
        时序数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",  # healthy / degraded / unhealthy
                "data_source_type": "tdengine",
                "response_time_ms": 45,
                "last_update": "2025-11-21 15:00:00",
                "connection_status": "connected",
                "metrics": {
                    "total_queries_today": 12345,
                    "avg_response_time_ms": 52,
                    "error_rate_percent": 0.05
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/timeseries_data_source.py:469:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        时序数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",  # healthy / degraded / unhealthy
                "data_source_type": "tdengine",
                "response_time_ms": 45,
                "last_update": "2025-11-21 15:00:00",
                "connection_status": "connected",
                "metrics": {
                    "total_queries_today": 12345,
                    "avg_response_time_ms": 52,
                    "error_rate_percent": 0.05
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/interfaces/timeseries_data_source.py:470:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        时序数据源健康检查

        Returns:
            Dict: 健康状态

        示例返回:
            {
                "status": "healthy",  # healthy / degraded / unhealthy
                "data_source_type": "tdengine",
                "response_time_ms": 45,
                "last_update": "2025-11-21 15:00:00",
                "connection_status": "connected",
                "metrics": {
                    "total_queries_today": 12345,
                    "avg_response_time_ms": 52,
                    "error_rate_percent": 0.05
                }
            }

        Raises:
            DataSourceException: 健康检查失败
        """
^
src/ml_strategy/__init__.py:1:1: D400 First line should end with a period
"""
Machine Learning Strategy Module for MyStocks

This module provides machine learning capabilities for stock price prediction,
feature engineering, and feature selection.

Modules:
    - feature_engineering: Rolling window feature generation
    - price_predictor: LightGBM-based price prediction
    - feature_selector: Multiple feature selection algorithms

Author: MyStocks Development Team
Created: 2025-10-19
"""
^
src/ml_strategy/automation/__init__.py:1:1: D400 First line should end with a period
"""
自动化调度系统 (Automation and Scheduling System)

提供量化交易系统的自动化任务调度功能:
- 定时数据更新
- 策略自动执行
- 交易信号通知
- 任务监控和日志

主要组件:
- TaskScheduler: 任务调度器
- NotificationManager: 通知管理器
- PredefinedTasks: 预定义任务

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/automation/notification_manager.py:1:1: D400 First line should end with a period
"""
通知管理器 (Notification Manager)

功能说明:
- 多渠道通知发送（邮件、Webhook、日志）
- 通知模板管理
- 通知历史记录
- 通知过滤和频率限制

支持的通知渠道:
- Email: SMTP邮件通知
- Webhook: HTTP POST到指定URL
- Log: 记录到日志文件
- Console: 控制台输出（开发调试）

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/automation/notification_manager.py:26:1: E402 module level import not at top of file
from typing import Dict, List, Optional, Any
^
src/ml_strategy/automation/notification_manager.py:27:1: E402 module level import not at top of file
from datetime import datetime, timedelta
^
src/ml_strategy/automation/notification_manager.py:28:1: E402 module level import not at top of file
from dataclasses import dataclass, field
^
src/ml_strategy/automation/notification_manager.py:29:1: E402 module level import not at top of file
from enum import Enum
^
src/ml_strategy/automation/notification_manager.py:30:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/automation/notification_manager.py:52:1: D400 First line should end with a period
    """通知渠道"""
^
src/ml_strategy/automation/notification_manager.py:61:1: D400 First line should end with a period
    """通知级别"""
^
src/ml_strategy/automation/notification_manager.py:71:1: D400 First line should end with a period
    """通知配置"""
^
src/ml_strategy/automation/notification_manager.py:96:1: D400 First line should end with a period
    """通知记录"""
^
src/ml_strategy/automation/notification_manager.py:110:1: D400 First line should end with a period
    """
    通知管理器

    功能:
    - 多渠道通知发送
    - 通知模板
    - 频率限制
    - 发送历史
    """
^
src/ml_strategy/automation/notification_manager.py:121:1: D400 First line should end with a period
        """
        初始化通知管理器

        参数:
            config: 通知配置
        """
^
src/ml_strategy/automation/notification_manager.py:130:80: E501 line too long (86 > 79 characters)
        self.config = config or NotificationConfig(channels=[NotificationChannel.LOG])
                                                                               ^
src/ml_strategy/automation/notification_manager.py:157:1: D400 First line should end with a period
        """
        发送通知

        参数:
            title: 通知标题
            message: 通知内容
            level: 通知级别
            context: 上下文数据
            channels: 发送渠道（可选，默认使用配置的渠道）

        返回:
            bool: 是否成功发送
        """
^
src/ml_strategy/automation/notification_manager.py:182:80: E501 line too long (80 > 79 characters)
            notification_id=f"notif_{datetime.now().strftime('%Y%m%d_%H%M%S')}",
                                                                               ^
src/ml_strategy/automation/notification_manager.py:229:1: D400 First line should end with a period
        """发送任务成功通知"""
^
src/ml_strategy/automation/notification_manager.py:246:1: D400 First line should end with a period
        """发送任务失败通知"""
^
src/ml_strategy/automation/notification_manager.py:273:1: D400 First line should end with a period
        """发送交易信号通知"""
^
src/ml_strategy/automation/notification_manager.py:287:24: F541 f-string is missing placeholders
            message += f"\n\n附加信息:\n"
                       ^
src/ml_strategy/automation/notification_manager.py:305:1: D400 First line should end with a period
        """发送邮件通知"""
^
src/ml_strategy/automation/notification_manager.py:330:80: E501 line too long (82 > 79 characters)
        with smtplib.SMTP(self.config.smtp_host, self.config.smtp_port) as server:
                                                                               ^
src/ml_strategy/automation/notification_manager.py:338:1: D400 First line should end with a period
        """发送Webhook通知"""
^
src/ml_strategy/automation/notification_manager.py:367:1: D400 First line should end with a period
        """发送日志通知"""
^
src/ml_strategy/automation/notification_manager.py:376:80: E501 line too long (80 > 79 characters)
        log_msg = f"[NOTIFICATION] {notification.title}: {notification.message}"
                                                                               ^
src/ml_strategy/automation/notification_manager.py:381:1: D400 First line should end with a period
        """发送控制台通知"""
^
src/ml_strategy/automation/notification_manager.py:392:80: E501 line too long (80 > 79 characters)
        print(f"  时间: {notification.timestamp.strftime('%Y-%m-%d %H:%M:%S')}\n")
                                                                               ^
src/ml_strategy/automation/notification_manager.py:395:1: D400 First line should end with a period
        """格式化HTML邮件"""
^
src/ml_strategy/automation/notification_manager.py:410:80: E501 line too long (87 > 79 characters)
        html = f"""
        <html>
          <head></head>
          <body style="font-family: Arial, sans-serif;">
            <div style="padding: 20px; background-color: #f5f5f5;">
              <div style="background-color: white; padding: 20px; border-radius: 5px;">
                <h2 style="color: {color}; margin-top: 0;">
                  {notification.title}
                </h2>
                <div style="line-height: 1.6;">
                  {notification.message.replace(chr(10), '<br>')}
                </div>
                <hr style="margin: 20px 0; border: none; border-top: 1px solid #e0e0e0;">
                <div style="font-size: 12px; color: #757575;">
                  <p>通知时间: {notification.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                  <p>通知级别: {notification.level.value.upper()}</p>
                </div>
              </div>
            </div>
          </body>
        </html>
        """



                    ^
src/ml_strategy/automation/notification_manager.py:417:80: E501 line too long (89 > 79 characters)
        html = f"""
        <html>
          <head></head>
          <body style="font-family: Arial, sans-serif;">
            <div style="padding: 20px; background-color: #f5f5f5;">
              <div style="background-color: white; padding: 20px; border-radius: 5px;">
                <h2 style="color: {color}; margin-top: 0;">
                  {notification.title}
                </h2>
                <div style="line-height: 1.6;">
                  {notification.message.replace(chr(10), '<br>')}
                </div>
                <hr style="margin: 20px 0; border: none; border-top: 1px solid #e0e0e0;">
                <div style="font-size: 12px; color: #757575;">
                  <p>通知时间: {notification.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                  <p>通知级别: {notification.level.value.upper()}</p>
                </div>
              </div>
            </div>
          </body>
        </html>
        """



                    ^
src/ml_strategy/automation/notification_manager.py:419:80: E501 line too long (85 > 79 characters)
        html = f"""
        <html>
          <head></head>
          <body style="font-family: Arial, sans-serif;">
            <div style="padding: 20px; background-color: #f5f5f5;">
              <div style="background-color: white; padding: 20px; border-radius: 5px;">
                <h2 style="color: {color}; margin-top: 0;">
                  {notification.title}
                </h2>
                <div style="line-height: 1.6;">
                  {notification.message.replace(chr(10), '<br>')}
                </div>
                <hr style="margin: 20px 0; border: none; border-top: 1px solid #e0e0e0;">
                <div style="font-size: 12px; color: #757575;">
                  <p>通知时间: {notification.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                  <p>通知级别: {notification.level.value.upper()}</p>
                </div>
              </div>
            </div>
          </body>
        </html>
        """



                    ^
src/ml_strategy/automation/notification_manager.py:431:1: D400 First line should end with a period
        """检查是否达到频率限制"""
^
src/ml_strategy/automation/notification_manager.py:442:1: D400 First line should end with a period
        """更新频率限制追踪"""
^
src/ml_strategy/automation/notification_manager.py:449:1: D400 First line should end with a period
        """
        获取通知历史

        参数:
            level: 通知级别过滤
            limit: 返回数量

        返回:
            List[Notification]: 通知列表
        """
^
src/ml_strategy/automation/notification_manager.py:467:1: D400 First line should end with a period
        """获取统计信息"""
^
src/ml_strategy/automation/notification_manager.py:471:80: E501 line too long (88 > 79 characters)
            "success_rate": (self.stats["total_sent"] / max(len(self.notifications), 1))
                                                                               ^
src/ml_strategy/automation/notification_manager.py:476:1: D400 First line should end with a period
        """清除旧通知历史"""
^
src/ml_strategy/automation/notification_manager.py:478:80: E501 line too long (84 > 79 characters)
        self.notifications = [n for n in self.notifications if n.timestamp > cutoff]
                                                                               ^
src/ml_strategy/automation/notification_manager.py:546:80: E501 line too long (93 > 79 characters)
            f"  [{notification.level.value}] {notification.title} - {notification.timestamp}"
                                                                               ^
src/ml_strategy/automation/predefined_tasks.py:1:1: D400 First line should end with a period
"""
预定义任务 (Predefined Tasks)

功能说明:
- 常用自动化任务的预定义实现
- 数据更新任务
- 策略执行任务
- 信号生成任务
- 系统维护任务

所有任务都遵循统一接口，可直接用于TaskScheduler调度

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/automation/predefined_tasks.py:23:1: E402 module level import not at top of file
from typing import Dict, List, Optional
^
src/ml_strategy/automation/predefined_tasks.py:24:1: E402 module level import not at top of file
from datetime import date, datetime
^
src/ml_strategy/automation/predefined_tasks.py:25:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/automation/predefined_tasks.py:32:1: D400 First line should end with a period
    """
    预定义任务集合

    提供常用的自动化任务函数，可直接用于调度器
    """
^
src/ml_strategy/automation/predefined_tasks.py:42:1: D400 First line should end with a period
        """
        每日数据更新任务

        参数:
            market: 市场代码 ('sh', 'sz')
            lookback_days: 回溯天数
            unified_manager: 数据管理器实例

        返回:
            Dict: 更新结果
        """
^
src/ml_strategy/automation/predefined_tasks.py:53:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:55:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:69:25: F541 f-string is missing placeholders
            logger.info(f"✓ 数据更新完成")
                        ^
src/ml_strategy/automation/predefined_tasks.py:92:1: D400 First line should end with a period
        """
        执行策略任务

        参数:
            strategy_name: 策略名称
            universe: 股票池
            strategy_executor: 策略执行器实例
            notification_manager: 通知管理器

        返回:
            Dict: 执行结果
        """
^
src/ml_strategy/automation/predefined_tasks.py:104:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:107:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:123:25: F541 f-string is missing placeholders
            logger.info(f"✓ 策略执行完成")
                        ^
src/ml_strategy/automation/predefined_tasks.py:156:1: D400 First line should end with a period
        """
        股票筛选任务

        参数:
            screener_config: 筛选器配置
            universe: 股票池（可选）
            unified_manager: 数据管理器

        返回:
            Dict: 筛选结果
        """
^
src/ml_strategy/automation/predefined_tasks.py:167:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:169:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:185:25: F541 f-string is missing placeholders
            logger.info(f"✓ 筛选完成")
                        ^
src/ml_strategy/automation/predefined_tasks.py:202:1: D400 First line should end with a period
        """
        数据库维护任务

        参数:
            unified_manager: 数据管理器

        返回:
            Dict: 维护结果
        """
^
src/ml_strategy/automation/predefined_tasks.py:211:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:213:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:233:25: F541 f-string is missing placeholders
            logger.info(f"✓ 数据库维护完成")
                        ^
src/ml_strategy/automation/predefined_tasks.py:243:80: E501 line too long (84 > 79 characters)
        date: Optional[date] = None, unified_manager=None, notification_manager=None
                                                                               ^
src/ml_strategy/automation/predefined_tasks.py:245:1: D400 First line should end with a period
        """
        生成每日报告任务

        参数:
            date: 报告日期（默认今天）
            unified_manager: 数据管理器
            notification_manager: 通知管理器

        返回:
            Dict: 报告信息
        """
^
src/ml_strategy/automation/predefined_tasks.py:258:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:260:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:264:13: F841 local variable 'report_data' is assigned to but never used
            report_data = {
            ^
src/ml_strategy/automation/predefined_tasks.py:310:25: F541 f-string is missing placeholders
            logger.info(f"✓ 报告生成完成")
                        ^
src/ml_strategy/automation/predefined_tasks.py:324:1: D400 First line should end with a period
        """
        系统健康检查任务

        参数:
            services: 需要检查的服务列表

        返回:
            Dict: 健康状态
        """
^
src/ml_strategy/automation/predefined_tasks.py:333:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:335:21: F541 f-string is missing placeholders
        logger.info(f"=" * 70)
                    ^
src/ml_strategy/automation/predefined_tasks.py:362:80: E501 line too long (83 > 79 characters)
        all_healthy = all(status == "healthy" for status in health_status.values())
                                                                               ^
src/ml_strategy/automation/predefined_tasks.py:376:6: F821 undefined name 'TaskConfig'
) -> "TaskConfig":
     ^
src/ml_strategy/automation/predefined_tasks.py:377:1: D400 First line should end with a period
    """
    创建每日数据更新任务配置

    参数:
        market: 市场代码
        hour: 执行小时（默认16:00，收盘后）
        minute: 执行分钟

    返回:
        TaskConfig: 任务配置
    """
^
src/ml_strategy/automation/predefined_tasks.py:404:6: F821 undefined name 'TaskConfig'
) -> "TaskConfig":
     ^
src/ml_strategy/automation/predefined_tasks.py:405:1: D400 First line should end with a period
    """
    创建策略执行任务配置

    参数:
        strategy_name: 策略名称
        hour: 执行小时（默认9:30，开盘后）
        minute: 执行分钟

    返回:
        TaskConfig: 任务配置
    """
^
src/ml_strategy/automation/predefined_tasks.py:422:80: E501 line too long (83 > 79 characters)
        trigger_args={"hour": hour, "minute": minute, "day_of_week": "0-4"},  # 工作日
                                                                               ^
src/ml_strategy/automation/predefined_tasks.py:427:21: F541 f-string is missing placeholders
        depends_on=[f"daily_data_update_sh"],  # 依赖数据更新
                    ^
src/ml_strategy/automation/predefined_tasks.py:431:61: F821 undefined name 'TaskConfig'
def create_health_check_task(interval_minutes: int = 30) -> "TaskConfig":
                                                            ^
src/ml_strategy/automation/predefined_tasks.py:432:1: D400 First line should end with a period
    """
    创建健康检查任务配置

    参数:
        interval_minutes: 检查间隔（分钟）

    返回:
        TaskConfig: 任务配置
    """
^
src/ml_strategy/automation/scheduler.py:1:1: D400 First line should end with a period
"""
自动化调度系统 (Automated Scheduling System)

功能说明:
- 定时数据更新和策略执行
- 多任务调度管理
- 任务监控和日志
- 故障重试和通知

使用APScheduler实现灵活的任务调度，支持:
- Cron表达式定时
- 间隔时间调度
- 一次性任务
- 任务链和依赖

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/automation/scheduler.py:26:1: E402 module level import not at top of file
from typing import Dict, List, Optional, Callable, Any
^
src/ml_strategy/automation/scheduler.py:27:1: E402 module level import not at top of file
from datetime import datetime, timedelta
^
src/ml_strategy/automation/scheduler.py:28:1: E402 module level import not at top of file
from dataclasses import dataclass, field
^
src/ml_strategy/automation/scheduler.py:29:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/automation/scheduler.py:30:1: E402 module level import not at top of file
import traceback
^
src/ml_strategy/automation/scheduler.py:31:1: E402 module level import not at top of file
import time
^
src/ml_strategy/automation/scheduler.py:32:1: E402 module level import not at top of file
from enum import Enum
^
src/ml_strategy/automation/scheduler.py:48:1: D400 First line should end with a period
    """任务状态"""
^
src/ml_strategy/automation/scheduler.py:59:1: D400 First line should end with a period
    """任务优先级"""
^
src/ml_strategy/automation/scheduler.py:69:1: D400 First line should end with a period
    """任务配置"""
^
src/ml_strategy/automation/scheduler.py:97:1: D400 First line should end with a period
    """任务执行记录"""
^
src/ml_strategy/automation/scheduler.py:111:1: D400 First line should end with a period
    """任务锁 - 防止重叠执行"""
^
src/ml_strategy/automation/scheduler.py:113:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/ml_strategy/automation/scheduler.py:118:1: D400 First line should end with a period
        """
        获取任务锁

        参数:
            job_id: 任务ID
            timeout: 锁超时时间（秒）

        返回:
            bool: 是否成功获取锁
        """
^
src/ml_strategy/automation/scheduler.py:147:1: D400 First line should end with a period
        """释放任务锁"""
^
src/ml_strategy/automation/scheduler.py:153:1: D400 First line should end with a period
        """检查任务是否已锁定"""
^
src/ml_strategy/automation/scheduler.py:158:1: D400 First line should end with a period
    """
    自动化任务调度器

    功能:
    - 定时任务调度
    - 任务重试逻辑
    - 执行监控和日志
    - 防止重叠执行
    """
^
src/ml_strategy/automation/scheduler.py:169:1: D400 First line should end with a period
        """
        初始化调度器

        参数:
            notification_manager: 通知管理器
            monitoring_db: 监控数据库
        """
^
src/ml_strategy/automation/scheduler.py:207:1: D400 First line should end with a period
        """
        添加定时任务

        参数:
            task_config: 任务配置

        返回:
            str: 任务ID
        """
^
src/ml_strategy/automation/scheduler.py:254:1: D400 First line should end with a period
        """创建触发器"""
^
src/ml_strategy/automation/scheduler.py:263:1: D200 One-line docstring should fit on one line with quotes
        """
        包装任务函数，添加锁、重试、监控逻辑
        """
^
src/ml_strategy/automation/scheduler.py:263:1: D400 First line should end with a period
        """
        包装任务函数，添加锁、重试、监控逻辑
        """
^
src/ml_strategy/automation/scheduler.py:269:80: E501 line too long (80 > 79 characters)
                f"{task_config.name}_{datetime.now().strftime('%Y%m%d_%H%M%S')}"
                                                                               ^
src/ml_strategy/automation/scheduler.py:273:80: E501 line too long (88 > 79 characters)
            if not self.job_lock.acquire(task_config.name, timeout=task_config.timeout):
                                                                               ^
src/ml_strategy/automation/scheduler.py:307:80: E501 line too long (83 > 79 characters)
                    f"✓ 任务执行成功: {task_config.name} (耗时: {execution.duration:.2f}秒)"
                                                                               ^
src/ml_strategy/automation/scheduler.py:365:1: D200 One-line docstring should fit on one line with quotes
        """
        执行任务，失败时重试（指数退避）
        """
^
src/ml_strategy/automation/scheduler.py:365:1: D400 First line should end with a period
        """
        执行任务，失败时重试（指数退避）
        """
^
src/ml_strategy/automation/scheduler.py:402:1: D400 First line should end with a period
        """触发后续任务"""
^
src/ml_strategy/automation/scheduler.py:417:1: D400 First line should end with a period
        """APScheduler事件监听器"""
^
src/ml_strategy/automation/scheduler.py:424:1: D400 First line should end with a period
        """记录到监控数据库"""
^
src/ml_strategy/automation/scheduler.py:441:1: D400 First line should end with a period
        """启动调度器"""
^
src/ml_strategy/automation/scheduler.py:452:1: D400 First line should end with a period
        """停止调度器"""
^
src/ml_strategy/automation/scheduler.py:458:1: D400 First line should end with a period
        """获取任务状态"""
^
src/ml_strategy/automation/scheduler.py:468:1: D400 First line should end with a period
        """
        获取执行历史

        参数:
            task_name: 任务名称（可选）
            limit: 返回记录数

        返回:
            List[TaskExecution]: 执行记录列表
        """
^
src/ml_strategy/automation/scheduler.py:483:80: E501 line too long (80 > 79 characters)
        return sorted(history, key=lambda x: x.start_time, reverse=True)[:limit]
                                                                               ^
src/ml_strategy/automation/scheduler.py:486:1: D400 First line should end with a period
        """获取调度器统计信息"""
^
src/ml_strategy/automation/scheduler.py:497:1: D400 First line should end with a period
        """暂停任务"""
^
src/ml_strategy/automation/scheduler.py:503:1: D400 First line should end with a period
        """恢复任务"""
^
src/ml_strategy/automation/scheduler.py:509:1: D400 First line should end with a period
        """移除任务"""
^
src/ml_strategy/automation/scheduler.py:518:1: D400 First line should end with a period
        """列出所有任务"""
^
src/ml_strategy/automation/scheduler.py:557:1: D103 Missing docstring in public function
    def test_task(task_id: str = "test"):
^
src/ml_strategy/backtest/__init__.py:1:1: D104 Missing docstring in public package
src/ml_strategy/backtest/backtest_engine.py:1:1: D400 First line should end with a period
"""
回测引擎主接口 (Backtest Engine)

功能说明:
- 整合向量化回测器、性能指标、风险指标
- 提供统一的回测接口
- 支持单股票和批量回测
- 自动生成完整的回测报告

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/backtest/backtest_engine.py:29:80: E501 line too long (80 > 79 characters)
    sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/ml_strategy/backtest/backtest_engine.py:30:80: E501 line too long (83 > 79 characters)
    from backtest.vectorized_backtester import VectorizedBacktester, BacktestConfig
                                                                               ^
src/ml_strategy/backtest/backtest_engine.py:36:1: D400 First line should end with a period
    """
    回测引擎 - 策略回测的统一接口

    功能:
    - 执行向量化回测
    - 计算性能和风险指标
    - 生成完整回测报告
    - 支持基准比较
    """
^
src/ml_strategy/backtest/backtest_engine.py:47:80: E501 line too long (83 > 79 characters)
        self, config: Optional[BacktestConfig] = None, risk_free_rate: float = 0.03
                                                                               ^
src/ml_strategy/backtest/backtest_engine.py:49:1: D400 First line should end with a period
        """
        初始化回测引擎

        参数:
            config: 回测配置
            risk_free_rate: 无风险利率（年化）
        """
^
src/ml_strategy/backtest/backtest_engine.py:77:1: D400 First line should end with a period
        """
        执行回测

        参数:
            price_data: 价格数据 (open, high, low, close, volume)
            signals: 信号数据 (signal, strength)
            benchmark_returns: 基准收益率（可选）

        返回:
            dict: 完整回测结果
                - backtest: 回测基础结果
                - performance: 性能指标
                - risk: 风险指标
                - report: 文字报告

        示例:
            >>> engine = BacktestEngine()
            >>> result = engine.run(price_data, signals)
            >>> print(result['report'])
        """
^
src/ml_strategy/backtest/backtest_engine.py:145:1: D400 First line should end with a period
        """获取交易记录DataFrame"""
^
src/ml_strategy/backtest/backtest_engine.py:149:1: D400 First line should end with a period
        """获取权益曲线"""
^
src/ml_strategy/backtest/backtest_engine.py:155:1: D400 First line should end with a period
        """获取每日收益率"""
^
src/ml_strategy/backtest/backtest_engine.py:161:1: D400 First line should end with a period
        """
        保存回测结果

        参数:
            filepath: 保存路径
        """
^
src/ml_strategy/backtest/performance_metrics.py:1:1: D400 First line should end with a period
"""
性能指标计算模块 (Performance Metrics)

功能说明:
- 计算回测的各种性能指标
- 支持年化收益率、夏普比率、索提诺比率等
- 提供可视化的性能报告

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/backtest/performance_metrics.py:21:1: D400 First line should end with a period
    """
    性能指标计算器

    提供常用的回测性能指标计算方法
    """
^
src/ml_strategy/backtest/performance_metrics.py:28:1: D400 First line should end with a period
        """
        初始化性能指标计算器

        参数:
            risk_free_rate: 无风险利率（年化）默认3%
        """
^
src/ml_strategy/backtest/performance_metrics.py:48:1: D400 First line should end with a period
        """
        计算所有性能指标

        参数:
            equity_curve: 权益曲线DataFrame
            daily_returns: 每日收益率Series
            trades: 交易记录列表
            initial_capital: 初始资金
            benchmark_returns: 基准收益率（可选）

        返回:
            dict: 所有性能指标
        """
^
src/ml_strategy/backtest/performance_metrics.py:66:80: E501 line too long (82 > 79 characters)
        metrics["total_return"] = self.total_return(equity_curve, initial_capital)
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:72:80: E501 line too long (80 > 79 characters)
        metrics["calmar_ratio"] = self.calmar_ratio(daily_returns, equity_curve)
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:76:80: E501 line too long (83 > 79 characters)
        metrics["max_drawdown_duration"] = self.max_drawdown_duration(equity_curve)
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:97:80: E501 line too long (88 > 79 characters)
    def total_return(self, equity_curve: pd.DataFrame, initial_capital: float) -> float:
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:98:1: D400 First line should end with a period
        """
        总收益率

        参数:
            equity_curve: 权益曲线
            initial_capital: 初始资金

        返回:
            float: 总收益率
        """
^
src/ml_strategy/backtest/performance_metrics.py:112:1: D400 First line should end with a period
        """
        年化收益率

        参数:
            daily_returns: 每日收益率

        返回:
            float: 年化收益率
        """
^
src/ml_strategy/backtest/performance_metrics.py:138:1: D400 First line should end with a period
        """
        夏普比率 (Sharpe Ratio)

        衡量单位风险的超额收益

        参数:
            daily_returns: 每日收益率

        返回:
            float: 夏普比率
        """
^
src/ml_strategy/backtest/performance_metrics.py:162:1: D400 First line should end with a period
        """
        索提诺比率 (Sortino Ratio)

        仅考虑下行风险的夏普比率

        参数:
            daily_returns: 每日收益率

        返回:
            float: 索提诺比率
        """
^
src/ml_strategy/backtest/performance_metrics.py:188:1: D400 First line should end with a period
        """
        最大回撤 (Maximum Drawdown)

        参数:
            equity_curve: 权益曲线

        返回:
            float: 最大回撤比例（正数）
        """
^
src/ml_strategy/backtest/performance_metrics.py:207:1: D400 First line should end with a period
        """
        最大回撤持续时间

        参数:
            equity_curve: 权益曲线

        返回:
            int: 最大回撤持续天数
        """
^
src/ml_strategy/backtest/performance_metrics.py:241:1: D400 First line should end with a period
        """
        卡尔玛比率 (Calmar Ratio)

        年化收益率 / 最大回撤

        参数:
            daily_returns: 每日收益率
            equity_curve: 权益曲线

        返回:
            float: 卡尔玛比率
        """
^
src/ml_strategy/backtest/performance_metrics.py:262:1: D400 First line should end with a period
        """
        波动率（年化标准差）

        参数:
            daily_returns: 每日收益率

        返回:
            float: 年化波动率
        """
^
src/ml_strategy/backtest/performance_metrics.py:276:1: D400 First line should end with a period
        """
        风险价值 (Value at Risk, VaR)

        给定置信水平下的最大损失

        参数:
            daily_returns: 每日收益率
            confidence: 置信水平（默认95%）

        返回:
            float: VaR值（负数表示损失）
        """
^
src/ml_strategy/backtest/performance_metrics.py:293:1: D400 First line should end with a period
        """
        条件风险价值 (Conditional VaR, CVaR)

        超过VaR的平均损失

        参数:
            daily_returns: 每日收益率
            confidence: 置信水平（默认95%）

        返回:
            float: CVaR值
        """
^
src/ml_strategy/backtest/performance_metrics.py:308:80: E501 line too long (88 > 79 characters)
    def alpha(self, strategy_returns: pd.Series, benchmark_returns: pd.Series) -> float:
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:309:1: D400 First line should end with a period
        """
        Alpha - 超额收益

        参数:
            strategy_returns: 策略收益率
            benchmark_returns: 基准收益率

        返回:
            float: Alpha值（年化）
        """
^
src/ml_strategy/backtest/performance_metrics.py:333:80: E501 line too long (87 > 79 characters)
    def beta(self, strategy_returns: pd.Series, benchmark_returns: pd.Series) -> float:
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:334:1: D400 First line should end with a period
        """
        Beta - 系统性风险

        参数:
            strategy_returns: 策略收益率
            benchmark_returns: 基准收益率

        返回:
            float: Beta值
        """
^
src/ml_strategy/backtest/performance_metrics.py:364:1: D400 First line should end with a period
        """
        信息比率 (Information Ratio)

        超额收益 / 跟踪误差

        参数:
            strategy_returns: 策略收益率
            benchmark_returns: 基准收益率

        返回:
            float: 信息比率
        """
^
src/ml_strategy/backtest/performance_metrics.py:397:1: D400 First line should end with a period
        """计算交易统计"""
^
src/ml_strategy/backtest/performance_metrics.py:411:80: E501 line too long (81 > 79 characters)
                np.mean([t.pnl for t in winning_trades]) if winning_trades else 0
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:413:80: E501 line too long (88 > 79 characters)
            "avg_loss": np.mean([t.pnl for t in losing_trades]) if losing_trades else 0,
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:417:80: E501 line too long (88 > 79 characters)
            "largest_loss": min([t.pnl for t in losing_trades]) if losing_trades else 0,
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:424:80: E501 line too long (80 > 79 characters)
        total_wins = sum(t.pnl for t in winning_trades) if winning_trades else 0
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:425:80: E501 line too long (85 > 79 characters)
        total_losses = abs(sum(t.pnl for t in losing_trades)) if losing_trades else 1
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:426:80: E501 line too long (85 > 79 characters)
        stats["profit_factor"] = total_wins / total_losses if total_losses > 0 else 0
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:437:1: D400 First line should end with a period
        """
        生成性能报告

        参数:
            metrics: 性能指标字典

        返回:
            str: 格式化的报告文本
        """
^
src/ml_strategy/backtest/performance_metrics.py:455:80: E501 line too long (84 > 79 characters)
        report.append(f"  最终资金:          {metrics.get('final_capital', 0):>15,.2f}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:456:80: E501 line too long (82 > 79 characters)
        report.append(f"  总收益率:          {metrics.get('total_return', 0):>15.2%}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:463:80: E501 line too long (82 > 79 characters)
        report.append(f"  最大回撤:          {metrics.get('max_drawdown', 0):>15.2%}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:469:80: E501 line too long (82 > 79 characters)
        report.append(f"  夏普比率:          {metrics.get('sharpe_ratio', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:470:80: E501 line too long (82 > 79 characters)
        report.append(f"  索提诺比率:        {metrics.get('sortino_ratio', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:471:80: E501 line too long (81 > 79 characters)
        report.append(f"  卡尔玛比率:        {metrics.get('calmar_ratio', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:475:80: E501 line too long (81 > 79 characters)
        report.append(f"  盈利次数:          {metrics.get('winning_trades', 0):>15}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:476:80: E501 line too long (80 > 79 characters)
        report.append(f"  亏损次数:          {metrics.get('losing_trades', 0):>15}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:477:80: E501 line too long (80 > 79 characters)
        report.append(f"  胜率:              {metrics.get('win_rate', 0):>15.2%}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:478:80: E501 line too long (84 > 79 characters)
        report.append(f"  盈亏比:            {metrics.get('profit_factor', 0):>15.2f}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:487:80: E501 line too long (84 > 79 characters)
            report.append(f"  信息比率:          {metrics['information_ratio']:>15.3f}")
                                                                               ^
src/ml_strategy/backtest/performance_metrics.py:509:80: E501 line too long (85 > 79 characters)
        {"equity": equity, "cash": 50000, "position": 500, "price": 100}, index=dates
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:1:1: D400 First line should end with a period
"""
风险指标计算模块 (Risk Metrics)

功能说明:
- 计算各种风险度量指标
- 提供风险敞口分析
- 生成风险报告

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/backtest/risk_metrics.py:22:1: D400 First line should end with a period
    """
    风险指标计算器

    提供全面的风险分析指标
    """
^
src/ml_strategy/backtest/risk_metrics.py:29:1: D400 First line should end with a period
        """初始化风险指标计算器"""
^
src/ml_strategy/backtest/risk_metrics.py:36:1: D400 First line should end with a period
        """
        下行偏差 (Downside Deviation)

        只考虑低于目标收益的波动

        参数:
            returns: 收益率序列
            target_return: 目标收益率

        返回:
            float: 年化下行偏差
        """
^
src/ml_strategy/backtest/risk_metrics.py:57:1: D400 First line should end with a period
        """
        溃疡指数 (Ulcer Index)

        衡量回撤的深度和持续时间

        参数:
            equity_curve: 权益曲线

        返回:
            float: 溃疡指数
        """
^
src/ml_strategy/backtest/risk_metrics.py:80:1: D400 First line should end with a period
        """
        痛苦指数 (Pain Index)

        平均回撤深度

        参数:
            equity_curve: 权益曲线

        返回:
            float: 痛苦指数
        """
^
src/ml_strategy/backtest/risk_metrics.py:101:1: D400 First line should end with a period
        """
        尾部比率 (Tail Ratio)

        右尾(95分位)与左尾(5分位)的比率

        参数:
            returns: 收益率序列

        返回:
            float: 尾部比率
        """
^
src/ml_strategy/backtest/risk_metrics.py:121:1: D400 First line should end with a period
        """
        偏度 (Skewness)

        收益分布的不对称性
        - 正值: 右偏（正收益较多）
        - 负值: 左偏（负收益较多）

        参数:
            returns: 收益率序列

        返回:
            float: 偏度
        """
^
src/ml_strategy/backtest/risk_metrics.py:137:1: D400 First line should end with a period
        """
        峰度 (Kurtosis)

        收益分布的尖峭程度
        - 正值: 尖峭（极端值较多）
        - 负值: 平坦

        参数:
            returns: 收益率序列

        返回:
            float: 峰度（超额峰度）
        """
^
src/ml_strategy/backtest/risk_metrics.py:152:80: E501 line too long (83 > 79 characters)
    def omega_ratio(self, returns: pd.Series, target_return: float = 0.0) -> float:
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:153:1: D400 First line should end with a period
        """
        Omega比率

        高于目标收益的概率加权收益 / 低于目标收益的概率加权损失

        参数:
            returns: 收益率序列
            target_return: 目标收益率

        返回:
            float: Omega比率
        """
^
src/ml_strategy/backtest/risk_metrics.py:181:1: D400 First line should end with a period
        """
        Burke比率

        超额收益 / 回撤平方和的平方根

        参数:
            returns: 收益率序列
            equity_curve: 权益曲线
            risk_free_rate: 无风险利率

        返回:
            float: Burke比率
        """
^
src/ml_strategy/backtest/risk_metrics.py:211:1: D400 First line should end with a period
        """
        最大连续亏损

        参数:
            trades: 交易记录列表

        返回:
            tuple: (最大连续亏损次数, 最大连续亏损金额)
        """
^
src/ml_strategy/backtest/risk_metrics.py:240:80: E501 line too long (81 > 79 characters)
    def recovery_factor(self, total_return: float, max_drawdown: float) -> float:
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:241:1: D400 First line should end with a period
        """
        恢复因子

        总收益 / 最大回撤

        参数:
            total_return: 总收益率
            max_drawdown: 最大回撤

        返回:
            float: 恢复因子
        """
^
src/ml_strategy/backtest/risk_metrics.py:259:1: D400 First line should end with a period
        """
        盈亏比 (Payoff Ratio)

        平均盈利 / 平均亏损

        参数:
            trades: 交易记录列表

        返回:
            float: 盈亏比
        """
^
src/ml_strategy/backtest/risk_metrics.py:288:1: D400 First line should end with a period
        """
        交易期望值

        (胜率 × 平均盈利) - (败率 × 平均亏损)

        参数:
            trades: 交易记录列表

        返回:
            float: 期望值
        """
^
src/ml_strategy/backtest/risk_metrics.py:322:1: D400 First line should end with a period
        """
        计算所有风险指标

        参数:
            equity_curve: 权益曲线
            returns: 收益率序列
            trades: 交易记录列表
            total_return: 总收益率
            max_drawdown: 最大回撤
            risk_free_rate: 无风险利率

        返回:
            dict: 所有风险指标
        """
^
src/ml_strategy/backtest/risk_metrics.py:350:80: E501 line too long (88 > 79 characters)
        metrics["burke_ratio"] = self.burke_ratio(returns, equity_curve, risk_free_rate)
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:351:80: E501 line too long (85 > 79 characters)
        metrics["recovery_factor"] = self.recovery_factor(total_return, max_drawdown)
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:364:1: D400 First line should end with a period
        """
        生成风险报告

        参数:
            metrics: 风险指标字典

        返回:
            str: 格式化的风险报告
        """
^
src/ml_strategy/backtest/risk_metrics.py:382:80: E501 line too long (81 > 79 characters)
        report.append(f"  溃疡指数:          {metrics.get('ulcer_index', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:383:80: E501 line too long (80 > 79 characters)
        report.append(f"  痛苦指数:          {metrics.get('pain_index', 0):>15.2%}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:386:80: E501 line too long (80 > 79 characters)
        report.append(f"  偏度:              {metrics.get('skewness', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:387:80: E501 line too long (80 > 79 characters)
        report.append(f"  峰度:              {metrics.get('kurtosis', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:388:80: E501 line too long (80 > 79 characters)
        report.append(f"  尾部比率:          {metrics.get('tail_ratio', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:391:80: E501 line too long (83 > 79 characters)
        report.append(f"  Omega比率:         {metrics.get('omega_ratio', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:392:80: E501 line too long (83 > 79 characters)
        report.append(f"  Burke比率:         {metrics.get('burke_ratio', 0):>15.3f}")
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:406:80: E501 line too long (82 > 79 characters)
                f"  最大连续亏损:      {metrics.get('max_consecutive_losses', 0):>12} 次"
                                                                               ^
src/ml_strategy/backtest/risk_metrics.py:409:80: E501 line too long (88 > 79 characters)
                f"  最大连续亏损额:    {metrics.get('max_consecutive_loss_amount', 0):>15,.2f}"
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:1:1: D400 First line should end with a period
"""
向量化回测引擎 (Vectorized Backtester)

功能说明:
- 基于预计算信号的向量化回测
- 支持多种仓位管理策略
- 自动计算交易成本（佣金、印花税、滑点）
- 生成详细的交易记录和权益曲线
- 性能优于事件驱动回测（10-100x）

设计原理:
- 使用NumPy向量化操作，避免循环
- 预计算所有买卖点位
- 批量计算收益和成本
- 适合已有信号的策略回测

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/backtest/vectorized_backtester.py:32:1: D400 First line should end with a period
    """回测配置"""
^
src/ml_strategy/backtest/vectorized_backtester.py:52:1: D400 First line should end with a period
    """交易记录"""
^
src/ml_strategy/backtest/vectorized_backtester.py:68:1: D400 First line should end with a period
    """
    向量化回测引擎

    特点:
    - 基于预计算的买卖信号
    - 向量化计算，性能优异
    - 支持多种仓位管理模式
    - 自动计算交易成本
    """
^
src/ml_strategy/backtest/vectorized_backtester.py:79:1: D400 First line should end with a period
        """
        初始化回测引擎

        参数:
            config: 回测配置
        """
^
src/ml_strategy/backtest/vectorized_backtester.py:97:1: D400 First line should end with a period
        """
        执行回测

        参数:
            price_data: 价格数据，包含 open, high, low, close, volume
                       index必须是DatetimeIndex
            signals: 信号数据，包含 signal ('buy'/'sell'), strength (可选)
                    index必须与price_data对齐

        返回:
            dict: 回测结果
                - trades: 交易记录列表
                - equity_curve: 权益曲线DataFrame
                - summary: 汇总统计

        示例:
            >>> backtester = VectorizedBacktester()
            >>> result = backtester.run(price_data, signals)
            >>> print(f"总收益率: {result['summary']['total_return']:.2%}")
        """
^
src/ml_strategy/backtest/vectorized_backtester.py:119:80: E501 line too long (81 > 79 characters)
        self.logger.info(f"数据范围: {price_data.index[0]} 至 {price_data.index[-1]}")
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:173:80: E501 line too long (81 > 79 characters)
                    pnl = sell_amount - (entry_shares * entry_price) - total_cost
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:187:80: E501 line too long (86 > 79 characters)
                        slippage=position * current_price * self.config.slippage_rate,
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:234:80: E501 line too long (80 > 79 characters)
                unrealized_pnl_pct = (current_price - entry_price) / entry_price
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:241:80: E501 line too long (80 > 79 characters)
                    self.logger.info(f"触发止损: {idx}, 亏损{unrealized_pnl_pct:.2%}")
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:250:80: E501 line too long (80 > 79 characters)
                    self.logger.info(f"触发止盈: {idx}, 盈利{unrealized_pnl_pct:.2%}")
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:263:80: E501 line too long (85 > 79 characters)
                sell_amount * self.config.commission_rate, self.config.min_commission
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:270:80: E501 line too long (87 > 79 characters)
                    sell_amount - (entry_shares * entry_price) - commission - stamp_tax
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:327:1: D400 First line should end with a period
        """验证输入数据"""
^
src/ml_strategy/backtest/vectorized_backtester.py:342:1: D400 First line should end with a period
        """计算汇总统计"""
^
src/ml_strategy/backtest/vectorized_backtester.py:366:80: E501 line too long (80 > 79 characters)
        win_rate = len(winning_trades) / total_trades if total_trades > 0 else 0
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:368:80: E501 line too long (83 > 79 characters)
        avg_win = np.mean([t.pnl for t in winning_trades]) if winning_trades else 0
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:369:80: E501 line too long (82 > 79 characters)
        avg_loss = np.mean([t.pnl for t in losing_trades]) if losing_trades else 0
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:371:80: E501 line too long (80 > 79 characters)
        total_wins = sum(t.pnl for t in winning_trades) if winning_trades else 0
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:372:80: E501 line too long (85 > 79 characters)
        total_losses = abs(sum(t.pnl for t in losing_trades)) if losing_trades else 1
                                                                               ^
src/ml_strategy/backtest/vectorized_backtester.py:388:1: D400 First line should end with a period
        """
        获取交易记录DataFrame

        返回:
            pd.DataFrame: 交易记录
        """
^
src/ml_strategy/backtest/vectorized_backtester.py:462:11: F541 f-string is missing placeholders
    print(f"\n回测结果:")
          ^
src/ml_strategy/backtest/vectorized_backtester.py:470:15: F541 f-string is missing placeholders
        print(f"\n前5笔交易:")
              ^
src/ml_strategy/feature_engineering.py:1:1: D400 First line should end with a period
"""
特征工程模块 - 滚动窗口特征生成

基于 PyProf 项目的特征工程方法，扩展为更完整的特征生成系统。
支持滚动窗口特征、技术指标特征和自定义特征。

作者: MyStocks Development Team
创建日期: 2025-10-19
版本: 1.0.0
"""
^
src/ml_strategy/feature_engineering.py:17:1: E402 module level import not at top of file
from typing import Tuple, List, Dict
^
src/ml_strategy/feature_engineering.py:18:1: E402 module level import not at top of file
import pandas as pd
^
src/ml_strategy/feature_engineering.py:19:1: E402 module level import not at top of file
import numpy as np
^
src/ml_strategy/feature_engineering.py:20:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/feature_engineering.py:21:1: E402 module level import not at top of file
from queue import Queue
^
src/ml_strategy/feature_engineering.py:25:1: D400 First line should end with a period
    """
    滚动窗口特征生成器

    生成基于历史数据的滚动窗口特征,用于机器学习预测。

    主要功能:
    - 滚动窗口特征提取
    - 技术指标计算
    - 特征矩阵构建

    示例:
        >>> generator = RollingFeatureGenerator(window_size=10)
        >>> X, y = generator.prepare_ml_data(df, target_col='close', forecast_horizon=1)
    """
^
src/ml_strategy/feature_engineering.py:37:80: E501 line too long (88 > 79 characters)
    """
    滚动窗口特征生成器

    生成基于历史数据的滚动窗口特征,用于机器学习预测。

    主要功能:
    - 滚动窗口特征提取
    - 技术指标计算
    - 特征矩阵构建

    示例:
        >>> generator = RollingFeatureGenerator(window_size=10)
        >>> X, y = generator.prepare_ml_data(df, target_col='close', forecast_horizon=1)
    """







^
src/ml_strategy/feature_engineering.py:41:1: D400 First line should end with a period
        """
        初始化特征生成器

        Args:
            window_size: 滚动窗口大小（天数）
        """
^
src/ml_strategy/feature_engineering.py:51:1: D400 First line should end with a period
        """
        生成滚动窗口特征

        Args:
            df: 包含 OHLCV 数据的 DataFrame
                必需列: open, high, low, close, vol

        Returns:
            DataFrame: 包含滚动窗口特征的数据
        """
^
src/ml_strategy/feature_engineering.py:75:31: E203 whitespace before ':'
            window = df.iloc[i : i + self.window_size]
                              ^
src/ml_strategy/feature_engineering.py:91:80: E501 line too long (81 > 79 characters)
    def _extract_window_features(self, window: pd.DataFrame) -> Dict[str, float]:
                                                                               ^
src/ml_strategy/feature_engineering.py:92:1: D400 First line should end with a period
        """
        从单个窗口提取特征

        Args:
            window: 窗口数据

        Returns:
            特征字典
        """
^
src/ml_strategy/feature_engineering.py:169:1: D400 First line should end with a period
        """
        生成滚动原始特征（PyProf 原始方法）

        将过去 N 天的原始数据展平为特征向量。
        例如: window_size=3 时, 生成 3×feature_num 个特征列

        Args:
            df: 原始数据
            feature_cols: 要使用的特征列（默认: open, high, low, close, vol, amount）

        Returns:
            DataFrame: 包含展平特征的数据
        """
^
src/ml_strategy/feature_engineering.py:193:13: B007 Loop control variable 'index' not used within the loop body. If this is intended, start the name with an underscore.
        for index, row in df.iterrows():
            ^
src/ml_strategy/feature_engineering.py:233:1: D400 First line should end with a period
        """
        准备机器学习数据

        Args:
            df: 原始数据
            target_col: 目标列名
            forecast_horizon: 预测步长（天数）
            feature_type: 特征类型
                - 'aggregate': 聚合特征（均值、标准差等）
                - 'raw': 原始滚动特征（展平）

        Returns:
            (X, y): 特征矩阵和目标变量
        """
^
src/ml_strategy/feature_engineering.py:240:1: RST301 Unexpected indentation.
        """
        准备机器学习数据

        Args:
            df: 原始数据
            target_col: 目标列名
            forecast_horizon: 预测步长（天数）
            feature_type: 特征类型
                - 'aggregate': 聚合特征（均值、标准差等）
                - 'raw': 原始滚动特征（展平）

        Returns:
            (X, y): 特征矩阵和目标变量
        """
^
src/ml_strategy/feature_engineering.py:255:14: N806 variable 'X' in function should be lowercase
            X = self.generate_features(df)
             ^
src/ml_strategy/feature_engineering.py:257:14: N806 variable 'X' in function should be lowercase
            X = self.generate_rolling_raw_features(df)
             ^
src/ml_strategy/feature_engineering.py:279:10: N806 variable 'X' in function should be lowercase
        X = X.iloc[: len(y)].reset_index(drop=True)
         ^
src/ml_strategy/feature_engineering.py:288:10: N806 variable 'X' in function should be lowercase
        X = X[mask].reset_index(drop=True)
         ^
src/ml_strategy/feature_engineering.py:296:1: D400 First line should end with a period
        """
        添加技术指标特征

        Args:
            df: 原始OHLCV数据

        Returns:
            DataFrame: 添加技术指标后的数据
        """
^
src/ml_strategy/indicators/__init__.py:1:1: D104 Missing docstring in public package
src/ml_strategy/indicators/talib_wrapper.py:1:1: D400 First line should end with a period
"""
TA-Lib 技术指标包装器

功能说明:
- 封装TA-Lib库的常用技术指标函数
- 提供统一的错误处理和参数验证
- 支持pandas Series和numpy array输入
- 自动处理NaN值和数据长度校验

依赖:
- TA-Lib 0.6.7+ (使用binary wheels安装)

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/indicators/talib_wrapper.py:25:1: D400 First line should end with a period
    """
    TA-Lib技术指标包装类

    提供常用技术指标的便捷访问接口，自动处理输入数据格式和异常情况
    """
^
src/ml_strategy/indicators/talib_wrapper.py:33:1: D400 First line should end with a period
        """
        将输入数据转换为numpy array

        参数:
            data: 输入数据 (numpy array或pandas Series)

        返回:
            np.ndarray: 转换后的numpy数组
        """
^
src/ml_strategy/indicators/talib_wrapper.py:48:1: D400 First line should end with a period
        """
        验证数据长度

        参数:
            data: 输入数据
            min_length: 最小数据长度
            name: 数据名称(用于错误提示)

        异常:
            ValueError: 数据长度不足
        """
^
src/ml_strategy/indicators/talib_wrapper.py:72:1: D400 First line should end with a period
        """
        简单移动平均 (Simple Moving Average)

        参数:
            close: 收盘价序列
            period: 移动平均周期

        返回:
            np.ndarray: SMA值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:90:1: D400 First line should end with a period
        """
        指数移动平均 (Exponential Moving Average)

        参数:
            close: 收盘价序列
            period: EMA周期

        返回:
            np.ndarray: EMA值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:108:1: D400 First line should end with a period
        """
        加权移动平均 (Weighted Moving Average)

        参数:
            close: 收盘价序列
            period: WMA周期

        返回:
            np.ndarray: WMA值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:130:1: D400 First line should end with a period
        """
        MACD指标 (Moving Average Convergence Divergence)

        参数:
            close: 收盘价序列
            fastperiod: 快速EMA周期
            slowperiod: 慢速EMA周期
            signalperiod: 信号线周期

        返回:
            tuple: (MACD线, 信号线, MACD柱)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:160:1: D400 First line should end with a period
        """
        相对强弱指标 (Relative Strength Index)

        参数:
            close: 收盘价序列
            period: RSI周期

        返回:
            np.ndarray: RSI值序列 (0-100)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:184:1: D400 First line should end with a period
        """
        随机指标 (Stochastic Oscillator)

        参数:
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列
            fastk_period: FastK周期
            slowk_period: SlowK周期
            slowd_period: SlowD周期

        返回:
            tuple: (SlowK, SlowD)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:225:1: D400 First line should end with a period
        """
        顺势指标 (Commodity Channel Index)

        参数:
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列
            period: CCI周期

        返回:
            np.ndarray: CCI值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:248:1: D400 First line should end with a period
        """
        动量指标 (Momentum)

        参数:
            close: 收盘价序列
            period: 动量周期

        返回:
            np.ndarray: 动量值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:274:1: D400 First line should end with a period
        """
        布林带 (Bollinger Bands)

        参数:
            close: 收盘价序列
            period: 移动平均周期
            nbdevup: 上轨标准差倍数
            nbdevdn: 下轨标准差倍数

        返回:
            tuple: (上轨, 中轨, 下轨)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:290:80: E501 line too long (84 > 79 characters)
            close_arr, timeperiod=period, nbdevup=nbdevup, nbdevdn=nbdevdn, matype=0
                                                                               ^
src/ml_strategy/indicators/talib_wrapper.py:302:1: D400 First line should end with a period
        """
        平均真实波幅 (Average True Range)

        参数:
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列
            period: ATR周期

        返回:
            np.ndarray: ATR值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:327:80: E501 line too long (86 > 79 characters)
        cls, close: Union[np.ndarray, pd.Series], volume: Union[np.ndarray, pd.Series]
                                                                               ^
src/ml_strategy/indicators/talib_wrapper.py:329:1: D400 First line should end with a period
        """
        能量潮 (On Balance Volume)

        参数:
            close: 收盘价序列
            volume: 成交量序列

        返回:
            np.ndarray: OBV值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:353:1: D400 First line should end with a period
        """
        累积/派发线 (Accumulation/Distribution Line)

        参数:
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列
            volume: 成交量序列

        返回:
            np.ndarray: A/D线值序列
        """
^
src/ml_strategy/indicators/talib_wrapper.py:385:1: D400 First line should end with a period
        """
        十字星形态识别 (Doji)

        参数:
            open_: 开盘价序列
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列

        返回:
            np.ndarray: 形态标识 (100=看涨, -100=看跌, 0=无形态)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:388:1: RST306 Unknown target name: "open".
        """
        十字星形态识别 (Doji)

        参数:
            open_: 开盘价序列
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列

        返回:
            np.ndarray: 形态标识 (100=看涨, -100=看跌, 0=无形态)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:412:1: D400 First line should end with a period
        """
        锤子线形态识别 (Hammer)

        参数:
            open_: 开盘价序列
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列

        返回:
            np.ndarray: 形态标识 (100=看涨锤子线, 0=无形态)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:415:1: RST306 Unknown target name: "open".
        """
        锤子线形态识别 (Hammer)

        参数:
            open_: 开盘价序列
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列

        返回:
            np.ndarray: 形态标识 (100=看涨锤子线, 0=无形态)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:439:1: D400 First line should end with a period
        """
        吞没形态识别 (Engulfing)

        参数:
            open_: 开盘价序列
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列

        返回:
            np.ndarray: 形态标识 (100=看涨吞没, -100=看跌吞没, 0=无形态)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:442:1: RST306 Unknown target name: "open".
        """
        吞没形态识别 (Engulfing)

        参数:
            open_: 开盘价序列
            high: 最高价序列
            low: 最低价序列
            close: 收盘价序列

        返回:
            np.ndarray: 形态标识 (100=看涨吞没, -100=看跌吞没, 0=无形态)
        """
^
src/ml_strategy/indicators/talib_wrapper.py:463:80: E501 line too long (81 > 79 characters)
    def calculate_all_indicators(cls, df: pd.DataFrame) -> Dict[str, np.ndarray]:
                                                                               ^
src/ml_strategy/indicators/talib_wrapper.py:464:1: D400 First line should end with a period
        """
        批量计算所有常用指标

        参数:
            df: K线数据DataFrame，需包含 open, high, low, close, volume 列

        返回:
            dict: 指标名称到值序列的映射

        示例:
            >>> indicators = TALibIndicators.calculate_all_indicators(df)
            >>> print(indicators.keys())
            dict_keys(['ma5', 'ma20', 'ema12', 'ema26', 'rsi14', ...])
        """
^
src/ml_strategy/indicators/talib_wrapper.py:513:80: E501 line too long (87 > 79 characters)
        indicators["atr14"] = cls.calculate_atr(df["high"], df["low"], df["close"], 14)
                                                                               ^
src/ml_strategy/indicators/talib_wrapper.py:558:80: E501 line too long (82 > 79 characters)
    upper, middle, lower = TALibIndicators.calculate_bbands(df["close"], 20, 2, 2)
                                                                               ^
src/ml_strategy/indicators/tdx_functions.py:1:1: D400 First line should end with a period
"""
TDX (Tongdaxin) 兼容技术指标函数库

功能说明:
- 提供与通达信公式兼容的技术指标函数
- 使用NumPy向量化计算，性能优于pandas rolling
- 支持多种技术分析指标 (MA, EMA, MACD, KDJ, RSI等)
- 自动处理NaN值和边界条件

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/indicators/tdx_functions.py:20:6: N802 function name 'MA' should be lowercase
def MA(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:21:1: D400 First line should end with a period
    """
    简单移动平均 (Simple Moving Average)

    参数:
        data: 价格序列 (收盘价、成交量等)
        period: 移动平均周期

    返回:
        np.ndarray: 移动平均值序列 (前period-1个值为NaN)

    示例:
        >>> close = np.array([10, 11, 12, 13, 14, 15])
        >>> ma5 = MA(close, 5)
        >>> print(ma5)
        [nan nan nan nan 12. 13.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:49:22: E203 whitespace before ':'
    result[period - 1 :] = ma
                     ^
src/ml_strategy/indicators/tdx_functions.py:54:6: N802 function name 'SMA' should be lowercase
def SMA(
     ^
src/ml_strategy/indicators/tdx_functions.py:57:1: D400 First line should end with a period
    """
    平滑移动平均 (Smoothed Moving Average)

    TDX公式: SMA(X, N, M) = (M*X + (N-M)*Y) / N
    其中Y为上一周期SMA值

    参数:
        data: 价格序列
        period: 平滑周期
        weight: 权重系数 (默认1.0)

    返回:
        np.ndarray: 平滑移动平均值序列

    示例:
        >>> close = np.array([10, 11, 12, 13, 14, 15])
        >>> sma5 = SMA(close, 5, 1)
    """
^
src/ml_strategy/indicators/tdx_functions.py:92:6: N802 function name 'EMA' should be lowercase
def EMA(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:93:1: D400 First line should end with a period
    """
    指数移动平均 (Exponential Moving Average)

    参数:
        data: 价格序列
        period: EMA周期

    返回:
        np.ndarray: 指数移动平均值序列

    示例:
        >>> close = np.array([10, 11, 12, 13, 14, 15])
        >>> ema5 = EMA(close, 5)
    """
^
src/ml_strategy/indicators/tdx_functions.py:123:6: N802 function name 'CROSS' should be lowercase
def CROSS(
     ^
src/ml_strategy/indicators/tdx_functions.py:124:80: E501 line too long (80 > 79 characters)
    series1: Union[np.ndarray, pd.Series], series2: Union[np.ndarray, pd.Series]
                                                                               ^
src/ml_strategy/indicators/tdx_functions.py:126:1: D400 First line should end with a period
    """
    交叉函数 - 判断series1是否向上穿越series2

    参数:
        series1: 第一个序列 (通常是短期均线)
        series2: 第二个序列 (通常是长期均线)

    返回:
        np.ndarray: 布尔数组，True表示发生向上交叉

    示例:
        >>> ma5 = np.array([10, 11, 12, 13, 14])
        >>> ma10 = np.array([12, 12, 12, 12, 12])
        >>> cross = CROSS(ma5, ma10)
        >>> print(cross)
        [False False False  True False]
    """
^
src/ml_strategy/indicators/tdx_functions.py:153:80: E501 line too long (80 > 79 characters)
        cross[1:] = (series1[1:] > series2[1:]) & (series1[:-1] <= series2[:-1])
                                                                               ^
src/ml_strategy/indicators/tdx_functions.py:158:6: N802 function name 'HHV' should be lowercase
def HHV(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:159:1: D400 First line should end with a period
    """
    最高值 (Highest High Value) - 滚动窗口内的最高价

    参数:
        data: 价格序列
        period: 滚动窗口周期

    返回:
        np.ndarray: 滚动最高值序列

    示例:
        >>> high = np.array([10, 12, 11, 15, 13, 14])
        >>> hhv5 = HHV(high, 5)
        >>> print(hhv5)
        [nan nan nan nan 15. 15.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:181:47: E203 whitespace before ':'
        result[i] = np.max(data[i - period + 1 : i + 1])
                                              ^
src/ml_strategy/indicators/tdx_functions.py:186:6: N802 function name 'LLV' should be lowercase
def LLV(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:187:1: D400 First line should end with a period
    """
    最低值 (Lowest Low Value) - 滚动窗口内的最低价

    参数:
        data: 价格序列
        period: 滚动窗口周期

    返回:
        np.ndarray: 滚动最低值序列

    示例:
        >>> low = np.array([10, 12, 11, 15, 13, 14])
        >>> llv5 = LLV(low, 5)
        >>> print(llv5)
        [nan nan nan nan 10. 11.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:209:47: E203 whitespace before ':'
        result[i] = np.min(data[i - period + 1 : i + 1])
                                              ^
src/ml_strategy/indicators/tdx_functions.py:214:6: N802 function name 'REF' should be lowercase
def REF(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:215:1: D400 First line should end with a period
    """
    引用函数 - 获取period周期前的数据

    参数:
        data: 价格序列
        period: 向前引用的周期数

    返回:
        np.ndarray: 向前引用后的序列

    示例:
        >>> close = np.array([10, 11, 12, 13, 14, 15])
        >>> ref1 = REF(close, 1)
        >>> print(ref1)
        [nan 10. 11. 12. 13. 14.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:240:6: N802 function name 'BARSLAST' should be lowercase
def BARSLAST(condition: Union[np.ndarray, pd.Series]) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:241:1: D400 First line should end with a period
    """
    上一次条件成立位置 - 距离上次条件为True的周期数

    参数:
        condition: 布尔数组

    返回:
        np.ndarray: 距离上次True的周期数

    示例:
        >>> cond = np.array([False, True, False, False, True, False])
        >>> bars = BARSLAST(cond)
        >>> print(bars)
        [nan  0.  1.  2.  0.  1.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:272:6: N802 function name 'STD' should be lowercase
def STD(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:273:1: D400 First line should end with a period
    """
    标准差 (Standard Deviation) - 滚动窗口标准差

    参数:
        data: 价格序列
        period: 滚动窗口周期

    返回:
        np.ndarray: 滚动标准差序列

    示例:
        >>> close = np.array([10, 11, 12, 13, 14, 15])
        >>> std5 = STD(close, 5)
    """
^
src/ml_strategy/indicators/tdx_functions.py:293:47: E203 whitespace before ':'
        result[i] = np.std(data[i - period + 1 : i + 1], ddof=1)
                                              ^
src/ml_strategy/indicators/tdx_functions.py:298:6: N802 function name 'SUM' should be lowercase
def SUM(data: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:299:1: D400 First line should end with a period
    """
    求和函数 - 滚动窗口求和

    参数:
        data: 价格序列
        period: 滚动窗口周期

    返回:
        np.ndarray: 滚动求和序列

    示例:
        >>> volume = np.array([100, 200, 150, 300, 250])
        >>> sum3 = SUM(volume, 3)
        >>> print(sum3)
        [nan nan 450. 650. 700.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:321:47: E203 whitespace before ':'
        result[i] = np.sum(data[i - period + 1 : i + 1])
                                              ^
src/ml_strategy/indicators/tdx_functions.py:326:6: N802 function name 'COUNT' should be lowercase
def COUNT(condition: Union[np.ndarray, pd.Series], period: int) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:327:1: D400 First line should end with a period
    """
    计数函数 - 统计滚动窗口内条件为True的次数

    参数:
        condition: 布尔数组
        period: 滚动窗口周期

    返回:
        np.ndarray: 滚动计数序列

    示例:
        >>> cond = np.array([True, False, True, True, False, True])
        >>> count3 = COUNT(cond, 3)
        >>> print(count3)
        [nan nan  2.  2.  2.  2.]
    """
^
src/ml_strategy/indicators/tdx_functions.py:349:52: E203 whitespace before ':'
        result[i] = np.sum(condition[i - period + 1 : i + 1])
                                                   ^
src/ml_strategy/indicators/tdx_functions.py:354:6: N802 function name 'MAX' should be lowercase
def MAX(
     ^
src/ml_strategy/indicators/tdx_functions.py:355:80: E501 line too long (80 > 79 characters)
    series1: Union[np.ndarray, pd.Series], series2: Union[np.ndarray, pd.Series]
                                                                               ^
src/ml_strategy/indicators/tdx_functions.py:357:1: D400 First line should end with a period
    """
    取最大值 - 逐个元素比较取大

    参数:
        series1: 第一个序列
        series2: 第二个序列

    返回:
        np.ndarray: 逐个元素的最大值
    """
^
src/ml_strategy/indicators/tdx_functions.py:375:6: N802 function name 'MIN' should be lowercase
def MIN(
     ^
src/ml_strategy/indicators/tdx_functions.py:376:80: E501 line too long (80 > 79 characters)
    series1: Union[np.ndarray, pd.Series], series2: Union[np.ndarray, pd.Series]
                                                                               ^
src/ml_strategy/indicators/tdx_functions.py:378:1: D400 First line should end with a period
    """
    取最小值 - 逐个元素比较取小

    参数:
        series1: 第一个序列
        series2: 第二个序列

    返回:
        np.ndarray: 逐个元素的最小值
    """
^
src/ml_strategy/indicators/tdx_functions.py:396:6: N802 function name 'ABS' should be lowercase
def ABS(data: Union[np.ndarray, pd.Series]) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:397:1: D400 First line should end with a period
    """
    绝对值函数

    参数:
        data: 数据序列

    返回:
        np.ndarray: 绝对值序列
    """
^
src/ml_strategy/indicators/tdx_functions.py:417:6: N802 function name 'MACD' should be lowercase
def MACD(
     ^
src/ml_strategy/indicators/tdx_functions.py:423:1: D400 First line should end with a period
    """
    MACD指标 (Moving Average Convergence Divergence)

    参数:
        close: 收盘价序列
        fast_period: 快速EMA周期 (默认12)
        slow_period: 慢速EMA周期 (默认26)
        signal_period: 信号线周期 (默认9)

    返回:
        tuple: (DIF, DEA, MACD柱)

    示例:
        >>> close = np.random.randn(100) + 100
        >>> dif, dea, macd = MACD(close)
    """
^
src/ml_strategy/indicators/tdx_functions.py:452:6: N802 function name 'KDJ' should be lowercase
def KDJ(
     ^
src/ml_strategy/indicators/tdx_functions.py:460:1: D400 First line should end with a period
    """
    KDJ指标 (随机指标)

    参数:
        high: 最高价序列
        low: 最低价序列
        close: 收盘价序列
        n: RSV计算周期 (默认9)
        m1: K值平滑周期 (默认3)
        m2: D值平滑周期 (默认3)

    返回:
        tuple: (K, D, J)

    示例:
        >>> k, d, j = KDJ(high, low, close)
    """
^
src/ml_strategy/indicators/tdx_functions.py:498:6: N802 function name 'RSI' should be lowercase
def RSI(close: Union[np.ndarray, pd.Series], period: int = 14) -> np.ndarray:
     ^
src/ml_strategy/indicators/tdx_functions.py:499:1: D400 First line should end with a period
    """
    相对强弱指标 (Relative Strength Index)

    参数:
        close: 收盘价序列
        period: RSI周期 (默认14)

    返回:
        np.ndarray: RSI值序列 (0-100)

    示例:
        >>> close = np.random.randn(100) + 100
        >>> rsi14 = RSI(close, 14)
    """
^
src/ml_strategy/indicators/tdx_functions.py:534:6: N802 function name 'BOLL' should be lowercase
def BOLL(
     ^
src/ml_strategy/indicators/tdx_functions.py:537:1: D400 First line should end with a period
    """
    布林带指标 (Bollinger Bands)

    参数:
        close: 收盘价序列
        period: 移动平均周期 (默认20)
        std_dev: 标准差倍数 (默认2.0)

    返回:
        tuple: (上轨, 中轨, 下轨)

    示例:
        >>> upper, middle, lower = BOLL(close, 20, 2)
    """
^
src/ml_strategy/ml_strategy.py:1:1: D400 First line should end with a period
"""
机器学习策略 (Machine Learning Strategy)

功能说明:
- 基于机器学习的量化策略
- 自动特征工程
- 多种ML模型支持
- 模型训练和预测

支持的模型:
- Random Forest
- Gradient Boosting
- XGBoost / LightGBM
- Neural Networks

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/ml_strategy.py:26:1: E402 module level import not at top of file
from typing import Dict, List
^
src/ml_strategy/ml_strategy.py:27:1: E402 module level import not at top of file
import pandas as pd
^
src/ml_strategy/ml_strategy.py:28:1: E402 module level import not at top of file
import numpy as np
^
src/ml_strategy/ml_strategy.py:29:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/ml_strategy.py:30:1: S403 Consider possible security implications associated with pickle module.
import pickle
^
src/ml_strategy/ml_strategy.py:30:1: E402 module level import not at top of file
import pickle
^
src/ml_strategy/ml_strategy.py:34:80: E501 line too long (83 > 79 characters)
    from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
                                                                               ^
src/ml_strategy/ml_strategy.py:37:80: E501 line too long (87 > 79 characters)
    from sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score
                                                                               ^
src/ml_strategy/ml_strategy.py:54:1: D101 Missing docstring in public class
    class BaseStrategy:
^
src/ml_strategy/ml_strategy.py:59:1: D400 First line should end with a period
    """
    特征工程

    自动生成技术指标特征
    """
^
src/ml_strategy/ml_strategy.py:67:1: D400 First line should end with a period
        """
        创建特征

        参数:
            data: 价格数据（OHLCV）

        返回:
            DataFrame: 包含特征的数据
        """
^
src/ml_strategy/ml_strategy.py:93:80: E501 line too long (82 > 79 characters)
            df[f"momentum_{period}"] = df["close"] / df["close"].shift(period) - 1
                                                                               ^
src/ml_strategy/ml_strategy.py:128:1: D400 First line should end with a period
        """
        创建目标变量（分类）

        参数:
            data: 价格数据
            forward_days: 前瞻天数
            threshold: 涨跌阈值

        返回:
            Series: 目标变量 (1=涨, 0=跌)
        """
^
src/ml_strategy/ml_strategy.py:145:1: D400 First line should end with a period
    """
    机器学习策略

    使用机器学习模型预测股票涨跌
    """
^
src/ml_strategy/ml_strategy.py:158:1: D400 First line should end with a period
        """
        初始化ML策略

        参数:
            model_type: 模型类型 ('random_forest', 'gradient_boosting')
            forward_days: 预测天数
            threshold: 涨跌阈值（默认1%）
            kwargs: 其他参数
        """
^
src/ml_strategy/ml_strategy.py:171:80: E501 line too long (84 > 79 characters)
                parameters={"model_type": model_type, "forward_days": forward_days},
                                                                               ^
src/ml_strategy/ml_strategy.py:197:1: D400 First line should end with a period
        """创建ML模型"""
^
src/ml_strategy/ml_strategy.py:208:80: E501 line too long (81 > 79 characters)
                n_estimators=100, learning_rate=0.1, max_depth=5, random_state=42
                                                                               ^
src/ml_strategy/ml_strategy.py:214:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, test_size: float = 0.2, cross_validate: bool = True
                                                                               ^
src/ml_strategy/ml_strategy.py:216:1: D400 First line should end with a period
        """
        训练模型

        参数:
            data: 训练数据（OHLCV）
            test_size: 测试集比例
            cross_validate: 是否交叉验证

        返回:
            Dict: 训练结果
        """
^
src/ml_strategy/ml_strategy.py:246:80: E501 line too long (88 > 79 characters)
        self.feature_columns = [col for col in df.columns if col not in exclude_columns]
                                                                               ^
src/ml_strategy/ml_strategy.py:248:10: N806 variable 'X' in function should be lowercase
        X = df[self.feature_columns].values
         ^
src/ml_strategy/ml_strategy.py:257:10: N806 variable 'X_scaled' in function should be lowercase
        X_scaled = self.scaler.fit_transform(X)
         ^
src/ml_strategy/ml_strategy.py:261:10: N806 variable 'X_train' in function should be lowercase
        X_train, X_test, y_train, y_test = train_test_split(
         ^
src/ml_strategy/ml_strategy.py:261:10: N806 variable 'X_test' in function should be lowercase
        X_train, X_test, y_train, y_test = train_test_split(
         ^
src/ml_strategy/ml_strategy.py:297:80: E501 line too long (84 > 79 characters)
            self.logger.info(f"  CV准确率: {cv_score:.4f} (+/- {cv_scores.std():.4f})")
                                                                               ^
src/ml_strategy/ml_strategy.py:307:80: E501 line too long (83 > 79 characters)
                    f"  {i+1}. {self.feature_columns[idx]}: {importances[idx]:.4f}"
                                                                               ^
src/ml_strategy/ml_strategy.py:325:1: D400 First line should end with a period
        """
        预测

        参数:
            data: 预测数据

        返回:
            DataFrame: 预测结果
        """
^
src/ml_strategy/ml_strategy.py:341:10: N806 variable 'X' in function should be lowercase
        X = df[self.feature_columns].values
         ^
src/ml_strategy/ml_strategy.py:344:10: N806 variable 'X_scaled' in function should be lowercase
        X_scaled = self.scaler.transform(X)
         ^
src/ml_strategy/ml_strategy.py:358:1: D400 First line should end with a period
        """
        生成交易信号

        参数:
            data: 价格数据

        返回:
            DataFrame: 信号数据
        """
^
src/ml_strategy/ml_strategy.py:378:80: E501 line too long (80 > 79 characters)
        low_confidence = (predictions["probability"] > (1 - prob_threshold)) & (
                                                                               ^
src/ml_strategy/ml_strategy.py:390:1: D400 First line should end with a period
        """保存模型"""
^
src/ml_strategy/ml_strategy.py:409:1: D400 First line should end with a period
        """加载模型"""
^
src/ml_strategy/ml_strategy.py:411:1: S301 Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
            model_data = pickle.load(f)
^
src/ml_strategy/ml_strategy.py:425:1: D400 First line should end with a period
        """计算评估指标"""
^
src/ml_strategy/ml_strategy.py:472:80: E501 line too long (85 > 79 characters)
    strategy = MLStrategy(model_type="random_forest", forward_days=1, threshold=0.01)
                                                                               ^
src/ml_strategy/price_predictor.py:1:1: D400 First line should end with a period
"""
价格预测策略模块 - LightGBM 股票价格预测

基于 PyProf 项目的价格预测模型，扩展为完整的预测策略系统。
使用 LightGBM 梯度提升决策树进行回归预测。

主要功能:
- LightGBM 模型训练
- 价格预测
- 超参数调优
- 模型持久化
- 完整的评估指标

作者: MyStocks Development Team
创建日期: 2025-10-19
版本: 1.0.0
"""
^
src/ml_strategy/price_predictor.py:24:1: E402 module level import not at top of file
from typing import Dict, Any, Optional, Tuple
^
src/ml_strategy/price_predictor.py:25:1: E402 module level import not at top of file
import pandas as pd
^
src/ml_strategy/price_predictor.py:26:1: E402 module level import not at top of file
import numpy as np
^
src/ml_strategy/price_predictor.py:27:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/price_predictor.py:28:1: E402 module level import not at top of file
from datetime import datetime
^
src/ml_strategy/price_predictor.py:31:1: E402 module level import not at top of file
from sklearn.model_selection import train_test_split, GridSearchCV
^
src/ml_strategy/price_predictor.py:32:1: E402 module level import not at top of file
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score
^
src/ml_strategy/price_predictor.py:33:1: E402 module level import not at top of file
import joblib
^
src/ml_strategy/price_predictor.py:46:1: D400 First line should end with a period
    """
    股票价格预测策略

    基于 LightGBM 的价格回归预测模型。

    示例:
        >>> predictor = PricePredictorStrategy()
        >>> metrics = predictor.train(X_train, y_train)
        >>> predictions = predictor.predict(X_test)
        >>> predictor.save_model('models/sh000001.pkl')
    """
^
src/ml_strategy/price_predictor.py:59:1: D400 First line should end with a period
        """
        初始化预测器

        Args:
            config: 模型配置参数（可选）
                如果不提供，使用默认配置
        """
^
src/ml_strategy/price_predictor.py:77:1: D400 First line should end with a period
        """
        默认 LightGBM 配置（基于 PyProf 项目的优化参数）

        Returns:
            配置字典
        """
^
src/ml_strategy/price_predictor.py:100:10: N803 argument name 'X' should be lowercase
        X: pd.DataFrame,
         ^
src/ml_strategy/price_predictor.py:106:1: D400 First line should end with a period
        """
        训练模型

        Args:
            X: 特征矩阵
            y: 目标变量
            test_size: 测试集比例（默认 0.2）
            random_state: 随机种子（默认 42）
            validation_split: 是否分割验证集（默认 True）

        Returns:
            评估指标字典
                - rmse: 均方根误差
                - mae: 平均绝对误差
                - r2_score: 决定系数
                - mape: 平均绝对百分比误差

        Raises:
            ValueError: 输入数据无效
        """
^
src/ml_strategy/price_predictor.py:137:14: N806 variable 'X_train' in function should be lowercase
            X_train, X_test, y_train, y_test = train_test_split(
             ^
src/ml_strategy/price_predictor.py:137:14: N806 variable 'X_test' in function should be lowercase
            X_train, X_test, y_train, y_test = train_test_split(
             ^
src/ml_strategy/price_predictor.py:142:14: N806 variable 'X_train' in function should be lowercase
            X_train, y_train = X, y
             ^
src/ml_strategy/price_predictor.py:143:14: N806 variable 'X_test' in function should be lowercase
            X_test, y_test = X, y
             ^
src/ml_strategy/price_predictor.py:186:24: N803 argument name 'X' should be lowercase
    def predict(self, X: pd.DataFrame) -> np.ndarray:
                       ^
src/ml_strategy/price_predictor.py:187:1: D400 First line should end with a period
        """
        预测价格

        Args:
            X: 特征矩阵

        Returns:
            预测结果数组

        Raises:
            ValueError: 模型未训练
        """
^
src/ml_strategy/price_predictor.py:216:16: N803 argument name 'X' should be lowercase
        self, X: pd.DataFrame, confidence_level: float = 0.95
               ^
src/ml_strategy/price_predictor.py:218:1: D400 First line should end with a period
        """
        预测价格并返回置信区间（简化版本）

        Args:
            X: 特征矩阵
            confidence_level: 置信水平（默认 0.95）

        Returns:
            (预测值, 下界, 上界)
        """
^
src/ml_strategy/price_predictor.py:245:10: N803 argument name 'X' should be lowercase
        X: pd.DataFrame,
         ^
src/ml_strategy/price_predictor.py:251:1: D400 First line should end with a period
        """
        超参数调优（网格搜索）

        Args:
            X: 特征矩阵
            y: 目标变量
            param_grid: 参数网格（可选）
            cv: 交叉验证折数（默认 5）
            scoring: 评分指标（默认 neg_mean_squared_error）

        Returns:
            调优结果字典
                - best_params: 最佳参数
                - best_score: 最佳得分
                - cv_results: 交叉验证结果

        Example:
            >>> param_grid = {
            ...     'num_leaves': [15, 25, 35],
            ...     'n_estimators': [50, 70, 100],
            ...     'learning_rate': [0.1, 0.2, 0.3]
            ... }
            >>> results = predictor.hyperparameter_tuning(X, y, param_grid)
        """
^
src/ml_strategy/price_predictor.py:284:80: E501 line too long (86 > 79 characters)
            f"开始超参数调优: CV={cv}, 参数组合={np.prod([len(v) for v in param_grid.values()])}"
                                                                               ^
src/ml_strategy/price_predictor.py:324:25: N803 argument name 'X' should be lowercase
    def evaluate(self, X: pd.DataFrame, y: pd.Series) -> Dict[str, float]:
                        ^
src/ml_strategy/price_predictor.py:325:1: D400 First line should end with a period
        """
        评估模型性能

        Args:
            X: 特征矩阵
            y: 真实值

        Returns:
            评估指标字典
        """
^
src/ml_strategy/price_predictor.py:348:80: E501 line too long (87 > 79 characters)
    def _calculate_metrics(y_true: np.ndarray, y_pred: np.ndarray) -> Dict[str, float]:
                                                                               ^
src/ml_strategy/price_predictor.py:349:1: D400 First line should end with a period
        """
        计算评估指标

        Args:
            y_true: 真实值
            y_pred: 预测值

        Returns:
            指标字典
        """
^
src/ml_strategy/price_predictor.py:375:80: E501 line too long (86 > 79 characters)
            mape = np.mean(np.abs((y_true[mask] - y_pred[mask]) / y_true[mask])) * 100
                                                                               ^
src/ml_strategy/price_predictor.py:383:1: D400 First line should end with a period
        """
        保存模型

        Args:
            file_path: 保存路径（.pkl 文件）

        Raises:
            ValueError: 模型未训练
        """
^
src/ml_strategy/price_predictor.py:412:1: D400 First line should end with a period
        """
        加载模型

        Args:
            file_path: 模型文件路径

        Raises:
            FileNotFoundError: 文件不存在
        """
^
src/ml_strategy/price_predictor.py:438:1: D400 First line should end with a period
        """
        获取特征重要性

        Args:
            feature_names: 特征名称列表（可选）
            top_k: 返回前 K 个重要特征（默认 10）

        Returns:
            特征重要性 DataFrame
        """
^
src/ml_strategy/price_predictor.py:455:80: E501 line too long (81 > 79 characters)
                "feature_names", [f"feature_{i}" for i in range(len(importance))]
                                                                               ^
src/ml_strategy/price_predictor.py:462:80: E501 line too long (86 > 79 characters)
        df_importance = df_importance.sort_values("importance", ascending=False).head(
                                                                               ^
src/ml_strategy/price_predictor.py:469:80: E501 line too long (85 > 79 characters)
        self, y_true: np.ndarray, y_pred: np.ndarray, save_path: Optional[str] = None
                                                                               ^
src/ml_strategy/price_predictor.py:471:1: D400 First line should end with a period
        """
        绘制预测结果对比图

        Args:
            y_true: 真实值
            y_pred: 预测值
            save_path: 保存路径（可选）
        """
^
src/ml_strategy/price_predictor.py:490:80: E501 line too long (83 > 79 characters)
            [y_true.min(), y_true.max()], [y_true.min(), y_true.max()], "r--", lw=2
                                                                               ^
src/ml_strategy/price_predictor.py:532:80: E501 line too long (81 > 79 characters)
        X.iloc[:, :5].sum(axis=1) * 100 + np.random.randn(n_samples) * 10 + 3000,
                                                                               ^
src/ml_strategy/price_predictor.py:576:11: F541 f-string is missing placeholders
    print(f"   ✅ 模型已加载")
          ^
src/ml_strategy/realtime/__init__.py:1:1: D400 First line should end with a period
"""
实时数据模块 (Real-time Data Module)

提供实时行情接收和处理功能:
- Tick数据接收
- WebSocket连接管理
- 数据缓存和分发
- 回调函数处理

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/realtime/tick_receiver.py:1:1: D400 First line should end with a period
"""
实时行情接收器 (Real-time Tick Receiver)

功能说明:
- 接收实时tick数据
- WebSocket连接管理
- 数据缓存和分发
- 支持多数据源

支持的数据源:
- TDX实时行情
- 自定义WebSocket源
- Redis发布/订阅

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/realtime/tick_receiver.py:25:1: E402 module level import not at top of file
from typing import Dict, List, Optional, Callable
^
src/ml_strategy/realtime/tick_receiver.py:26:1: E402 module level import not at top of file
from datetime import datetime
^
src/ml_strategy/realtime/tick_receiver.py:27:1: E402 module level import not at top of file
from dataclasses import dataclass
^
src/ml_strategy/realtime/tick_receiver.py:28:1: E402 module level import not at top of file
from enum import Enum
^
src/ml_strategy/realtime/tick_receiver.py:29:1: E402 module level import not at top of file
import logging
^
src/ml_strategy/realtime/tick_receiver.py:30:1: E402 module level import not at top of file
import threading
^
src/ml_strategy/realtime/tick_receiver.py:31:1: E402 module level import not at top of file
import queue
^
src/ml_strategy/realtime/tick_receiver.py:32:1: E402 module level import not at top of file
import time
^
src/ml_strategy/realtime/tick_receiver.py:36:5: F401 'websocket' imported but unused
    import websocket
    ^
src/ml_strategy/realtime/tick_receiver.py:46:5: F401 'redis' imported but unused
    import redis
    ^
src/ml_strategy/realtime/tick_receiver.py:54:1: D400 First line should end with a period
    """数据源类型"""
^
src/ml_strategy/realtime/tick_receiver.py:64:1: D400 First line should end with a period
    """Tick数据"""
^
src/ml_strategy/realtime/tick_receiver.py:82:1: D400 First line should end with a period
    """
    实时行情接收器

    功能:
    - 管理多个数据源连接
    - 数据缓存和分发
    - 回调函数处理
    - 线程安全
    """
^
src/ml_strategy/realtime/tick_receiver.py:93:80: E501 line too long (86 > 79 characters)
        self, cache_size: int = 1000, source_type: DataSourceType = DataSourceType.TDX
                                                                               ^
src/ml_strategy/realtime/tick_receiver.py:95:1: D400 First line should end with a period
        """
        初始化接收器

        参数:
            cache_size: 缓存大小
            source_type: 数据源类型
        """
^
src/ml_strategy/realtime/tick_receiver.py:125:80: E501 line too long (83 > 79 characters)
        self.stats = {"total_ticks": 0, "ticks_per_second": 0, "last_update": None}
                                                                               ^
src/ml_strategy/realtime/tick_receiver.py:128:1: D400 First line should end with a period
        """
        订阅股票

        参数:
            symbols: 股票代码列表
        """
^
src/ml_strategy/realtime/tick_receiver.py:141:1: D400 First line should end with a period
        """取消订阅"""
^
src/ml_strategy/realtime/tick_receiver.py:149:1: D400 First line should end with a period
        """
        注册回调函数

        参数:
            callback: 回调函数，接收TickData参数
        """
^
src/ml_strategy/realtime/tick_receiver.py:159:1: D400 First line should end with a period
        """启动接收器"""
^
src/ml_strategy/realtime/tick_receiver.py:167:80: E501 line too long (88 > 79 characters)
        self.receiver_thread = threading.Thread(target=self._receiver_loop, daemon=True)
                                                                               ^
src/ml_strategy/realtime/tick_receiver.py:183:1: D400 First line should end with a period
        """停止接收器"""
^
src/ml_strategy/realtime/tick_receiver.py:195:1: D400 First line should end with a period
        """接收线程主循环"""
^
src/ml_strategy/realtime/tick_receiver.py:206:1: D400 First line should end with a period
        """处理线程主循环"""
^
src/ml_strategy/realtime/tick_receiver.py:227:1: D400 First line should end with a period
        """从TDX接收数据"""
^
src/ml_strategy/realtime/tick_receiver.py:235:1: D400 First line should end with a period
        """从WebSocket接收数据"""
^
src/ml_strategy/realtime/tick_receiver.py:252:1: D400 First line should end with a period
        """从Redis订阅数据"""
^
src/ml_strategy/realtime/tick_receiver.py:264:1: D400 First line should end with a period
        """接收模拟数据（用于测试）"""
^
src/ml_strategy/realtime/tick_receiver.py:275:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    last_price=10.0 + random.uniform(-0.5, 0.5),
^
src/ml_strategy/realtime/tick_receiver.py:276:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    volume=random.randint(100, 10000),
^
src/ml_strategy/realtime/tick_receiver.py:277:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    amount=random.uniform(1000, 100000),
^
src/ml_strategy/realtime/tick_receiver.py:278:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    bid_price=10.0 + random.uniform(-0.5, 0.5),
^
src/ml_strategy/realtime/tick_receiver.py:279:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    bid_volume=random.randint(100, 1000),
^
src/ml_strategy/realtime/tick_receiver.py:280:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    ask_price=10.0 + random.uniform(-0.5, 0.5),
^
src/ml_strategy/realtime/tick_receiver.py:281:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    ask_volume=random.randint(100, 1000),
^
src/ml_strategy/realtime/tick_receiver.py:294:1: D400 First line should end with a period
        """缓存tick数据"""
^
src/ml_strategy/realtime/tick_receiver.py:306:1: D400 First line should end with a period
        """调用所有回调函数"""
^
src/ml_strategy/realtime/tick_receiver.py:314:1: D400 First line should end with a period
        """更新统计信息"""
^
src/ml_strategy/realtime/tick_receiver.py:319:1: D400 First line should end with a period
        """
        获取最新tick数据

        参数:
            symbol: 股票代码

        返回:
            TickData: 最新数据，如果没有则返回None
        """
^
src/ml_strategy/realtime/tick_receiver.py:331:80: E501 line too long (80 > 79 characters)
    def get_tick_history(self, symbol: str, limit: int = 100) -> List[TickData]:
                                                                               ^
src/ml_strategy/realtime/tick_receiver.py:332:1: D400 First line should end with a period
        """
        获取历史tick数据

        参数:
            symbol: 股票代码
            limit: 返回数量

        返回:
            List[TickData]: 历史数据列表
        """
^
src/ml_strategy/realtime/tick_receiver.py:346:1: D400 First line should end with a period
        """获取统计信息"""
^
src/ml_strategy/realtime/tick_receiver.py:350:80: E501 line too long (80 > 79 characters)
            "cache_size": sum(len(cache) for cache in self.tick_cache.values()),
                                                                               ^
src/ml_strategy/realtime/tick_receiver.py:372:1: D103 Missing docstring in public function
    def on_tick(tick: TickData):
^
src/ml_strategy/realtime/tick_receiver.py:374:80: E501 line too long (108 > 79 characters)
            f"  收到数据: {tick.symbol} - {tick.last_price:.2f} @ {tick.timestamp.strftime('%H:%M:%S.%f')[:12]}"
                                                                               ^
src/ml_strategy/strategy/__init__.py:1:1: D104 Missing docstring in public package
src/ml_strategy/strategy/base_strategy.py:1:1: D400 First line should end with a period
"""
策略基类 (Base Strategy Class)

功能说明:
- 提供策略开发的基础框架
- 定义策略必须实现的接口方法
- 提供常用的工具方法和指标计算
- 集成UnifiedDataManager进行数据访问
- 支持参数验证和回测兼容

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/base_strategy.py:31:1: E402 module level import not at top of file
from indicators.tdx_functions import (
^
src/ml_strategy/strategy/base_strategy.py:39:1: D400 First line should end with a period
    """
    策略基类 - 所有自定义策略必须继承此类

    子类必须实现:
        - generate_signals(): 核心信号生成逻辑

    子类可选重写:
        - validate_parameters(): 自定义参数验证
        - on_before_execute(): 执行前回调
        - on_after_execute(): 执行后回调
    """
^
src/ml_strategy/strategy/base_strategy.py:59:1: D400 First line should end with a period
        """
        初始化策略

        参数:
            name: 策略名称 (字母数字+连字符/下划线)
            version: 策略版本 (语义化版本号 X.Y.Z)
            parameters: 策略参数字典
            unified_manager: UnifiedDataManager实例 (用于数据访问)
            description: 策略描述
        """
^
src/ml_strategy/strategy/base_strategy.py:98:1: D400 First line should end with a period
        """
        核心信号生成方法 - 子类必须实现

        参数:
            data: K线数据DataFrame，必须包含:
                  - index: DatetimeIndex
                  - columns: open, high, low, close, volume

        返回:
            pd.DataFrame: 信号DataFrame，包含:
                - index: DatetimeIndex (与输入data相同)
                - signal: 信号类型 ('buy', 'sell', None)
                - strength: 信号强度 (0.0-1.0)
                - entry_price: 建议入场价格
                - indicators: 指标值字典 (可选)

        示例:
            >>> def generate_signals(self, data):
            ...     signals = pd.DataFrame(index=data.index)
            ...     signals['signal'] = None
            ...     signals['strength'] = 0.0
            ...     signals['entry_price'] = data['close']
            ...
            ...     # 计算指标
            ...     ma5 = MA(data['close'], 5)
            ...     ma20 = MA(data['close'], 20)
            ...
            ...     # 生成买入信号
            ...     buy_condition = CROSS(ma5, ma20)
            ...     signals.loc[buy_condition, 'signal'] = 'buy'
            ...     signals.loc[buy_condition, 'strength'] = 0.8
            ...
            ...     return signals
        """
^
src/ml_strategy/strategy/base_strategy.py:135:1: D400 First line should end with a period
        """
        参数验证方法 - 子类可重写以添加自定义验证

        返回:
            bool: 验证是否通过

        异常:
            ValueError: 参数验证失败时抛出
        """
^
src/ml_strategy/strategy/base_strategy.py:157:1: D400 First line should end with a period
        """
        计算策略代码的SHA-256哈希值

        用于版本控制和变更追踪

        返回:
            str: 64位十六进制哈希字符串
        """
^
src/ml_strategy/strategy/base_strategy.py:171:80: E501 line too long (83 > 79 characters)
        hash_input = f"{source_code}:{json.dumps(self.parameters, sort_keys=True)}"
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:175:80: E501 line too long (85 > 79 characters)
        self, symbol: str, start_date: date, end_date: date, frequency: str = "daily"
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:177:1: D400 First line should end with a period
        """
        获取市场数据

        参数:
            symbol: 股票代码
            start_date: 开始日期
            end_date: 结束日期
            frequency: 数据频率 ('daily', 'minute', 'tick')

        返回:
            pd.DataFrame: K线数据

        异常:
            ValueError: 如果unified_manager未初始化
        """
^
src/ml_strategy/strategy/base_strategy.py:214:1: D400 First line should end with a period
        """
        执行策略对股票池进行筛选

        参数:
            symbols: 股票代码列表
            start_date: 开始日期
            end_date: 结束日期
            **kwargs: 额外参数

        返回:
            dict: 执行结果
                - signals: 生成的信号列表
                - statistics: 执行统计信息
                - errors: 错误列表

        示例:
            >>> strategy = MyStrategy(...)
            >>> result = strategy.execute(
            ...     symbols=['000001', '000002'],
            ...     start_date=date(2024, 1, 1),
            ...     end_date=date(2024, 12, 31)
            ... )
            >>> print(f"生成了 {len(result['signals'])} 个信号")
        """
^
src/ml_strategy/strategy/base_strategy.py:217:1: RST210 Inline strong start-string without end-string.
        """
        执行策略对股票池进行筛选

        参数:
            symbols: 股票代码列表
            start_date: 开始日期
            end_date: 结束日期
            **kwargs: 额外参数

        返回:
            dict: 执行结果
                - signals: 生成的信号列表
                - statistics: 执行统计信息
                - errors: 错误列表

        示例:
            >>> strategy = MyStrategy(...)
            >>> result = strategy.execute(
            ...     symbols=['000001', '000002'],
            ...     start_date=date(2024, 1, 1),
            ...     end_date=date(2024, 12, 31)
            ... )
            >>> print(f"生成了 {len(result['signals'])} 个信号")
        """
^
src/ml_strategy/strategy/base_strategy.py:272:80: E501 line too long (80 > 79 characters)
                    self.logger.info(f"股票 {symbol} 生成 {len(valid_signals)} 个信号")
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:278:80: E501 line too long (84 > 79 characters)
                    {"symbol": symbol, "error": str(e), "timestamp": datetime.now()}
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:291:80: E501 line too long (83 > 79 characters)
        self.stats["buy_signals"] += len(signals_df[signals_df["signal"] == "buy"])
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:292:80: E501 line too long (85 > 79 characters)
        self.stats["sell_signals"] += len(signals_df[signals_df["signal"] == "sell"])
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:303:80: E501 line too long (80 > 79 characters)
                "sell_signals": len(signals_df[signals_df["signal"] == "sell"]),
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:318:5: B027 on_before_execute is an empty method in an abstract base class, but has no abstract decorator. Consider adding @abstractmethod.
    def on_before_execute(
    ^
src/ml_strategy/strategy/base_strategy.py:321:1: D400 First line should end with a period
        """
        执行前回调 - 子类可重写

        参数:
            symbols: 股票代码列表
            start_date: 开始日期
            end_date: 结束日期
            **kwargs: 额外参数
        """
^
src/ml_strategy/strategy/base_strategy.py:324:1: RST210 Inline strong start-string without end-string.
        """
        执行前回调 - 子类可重写

        参数:
            symbols: 股票代码列表
            start_date: 开始日期
            end_date: 结束日期
            **kwargs: 额外参数
        """
^
src/ml_strategy/strategy/base_strategy.py:332:5: B027 on_after_execute is an empty method in an abstract base class, but has no abstract decorator. Consider adding @abstractmethod.
    def on_after_execute(self, result: Dict):
    ^
src/ml_strategy/strategy/base_strategy.py:333:1: D400 First line should end with a period
        """
        执行后回调 - 子类可重写

        参数:
            result: 执行结果字典
        """
^
src/ml_strategy/strategy/base_strategy.py:342:1: D400 First line should end with a period
        """
        将策略转换为字典格式 (用于数据库存储)

        返回:
            dict: 策略信息字典
        """
^
src/ml_strategy/strategy/base_strategy.py:359:1: D105 Missing docstring in magic method
    def __repr__(self) -> str:
^
src/ml_strategy/strategy/base_strategy.py:361:80: E501 line too long (88 > 79 characters)
            f"<{self.__class__.__name__}(name='{self.name}', version='{self.version}')>"
                                                                               ^
src/ml_strategy/strategy/base_strategy.py:371:1: D400 First line should end with a period
    """
    动量策略示例 - MA交叉 + RSI过滤

    策略逻辑:
        - 买入信号: MA5上穿MA20 且 RSI < 30 (超卖)
        - 卖出信号: MA5下穿MA20 或 RSI > 70 (超买)
    """
^
src/ml_strategy/strategy/base_strategy.py:379:1: D107 Missing docstring in __init__
    def __init__(self, unified_manager=None):
^
src/ml_strategy/strategy/base_strategy.py:397:1: D400 First line should end with a period
        """实现信号生成逻辑"""
^
src/ml_strategy/strategy/base_strategy.py:480:80: E501 line too long (84 > 79 characters)
    print(json.dumps(strategy.to_dict(), indent=2, ensure_ascii=False, default=str))
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:1:1: D400 First line should end with a period
"""
信号管理器 (Signal Manager)

功能说明:
- 策略信号的持久化存储和查询
- 批量操作优化
- 与UnifiedDataManager集成
- 支持信号统计和分析

数据库:
- PostgreSQL+TimescaleDB (strategy_signals表)
- 通过UnifiedDataManager进行数据访问

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/signal_manager.py:28:1: D400 First line should end with a period
    """
    信号管理器 - 负责策略信号的存储、查询和管理

    功能:
        - 批量保存策略信号到数据库
        - 按条件查询信号
        - 信号统计分析
        - 信号去重和验证
    """
^
src/ml_strategy/strategy/signal_manager.py:39:1: D400 First line should end with a period
        """
        初始化信号管理器

        参数:
            unified_manager: UnifiedDataManager实例
            batch_size: 批量插入的批次大小
        """
^
src/ml_strategy/strategy/signal_manager.py:63:80: E501 line too long (80 > 79 characters)
        self, signals: pd.DataFrame, strategy_id: int, batch_insert: bool = True
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:65:1: D400 First line should end with a period
        """
        保存策略信号到数据库

        参数:
            signals: 信号DataFrame，必须包含:
                    - index: DatetimeIndex (信号日期)
                    - symbol: 股票代码
                    - signal: 信号类型 ('buy' or 'sell')
                    - strength: 信号强度 (0.0-1.0，可选)
                    - entry_price: 入场价格
                    - indicators: 指标字典 (可选)
                    - metadata: 元数据字典 (可选)
            strategy_id: 策略ID
            batch_insert: 是否使用批量插入

        返回:
            dict: 保存结果
                - success: 是否成功
                - saved_count: 保存的信号数量
                - failed_count: 失败的信号数量
                - execution_time: 执行时间(秒)

        示例:
            >>> signals_df = pd.DataFrame({
            ...     'symbol': ['000001', '000002'],
            ...     'signal': ['buy', 'sell'],
            ...     'entry_price': [12.34, 56.78],
            ...     'strength': [0.8, 0.9]
            ... }, index=pd.date_range('2024-01-01', periods=2))
            >>> result = signal_manager.save_signals(signals_df, strategy_id=1)
            >>> print(f"保存了 {result['saved_count']} 个信号")
        """
^
src/ml_strategy/strategy/signal_manager.py:76:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        保存策略信号到数据库

        参数:
            signals: 信号DataFrame，必须包含:
                    - index: DatetimeIndex (信号日期)
                    - symbol: 股票代码
                    - signal: 信号类型 ('buy' or 'sell')
                    - strength: 信号强度 (0.0-1.0，可选)
                    - entry_price: 入场价格
                    - indicators: 指标字典 (可选)
                    - metadata: 元数据字典 (可选)
            strategy_id: 策略ID
            batch_insert: 是否使用批量插入

        返回:
            dict: 保存结果
                - success: 是否成功
                - saved_count: 保存的信号数量
                - failed_count: 失败的信号数量
                - execution_time: 执行时间(秒)

        示例:
            >>> signals_df = pd.DataFrame({
            ...     'symbol': ['000001', '000002'],
            ...     'signal': ['buy', 'sell'],
            ...     'entry_price': [12.34, 56.78],
            ...     'strength': [0.8, 0.9]
            ... }, index=pd.date_range('2024-01-01', periods=2))
            >>> result = signal_manager.save_signals(signals_df, strategy_id=1)
            >>> print(f"保存了 {result['saved_count']} 个信号")
        """
^
src/ml_strategy/strategy/signal_manager.py:111:80: E501 line too long (83 > 79 characters)
        missing_cols = [col for col in required_cols if col not in signals.columns]
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:127:80: E501 line too long (84 > 79 characters)
                "signal_date": idx.date() if isinstance(idx, pd.Timestamp) else idx,
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:161:45: E203 whitespace before ':'
                    batch = signal_records[i : i + self.batch_size]
                                            ^
src/ml_strategy/strategy/signal_manager.py:168:80: E501 line too long (81 > 79 characters)
                            f"批次 {i//self.batch_size + 1} 保存成功: {len(batch)} 条记录"
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:205:1: D400 First line should end with a period
        """
        实际保存信号到数据库 (通过UnifiedDataManager)

        参数:
            signals_df: 信号DataFrame
        """
^
src/ml_strategy/strategy/signal_manager.py:233:1: D400 First line should end with a period
        """
        查询策略信号

        参数:
            strategy_id: 策略ID (可选)
            symbol: 股票代码 (可选)
            start_date: 开始日期 (可选)
            end_date: 结束日期 (可选)
            signal_type: 信号类型 ('buy' or 'sell'，可选)
            limit: 返回记录数限制
            offset: 偏移量 (用于分页)

        返回:
            pd.DataFrame: 信号记录

        示例:
            >>> # 查询特定策略的所有买入信号
            >>> signals = signal_manager.query_signals(
            ...     strategy_id=1,
            ...     signal_type='buy',
            ...     start_date=date(2024, 1, 1),
            ...     end_date=date(2024, 12, 31)
            ... )
        """
^
src/ml_strategy/strategy/signal_manager.py:306:1: D400 First line should end with a period
        """
        删除策略信号

        参数:
            strategy_id: 策略ID
            start_date: 开始日期 (可选)
            end_date: 结束日期 (可选)

        返回:
            int: 删除的记录数

        警告:
            此操作不可逆，请谨慎使用！

        示例:
            >>> # 删除策略ID为1的所有2024年信号
            >>> deleted = signal_manager.delete_signals(
            ...     strategy_id=1,
            ...     start_date=date(2024, 1, 1),
            ...     end_date=date(2024, 12, 31)
            ... )
        """
^
src/ml_strategy/strategy/signal_manager.py:365:1: D400 First line should end with a period
        """
        获取信号统计信息

        参数:
            strategy_id: 策略ID
            start_date: 开始日期 (可选)
            end_date: 结束日期 (可选)

        返回:
            dict: 统计信息
                - total_signals: 总信号数
                - buy_signals: 买入信号数
                - sell_signals: 卖出信号数
                - unique_symbols: 涉及股票数
                - avg_strength: 平均信号强度
                - date_range: 日期范围

        示例:
            >>> stats = signal_manager.get_signal_statistics(strategy_id=1)
            >>> print(f"总信号数: {stats['total_signals']}")
            >>> print(f"买入/卖出比例: {stats['buy_signals']}/{stats['sell_signals']}")
        """
^
src/ml_strategy/strategy/signal_manager.py:385:80: E501 line too long (81 > 79 characters)
        """
        获取信号统计信息

        参数:
            strategy_id: 策略ID
            start_date: 开始日期 (可选)
            end_date: 结束日期 (可选)

        返回:
            dict: 统计信息
                - total_signals: 总信号数
                - buy_signals: 买入信号数
                - sell_signals: 卖出信号数
                - unique_symbols: 涉及股票数
                - avg_strength: 平均信号强度
                - date_range: 日期范围

        示例:
            >>> stats = signal_manager.get_signal_statistics(strategy_id=1)
            >>> print(f"总信号数: {stats['total_signals']}")
            >>> print(f"买入/卖出比例: {stats['buy_signals']}/{stats['sell_signals']}")
        """





       ^
src/ml_strategy/strategy/signal_manager.py:410:80: E501 line too long (87 > 79 characters)
            "date_range": (signals["signal_date"].min(), signals["signal_date"].max()),
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:416:1: D400 First line should end with a period
        """
        验证单个信号的有效性

        参数:
            signal: 信号字典

        返回:
            tuple: (是否有效, 错误信息)

        示例:
            >>> signal = {
            ...     'symbol': '000001',
            ...     'signal': 'buy',
            ...     'entry_price': 12.34,
            ...     'strength': 0.8
            ... }
            >>> is_valid, error = signal_manager.validate_signal(signal)
        """
^
src/ml_strategy/strategy/signal_manager.py:454:80: E501 line too long (82 > 79 characters)
            if not isinstance(strength, (int, float)) or not (0 <= strength <= 1):
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:459:80: E501 line too long (84 > 79 characters)
    def get_latest_signals(self, strategy_id: int, limit: int = 10) -> pd.DataFrame:
                                                                               ^
src/ml_strategy/strategy/signal_manager.py:460:1: D400 First line should end with a period
        """
        获取最新的N个信号

        参数:
            strategy_id: 策略ID
            limit: 返回记录数

        返回:
            pd.DataFrame: 最新信号记录 (按日期降序)

        示例:
            >>> latest = signal_manager.get_latest_signals(strategy_id=1, limit=5)
            >>> print(latest[['symbol', 'signal_type', 'signal_date']])
        """
^
src/ml_strategy/strategy/signal_manager.py:471:80: E501 line too long (82 > 79 characters)
        """
        获取最新的N个信号

        参数:
            strategy_id: 策略ID
            limit: 返回记录数

        返回:
            pd.DataFrame: 最新信号记录 (按日期降序)

        示例:
            >>> latest = signal_manager.get_latest_signals(strategy_id=1, limit=5)
            >>> print(latest[['symbol', 'signal_type', 'signal_date']])
        """





      ^
src/ml_strategy/strategy/signal_manager.py:482:1: D400 First line should end with a period
        """
        获取管理器统计信息

        返回:
            dict: 统计信息
        """
^
src/ml_strategy/strategy/stock_screener.py:1:1: D400 First line should end with a period
"""
股票筛选器 (Stock Screener)

功能说明:
- 根据多维度条件筛选股票池
- 支持市值、行业、价格、成交量等过滤条件
- 排除ST股票、停牌股票等特殊状态
- 与UnifiedDataManager集成获取股票信息

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/stock_screener.py:24:1: D400 First line should end with a period
    """筛选条件配置"""
^
src/ml_strategy/strategy/stock_screener.py:57:1: D400 First line should end with a period
        """初始化后处理"""
^
src/ml_strategy/strategy/stock_screener.py:73:1: D400 First line should end with a period
    """
    股票筛选器 - 根据条件过滤股票池

    功能:
        - 多维度条件筛选
        - ST股票、停牌股票过滤
        - 行业、板块、市值过滤
        - 自定义过滤函数支持
    """
^
src/ml_strategy/strategy/stock_screener.py:84:80: E501 line too long (80 > 79 characters)
        self, unified_manager=None, criteria: Optional[ScreeningCriteria] = None
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:86:1: D400 First line should end with a period
        """
        初始化股票筛选器

        参数:
            unified_manager: UnifiedDataManager实例
            criteria: 筛选条件配置
        """
^
src/ml_strategy/strategy/stock_screener.py:115:80: E501 line too long (84 > 79 characters)
        self, symbols: Optional[List[str]] = None, as_of_date: Optional[date] = None
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:117:1: D400 First line should end with a period
        """
        执行股票筛选

        参数:
            symbols: 输入股票池 (如果为None，使用全市场股票)
            as_of_date: 筛选基准日期 (默认为今天)

        返回:
            List[str]: 筛选后的股票代码列表

        示例:
            >>> screener = StockScreener(unified_manager, criteria)
            >>> filtered = screener.screen(symbols=['000001', '000002', '600000'])
            >>> print(f"筛选后股票数量: {len(filtered)}")
        """
^
src/ml_strategy/strategy/stock_screener.py:129:80: E501 line too long (82 > 79 characters)
        """
        执行股票筛选

        参数:
            symbols: 输入股票池 (如果为None，使用全市场股票)
            as_of_date: 筛选基准日期 (默认为今天)

        返回:
            List[str]: 筛选后的股票代码列表

        示例:
            >>> screener = StockScreener(unified_manager, criteria)
            >>> filtered = screener.screen(symbols=['000001', '000002', '600000'])
            >>> print(f"筛选后股票数量: {len(filtered)}")
        """




                                       ^
src/ml_strategy/strategy/stock_screener.py:152:80: E501 line too long (83 > 79 characters)
            filtered_symbols = self._filter_st_stocks(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:168:80: E501 line too long (82 > 79 characters)
            filtered_symbols = self._filter_by_price(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:172:80: E501 line too long (83 > 79 characters)
            filtered_symbols = self._filter_by_volume(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:176:80: E501 line too long (87 > 79 characters)
            filtered_symbols = self._filter_by_market_cap(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:179:80: E501 line too long (80 > 79 characters)
        if self.criteria.exclude_industries or self.criteria.include_industries:
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:180:80: E501 line too long (85 > 79 characters)
            filtered_symbols = self._filter_by_industry(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:184:80: E501 line too long (82 > 79 characters)
            filtered_symbols = self._filter_by_board(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:188:80: E501 line too long (85 > 79 characters)
            filtered_symbols = self._filter_by_exchange(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:192:80: E501 line too long (87 > 79 characters)
            filtered_symbols = self._apply_custom_filters(filtered_symbols, stock_info)
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:203:1: D400 First line should end with a period
        """获取全市场股票列表"""
^
src/ml_strategy/strategy/stock_screener.py:220:80: E501 line too long (84 > 79 characters)
    def _get_stock_info(self, symbols: List[str], as_of_date: date) -> pd.DataFrame:
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:221:1: D400 First line should end with a period
        """
        获取股票基本信息

        返回DataFrame包含:
            - symbol: 股票代码
            - name: 股票名称
            - exchange: 交易所
            - industry: 行业
            - board: 板块
            - list_date: 上市日期
            - is_st: 是否ST
            - is_suspended: 是否停牌
            - close: 收盘价
            - volume: 成交量
            - amount: 成交额
            - market_cap: 市值
        """
^
src/ml_strategy/strategy/stock_screener.py:272:1: D400 First line should end with a period
        """过滤ST股票"""
^
src/ml_strategy/strategy/stock_screener.py:273:80: E501 line too long (80 > 79 characters)
        st_stocks = stock_info[stock_info["name"].str.contains("ST", na=False)][
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:287:1: D400 First line should end with a period
        """过滤停牌股票"""
^
src/ml_strategy/strategy/stock_screener.py:303:1: D400 First line should end with a period
        """过滤次新股"""
^
src/ml_strategy/strategy/stock_screener.py:323:80: E501 line too long (88 > 79 characters)
    def _filter_by_price(self, symbols: Set[str], stock_info: pd.DataFrame) -> Set[str]:
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:324:1: D400 First line should end with a period
        """按价格过滤"""
^
src/ml_strategy/strategy/stock_screener.py:328:80: E501 line too long (82 > 79 characters)
            below_min = stock_info[stock_info["close"] < self.criteria.min_price][
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:334:80: E501 line too long (82 > 79 characters)
            above_max = stock_info[stock_info["close"] > self.criteria.max_price][
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:352:1: D400 First line should end with a period
        """按成交量/成交额过滤"""
^
src/ml_strategy/strategy/stock_screener.py:356:80: E501 line too long (84 > 79 characters)
            below_vol = stock_info[stock_info["volume"] < self.criteria.min_volume][
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:362:80: E501 line too long (84 > 79 characters)
            below_amt = stock_info[stock_info["amount"] < self.criteria.min_amount][
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:377:1: D400 First line should end with a period
        """按市值过滤"""
^
src/ml_strategy/strategy/stock_screener.py:385:80: E501 line too long (87 > 79 characters)
            stock_info["market_cap"] = stock_info["close"] * stock_info["total_shares"]
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:410:1: D400 First line should end with a period
        """按行业过滤"""
^
src/ml_strategy/strategy/stock_screener.py:434:80: E501 line too long (88 > 79 characters)
    def _filter_by_board(self, symbols: Set[str], stock_info: pd.DataFrame) -> Set[str]:
                                                                               ^
src/ml_strategy/strategy/stock_screener.py:435:1: D400 First line should end with a period
        """按板块过滤"""
^
src/ml_strategy/strategy/stock_screener.py:461:1: D400 First line should end with a period
        """按交易所过滤"""
^
src/ml_strategy/strategy/stock_screener.py:476:1: D400 First line should end with a period
        """应用自定义过滤函数"""
^
src/ml_strategy/strategy/stock_screener.py:496:1: D400 First line should end with a period
        """打印筛选摘要"""
^
src/ml_strategy/strategy/stock_screener.py:510:80: E501 line too long (85 > 79 characters)
            f"筛选通过率: {self.stats['total_output']/self.stats['total_input']*100:.1f}%"
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:1:1: D400 First line should end with a period
"""
策略执行引擎 (Strategy Executor)

功能说明:
- 多进程并行执行策略
- 进度跟踪和性能监控
- 异常处理和失败重试
- 自动保存信号到数据库
- 支持快速模式和完整模式

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/strategy_executor.py:35:80: E501 line too long (80 > 79 characters)
    sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:41:1: D400 First line should end with a period
    """执行模式枚举"""
^
src/ml_strategy/strategy/strategy_executor.py:49:1: D400 First line should end with a period
    """执行配置"""
^
src/ml_strategy/strategy/strategy_executor.py:62:1: D400 First line should end with a period
    """执行进度"""
^
src/ml_strategy/strategy/strategy_executor.py:72:1: D400 First line should end with a period
        """获取进度百分比"""
^
src/ml_strategy/strategy/strategy_executor.py:79:1: D400 First line should end with a period
    """
    策略执行引擎 - 负责策略的并行执行和结果管理

    功能:
        - 多进程并行执行策略
        - 实时进度跟踪
        - 异常处理和重试
        - 自动保存信号到数据库
    """
^
src/ml_strategy/strategy/strategy_executor.py:95:1: D400 First line should end with a period
        """
        初始化策略执行引擎

        参数:
            strategy: 策略实例
            signal_manager: 信号管理器实例
            config: 执行配置 (可选)
        """
^
src/ml_strategy/strategy/strategy_executor.py:124:1: D400 First line should end with a period
        """
        执行策略对股票池进行筛选

        参数:
            stock_pool: 股票代码列表
            mode: 执行模式 (FAST或FULL)
            start_date: 开始日期 (FULL模式必需)
            end_date: 结束日期 (FULL模式必需)
            **kwargs: 额外参数

        返回:
            dict: 执行结果
                - execution_id: 执行ID
                - status: 执行状态 ('completed', 'failed', 'partial')
                - signals: 生成的信号DataFrame
                - progress: 进度信息
                - statistics: 统计信息
                - errors: 错误列表

        示例:
            >>> executor = StrategyExecutor(strategy, signal_manager)
            >>> # 快速模式: 仅当前交易日
            >>> result = executor.execute(
            ...     stock_pool=['000001', '000002', '000003'],
            ...     mode=ExecutionMode.FAST
            ... )
            >>> # 完整模式: 历史周期
            >>> result = executor.execute(
            ...     stock_pool=['000001', '000002'],
            ...     mode=ExecutionMode.FULL,
            ...     start_date=date(2024, 1, 1),
            ...     end_date=date(2024, 12, 31)
            ... )
        """
^
src/ml_strategy/strategy/strategy_executor.py:127:1: RST210 Inline strong start-string without end-string.
        """
        执行策略对股票池进行筛选

        参数:
            stock_pool: 股票代码列表
            mode: 执行模式 (FAST或FULL)
            start_date: 开始日期 (FULL模式必需)
            end_date: 结束日期 (FULL模式必需)
            **kwargs: 额外参数

        返回:
            dict: 执行结果
                - execution_id: 执行ID
                - status: 执行状态 ('completed', 'failed', 'partial')
                - signals: 生成的信号DataFrame
                - progress: 进度信息
                - statistics: 统计信息
                - errors: 错误列表

        示例:
            >>> executor = StrategyExecutor(strategy, signal_manager)
            >>> # 快速模式: 仅当前交易日
            >>> result = executor.execute(
            ...     stock_pool=['000001', '000002', '000003'],
            ...     mode=ExecutionMode.FAST
            ... )
            >>> # 完整模式: 历史周期
            >>> result = executor.execute(
            ...     stock_pool=['000001', '000002'],
            ...     mode=ExecutionMode.FULL,
            ...     start_date=date(2024, 1, 1),
            ...     end_date=date(2024, 12, 31)
            ... )
        """
^
src/ml_strategy/strategy/strategy_executor.py:168:26: F541 f-string is missing placeholders
        self.logger.info(f"=" * 60)
                         ^
src/ml_strategy/strategy/strategy_executor.py:169:26: F541 f-string is missing placeholders
        self.logger.info(f"策略执行开始")
                         ^
src/ml_strategy/strategy/strategy_executor.py:177:26: F541 f-string is missing placeholders
        self.logger.info(f"=" * 60)
                         ^
src/ml_strategy/strategy/strategy_executor.py:283:80: E501 line too long (81 > 79 characters)
                    signals_df["symbol"].nunique() if not signals_df.empty else 0
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:287:80: E501 line too long (80 > 79 characters)
                    if not signals_df.empty and "strength" in signals_df.columns
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:291:80: E501 line too long (83 > 79 characters)
                    self.progress.processed_symbols / self.progress.elapsed_seconds
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:300:26: F541 f-string is missing placeholders
        self.logger.info(f"=" * 60)
                         ^
src/ml_strategy/strategy/strategy_executor.py:301:26: F541 f-string is missing placeholders
        self.logger.info(f"策略执行完成")
                         ^
src/ml_strategy/strategy/strategy_executor.py:304:80: E501 line too long (84 > 79 characters)
            f"处理股票: {self.progress.processed_symbols}/{self.progress.total_symbols}"
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:312:26: F541 f-string is missing placeholders
        self.logger.info(f"=" * 60)
                         ^
src/ml_strategy/strategy/strategy_executor.py:319:1: D400 First line should end with a period
        """串行执行策略"""
^
src/ml_strategy/strategy/strategy_executor.py:337:80: E501 line too long (92 > 79 characters)
                        f"({self.progress.processed_symbols}/{self.progress.total_symbols})"
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:343:80: E501 line too long (84 > 79 characters)
                    {"symbol": symbol, "error": str(e), "timestamp": datetime.now()}
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:352:1: D400 First line should end with a period
        """并行执行策略"""
^
src/ml_strategy/strategy/strategy_executor.py:358:25: E203 whitespace before ':'
            stock_pool[i : i + self.config.batch_size]
                        ^
src/ml_strategy/strategy/strategy_executor.py:364:80: E501 line too long (82 > 79 characters)
        with ProcessPoolExecutor(max_workers=self.config.max_workers) as executor:
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:374:80: E501 line too long (85 > 79 characters)
            for future in as_completed(futures, timeout=self.config.timeout_seconds):
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:404:1: D400 First line should end with a period
        """处理一批股票"""
^
src/ml_strategy/strategy/strategy_executor.py:418:80: E501 line too long (84 > 79 characters)
                    {"symbol": symbol, "error": str(e), "timestamp": datetime.now()}
                                                                               ^
src/ml_strategy/strategy/strategy_executor.py:426:1: D400 First line should end with a period
        """处理单只股票"""
^
src/ml_strategy/strategy/strategy_executor.py:448:1: D400 First line should end with a period
        """
        获取当前执行进度

        返回:
            dict: 进度信息
        """
^
src/ml_strategy/strategy/templates/custom_template.py:1:1: D400 First line should end with a period
"""
自定义策略模板 (Custom Strategy Template)

使用说明:
1. 复制此模板文件
2. 修改类名为您的策略名称
3. 在__init__中定义策略参数
4. 在generate_signals中实现信号生成逻辑
5. (可选) 在validate_parameters中添加自定义参数验证
6. (可选) 在on_before_execute和on_after_execute中添加回调逻辑

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/templates/custom_template.py:24:80: E501 line too long (80 > 79 characters)
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/ml_strategy/strategy/templates/custom_template.py:27:1: E402 module level import not at top of file
from strategy.base_strategy import BaseStrategy
^
src/ml_strategy/strategy/templates/custom_template.py:30:1: E402 module level import not at top of file
from indicators.tdx_functions import (
^
src/ml_strategy/strategy/templates/custom_template.py:38:1: D400 First line should end with a period
    """
    自定义策略 - 请在此处添加策略描述

    策略逻辑:
        - 买入条件: [描述您的买入条件]
        - 卖出条件: [描述您的卖出条件]

    技术指标:
        - [列出您使用的技术指标]

    参数说明:
        - param1: [参数1说明]
        - param2: [参数2说明]
    """
^
src/ml_strategy/strategy/templates/custom_template.py:53:80: E501 line too long (84 > 79 characters)
    def __init__(self, unified_manager=None, param1: int = 10, param2: float = 0.5):
                                                                               ^
src/ml_strategy/strategy/templates/custom_template.py:54:1: D400 First line should end with a period
        """
        初始化自定义策略

        参数:
            unified_manager: UnifiedDataManager实例
            param1: [参数1说明]
            param2: [参数2说明]
        """
^
src/ml_strategy/strategy/templates/custom_template.py:79:1: D400 First line should end with a period
        """
        参数验证 (可选)

        在此处添加您的自定义参数验证逻辑

        返回:
            bool: 验证是否通过

        示例:
            if self.parameters['param1'] <= 0:
                raise ValueError("param1必须大于0")
        """
^
src/ml_strategy/strategy/templates/custom_template.py:102:1: D400 First line should end with a period
        """
        生成交易信号 - 核心策略逻辑

        这是策略的核心方法，您需要在此实现信号生成逻辑

        参数:
            data: K线数据DataFrame，包含:
                  - index: DatetimeIndex (日期索引)
                  - columns: open, high, low, close, volume

        返回:
            pd.DataFrame: 信号DataFrame，必须包含以下列:
                - signal: 信号类型 ('buy' 或 'sell' 或 None)
                - strength: 信号强度 (0.0-1.0)
                - entry_price: 建议入场价格
                - indicators: 指标值字典 (可选，用于分析)

        示例实现:
        """
^
src/ml_strategy/strategy/templates/custom_template.py:130:9: F841 local variable 'high' is assigned to but never used
        high = data["high"].values
        ^
src/ml_strategy/strategy/templates/custom_template.py:131:9: F841 local variable 'low' is assigned to but never used
        low = data["low"].values
        ^
src/ml_strategy/strategy/templates/custom_template.py:132:9: F841 local variable 'volume' is assigned to but never used
        volume = data["volume"].values
        ^
src/ml_strategy/strategy/templates/custom_template.py:162:80: E501 line too long (85 > 79 characters)
                        float(ma_short[pos]) if not np.isnan(ma_short[pos]) else None
                                                                               ^
src/ml_strategy/strategy/templates/custom_template.py:164:80: E501 line too long (88 > 79 characters)
                    "ma20": float(ma_long[pos]) if not np.isnan(ma_long[pos]) else None,
                                                                               ^
src/ml_strategy/strategy/templates/custom_template.py:165:80: E501 line too long (81 > 79 characters)
                    "rsi14": float(rsi[pos]) if not np.isnan(rsi[pos]) else None,
                                                                               ^
src/ml_strategy/strategy/templates/custom_template.py:171:1: D400 First line should end with a period
        """
        执行前回调 (可选)

        在策略执行前调用，可用于:
        - 打印执行信息
        - 预处理数据
        - 初始化状态

        参数:
            symbols: 股票代码列表
            start_date: 开始日期
            end_date: 结束日期
            **kwargs: 额外参数
        """
^
src/ml_strategy/strategy/templates/custom_template.py:179:1: RST210 Inline strong start-string without end-string.
        """
        执行前回调 (可选)

        在策略执行前调用，可用于:
        - 打印执行信息
        - 预处理数据
        - 初始化状态

        参数:
            symbols: 股票代码列表
            start_date: 开始日期
            end_date: 结束日期
            **kwargs: 额外参数
        """
^
src/ml_strategy/strategy/templates/custom_template.py:192:1: D400 First line should end with a period
        """
        执行后回调 (可选)

        在策略执行完成后调用，可用于:
        - 打印执行结果
        - 保存额外信息
        - 发送通知

        参数:
            result: 执行结果字典
        """
^
src/ml_strategy/strategy/templates/custom_template.py:228:11: F541 f-string is missing placeholders
    print(f"\n策略参数:")
          ^
src/ml_strategy/strategy/templates/custom_template.py:251:11: F541 f-string is missing placeholders
    print(f"\n信号统计:")
          ^
src/ml_strategy/strategy/templates/custom_template.py:257:15: F541 f-string is missing placeholders
        print(f"\n最近3个信号:")
              ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:1:1: D400 First line should end with a period
"""
均值回归策略模板 (Mean Reversion Strategy Template)

策略逻辑:
- 买入信号: 价格触及布林带下轨 + RSI超卖
- 卖出信号: 价格触及布林带上轨 + RSI超买

技术指标:
- BOLL (20, 2): 布林带
- RSI14: 相对强弱指标

适用场景:
- 震荡市场
- 价格围绕均值波动的个股

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:28:80: E501 line too long (80 > 79 characters)
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:31:1: E402 module level import not at top of file
from strategy.base_strategy import BaseStrategy
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:32:1: E402 module level import not at top of file
from indicators.tdx_functions import BOLL, RSI
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:36:1: D400 First line should end with a period
    """
    均值回归策略 - 基于布林带和RSI

    参数说明:
        - boll_period: 布林带周期 (默认20)
        - boll_std_dev: 布林带标准差倍数 (默认2)
        - rsi_period: RSI计算周期 (默认14)
        - rsi_oversold: RSI超卖阈值 (默认30)
        - rsi_overbought: RSI超买阈值 (默认70)
        - price_touch_threshold: 价格触及阈值 (默认0.01, 即1%)
    """
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:58:1: D400 First line should end with a period
        """
        初始化均值回归策略

        参数:
            unified_manager: UnifiedDataManager实例
            boll_period: 布林带周期
            boll_std_dev: 布林带标准差倍数
            rsi_period: RSI周期
            rsi_oversold: RSI超卖阈值
            rsi_overbought: RSI超买阈值
            price_touch_threshold: 价格触及阈值比例
        """
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:88:1: D400 First line should end with a period
        """参数验证"""
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:113:1: D400 First line should end with a period
        """
        生成交易信号

        参数:
            data: K线数据，包含 open, high, low, close, volume

        返回:
            pd.DataFrame: 信号数据
        """
^
src/ml_strategy/strategy/templates/mean_reversion_template.py:134:80: E501 line too long (82 > 79 characters)
            close, self.parameters["boll_period"], self.parameters["boll_std_dev"]
                                                                               ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:153:80: E501 line too long (80 > 79 characters)
        sell_condition = touch_upper & (rsi > self.parameters["rsi_overbought"])
                                                                               ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:191:80: E501 line too long (81 > 79 characters)
                        float(middle[pos]) if not np.isnan(middle[pos]) else None
                                                                               ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:246:11: F541 f-string is missing placeholders
    print(f"\n策略参数:")
          ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:254:11: F541 f-string is missing placeholders
    print(f"\n信号统计:")
          ^
src/ml_strategy/strategy/templates/mean_reversion_template.py:261:15: F541 f-string is missing placeholders
        print(f"\n最近3个信号:")
              ^
src/ml_strategy/strategy/templates/momentum_template.py:1:1: D400 First line should end with a period
"""
动量策略模板 (Momentum Strategy Template)

策略逻辑:
- 买入信号: 短期均线上穿长期均线 + RSI超卖
- 卖出信号: 短期均线下穿长期均线 或 RSI超买

技术指标:
- MA5, MA20: 短期和长期移动平均
- RSI14: 相对强弱指标

适用场景:
- 趋势明显的市场
- 波动较大的个股

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/ml_strategy/strategy/templates/momentum_template.py:28:80: E501 line too long (80 > 79 characters)
    os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
                                                                               ^
src/ml_strategy/strategy/templates/momentum_template.py:31:1: E402 module level import not at top of file
from strategy.base_strategy import BaseStrategy
^
src/ml_strategy/strategy/templates/momentum_template.py:32:1: E402 module level import not at top of file
from indicators.tdx_functions import MA, CROSS, RSI
^
src/ml_strategy/strategy/templates/momentum_template.py:36:1: D400 First line should end with a period
    """
    动量策略 - 基于均线交叉和RSI过滤

    参数说明:
        - ma_short: 短期均线周期 (默认5)
        - ma_long: 长期均线周期 (默认20)
        - rsi_period: RSI计算周期 (默认14)
        - rsi_oversold: RSI超卖阈值 (默认30)
        - rsi_overbought: RSI超买阈值 (默认70)
    """
^
src/ml_strategy/strategy/templates/momentum_template.py:56:1: D400 First line should end with a period
        """
        初始化动量策略

        参数:
            unified_manager: UnifiedDataManager实例
            ma_short: 短期均线周期
            ma_long: 长期均线周期
            rsi_period: RSI周期
            rsi_oversold: RSI超卖阈值
            rsi_overbought: RSI超买阈值
        """
^
src/ml_strategy/strategy/templates/momentum_template.py:84:1: D400 First line should end with a period
        """参数验证"""
^
src/ml_strategy/strategy/templates/momentum_template.py:106:1: D400 First line should end with a period
        """
        生成交易信号

        参数:
            data: K线数据，包含 open, high, low, close, volume

        返回:
            pd.DataFrame: 信号数据
        """
^
src/ml_strategy/strategy/templates/momentum_template.py:138:80: E501 line too long (80 > 79 characters)
        sell_condition = death_cross | (rsi > self.parameters["rsi_overbought"])
                                                                               ^
src/ml_strategy/strategy/templates/momentum_template.py:167:80: E501 line too long (85 > 79 characters)
                        float(ma_short[pos]) if not np.isnan(ma_short[pos]) else None
                                                                               ^
src/ml_strategy/strategy/templates/momentum_template.py:170:80: E501 line too long (83 > 79 characters)
                        float(ma_long[pos]) if not np.isnan(ma_long[pos]) else None
                                                                               ^
src/ml_strategy/strategy/templates/momentum_template.py:213:11: F541 f-string is missing placeholders
    print(f"\n策略参数:")
          ^
src/ml_strategy/strategy/templates/momentum_template.py:221:11: F541 f-string is missing placeholders
    print(f"\n信号统计:")
          ^
src/ml_strategy/strategy/templates/momentum_template.py:227:15: F541 f-string is missing placeholders
        print(f"\n最近3个信号:")
              ^
src/mock/mock_Analysis.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Analysis
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Analysis.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Analysis
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Analysis.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_Analysis.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_Analysis.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_Analysis.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_Analysis.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Analysis.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Analysis.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Analysis.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_Analysis.py:115:11: F541 f-string is missing placeholders
    print(f"get_data_list() 调用测试:")
          ^
src/mock/mock_Analysis.py:120:9: F541 f-string is missing placeholders
        f"""
get_data_detail() 调用测试:"""
        ^
src/mock/mock_Analysis.py:127:9: F541 f-string is missing placeholders
        f"""
get_data_table() 调用测试:"""
        ^
src/mock/mock_BacktestAnalysis.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: BacktestAnalysis
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_BacktestAnalysis.py:1:1: D400 First line should end with a period
"""
Mock数据文件: BacktestAnalysis
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_BacktestAnalysis.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_BacktestAnalysis.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_BacktestAnalysis.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_BacktestAnalysis.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_BacktestAnalysis.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_BacktestAnalysis.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_BacktestAnalysis.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_BacktestAnalysis.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_BacktestAnalysis.py:115:11: F541 f-string is missing placeholders
    print(f"get_data_list() 调用测试:")
          ^
src/mock/mock_BacktestAnalysis.py:120:9: F541 f-string is missing placeholders
        f"""
get_data_detail() 调用测试:"""
        ^
src/mock/mock_BacktestAnalysis.py:127:9: F541 f-string is missing placeholders
        f"""
get_data_table() 调用测试:"""
        ^
src/mock/mock_BacktestAnalysis.py:132:9: F541 f-string is missing placeholders
        f"""返回数据:
"""
        ^
src/mock/mock_Dashboard.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Dashboard
提供接口:
1. get_market_stats() -> Dict - 获取市场统计数据（仪表盘顶部4个统计卡片）
2. get_market_heat_data() -> List[Dict] - 获取市场热度数据（图表）
3. get_leading_sectors() -> List[Dict] - 获取领涨板块数据（图表）
4. get_price_distribution() -> List[Dict] - 获取涨跌分布数据（图表）
5. get_capital_flow_data() -> List[Dict] - 获取资金流向数据（图表）
6. get_industry_fund_flow(standard: str) -> Dict - 获取行业资金流向（图表）
7. get_favorite_stocks() -> List[Dict] - 获取自选股板块表现数据
8. get_strategy_stocks() -> List[Dict] - 获取策略选股板块表现数据
9. get_industry_stocks() -> List[Dict] - 获取行业选股板块表现数据
10. get_concept_stocks() -> List[Dict] - 获取概念选股板块表现数据

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Dashboard.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Dashboard
提供接口:
1. get_market_stats() -> Dict - 获取市场统计数据（仪表盘顶部4个统计卡片）
2. get_market_heat_data() -> List[Dict] - 获取市场热度数据（图表）
3. get_leading_sectors() -> List[Dict] - 获取领涨板块数据（图表）
4. get_price_distribution() -> List[Dict] - 获取涨跌分布数据（图表）
5. get_capital_flow_data() -> List[Dict] - 获取资金流向数据（图表）
6. get_industry_fund_flow(standard: str) -> Dict - 获取行业资金流向（图表）
7. get_favorite_stocks() -> List[Dict] - 获取自选股板块表现数据
8. get_strategy_stocks() -> List[Dict] - 获取策略选股板块表现数据
9. get_industry_stocks() -> List[Dict] - 获取行业选股板块表现数据
10. get_concept_stocks() -> List[Dict] - 获取概念选股板块表现数据

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Dashboard.py:31:1: D400 First line should end with a period
    """获取市场概览数据（仪表盘顶部4个统计卡片）

    Returns:
        Dict: 包含总股票数、活跃股票、数据更新、系统状态
    """
^
src/mock/mock_Dashboard.py:76:1: D400 First line should end with a period
    """获取市场统计数据（监控摘要）

    Returns:
        Dict: 市场统计数据，包含涨跌分布、成交额等
    """
^
src/mock/mock_Dashboard.py:83:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "limit_up_count": random.randint(30, 60),
^
src/mock/mock_Dashboard.py:84:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "limit_down_count": random.randint(5, 15),
^
src/mock/mock_Dashboard.py:85:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "strong_up_count": random.randint(80, 150),
^
src/mock/mock_Dashboard.py:86:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "strong_down_count": random.randint(40, 100),
^
src/mock/mock_Dashboard.py:87:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "avg_change_percent": round(random.uniform(-2.0, 2.0), 2),
^
src/mock/mock_Dashboard.py:88:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "total_amount": round(random.uniform(800, 1200), 2) * 100000000,  # 800-1200亿
^
src/mock/mock_Dashboard.py:88:80: E501 line too long (85 > 79 characters)
        "total_amount": round(random.uniform(800, 1200), 2) * 100000000,  # 800-1200亿
                                                                               ^
src/mock/mock_Dashboard.py:89:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "active_alerts": random.randint(15, 35),
^
src/mock/mock_Dashboard.py:90:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "unread_alerts": random.randint(8, 20),
^
src/mock/mock_Dashboard.py:95:1: D400 First line should end with a period
    """获取市场热度数据（用于市场热力图）

    Returns:
        List[Dict]: 各概念板块的热度指数数据
    """
^
src/mock/mock_Dashboard.py:110:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return [{"name": sector, "value": random.randint(60, 95)} for sector in sectors]
^
src/mock/mock_Dashboard.py:110:80: E501 line too long (84 > 79 characters)
    return [{"name": sector, "value": random.randint(60, 95)} for sector in sectors]
                                                                               ^
src/mock/mock_Dashboard.py:114:1: D400 First line should end with a period
    """获取实时告警数据（用于监控页面）

    Returns:
        Dict: 实时告警数据
    """
^
src/mock/mock_Dashboard.py:145:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        alert_type = random.choice(alert_types)
^
src/mock/mock_Dashboard.py:146:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        alert_level = random.choice(alert_levels)
^
src/mock/mock_Dashboard.py:150:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            message = f"{stock_names[symbol_idx]}股价突破{random.randint(100, 2000)}元"
^
src/mock/mock_Dashboard.py:150:80: E501 line too long (82 > 79 characters)
            message = f"{stock_names[symbol_idx]}股价突破{random.randint(100, 2000)}元"
                                                                               ^
src/mock/mock_Dashboard.py:152:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            message = f"{stock_names[symbol_idx]}成交量激增{random.randint(2, 10)}倍"
^
src/mock/mock_Dashboard.py:156:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                f"{stock_names[symbol_idx]}{random.choice(indicators)}指标出现信号"
^
src/mock/mock_Dashboard.py:159:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            direction = "流入" if random.choice([True, False]) else "流出"
^
src/mock/mock_Dashboard.py:160:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            amount = random.randint(1000, 10000)
^
src/mock/mock_Dashboard.py:167:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            minutes=random.randint(0, 1440)
^
src/mock/mock_Dashboard.py:179:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "is_read": random.choice([True, False]),
^
src/mock/mock_Dashboard.py:191:1: D400 First line should end with a period
    """获取市场热度数据（图表数据）

    Returns:
        List[Dict]: 各概念板块的热度指数数据
    """
^
src/mock/mock_Dashboard.py:206:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return [{"name": sector, "value": random.randint(60, 95)} for sector in sectors]
^
src/mock/mock_Dashboard.py:206:80: E501 line too long (84 > 79 characters)
    return [{"name": sector, "value": random.randint(60, 95)} for sector in sectors]
                                                                               ^
src/mock/mock_Dashboard.py:210:1: D400 First line should end with a period
    """获取龙虎榜数据

    Returns:
        List[Dict]: 龙虎榜数据列表
    """
^
src/mock/mock_Dashboard.py:216:80: E501 line too long (82 > 79 characters)
        {"symbol": "600519", "name": "贵州茅台", "change": 5.2, "amount": 1500000000},
                                                                               ^
src/mock/mock_Dashboard.py:217:80: E501 line too long (80 > 79 characters)
        {"symbol": "000858", "name": "五粮液", "change": 3.8, "amount": 800000000},
                                                                               ^
src/mock/mock_Dashboard.py:218:80: E501 line too long (82 > 79 characters)
        {"symbol": "300750", "name": "宁德时代", "change": 4.5, "amount": 1200000000},
                                                                               ^
src/mock/mock_Dashboard.py:219:80: E501 line too long (81 > 79 characters)
        {"symbol": "688981", "name": "中芯国际", "change": 6.1, "amount": 950000000},
                                                                               ^
src/mock/mock_Dashboard.py:220:80: E501 line too long (80 > 79 characters)
        {"symbol": "002594", "name": "比亚迪", "change": 2.9, "amount": 750000000},
                                                                               ^
src/mock/mock_Dashboard.py:228:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change_percent": round(stock["change"] * random.uniform(0.8, 1.2), 2),
^
src/mock/mock_Dashboard.py:228:80: E501 line too long (83 > 79 characters)
            "change_percent": round(stock["change"] * random.uniform(0.8, 1.2), 2),
                                                                               ^
src/mock/mock_Dashboard.py:240:1: D400 First line should end with a period
    """获取领涨板块数据（图表数据）

    Returns:
        List[Dict]: 各板块的涨幅数据
    """
^
src/mock/mock_Dashboard.py:247:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        {"name": sector, "change": round(random.uniform(2.0, 8.5), 2)}
^
src/mock/mock_Dashboard.py:253:1: D400 First line should end with a period
    """获取涨跌分布数据（图表数据）

    Returns:
        List[Dict]: 各涨跌区间的股票数量分布
    """
^
src/mock/mock_Dashboard.py:261:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "value": random.randint(400, 500),
^
src/mock/mock_Dashboard.py:266:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "value": random.randint(1200, 1300),
^
src/mock/mock_Dashboard.py:271:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "value": random.randint(750, 850),
^
src/mock/mock_Dashboard.py:276:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "value": random.randint(1100, 1200),
^
src/mock/mock_Dashboard.py:281:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "value": random.randint(300, 400),
^
src/mock/mock_Dashboard.py:288:1: D400 First line should end with a period
    """获取资金流向数据（图表数据）

    Returns:
        List[Dict]: 各类型资金流向数据
    """
^
src/mock/mock_Dashboard.py:294:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        {"name": "超大单", "value": round(random.uniform(100, 150), 1)},
^
src/mock/mock_Dashboard.py:295:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        {"name": "大单", "value": round(random.uniform(80, 90), 1)},
^
src/mock/mock_Dashboard.py:296:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        {"name": "中单", "value": round(random.uniform(-50, -40), 1)},
^
src/mock/mock_Dashboard.py:297:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        {"name": "小单", "value": round(random.uniform(-170, -160), 1)},
^
src/mock/mock_Dashboard.py:302:1: D400 First line should end with a period
    """获取行业资金流向数据（图表数据）

    Args:
        standard: 行业分类标准（csrc=证监会，sw_l1=申万一级，sw_l2=申万二级）

    Returns:
        Dict: 行业资金流向图表配置
    """
^
src/mock/mock_Dashboard.py:362:1: D400 First line should end with a period
    """获取策略选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 策略选股列表及评分数据
    """
^
src/mock/mock_Dashboard.py:379:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(10, 100), 2),
^
src/mock/mock_Dashboard.py:380:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-2, 6), 2),
^
src/mock/mock_Dashboard.py:394:1: D400 First line should end with a period
    """获取行业选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 行业龙头股票数据
    """
^
src/mock/mock_Dashboard.py:441:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(50, 2000), 2),
^
src/mock/mock_Dashboard.py:442:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-1, 3), 2),
^
src/mock/mock_Dashboard.py:452:1: D400 First line should end with a period
    """获取概念选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 热门概念股票数据
    """
^
src/mock/mock_Dashboard.py:494:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(20, 200), 2),
^
src/mock/mock_Dashboard.py:495:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(1, 7), 2),
^
src/mock/mock_Dashboard.py:506:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Dashboard.py:515:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Dashboard.py:521:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Dashboard.py:526:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_Dashboard.py:530:1: D400 First line should end with a period
    """获取Dashboard专用的统计数据数组格式

    Returns:
        List[Dict]: Dashboard.vue期望的stats数组格式
    """
^
src/mock/mock_Dashboard.py:546:1: D400 First line should end with a period
    """获取自选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 自选股列表及其实时行情数据
    """
^
src/mock/mock_Dashboard.py:563:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(20, 2000), 2),
^
src/mock/mock_Dashboard.py:564:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-3, 5), 2),
^
src/mock/mock_Dashboard.py:565:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "volume": f"{random.randint(10, 50)}万手",
^
src/mock/mock_Dashboard.py:566:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "turnover": round(random.uniform(0.5, 5.0), 2),
^
src/mock/mock_Dashboard.py:573:1: F811 redefinition of unused 'get_strategy_stocks' from line 361
def get_strategy_stocks() -> List[Dict]:
^
src/mock/mock_Dashboard.py:574:1: D400 First line should end with a period
    """获取策略选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 策略选股列表及评分数据
    """
^
src/mock/mock_Dashboard.py:591:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(10, 100), 2),
^
src/mock/mock_Dashboard.py:592:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-2, 6), 2),
^
src/mock/mock_Dashboard.py:605:1: F811 redefinition of unused 'get_industry_stocks' from line 393
def get_industry_stocks() -> List[Dict]:
^
src/mock/mock_Dashboard.py:606:1: D400 First line should end with a period
    """获取行业选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 行业龙头股票数据
    """
^
src/mock/mock_Dashboard.py:653:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(50, 2000), 2),
^
src/mock/mock_Dashboard.py:654:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-1, 3), 2),
^
src/mock/mock_Dashboard.py:663:1: F811 redefinition of unused 'get_concept_stocks' from line 451
def get_concept_stocks() -> List[Dict]:
^
src/mock/mock_Dashboard.py:664:1: D400 First line should end with a period
    """获取概念选股板块表现数据（表格数据）

    Returns:
        List[Dict]: 热门概念股票数据
    """
^
src/mock/mock_Dashboard.py:706:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(20, 200), 2),
^
src/mock/mock_Dashboard.py:707:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(1, 7), 2),
^
src/mock/mock_Dashboard.py:716:1: D400 First line should end with a period
    """获取Dashboard专用的行业数据

    Returns:
        Dict: Dashboard.vue期望的industryData格式
    """
^
src/mock/mock_Dashboard.py:768:11: F541 f-string is missing placeholders
    print(f"get_market_overview() 调用测试:")
          ^
src/mock/mock_Dashboard.py:772:11: F541 f-string is missing placeholders
    print(f"\nget_market_stats() 调用测试:")
          ^
src/mock/mock_Dashboard.py:776:11: F541 f-string is missing placeholders
    print(f"\nget_market_heat() 调用测试:")
          ^
src/mock/mock_IndicatorLibrary.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: IndicatorLibrary
提供接口:
1. get_indicator_list() -> List[Dict] - 获取指标列表
2. get_indicator_detail() -> Dict - 获取指标详情
3. get_indicator_data() -> pd.DataFrame - 获取指标数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-15
"""
^
src/mock/mock_IndicatorLibrary.py:1:1: D400 First line should end with a period
"""
Mock数据文件: IndicatorLibrary
提供接口:
1. get_indicator_list() -> List[Dict] - 获取指标列表
2. get_indicator_detail() -> Dict - 获取指标详情
3. get_indicator_data() -> pd.DataFrame - 获取指标数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-15
"""
^
src/mock/mock_IndicatorLibrary.py:25:1: D400 First line should end with a period
    """获取指标列表

    Args:
        params: Dict - 查询参数：
                category: Optional[str] - 指标分类（trend, momentum, volatility, volume）
                limit: int - 每页数量，默认20
                offset: int - 偏移量，默认0

    Returns:
        List[Dict]: 指标列表数据，前端表格所需字段：
                   - id: 指标ID
                   - name: 指标名称
                   - category: 指标分类
                   - description: 指标描述
                   - formula: 计算公式
                   - created_at: 创建时间
    """
^
src/mock/mock_IndicatorLibrary.py:29:80: E501 line too long (83 > 79 characters)
    """获取指标列表

    Args:
        params: Dict - 查询参数：
                category: Optional[str] - 指标分类（trend, momentum, volatility, volume）
                limit: int - 每页数量，默认20
                offset: int - 偏移量，默认0

    Returns:
        List[Dict]: 指标列表数据，前端表格所需字段：
                   - id: 指标ID
                   - name: 指标名称
                   - category: 指标分类
                   - description: 指标描述
                   - formula: 计算公式
                   - created_at: 创建时间
    """




                         ^
src/mock/mock_IndicatorLibrary.py:217:55: E203 whitespace before ':'
    paginated_indicators = available_indicators[offset : offset + limit]
                                                      ^
src/mock/mock_IndicatorLibrary.py:221:80: E501 line too long (81 > 79 characters)
    base_date = datetime.datetime.now() - datetime.timedelta(days=365)  # 约1年前的日期
                                                                               ^
src/mock/mock_IndicatorLibrary.py:223:9: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
    for i, indicator in enumerate(paginated_indicators):
        ^
src/mock/mock_IndicatorLibrary.py:224:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        created_date = base_date + datetime.timedelta(days=random.randint(0, 365))
^
src/mock/mock_IndicatorLibrary.py:224:80: E501 line too long (82 > 79 characters)
        created_date = base_date + datetime.timedelta(days=random.randint(0, 365))
                                                                               ^
src/mock/mock_IndicatorLibrary.py:241:1: D400 First line should end with a period
    """获取指标详情

    Args:
        indicator_id: str - 指标ID

    Returns:
        Dict: 指标详情数据，包含：
             - id: 指标ID
             - name: 指标名称
             - category: 指标分类
             - description: 指标描述
             - formula: 计算公式
             - parameters: 参数列表
             - usage: 使用说明
             - interpretation: 指标解读
    """
^
src/mock/mock_IndicatorLibrary.py:281:80: E501 line too long (90 > 79 characters)
            "formula": "DIF=EMA(CLOSE,12)-EMA(CLOSE,26); DEA=EMA(DIF,9); BAR=2*(DIF-DEA)",
                                                                               ^
src/mock/mock_IndicatorLibrary.py:282:80: E501 line too long (85 > 79 characters)
            "parameters": ["fast_period: 12", "slow_period: 26", "signal_period: 9"],
                                                                               ^
src/mock/mock_IndicatorLibrary.py:290:80: E501 line too long (120 > 79 characters)
            "formula": "RSV=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100; K=SMA(RSV,M1,1); D=SMA(K,M2,1); J=3*K-2*D",
                                                                               ^
src/mock/mock_IndicatorLibrary.py:299:80: E501 line too long (99 > 79 characters)
            "formula": "ATR(MAX(MAX(HIGH-LOW, ABS(HIGH-REF(CLOSE,1))), ABS(LOW-REF(CLOSE,1))), N)",
                                                                               ^
src/mock/mock_IndicatorLibrary.py:308:80: E501 line too long (109 > 79 characters)
            "formula": "IF(CLOSE>REF(CLOSE,1), VOLUME, IF(CLOSE<REF(CLOSE,1), -VOLUME, 0)); OBV=CUM(SUMVOL)",
                                                                               ^
src/mock/mock_IndicatorLibrary.py:342:80: E501 line too long (87 > 79 characters)
def get_indicator_data(indicator_id: str, symbol: str, days: int = 30) -> pd.DataFrame:
                                                                               ^
src/mock/mock_IndicatorLibrary.py:343:1: D400 First line should end with a period
    """获取指标数据表格

    Args:
        indicator_id: str - 指标ID
        symbol: str - 股票代码
        days: int - 历史天数，默认30天

    Returns:
        pd.DataFrame: 指标数据表格，列名对应前端表格字段
    """
^
src/mock/mock_IndicatorLibrary.py:386:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(current_price + random.uniform(-5.0, 5.0), 2)
^
src/mock/mock_IndicatorLibrary.py:386:80: E501 line too long (81 > 79 characters)
            indicator_value = round(current_price + random.uniform(-5.0, 5.0), 2)
                                                                               ^
src/mock/mock_IndicatorLibrary.py:389:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(20.0, 80.0), 2)
^
src/mock/mock_IndicatorLibrary.py:392:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(20.0, 80.0), 2)
^
src/mock/mock_IndicatorLibrary.py:395:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(20.0, 80.0), 2)
^
src/mock/mock_IndicatorLibrary.py:398:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(20.0, 80.0), 2)
^
src/mock/mock_IndicatorLibrary.py:401:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(-2.0, 2.0), 4)
^
src/mock/mock_IndicatorLibrary.py:404:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(0.5, 5.0), 2)
^
src/mock/mock_IndicatorLibrary.py:407:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(1000000, 100000000), 0)
^
src/mock/mock_IndicatorLibrary.py:413:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(0.5, 5.0), 2)
^
src/mock/mock_IndicatorLibrary.py:416:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            indicator_value = round(random.uniform(0.0, 100.0), 2)
^
src/mock/mock_IndicatorLibrary.py:421:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change = round(random.uniform(-3.0, 3.0), 2)
^
src/mock/mock_IndicatorLibrary.py:442:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_IndicatorLibrary.py:451:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_IndicatorLibrary.py:457:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_IndicatorLibrary.py:462:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_IndicatorLibrary.py:469:11: F541 f-string is missing placeholders
    print(f"get_indicator_list() 调用测试:")
          ^
src/mock/mock_IndicatorLibrary.py:473:11: F541 f-string is missing placeholders
    print(f"\nget_indicator_detail() 调用测试:")
          ^
src/mock/mock_IndicatorLibrary.py:477:11: F541 f-string is missing placeholders
    print(f"\nget_indicator_data() 调用测试:")
          ^
src/mock/mock_Login.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Login
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Login.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Login
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Login.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_Login.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_Login.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_Login.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_Login.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Login.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Login.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Login.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_Login.py:115:11: F541 f-string is missing placeholders
    print(f"get_data_list() 调用测试:")
          ^
src/mock/mock_Login.py:120:9: F541 f-string is missing placeholders
        f"""
get_data_detail() 调用测试:"""
        ^
src/mock/mock_Login.py:127:9: F541 f-string is missing placeholders
        f"""
get_data_table() 调用测试:"""
        ^
src/mock/mock_Login.py:132:9: F541 f-string is missing placeholders
        f"""返回数据:
"""
        ^
src/mock/mock_Market.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Market
提供接口:
1. get_market_heatmap() -> List[Dict] - 获取市场热力图数据
2. get_real_time_quotes() -> List[Dict] - 获取实时行情
3. get_fund_flow() -> List[Dict] - 获取资金流向数据
4. get_etf_list() -> List[Dict] - 获取ETF列表
5. get_chip_race() -> List[Dict] - 获取竞价抢筹数据
6. get_lhb_detail() -> List[Dict] - 获取龙虎榜数据
7. get_stock_list() -> List[Dict] - 获取股票列表
8. get_kline_data() -> List[Dict] - 获取K线数据

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Market.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Market
提供接口:
1. get_market_heatmap() -> List[Dict] - 获取市场热力图数据
2. get_real_time_quotes() -> List[Dict] - 获取实时行情
3. get_fund_flow() -> List[Dict] - 获取资金流向数据
4. get_etf_list() -> List[Dict] - 获取ETF列表
5. get_chip_race() -> List[Dict] - 获取竞价抢筹数据
6. get_lhb_detail() -> List[Dict] - 获取龙虎榜数据
7. get_stock_list() -> List[Dict] - 获取股票列表
8. get_kline_data() -> List[Dict] - 获取K线数据

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Market.py:33:1: D400 First line should end with a period
    """生成更真实的股票价格，使用对数正态分布

    Args:
        base_price: 基准价格
        volatility: 价格波动率

    Returns:
        float: 生成的股票价格
    """
^
src/mock/mock_Market.py:49:1: D400 First line should end with a period
    """基于市值生成更真实的成交量

    Args:
        market_cap: 市值(亿元)

    Returns:
        int: 成交量(股)
    """
^
src/mock/mock_Market.py:60:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    volume = base_volume * market_factor * random.uniform(0.5, 3.0)
^
src/mock/mock_Market.py:65:1: D400 First line should end with a period
    """生成相关的价格变动和百分比变动

    Args:
        volatility: 波动率

    Returns:
        tuple: (change_amount, change_percent)
    """
^
src/mock/mock_Market.py:83:1: D400 First line should end with a period
    """获取市场热力图数据

    Args:
        market: str - 市场类型: cn(A股)/hk(港股)
        limit: int - 返回股票数量

    Returns:
        List[Dict]: 市场热力图数据，包含:
                   - symbol: 股票代码
                   - name: 股票名称
                   - price: 实时价格
                   - change: 涨跌额
                   - change_pct: 涨跌幅(%)
                   - volume: 成交量
                   - amount: 成交额
                   - market_cap: 市值
    """
^
src/mock/mock_Market.py:217:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        volatility = random.uniform(0.01, 0.05)  # 不同股票有不同的波动率
^
src/mock/mock_Market.py:254:1: D400 First line should end with a period
    """获取实时行情

    Args:
        symbols: Optional[str] - 股票代码列表，逗号分隔

    Returns:
        List[Dict]: 实时行情列表，包含:
                   - symbol: 股票代码
                   - name: 股票名称
                   - price: 实时价格
                   - change: 涨跌额
                   - change_pct: 涨跌幅(%)
                   - volume: 成交量
                   - turnover: 成交额
                   - open: 开盘价
                   - high: 最高价
                   - low: 最低价
                   - close: 昨收价
    """
^
src/mock/mock_Market.py:293:80: E501 line too long (84 > 79 characters)
        stock = stock_info.get(symbol, {"name": f"股票{symbol}", "base_price": 100.0})
                                                                               ^
src/mock/mock_Market.py:297:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_amount = round(random.uniform(-base_price * 0.05, base_price * 0.05), 2)
^
src/mock/mock_Market.py:297:80: E501 line too long (87 > 79 characters)
        change_amount = round(random.uniform(-base_price * 0.05, base_price * 0.05), 2)
                                                                               ^
src/mock/mock_Market.py:302:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            base_price + random.uniform(-base_price * 0.02, base_price * 0.02), 2
^
src/mock/mock_Market.py:302:80: E501 line too long (81 > 79 characters)
            base_price + random.uniform(-base_price * 0.02, base_price * 0.02), 2
                                                                               ^
src/mock/mock_Market.py:305:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            max(price, open_price) + random.uniform(0, base_price * 0.01), 2
^
src/mock/mock_Market.py:308:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            min(price, open_price) - random.uniform(0, base_price * 0.01), 2
^
src/mock/mock_Market.py:311:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        volume = random.randint(1000000, 50000000)
^
src/mock/mock_Market.py:327:80: E501 line too long (83 > 79 characters)
                "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_Market.py:340:1: D400 First line should end with a period
    """获取资金流向数据

    Args:
        symbol: str - 股票代码
        timeframe: str - 时间维度: 1/3/5/10天
        start_date: Optional[str] - 开始日期
        end_date: Optional[str] - 结束日期

    Returns:
        List[Dict]: 资金流向数据，包含:
                   - date: 日期
                   - main_inflow: 主力净流入
                   - main_outflow: 主力净流出
                   - retail_inflow: 散户净流入
                   - retail_outflow: 散户净流出
                   - net_amount: 净流入额
    """
^
src/mock/mock_Market.py:358:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    base_flow = random.randint(-50000000, 50000000)  # 基础净流入
^
src/mock/mock_Market.py:380:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            main_inflow = random.randint(1000000, 50000000)
^
src/mock/mock_Market.py:381:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            main_outflow = random.randint(1000000, 50000000)
^
src/mock/mock_Market.py:382:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            retail_inflow = random.randint(500000, 10000000)
^
src/mock/mock_Market.py:383:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            retail_outflow = random.randint(500000, 10000000)
^
src/mock/mock_Market.py:385:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            net_amount = current_flow + random.randint(-10000000, 10000000)
^
src/mock/mock_Market.py:407:80: E501 line too long (80 > 79 characters)
    symbol: Optional[str] = None, keyword: Optional[str] = None, limit: int = 50
                                                                               ^
src/mock/mock_Market.py:409:1: D400 First line should end with a period
    """获取ETF列表

    Args:
        symbol: Optional[str] - ETF代码
        keyword: Optional[str] - 关键词搜索
        limit: int - 返回数量

    Returns:
        List[Dict]: ETF数据，包含:
                   - symbol: ETF代码
                   - name: ETF名称
                   - price: 最新价
                   - change: 涨跌额
                   - change_pct: 涨跌幅(%)
                   - volume: 成交量
                   - amount: 成交额
    """
^
src/mock/mock_Market.py:451:80: E501 line too long (87 > 79 characters)
        {"symbol": "515050", "name": "5G ETF", "base_price": 1.23, "volume": 28000000},
                                                                               ^
src/mock/mock_Market.py:452:80: E501 line too long (86 > 79 characters)
        {"symbol": "159928", "name": "消费ETF", "base_price": 0.87, "volume": 15000000},
                                                                               ^
src/mock/mock_Market.py:453:80: E501 line too long (85 > 79 characters)
        {"symbol": "512690", "name": "酒ETF", "base_price": 0.76, "volume": 22000000},
                                                                               ^
src/mock/mock_Market.py:454:80: E501 line too long (86 > 79 characters)
        {"symbol": "515000", "name": "科技ETF", "base_price": 1.05, "volume": 19000000},
                                                                               ^
src/mock/mock_Market.py:469:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_pct = round(random.uniform(-3.0, 3.0), 2)
^
src/mock/mock_Market.py:473:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        volume_variation = random.uniform(0.5, 3.0)
^
src/mock/mock_Market.py:498:1: D400 First line should end with a period
    """获取竞价抢筹数据

    Args:
        race_type: str - 抢筹类型: open/end
        trade_date: Optional[str] - 交易日期
        min_race_amount: Optional[float] - 最小抢筹金额
        limit: int - 返回数量

    Returns:
        List[Dict]: 竞价抢筹数据，包含:
                   - symbol: 股票代码
                   - name: 股票名称
                   - race_amount: 抢筹金额
                   - race_ratio: 抢筹比例
                   - open_price: 开盘价
                   - close_price: 收盘价
                   - change_pct: 涨跌幅
    """
^
src/mock/mock_Market.py:531:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        race_amount = random.randint(1000000, 100000000)
^
src/mock/mock_Market.py:532:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        race_ratio = round(random.uniform(0.1, 15.0), 2)
^
src/mock/mock_Market.py:536:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_pct = round(random.uniform(-5.0, 5.0), 2)
^
src/mock/mock_Market.py:541:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            open_price = round(close_price * (1 + random.uniform(-0.02, 0.02)), 2)
^
src/mock/mock_Market.py:541:80: E501 line too long (82 > 79 characters)
            open_price = round(close_price * (1 + random.uniform(-0.02, 0.02)), 2)
                                                                               ^
src/mock/mock_Market.py:576:1: D400 First line should end with a period
    """获取龙虎榜详细数据

    Args:
        symbol: Optional[str] - 股票代码
        start_date: Optional[str] - 开始日期
        end_date: Optional[str] - 结束日期
        min_net_amount: Optional[float] - 最小净买入额
        limit: int - 返回数量

    Returns:
        List[Dict]: 龙虎榜数据，包含:
                   - trade_date: 交易日期
                   - symbol: 股票代码
                   - name: 股票名称
                   - net_amount: 净买入额
                   - buy_amount: 买入金额
                   - sell_amount: 卖出金额
                   - reason: 上榜原因
    """
^
src/mock/mock_Market.py:622:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                net_amount = random.randint(-50000000, 100000000)
^
src/mock/mock_Market.py:630:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                buy_amount = max(0, net_amount) + random.randint(0, 50000000)
^
src/mock/mock_Market.py:631:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                sell_amount = max(0, -net_amount) + random.randint(0, 50000000)
^
src/mock/mock_Market.py:632:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                reason = random.choice(reason_pool)
^
src/mock/mock_Market.py:650:80: E501 line too long (80 > 79 characters)
        lhb_data, key=lambda x: (x["trade_date"], x["net_amount"]), reverse=True
                                                                               ^
src/mock/mock_Market.py:662:1: D400 First line should end with a period
    """获取股票列表

    Args:
        limit: int - 返回记录数限制
        search: Optional[str] - 股票代码或名称搜索关键词
        exchange: Optional[str] - 交易所筛选: SSE/SZSE
        security_type: Optional[str] - 证券类型筛选

    Returns:
        List[Dict]: 股票列表，包含:
                   - symbol: 股票代码
                   - name: 股票名称
                   - exchange: 交易所
                   - security_type: 证券类型
                   - list_date: 上市日期
                   - status: 状态
                   - listing_board: 上市板块
                   - market_cap: 总市值
                   - circulating_market_cap: 流通市值
    """
^
src/mock/mock_Market.py:756:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        days=random.randint(1000, 8000)
^
src/mock/mock_Market.py:760:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        list_date = base_date + datetime.timedelta(days=random.randint(0, 7000))
^
src/mock/mock_Market.py:760:80: E501 line too long (80 > 79 characters)
        list_date = base_date + datetime.timedelta(days=random.randint(0, 7000))
                                                                               ^
src/mock/mock_Market.py:786:1: D400 First line should end with a period
    """获取K线数据

    Args:
        stock_code: str - 股票代码
        period: str - 时间周期: daily/weekly/monthly
        adjust: str - 复权类型: qfq/hfq/空字符串
        start_date: Optional[str] - 开始日期
        end_date: Optional[str] - 结束日期

    Returns:
        List[Dict]: K线数据，包含:
                   - date: 日期
                   - open: 开盘价
                   - high: 最高价
                   - low: 最低价
                   - close: 收盘价
                   - volume: 成交量
                   - amount: 成交额
    """
^
src/mock/mock_Market.py:848:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            open_price = round(current_price + random.uniform(-2.0, 2.0), 2)
^
src/mock/mock_Market.py:849:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            daily_change = random.uniform(-0.03, 0.03)
^
src/mock/mock_Market.py:851:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                max(open_price, current_price) * (1 + random.uniform(0, 0.02)), 2
^
src/mock/mock_Market.py:851:80: E501 line too long (81 > 79 characters)
                max(open_price, current_price) * (1 + random.uniform(0, 0.02)), 2
                                                                               ^
src/mock/mock_Market.py:854:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                min(open_price, current_price) * (1 - random.uniform(0, 0.02)), 2
^
src/mock/mock_Market.py:854:80: E501 line too long (81 > 79 characters)
                min(open_price, current_price) * (1 - random.uniform(0, 0.02)), 2
                                                                               ^
src/mock/mock_Market.py:857:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            volume = random.randint(1000000, 50000000)
^
src/mock/mock_Market.py:883:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Market.py:892:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Market.py:898:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Market.py:903:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_MarketData.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: MarketData
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_MarketData.py:1:1: D400 First line should end with a period
"""
Mock数据文件: MarketData
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_MarketData.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_MarketData.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_MarketData.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_MarketData.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_MarketData.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_MarketData.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_MarketData.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_MarketData.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_MarketData.py:115:11: F541 f-string is missing placeholders
    print(f"get_data_list() 调用测试:")
          ^
src/mock/mock_MarketData.py:120:9: F541 f-string is missing placeholders
        f"""
get_data_detail() 调用测试:"""
        ^
src/mock/mock_MarketData.py:127:9: F541 f-string is missing placeholders
        f"""
get_data_table() 调用测试:"""
        ^
src/mock/mock_MarketData.py:132:9: F541 f-string is missing placeholders
        f"""返回数据:
"""
        ^
src/mock/mock_MarketDataView.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: MarketDataView
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_MarketDataView.py:1:1: D400 First line should end with a period
"""
Mock数据文件: MarketDataView
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_MarketDataView.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_MarketDataView.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_MarketDataView.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_MarketDataView.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_MarketDataView.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_MarketDataView.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_MarketDataView.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_MarketDataView.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_MarketDataView.py:115:11: F541 f-string is missing placeholders
    print(f"get_data_list() 调用测试:")
          ^
src/mock/mock_MarketDataView.py:120:9: F541 f-string is missing placeholders
        f"""
get_data_detail() 调用测试:"""
        ^
src/mock/mock_MarketDataView.py:127:9: F541 f-string is missing placeholders
        f"""
get_data_table() 调用测试:"""
        ^
src/mock/mock_MarketDataView.py:132:9: F541 f-string is missing placeholders
        f"""返回数据:
"""
        ^
src/mock/mock_RealTimeMonitor.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: RealTimeMonitor
提供接口:
1. get_realtime_alerts() -> List[Dict] - 获取实时告警
2. get_monitoring_summary() -> Dict - 获取监控摘要
3. get_monitoring_status() -> Dict - 获取监控状态

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-15
"""
^
src/mock/mock_RealTimeMonitor.py:1:1: D400 First line should end with a period
"""
Mock数据文件: RealTimeMonitor
提供接口:
1. get_realtime_alerts() -> List[Dict] - 获取实时告警
2. get_monitoring_summary() -> Dict - 获取监控摘要
3. get_monitoring_status() -> Dict - 获取监控状态

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-15
"""
^
src/mock/mock_RealTimeMonitor.py:24:1: D400 First line should end with a period
    """获取实时告警

    Args:
        params: Dict - 查询参数：
                limit: int - 返回记录数，默认50
                offset: int - 偏移量，默认0
                is_read: bool - 是否已读，None表示全部

    Returns:
        List[Dict]: 实时告警数据列表，包含：
                   - id: 告警ID
                   - symbol: 股票代码
                   - stock_name: 股票名称
                   - alert_type: 告警类型
                   - level: 告警级别
                   - message: 告警消息
                   - timestamp: 时间戳
                   - is_read: 是否已读
    """
^
src/mock/mock_RealTimeMonitor.py:75:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        alert_type = random.choice(alert_types)
^
src/mock/mock_RealTimeMonitor.py:76:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        alert_level = random.choice(alert_levels)
^
src/mock/mock_RealTimeMonitor.py:80:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            message = f"{stock_names[symbol_idx]}股价突破{random.randint(100, 2000)}元"
^
src/mock/mock_RealTimeMonitor.py:80:80: E501 line too long (82 > 79 characters)
            message = f"{stock_names[symbol_idx]}股价突破{random.randint(100, 2000)}元"
                                                                               ^
src/mock/mock_RealTimeMonitor.py:82:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            message = f"{stock_names[symbol_idx]}成交量激增{random.randint(2, 10)}倍"
^
src/mock/mock_RealTimeMonitor.py:86:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                f"{stock_names[symbol_idx]}{random.choice(indicators)}指标出现信号"
^
src/mock/mock_RealTimeMonitor.py:89:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            direction = "流入" if random.choice([True, False]) else "流出"
^
src/mock/mock_RealTimeMonitor.py:90:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            amount = random.randint(1000, 10000)
^
src/mock/mock_RealTimeMonitor.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            minutes=random.randint(0, 1440)
^
src/mock/mock_RealTimeMonitor.py:109:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "is_read": random.choice([True, False]) if is_read is None else is_read,
^
src/mock/mock_RealTimeMonitor.py:109:80: E501 line too long (88 > 79 characters)
                "is_read": random.choice([True, False]) if is_read is None else is_read,
                                                                               ^
src/mock/mock_RealTimeMonitor.py:119:37: E203 whitespace before ':'
    paginated_alerts = alerts[offset : offset + limit]
                                    ^
src/mock/mock_RealTimeMonitor.py:129:1: D400 First line should end with a period
    """获取监控摘要

    Returns:
        Dict: 监控摘要数据，包含：
             - total_stocks: 总股票数
             - limit_up_count: 涨停数
             - limit_down_count: 跌停数
             - strong_up_count: 强势上涨数
             - strong_down_count: 强势下跌数
             - avg_change_percent: 平均涨跌幅
             - total_amount: 总成交额
             - active_alerts: 活跃告警数
             - unread_alerts: 未读告警数
    """
^
src/mock/mock_RealTimeMonitor.py:145:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "limit_up_count": random.randint(30, 60),
^
src/mock/mock_RealTimeMonitor.py:146:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "limit_down_count": random.randint(5, 15),
^
src/mock/mock_RealTimeMonitor.py:147:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "strong_up_count": random.randint(80, 150),
^
src/mock/mock_RealTimeMonitor.py:148:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "strong_down_count": random.randint(40, 100),
^
src/mock/mock_RealTimeMonitor.py:149:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "avg_change_percent": round(random.uniform(-2.0, 2.0), 2),
^
src/mock/mock_RealTimeMonitor.py:150:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "total_amount": round(random.uniform(800, 1200), 2) * 100000000,  # 800-1200亿
^
src/mock/mock_RealTimeMonitor.py:150:80: E501 line too long (85 > 79 characters)
        "total_amount": round(random.uniform(800, 1200), 2) * 100000000,  # 800-1200亿
                                                                               ^
src/mock/mock_RealTimeMonitor.py:151:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "active_alerts": random.randint(15, 35),
^
src/mock/mock_RealTimeMonitor.py:152:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "unread_alerts": random.randint(8, 20),
^
src/mock/mock_RealTimeMonitor.py:157:1: D400 First line should end with a period
    """获取监控状态

    Returns:
        Dict: 监控状态信息，包含：
             - is_running: 是否运行中
             - start_time: 启动时间
             - last_update: 最后更新时间
             - monitored_symbols: 监控股票数
             - active_alerts: 活跃告警数
             - status: 状态
    """
^
src/mock/mock_RealTimeMonitor.py:170:80: E501 line too long (87 > 79 characters)
        "start_time": (datetime.datetime.now() - datetime.timedelta(hours=8)).strftime(
                                                                               ^
src/mock/mock_RealTimeMonitor.py:175:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "active_alerts": random.randint(10, 25),
^
src/mock/mock_RealTimeMonitor.py:183:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_RealTimeMonitor.py:192:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_RealTimeMonitor.py:198:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_RealTimeMonitor.py:203:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_RealTimeMonitor.py:210:11: F541 f-string is missing placeholders
    print(f"get_realtime_alerts() 调用测试:")
          ^
src/mock/mock_RealTimeMonitor.py:214:11: F541 f-string is missing placeholders
    print(f"\nget_monitoring_summary() 调用测试:")
          ^
src/mock/mock_RealTimeMonitor.py:218:11: F541 f-string is missing placeholders
    print(f"\nget_monitoring_status() 调用测试:")
          ^
src/mock/mock_RiskMonitor.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: RiskMonitor
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_RiskMonitor.py:1:1: D400 First line should end with a period
"""
Mock数据文件: RiskMonitor
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_RiskMonitor.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_RiskMonitor.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_RiskMonitor.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_RiskMonitor.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_RiskMonitor.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_RiskMonitor.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_RiskMonitor.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_RiskMonitor.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_Settings.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Settings
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Settings.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Settings
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Settings.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_Settings.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_Settings.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_Settings.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_Settings.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Settings.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Settings.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Settings.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_StockSearch.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: StockSearch
提供接口:
1. search_stocks() -> List[Dict] - 搜索股票（支持按代码、名称、行业搜索）
2. get_stock_detail() -> Dict - 获取股票详情
3. get_industry_list() -> List[Dict] - 获取行业列表
4. get_stock_concept() -> List[Dict] - 获取概念板块

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_StockSearch.py:1:1: D400 First line should end with a period
"""
Mock数据文件: StockSearch
提供接口:
1. search_stocks() -> List[Dict] - 搜索股票（支持按代码、名称、行业搜索）
2. get_stock_detail() -> Dict - 获取股票详情
3. get_industry_list() -> List[Dict] - 获取行业列表
4. get_stock_concept() -> List[Dict] - 获取概念板块

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_StockSearch.py:26:1: D400 First line should end with a period
    """生成更真实的市值分布（对数正态分布）"""
^
src/mock/mock_StockSearch.py:34:1: D400 First line should end with a period
    """生成相关联的价格、涨跌幅、成交量数据"""
^
src/mock/mock_StockSearch.py:48:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    volume = int(volume_base * random.uniform(0.3, 3.0))
^
src/mock/mock_StockSearch.py:61:1: D400 First line should end with a period
    """搜索股票（支持按代码、名称、行业搜索）

    Args:
        keyword: str - 搜索关键词（股票代码或名称）
        industry: str - 行业筛选
        market: str - 市场筛选 (SSE/SZSE)
        limit: int - 返回数量限制

    Returns:
        List[Dict]: 搜索结果，包含：
                   - symbol: 股票代码
                   - name: 股票名称
                   - industry: 所属行业
                   - market: 市场
                   - current_price: 当前价格
                   - change_pct: 涨跌幅(%)
                   - volume: 成交量
                   - market_cap: 市值
    """
^
src/mock/mock_StockSearch.py:206:80: E501 line too long (85 > 79 characters)
            if keyword in stock["symbol"].lower() or keyword in stock["name"].lower()
                                                                               ^
src/mock/mock_StockSearch.py:246:1: D400 First line should end with a period
    """获取股票详情

    Args:
        symbol: str - 股票代码

    Returns:
        Dict: 股票详情，包含：
             - basic_info: 基本信息
             - financial_info: 财务信息
             - price_info: 价格信息
             - business_scope: 经营范围
    """
^
src/mock/mock_StockSearch.py:312:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    base_price = random.uniform(10.0, 100.0)
^
src/mock/mock_StockSearch.py:313:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    current_price = round(base_price * (1 + random.uniform(-0.1, 0.1)), 2)
^
src/mock/mock_StockSearch.py:317:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "pe_ratio": round(random.uniform(8.0, 50.0), 2),
^
src/mock/mock_StockSearch.py:318:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "pb_ratio": round(random.uniform(0.5, 3.0), 2),
^
src/mock/mock_StockSearch.py:319:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "roe": round(random.uniform(5.0, 25.0), 2),
^
src/mock/mock_StockSearch.py:320:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "debt_ratio": round(random.uniform(30.0, 90.0), 2),
^
src/mock/mock_StockSearch.py:321:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "revenue_growth": round(random.uniform(-20.0, 30.0), 2),
^
src/mock/mock_StockSearch.py:322:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "net_profit_growth": round(random.uniform(-30.0, 40.0), 2),
^
src/mock/mock_StockSearch.py:326:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_amount = round(random.uniform(-5.0, 5.0), 2)
^
src/mock/mock_StockSearch.py:331:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "open_price": round(base_price + random.uniform(-2.0, 2.0), 2),
^
src/mock/mock_StockSearch.py:332:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "high_price": round(max(base_price, current_price) + random.uniform(0, 3.0), 2),
^
src/mock/mock_StockSearch.py:332:80: E501 line too long (88 > 79 characters)
        "high_price": round(max(base_price, current_price) + random.uniform(0, 3.0), 2),
                                                                               ^
src/mock/mock_StockSearch.py:333:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "low_price": round(min(base_price, current_price) - random.uniform(0, 3.0), 2),
^
src/mock/mock_StockSearch.py:333:80: E501 line too long (87 > 79 characters)
        "low_price": round(min(base_price, current_price) - random.uniform(0, 3.0), 2),
                                                                               ^
src/mock/mock_StockSearch.py:337:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "volume": random.randint(1000000, 50000000),
^
src/mock/mock_StockSearch.py:338:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "amount": round(current_price * random.randint(1000000, 50000000), 2),
^
src/mock/mock_StockSearch.py:339:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "turnover_rate": round(random.uniform(0.1, 10.0), 2),
^
src/mock/mock_StockSearch.py:362:1: D400 First line should end with a period
    """获取行业列表

    Returns:
        List[Dict]: 行业列表，包含：
                   - industry: 行业名称
                   - stock_count: 股票数量
                   - avg_change_pct: 平均涨跌幅
                   - total_market_cap: 总市值
    """
^
src/mock/mock_StockSearch.py:388:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        stock_count = industry["base_count"] + random.randint(-20, 50)
^
src/mock/mock_StockSearch.py:389:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        avg_change_pct = round(random.uniform(-3.0, 3.0), 2)
^
src/mock/mock_StockSearch.py:390:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        total_market_cap = int(industry["base_cap"] * (1 + random.uniform(-0.2, 0.5)))
^
src/mock/mock_StockSearch.py:390:80: E501 line too long (86 > 79 characters)
        total_market_cap = int(industry["base_cap"] * (1 + random.uniform(-0.2, 0.5)))
                                                                               ^
src/mock/mock_StockSearch.py:398:80: E501 line too long (83 > 79 characters)
                "leading_stocks": get_leading_stocks_by_industry(industry["name"]),
                                                                               ^
src/mock/mock_StockSearch.py:406:1: D400 First line should end with a period
    """获取概念板块

    Args:
        concept_name: str - 概念名称（可选）

    Returns:
        List[Dict]: 概念板块数据，包含：
                   - concept_name: 概念名称
                   - stock_count: 股票数量
                   - avg_change_pct: 平均涨跌幅
                   - leading_stocks: 龙头股票
    """
^
src/mock/mock_StockSearch.py:462:80: E501 line too long (85 > 79 characters)
        concepts = [c for c in concepts if concept_name.lower() in c["name"].lower()]
                                                                               ^
src/mock/mock_StockSearch.py:468:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        avg_change_pct = round(concept["base_change"] + random.uniform(-2.0, 2.0), 2)
^
src/mock/mock_StockSearch.py:468:80: E501 line too long (85 > 79 characters)
        avg_change_pct = round(concept["base_change"] + random.uniform(-2.0, 2.0), 2)
                                                                               ^
src/mock/mock_StockSearch.py:473:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            current_price = round(random.uniform(10.0, 100.0), 2)
^
src/mock/mock_StockSearch.py:474:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            change_pct = round(avg_change_pct + random.uniform(-1.0, 1.0), 2)
^
src/mock/mock_StockSearch.py:498:1: D400 First line should end with a period
    """根据股票代码获取股票名称"""
^
src/mock/mock_StockSearch.py:533:1: D400 First line should end with a period
    """根据行业获取龙头股票"""
^
src/mock/mock_Stocks.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Stocks
提供接口:
1. get_stock_list() -> List[Dict] - 获取股票列表（支持按交易所筛选，支持分页）
2. get_real_time_quote() -> Dict - 获取实时行情（必填参数：股票代码）
3. get_history_profit() -> pd.DataFrame - 获取历史收益（默认30天，返回DataFrame）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Stocks.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Stocks
提供接口:
1. get_stock_list() -> List[Dict] - 获取股票列表（支持按交易所筛选，支持分页）
2. get_real_time_quote() -> Dict - 获取实时行情（必填参数：股票代码）
3. get_history_profit() -> pd.DataFrame - 获取历史收益（默认30天，返回DataFrame）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Stocks.py:25:1: D400 First line should end with a period
    """获取股票列表（支持按交易所筛选，支持分页）

    Args:
        params: Dict - 查询参数：
                exchange: Optional[str] - 交易所筛选（sh=上交所，sz=深交所）
                limit: int - 每页数量，默认20
                offset: int - 偏移量，默认0

    Returns:
        List[Dict]: 股票列表数据，前端表格所需字段：
                   - symbol: 股票代码
                   - name: 股票名称
                   - industry: 所属行业
                   - area: 地区
                   - market: 市场
                   - list_date: 上市日期
    """
^
src/mock/mock_Stocks.py:176:47: E203 whitespace before ':'
    paginated_stocks = available_stocks[offset : offset + limit]
                                              ^
src/mock/mock_Stocks.py:184:9: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
    for i, stock in enumerate(paginated_stocks):
        ^
src/mock/mock_Stocks.py:185:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        list_date = base_date + datetime.timedelta(days=random.randint(0, 3650))
^
src/mock/mock_Stocks.py:185:80: E501 line too long (80 > 79 characters)
        list_date = base_date + datetime.timedelta(days=random.randint(0, 3650))
                                                                               ^
src/mock/mock_Stocks.py:202:1: D400 First line should end with a period
    """获取实时行情（必填参数：股票代码列表）

    Args:
        stock_codes: List[str] - 股票代码列表（必填）

    Returns:
        List[Dict]: 实时行情数据列表，每项包含：
             - symbol: 股票代码
             - name: 股票名称
             - price: 实时价格
             - change: 涨跌额
             - change_pct: 涨跌幅(%)
             - volume: 成交量
             - turnover: 成交额
             - open: 开盘价
             - high: 最高价
             - low: 最低价
             - close: 昨收价
    """
^
src/mock/mock_Stocks.py:241:80: E501 line too long (80 > 79 characters)
        stock = stock_info.get(code, {"name": f"股票{code}", "base_price": 100.0})
                                                                               ^
src/mock/mock_Stocks.py:245:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_amount = round(random.uniform(-10.0, 10.0), 2)  # 涨跌额
^
src/mock/mock_Stocks.py:249:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        open_price = round(base_price + random.uniform(-3.0, 3.0), 2)
^
src/mock/mock_Stocks.py:251:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            max(base_price, open_price, current_price) + random.uniform(0, 5.0), 2
^
src/mock/mock_Stocks.py:251:80: E501 line too long (82 > 79 characters)
            max(base_price, open_price, current_price) + random.uniform(0, 5.0), 2
                                                                               ^
src/mock/mock_Stocks.py:254:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            min(base_price, open_price, current_price) - random.uniform(0, 5.0), 2
^
src/mock/mock_Stocks.py:254:80: E501 line too long (82 > 79 characters)
            min(base_price, open_price, current_price) - random.uniform(0, 5.0), 2
                                                                               ^
src/mock/mock_Stocks.py:257:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        volume = random.randint(1000000, 100000000)  # 成交量
^
src/mock/mock_Stocks.py:273:80: E501 line too long (83 > 79 characters)
                "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_Stocks.py:281:1: D400 First line should end with a period
    """获取历史收益（默认30天，返回DataFrame）

    Args:
        code: str - 股票代码（必填）
        days: int - 历史天数，默认30天

    Returns:
        pd.DataFrame: 历史收益数据，包含字段：
                     - date: 日期
                     - price: 收盘价
                     - change_amount: 涨跌额
                     - change_pct: 涨跌幅(%)
                     - volume: 成交量
                     - turnover: 成交额
    """
^
src/mock/mock_Stocks.py:329:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change = round(random.uniform(-3.0, 3.0), 2)
^
src/mock/mock_Stocks.py:332:80: E501 line too long (86 > 79 characters)
        change_pct = round((change_amount / (current_price - change_amount)) * 100, 4)
                                                                               ^
src/mock/mock_Stocks.py:334:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        volume = random.randint(1000000, 50000000)
^
src/mock/mock_Stocks.py:357:1: D400 First line should end with a period
    """获取股票详细信息

    Args:
        params: Dict - 查询参数：
                stock_code: str - 股票代码

    Returns:
        Dict: 股票详细信息
    """
^
src/mock/mock_Stocks.py:438:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            - datetime.timedelta(days=random.randint(1000, 5000))
^
src/mock/mock_Stocks.py:440:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "total_shares": random.randint(100000000, 10000000000),
^
src/mock/mock_Stocks.py:441:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "circulating_shares": random.randint(50000000, 8000000000),
^
src/mock/mock_Stocks.py:442:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "pe_ratio": round(random.uniform(5, 50), 2),
^
src/mock/mock_Stocks.py:443:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "pb_ratio": round(random.uniform(0.5, 5), 2),
^
src/mock/mock_Stocks.py:448:1: D400 First line should end with a period
    """获取股票财务数据

    Args:
        params: Dict - 查询参数：
                stock_code: str - 股票代码

    Returns:
        Dict: 股票财务数据
    """
^
src/mock/mock_Stocks.py:463:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "revenue": round(random.uniform(1000000000, 50000000000), 2),  # 收入
^
src/mock/mock_Stocks.py:464:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "net_profit": round(random.uniform(100000000, 10000000000), 2),  # 净利润
^
src/mock/mock_Stocks.py:464:80: E501 line too long (82 > 79 characters)
            "net_profit": round(random.uniform(100000000, 10000000000), 2),  # 净利润
                                                                               ^
src/mock/mock_Stocks.py:466:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                random.uniform(5000000000, 100000000000), 2
^
src/mock/mock_Stocks.py:468:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "net_assets": round(random.uniform(2000000000, 50000000000), 2),  # 净资产
^
src/mock/mock_Stocks.py:468:80: E501 line too long (83 > 79 characters)
            "net_assets": round(random.uniform(2000000000, 50000000000), 2),  # 净资产
                                                                               ^
src/mock/mock_Stocks.py:469:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "roa": round(random.uniform(0.01, 0.15), 4),  # 总资产收益率
^
src/mock/mock_Stocks.py:469:13: F601 dictionary key 'roa' repeated with different values
            "roa": round(random.uniform(0.01, 0.15), 4),  # 总资产收益率
            ^
src/mock/mock_Stocks.py:470:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "roa": round(random.uniform(0.02, 0.25), 4),  # 净资产收益率
^
src/mock/mock_Stocks.py:470:13: F601 dictionary key 'roa' repeated with different values
            "roa": round(random.uniform(0.02, 0.25), 4),  # 净资产收益率
            ^
src/mock/mock_Stocks.py:471:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "debt_ratio": round(random.uniform(0.2, 0.6), 4),  # 资产负债率
^
src/mock/mock_Stocks.py:472:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "current_ratio": round(random.uniform(0.8, 2.5), 2),  # 流动比率
^
src/mock/mock_Stocks.py:475:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                - datetime.timedelta(days=random.randint(0, 365))
^
src/mock/mock_Stocks.py:484:1: D400 First line should end with a period
    """获取股票技术指标

    Args:
        params: Dict - 查询参数：
                stock_code: str - 股票代码

    Returns:
        Dict: 股票技术指标
    """
^
src/mock/mock_Stocks.py:498:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "ma5": round(random.uniform(50, 200), 2),
^
src/mock/mock_Stocks.py:499:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "ma10": round(random.uniform(50, 200), 2),
^
src/mock/mock_Stocks.py:500:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "ma20": round(random.uniform(50, 200), 2),
^
src/mock/mock_Stocks.py:501:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "rsi": round(random.uniform(20, 80), 2),
^
src/mock/mock_Stocks.py:502:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "macd": round(random.uniform(-5, 5), 3),
^
src/mock/mock_Stocks.py:503:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "kdj_k": round(random.uniform(20, 80), 2),
^
src/mock/mock_Stocks.py:504:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "kdj_d": round(random.uniform(20, 80), 2),
^
src/mock/mock_Stocks.py:505:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "kdj_j": round(random.uniform(20, 80), 2),
^
src/mock/mock_Stocks.py:506:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "boll_upper": round(random.uniform(55, 210), 2),
^
src/mock/mock_Stocks.py:507:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "boll_middle": round(random.uniform(50, 200), 2),
^
src/mock/mock_Stocks.py:508:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "boll_lower": round(random.uniform(45, 190), 2),
^
src/mock/mock_Stocks.py:509:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "atr": round(random.uniform(1, 10), 2),
^
src/mock/mock_Stocks.py:510:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "volume_ratio": round(random.uniform(0.5, 3), 2),
^
src/mock/mock_Stocks.py:516:1: D400 First line should end with a period
    """获取实时行情数据

    Returns:
        List[Dict]: 实时行情数据列表
    """
^
src/mock/mock_Stocks.py:544:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_price = random.uniform(20, 2000) if i < 2 else random.uniform(10, 100)
^
src/mock/mock_Stocks.py:544:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_price = random.uniform(20, 2000) if i < 2 else random.uniform(10, 100)
^
src/mock/mock_Stocks.py:544:80: E501 line too long (83 > 79 characters)
        base_price = random.uniform(20, 2000) if i < 2 else random.uniform(10, 100)
                                                                               ^
src/mock/mock_Stocks.py:545:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_pct = round(random.uniform(-5, 5), 2)
^
src/mock/mock_Stocks.py:555:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "volume": random.randint(1000000, 100000000),
^
src/mock/mock_Stocks.py:557:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                    current_price * random.randint(1000000, 100000000), 2
^
src/mock/mock_Stocks.py:559:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "high": round(current_price * (1 + random.uniform(0, 0.05)), 2),
^
src/mock/mock_Stocks.py:559:80: E501 line too long (80 > 79 characters)
                "high": round(current_price * (1 + random.uniform(0, 0.05)), 2),
                                                                               ^
src/mock/mock_Stocks.py:560:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "low": round(current_price * (1 - random.uniform(0, 0.05)), 2),
^
src/mock/mock_Stocks.py:561:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "open": round(base_price + random.uniform(-2, 2), 2),
^
src/mock/mock_Stocks.py:563:80: E501 line too long (83 > 79 characters)
                "timestamp": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_Stocks.py:571:1: D400 First line should end with a period
    """搜索股票

    Args:
        params: Dict - 查询参数：
                q: str - 搜索关键词
                limit: int - 搜索结果数量

    Returns:
        Dict: 搜索结果
    """
^
src/mock/mock_Stocks.py:616:1: D400 First line should end with a period
    """按行业获取股票

    Args:
        params: Dict - 查询参数：
                industry_name: str - 行业名称
                page: int - 页码
                limit: int - 每页数量

    Returns:
        Dict: 行业股票列表
    """
^
src/mock/mock_Stocks.py:637:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(1500, 2000), 2),
^
src/mock/mock_Stocks.py:642:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(130, 250), 2),
^
src/mock/mock_Stocks.py:647:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(150, 250), 2),
^
src/mock/mock_Stocks.py:652:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(80, 180), 2),
^
src/mock/mock_Stocks.py:659:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(30, 50), 2),
^
src/mock/mock_Stocks.py:664:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(10, 20), 2),
^
src/mock/mock_Stocks.py:669:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(4, 7), 2),
^
src/mock/mock_Stocks.py:674:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(5, 8), 2),
^
src/mock/mock_Stocks.py:681:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(35, 60), 2),
^
src/mock/mock_Stocks.py:686:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(20, 50), 2),
^
src/mock/mock_Stocks.py:691:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "price": round(random.uniform(70, 150), 2),
^
src/mock/mock_Stocks.py:715:1: D400 First line should end with a period
    """获取自选股列表

    Returns:
        Dict: 自选股列表
    """
^
src/mock/mock_Stocks.py:724:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(1500, 2000), 2),
^
src/mock/mock_Stocks.py:725:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-5, 5), 2),
^
src/mock/mock_Stocks.py:730:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(200, 500), 2),
^
src/mock/mock_Stocks.py:731:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-5, 5), 2),
^
src/mock/mock_Stocks.py:736:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(50, 100), 2),
^
src/mock/mock_Stocks.py:737:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-5, 5), 2),
^
src/mock/mock_Stocks.py:742:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "price": round(random.uniform(130, 250), 2),
^
src/mock/mock_Stocks.py:743:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            "change": round(random.uniform(-5, 5), 2),
^
src/mock/mock_Stocks.py:755:1: D400 First line should end with a period
    """添加到自选股

    Args:
        params: Dict - 请求参数：
                stock_code: str - 股票代码
                notes: str - 备注（可选）

    Returns:
        Dict: 添加结果
    """
^
src/mock/mock_Stocks.py:778:1: D400 First line should end with a period
    """从自选股移除

    Args:
        params: Dict - 查询参数：
                stock_code: str - 股票代码

    Returns:
        Dict: 移除结果
    """
^
src/mock/mock_Stocks.py:800:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Stocks.py:809:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Stocks.py:815:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Stocks.py:820:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_Stocks.py:827:11: F541 f-string is missing placeholders
    print(f"get_stock_list() 调用测试:")
          ^
src/mock/mock_Stocks.py:831:11: F541 f-string is missing placeholders
    print(f"\nget_stock_detail() 调用测试:")
          ^
src/mock/mock_Stocks.py:835:11: F541 f-string is missing placeholders
    print(f"\nget_stock_indicators() 调用测试:")
          ^
src/mock/mock_StrategyManagement.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: StrategyManagement
提供接口:
1. get_strategy_definitions() -> Dict - 获取策略定义列表（对应/api/strategy/definitions）
2. run_strategy_single() -> Dict - 单策略运行（对应/api/strategy/run/single）
3. run_strategy_batch() -> Dict - 批量策略运行（对应/api/strategy/run/batch）
4. get_strategy_results() -> Dict - 获取策略结果（对应/api/strategy/results）
5. get_matched_stocks() -> Dict - 获取匹配的股票（对应/api/strategy/matched-stocks）
6. get_strategy_stats() -> Dict - 获取策略统计（对应/api/strategy/stats/summary）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_StrategyManagement.py:1:1: D400 First line should end with a period
"""
Mock数据文件: StrategyManagement
提供接口:
1. get_strategy_definitions() -> Dict - 获取策略定义列表（对应/api/strategy/definitions）
2. run_strategy_single() -> Dict - 单策略运行（对应/api/strategy/run/single）
3. run_strategy_batch() -> Dict - 批量策略运行（对应/api/strategy/run/batch）
4. get_strategy_results() -> Dict - 获取策略结果（对应/api/strategy/results）
5. get_matched_stocks() -> Dict - 获取匹配的股票（对应/api/strategy/matched-stocks）
6. get_strategy_stats() -> Dict - 获取策略统计（对应/api/strategy/stats/summary）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_StrategyManagement.py:28:1: D400 First line should end with a period
    """获取策略定义列表（对应/api/strategy/definitions）

    Returns:
        Dict: 策略定义列表数据
    """
^
src/mock/mock_StrategyManagement.py:192:1: D400 First line should end with a period
    """单策略运行（对应/api/strategy/run/single）

    Args:
        request: Dict - 请求参数：
                strategy_code: str - 策略代码
                parameters: Dict - 策略参数
                date_range: Dict - 日期范围

    Returns:
        Dict: 策略运行结果
    """
^
src/mock/mock_StrategyManagement.py:207:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    execution_time = random.uniform(2, 8)
^
src/mock/mock_StrategyManagement.py:211:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    stock_count = random.randint(5, 50)
^
src/mock/mock_StrategyManagement.py:228:1: D400 First line should end with a period
    """批量策略运行（对应/api/strategy/run/batch）

    Args:
        request: Dict - 请求参数：
                strategy_codes: List[str] - 策略代码列表
                parameters: Dict - 策略参数
                date_range: Dict - 日期范围

    Returns:
        Dict: 批量策略运行结果
    """
^
src/mock/mock_StrategyManagement.py:240:5: F841 local variable 'parameters' is assigned to but never used
    parameters = request.get("parameters", {})
    ^
src/mock/mock_StrategyManagement.py:243:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    execution_time = random.uniform(5, 20)
^
src/mock/mock_StrategyManagement.py:251:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        stock_count = random.randint(3, 30)
^
src/mock/mock_StrategyManagement.py:273:1: D400 First line should end with a period
    """获取策略结果（对应/api/strategy/results）

    Args:
        request: Dict - 请求参数：
                strategy_code: str - 策略代码
                limit: int - 限制数量
                offset: int - 偏移量

    Returns:
        Dict: 策略结果数据
    """
^
src/mock/mock_StrategyManagement.py:289:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    stock_count = random.randint(20, 100)
^
src/mock/mock_StrategyManagement.py:293:39: E203 whitespace before ':'
    paginated_results = results[offset : offset + limit]
                                      ^
src/mock/mock_StrategyManagement.py:307:1: D400 First line should end with a period
    """获取匹配的股票（对应/api/strategy/matched-stocks）

    Args:
        request: Dict - 请求参数：
                strategy_code: str - 策略代码
                filters: Dict - 筛选条件

    Returns:
        Dict: 匹配股票数据
    """
^
src/mock/mock_StrategyManagement.py:320:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    stock_count = random.randint(10, 80)
^
src/mock/mock_StrategyManagement.py:334:1: D400 First line should end with a period
    """获取策略统计（对应/api/strategy/stats/summary）

    Returns:
        Dict: 策略统计数据
    """
^
src/mock/mock_StrategyManagement.py:343:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "total_runs": random.randint(100, 500),
^
src/mock/mock_StrategyManagement.py:344:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "today_runs": random.randint(5, 20),
^
src/mock/mock_StrategyManagement.py:345:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "total_matches": random.randint(1000, 5000),
^
src/mock/mock_StrategyManagement.py:346:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "avg_run_time": round(random.uniform(2, 10), 2),
^
src/mock/mock_StrategyManagement.py:347:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "success_rate": round(random.uniform(0.85, 0.95), 2),
^
src/mock/mock_StrategyManagement.py:352:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "run_count": random.randint(20, 50),
^
src/mock/mock_StrategyManagement.py:353:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "avg_matches": random.randint(8, 25),
^
src/mock/mock_StrategyManagement.py:354:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "success_rate": round(random.uniform(0.80, 0.90), 2),
^
src/mock/mock_StrategyManagement.py:359:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "run_count": random.randint(15, 40),
^
src/mock/mock_StrategyManagement.py:360:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "avg_matches": random.randint(12, 35),
^
src/mock/mock_StrategyManagement.py:361:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "success_rate": round(random.uniform(0.85, 0.95), 2),
^
src/mock/mock_StrategyManagement.py:366:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "run_count": random.randint(25, 60),
^
src/mock/mock_StrategyManagement.py:367:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "avg_matches": random.randint(5, 20),
^
src/mock/mock_StrategyManagement.py:368:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "success_rate": round(random.uniform(0.75, 0.85), 2),
^
src/mock/mock_StrategyManagement.py:377:1: D400 First line should end with a period
    """生成匹配股票数据

    Args:
        count: int - 股票数量

    Returns:
        List[Dict]: 股票数据列表
    """
^
src/mock/mock_StrategyManagement.py:421:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_price = random.uniform(10, 500)
^
src/mock/mock_StrategyManagement.py:422:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        change_pct = random.uniform(-8, 12)
^
src/mock/mock_StrategyManagement.py:434:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "成交量": f"{random.randint(100, 5000)}万手",
^
src/mock/mock_StrategyManagement.py:435:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "成交额": f"{random.randint(1, 50)}亿元",
^
src/mock/mock_StrategyManagement.py:436:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "换手率": f"{random.uniform(1, 15):.2f}%",
^
src/mock/mock_StrategyManagement.py:438:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "策略得分": round(random.uniform(60, 95), 1),
^
src/mock/mock_StrategyManagement.py:449:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_StrategyManagement.py:458:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_StrategyManagement.py:464:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_StrategyManagement.py:469:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_StrategyManagement.py:476:11: F541 f-string is missing placeholders
    print(f"get_data_list() 调用测试:")
          ^
src/mock/mock_StrategyManagement.py:477:15: F821 undefined name 'get_data_list'
    result1 = get_data_list()
              ^
src/mock/mock_StrategyManagement.py:480:11: F541 f-string is missing placeholders
    print(f"\nget_data_detail() 调用测试:")
          ^
src/mock/mock_StrategyManagement.py:481:15: F821 undefined name 'get_data_detail'
    result2 = get_data_detail()
              ^
src/mock/mock_StrategyManagement.py:484:11: F541 f-string is missing placeholders
    print(f"\nget_data_table() 调用测试:")
          ^
src/mock/mock_StrategyManagement.py:485:15: F821 undefined name 'get_data_table'
    result3 = get_data_table()
              ^
src/mock/mock_TaskManagement.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: TaskManagement
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TaskManagement.py:1:1: D400 First line should end with a period
"""
Mock数据文件: TaskManagement
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TaskManagement.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_TaskManagement.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_TaskManagement.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_TaskManagement.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_TaskManagement.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_TaskManagement.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_TaskManagement.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_TaskManagement.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_TdxMarket.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: TdxMarket
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TdxMarket.py:1:1: D400 First line should end with a period
"""
Mock数据文件: TdxMarket
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TdxMarket.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_TdxMarket.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_TdxMarket.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_TdxMarket.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_TdxMarket.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_TdxMarket.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_TdxMarket.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_TdxMarket.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_TechnicalAnalysis.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: TechnicalAnalysis
提供接口:
1. calculate_indicators() -> Dict - 计算技术指标（对应/indicators/calculate API）
2. get_stock_kline() -> List[Dict] - 获取股票K线数据
3. get_technical_indicators() -> Dict - 获取技术指标数据
4. get_signal_analysis() -> pd.DataFrame - 获取买卖信号分析

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TechnicalAnalysis.py:1:1: D400 First line should end with a period
"""
Mock数据文件: TechnicalAnalysis
提供接口:
1. calculate_indicators() -> Dict - 计算技术指标（对应/indicators/calculate API）
2. get_stock_kline() -> List[Dict] - 获取股票K线数据
3. get_technical_indicators() -> Dict - 获取技术指标数据
4. get_signal_analysis() -> pd.DataFrame - 获取买卖信号分析

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TechnicalAnalysis.py:26:1: D400 First line should end with a period
    """获取技术指标数据 - 别名函数，与get_all_indicators相同

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 技术指标数据，包含趋势、动量、波动率、成交量等指标
    """
^
src/mock/mock_TechnicalAnalysis.py:38:1: D400 First line should end with a period
    """获取所有技术指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 所有技术指标数据，包含趋势、动量、波动率、成交量等指标
    """
^
src/mock/mock_TechnicalAnalysis.py:84:1: D400 First line should end with a period
    """获取趋势指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 趋势指标数据
    """
^
src/mock/mock_TechnicalAnalysis.py:121:1: D400 First line should end with a period
    """获取动量指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 动量指标数据
    """
^
src/mock/mock_TechnicalAnalysis.py:147:1: D400 First line should end with a period
    """获取波动率指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 波动率指标数据
    """
^
src/mock/mock_TechnicalAnalysis.py:176:1: D400 First line should end with a period
    """获取成交量指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 成交量指标数据
    """
^
src/mock/mock_TechnicalAnalysis.py:200:1: D400 First line should end with a period
    """获取交易信号

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 交易信号数据
    """
^
src/mock/mock_TechnicalAnalysis.py:238:1: D400 First line should end with a period
    """获取K线历史数据

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: K线历史数据
    """
^
src/mock/mock_TechnicalAnalysis.py:252:80: E501 line too long (81 > 79 characters)
            (datetime.datetime.now() - datetime.timedelta(days=29 - i)).strftime(
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:276:1: D400 First line should end with a period
    """获取形态识别结果

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 形态识别结果
    """
^
src/mock/mock_TechnicalAnalysis.py:301:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "pattern_name": random.choice(patterns),
^
src/mock/mock_TechnicalAnalysis.py:302:80: E501 line too long (80 > 79 characters)
                "confidence": round(0.7 + (hash(stock_code + str(i)) % 0.3), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:303:80: E501 line too long (81 > 79 characters)
                "target_price": round(105 + (hash(stock_code + str(i)) % 20), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:319:1: D400 First line should end with a period
    """计算技术指标 - 兼容测试接口

    Args:
        request: Dict - 计算请求参数
            symbol: str - 股票代码
            start_date: str - 开始日期
            end_date: str - 结束日期
            indicators: List[str] - 指标列表

    Returns:
        Dict: 技术指标数据
    """
^
src/mock/mock_TechnicalAnalysis.py:354:80: E501 line too long (95 > 79 characters)
                    "open": round(base_price + (hash(symbol + str(current_date.day)) % 10), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:355:80: E501 line too long (98 > 79 characters)
                    "high": round(base_price + 5 + (hash(symbol + str(current_date.day)) % 5), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:356:80: E501 line too long (97 > 79 characters)
                    "low": round(base_price - 5 + (hash(symbol + str(current_date.day)) % 5), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:357:80: E501 line too long (95 > 79 characters)
                    "close": round(base_price + (hash(symbol + str(current_date.day)) % 8), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:358:80: E501 line too long (94 > 79 characters)
                    "volume": int(1000000 + (hash(symbol + str(current_date.day)) % 9000000)),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:373:80: E501 line too long (80 > 79 characters)
                    "open": round(base_price + (hash(symbol + str(i)) % 10), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:374:80: E501 line too long (83 > 79 characters)
                    "high": round(base_price + 5 + (hash(symbol + str(i)) % 5), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:375:80: E501 line too long (82 > 79 characters)
                    "low": round(base_price - 5 + (hash(symbol + str(i)) % 5), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:376:80: E501 line too long (80 > 79 characters)
                    "close": round(base_price + (hash(symbol + str(i)) % 8), 2),
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:383:80: E501 line too long (97 > 79 characters)
            dates.append((datetime.datetime.now() - timedelta(days=29 - i)).strftime("%Y-%m-%d"))
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:407:80: E501 line too long (102 > 79 characters)
                calculated_indicators["ma5"] = ma5_values[-5:] if len(ma5_values) >= 5 else ma5_values
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:414:80: E501 line too long (106 > 79 characters)
                calculated_indicators["ma10"] = ma10_values[-5:] if len(ma10_values) >= 5 else ma10_values
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:421:80: E501 line too long (106 > 79 characters)
                calculated_indicators["ma20"] = ma20_values[-5:] if len(ma20_values) >= 5 else ma20_values
                                                                               ^
src/mock/mock_TechnicalAnalysis.py:464:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_TechnicalAnalysis.py:473:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_TechnicalAnalysis.py:479:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_TechnicalAnalysis.py:484:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_TechnicalAnalysis.py:491:11: F541 f-string is missing placeholders
    print(f"get_all_indicators() 调用测试:")
          ^
src/mock/mock_TechnicalAnalysis.py:495:11: F541 f-string is missing placeholders
    print(f"\nget_trend_indicators() 调用测试:")
          ^
src/mock/mock_TechnicalAnalysis.py:499:11: F541 f-string is missing placeholders
    print(f"\nget_momentum_indicators() 调用测试:")
          ^
src/mock/mock_TradeManagement.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: TradeManagement
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TradeManagement.py:1:1: D400 First line should end with a period
"""
Mock数据文件: TradeManagement
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TradeManagement.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_TradeManagement.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_TradeManagement.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_TradeManagement.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_TradeManagement.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_TradeManagement.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_TradeManagement.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_TradeManagement.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_TradingView.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: TradingView
提供接口:
1. get_chart_config() -> Dict - 获取TradingView图表配置
2. get_mini_chart_config() -> Dict - 获取迷你图表配置
3. get_ticker_tape_config() -> Dict - 获取滚动行情配置
4. get_market_overview_config() -> Dict - 获取市场概览配置
5. get_screener_config() -> Dict - 获取股票筛选器配置
6. convert_symbol() -> Dict - 转换股票代码格式

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TradingView.py:1:1: D400 First line should end with a period
"""
Mock数据文件: TradingView
提供接口:
1. get_chart_config() -> Dict - 获取TradingView图表配置
2. get_mini_chart_config() -> Dict - 获取迷你图表配置
3. get_ticker_tape_config() -> Dict - 获取滚动行情配置
4. get_market_overview_config() -> Dict - 获取市场概览配置
5. get_screener_config() -> Dict - 获取股票筛选器配置
6. convert_symbol() -> Dict - 转换股票代码格式

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_TradingView.py:32:1: D400 First line should end with a period
    """获取TradingView图表配置

    Args:
        symbol: str - 股票代码
        market: str - 市场类型: CN, US, HK
        interval: str - 时间间隔: 1, 5, 15, 60, D, W, M
        theme: str - 主题: light, dark
        locale: str - 语言: zh_CN, en
        container_id: str - 容器ID

    Returns:
        Dict: TradingView图表配置，包含：
             - symbol: TradingView格式的股票代码
             - interval: 时间间隔
             - container: 容器配置
             - overrides: 样式覆盖
             - studies: 研究指标
    """
^
src/mock/mock_TradingView.py:74:80: E501 line too long (86 > 79 characters)
            "paneProperties.background": "#ffffff" if theme == "light" else "#131722",
                                                                               ^
src/mock/mock_TradingView.py:82:80: E501 line too long (80 > 79 characters)
            "scalesProperties.textColor": "#AAA" if theme == "dark" else "#666",
                                                                               ^
src/mock/mock_TradingView.py:96:1: D400 First line should end with a period
    """获取TradingView迷你图表配置

    Args:
        symbol: str - 股票代码
        market: str - 市场类型
        theme: str - 主题
        locale: str - 语言
        container_id: str - 容器ID

    Returns:
        Dict: 迷你图表配置
    """
^
src/mock/mock_TradingView.py:140:1: D400 First line should end with a period
    """获取滚动行情配置

    Args:
        symbols: Optional[List[Dict]] - 股票列表 [{"proName": "NASDAQ:AAPL", "title": "Apple"}]
        theme: str - 主题
        locale: str - 语言
        container_id: str - 容器ID

    Returns:
        Dict: 滚动行情配置
    """
^
src/mock/mock_TradingView.py:143:80: E501 line too long (91 > 79 characters)
    """获取滚动行情配置

    Args:
        symbols: Optional[List[Dict]] - 股票列表 [{"proName": "NASDAQ:AAPL", "title": "Apple"}]
        theme: str - 主题
        locale: str - 语言
        container_id: str - 容器ID

    Returns:
        Dict: 滚动行情配置
    """



                                                    ^
src/mock/mock_TradingView.py:184:1: D400 First line should end with a period
    """获取市场概览配置

    Args:
        market: str - 市场类型: china, us, crypto
        theme: str - 主题
        locale: str - 语言
        container_id: str - 容器ID

    Returns:
        Dict: 市场概览配置
    """
^
src/mock/mock_TradingView.py:260:1: D400 First line should end with a period
    """获取股票筛选器配置

    Args:
        market: str - 市场类型: china, america, crypto
        theme: str - 主题
        locale: str - 语言
        container_id: str - 容器ID

    Returns:
        Dict: 股票筛选器配置
    """
^
src/mock/mock_TradingView.py:303:80: E501 line too long (86 > 79 characters)
            {"left": "market_cap", "operation": "greater", "right": 1000000000}  # 10亿
                                                                               ^
src/mock/mock_TradingView.py:327:1: D400 First line should end with a period
    """转换股票代码格式

    Args:
        symbol: str - 股票代码
        market: str - 市场类型

    Returns:
        Dict: 转换后的代码信息
    """
^
src/mock/mock_TradingView.py:379:80: E501 line too long (84 > 79 characters)
def get_symbol_list_by_market(market: str = "china", limit: int = 10) -> List[Dict]:
                                                                               ^
src/mock/mock_TradingView.py:380:1: D400 First line should end with a period
    """根据市场获取股票列表

    Args:
        market: str - 市场类型
        limit: int - 返回数量限制

    Returns:
        List[Dict]: 股票列表
    """
^
src/mock/mock_TradingView.py:405:80: E501 line too long (86 > 79 characters)
            {"symbol": "MSFT", "name": "Microsoft Corporation", "exchange": "NASDAQ"},
                                                                               ^
src/mock/mock_TradingView.py:408:80: E501 line too long (81 > 79 characters)
            {"symbol": "AMZN", "name": "Amazon.com, Inc.", "exchange": "NASDAQ"},
                                                                               ^
src/mock/mock_TradingView.py:409:80: E501 line too long (85 > 79 characters)
            {"symbol": "META", "name": "Meta Platforms, Inc.", "exchange": "NASDAQ"},
                                                                               ^
src/mock/mock_TradingView.py:410:80: E501 line too long (83 > 79 characters)
            {"symbol": "NVDA", "name": "NVIDIA Corporation", "exchange": "NASDAQ"},
                                                                               ^
src/mock/mock_TradingView.py:411:80: E501 line too long (82 > 79 characters)
            {"symbol": "JPM", "name": "JPMorgan Chase & Co.", "exchange": "NYSE"},
                                                                               ^
src/mock/mock_TradingView.py:433:1: D400 First line should end with a period
    """获取图表研究指标

    Args:
        theme: str - 主题

    Returns:
        Dict: 研究指标配置
    """
^
src/mock/mock_TradingView.py:471:80: E501 line too long (80 > 79 characters)
            "scaleProperties.fontFamily": "Segoe UI, Roboto, Arial, sans-serif",
                                                                               ^
src/mock/mock_TradingView.py:473:80: E501 line too long (86 > 79 characters)
            "scaleProperties.lineColor": "#E6E9EF" if theme == "light" else "#2A2E39",
                                                                               ^
src/mock/mock_TradingView.py:480:80: E501 line too long (82 > 79 characters)
            "backgroundBottomColor": "#ffffff" if theme == "light" else "#131722",
                                                                               ^
src/mock/mock_TradingView.py:481:80: E501 line too long (80 > 79 characters)
            "backgroundLeftColor": "#ffffff" if theme == "light" else "#131722",
                                                                               ^
src/mock/mock_TradingView.py:482:80: E501 line too long (81 > 79 characters)
            "backgroundRightColor": "#ffffff" if theme == "light" else "#131722",
                                                                               ^
src/mock/mock_TradingView.py:483:80: E501 line too long (80 > 79 characters)
            "backgroundAllColors": "#ffffff" if theme == "light" else "#131722",
                                                                               ^
src/mock/mock_TradingView.py:487:80: E501 line too long (87 > 79 characters)
            "backgroundGradientEndColor": "#ffffff" if theme == "light" else "#131722",
                                                                               ^
src/mock/mock_TradingView.py:540:80: E501 line too long (89 > 79 characters)
        f"   代码转换结果: {converted['original_symbol']} -> {converted['tradingview_symbol']}"
                                                                               ^
src/mock/mock_Wencai.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: Wencai
提供接口:
1. get_wencai_queries() -> Dict - 获取预定义查询列表（对应/api/market/wencai/queries）
2. execute_query() -> Dict - 执行预定义查询（对应/api/market/wencai/query）
3. execute_custom_query() -> Dict - 执行自定义查询（对应/api/market/wencai/custom-query）
4. get_query_results() -> Dict - 获取查询结果（对应/api/market/wencai/results/{queryName}）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Wencai.py:1:1: D400 First line should end with a period
"""
Mock数据文件: Wencai
提供接口:
1. get_wencai_queries() -> Dict - 获取预定义查询列表（对应/api/market/wencai/queries）
2. execute_query() -> Dict - 执行预定义查询（对应/api/market/wencai/query）
3. execute_custom_query() -> Dict - 执行自定义查询（对应/api/market/wencai/custom-query）
4. get_query_results() -> Dict - 获取查询结果（对应/api/market/wencai/results/{queryName}）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_Wencai.py:7:80: E501 line too long (81 > 79 characters)
"""
Mock数据文件: Wencai
提供接口:
1. get_wencai_queries() -> Dict - 获取预定义查询列表（对应/api/market/wencai/queries）
2. execute_query() -> Dict - 执行预定义查询（对应/api/market/wencai/query）
3. execute_custom_query() -> Dict - 执行自定义查询（对应/api/market/wencai/custom-query）
4. get_query_results() -> Dict - 获取查询结果（对应/api/market/wencai/results/{queryName}）

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""



                                                    ^
src/mock/mock_Wencai.py:26:1: D400 First line should end with a period
    """获取预定义查询列表（对应/api/market/wencai/queries）

    Returns:
        Dict: 包含queries字段的字典，queries是查询列表数组
    """
^
src/mock/mock_Wencai.py:124:1: D400 First line should end with a period
    """执行预定义查询（对应/api/market/wencai/query）

    Args:
        request: Dict - 请求参数：
                query_name: str - 查询名称
                pages: int - 页数

    Returns:
        Dict: 执行结果，包含total_records等字段
    """
^
src/mock/mock_Wencai.py:138:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    time.sleep(random.uniform(0.5, 2.0))
^
src/mock/mock_Wencai.py:142:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_1": random.randint(50, 150),  # 涨停股票
^
src/mock/mock_Wencai.py:143:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_2": random.randint(100, 300),  # 涨幅超过5%
^
src/mock/mock_Wencai.py:144:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_3": random.randint(200, 500),  # 成交量放大
^
src/mock/mock_Wencai.py:145:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_4": random.randint(80, 200),  # 技术指标金叉
^
src/mock/mock_Wencai.py:146:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_5": random.randint(150, 400),  # 机构重仓
^
src/mock/mock_Wencai.py:147:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_6": random.randint(60, 180),  # 业绩预增
^
src/mock/mock_Wencai.py:148:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_7": random.randint(30, 100),  # 概念龙头
^
src/mock/mock_Wencai.py:149:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_8": random.randint(300, 800),  # 低估值
^
src/mock/mock_Wencai.py:150:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "qs_9": random.randint(80, 250),  # 创新高
^
src/mock/mock_Wencai.py:153:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    total_records = query_result_counts.get(query_name, random.randint(100, 500))
^
src/mock/mock_Wencai.py:153:80: E501 line too long (81 > 79 characters)
    total_records = query_result_counts.get(query_name, random.randint(100, 500))
                                                                               ^
src/mock/mock_Wencai.py:161:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "execution_time": round(random.uniform(1.0, 3.0), 2),
^
src/mock/mock_Wencai.py:166:1: D400 First line should end with a period
    """执行自定义查询（对应/api/market/wencai/custom-query）

    Args:
        request: Dict - 请求参数：
                query_text: str - 自定义查询文本
                pages: int - 页数

    Returns:
        Dict: 自定义查询结果
    """
^
src/mock/mock_Wencai.py:180:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    time.sleep(random.uniform(1.0, 3.0))
^
src/mock/mock_Wencai.py:183:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    base_count = random.randint(50, 200)
^
src/mock/mock_Wencai.py:186:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_count = random.randint(30, 120)
^
src/mock/mock_Wencai.py:188:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_count = random.randint(100, 400)
^
src/mock/mock_Wencai.py:190:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_count = random.randint(200, 600)
^
src/mock/mock_Wencai.py:192:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        base_count = random.randint(300, 800)
^
src/mock/mock_Wencai.py:204:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        "execution_time": round(random.uniform(1.5, 4.0), 2),
^
src/mock/mock_Wencai.py:208:80: E501 line too long (81 > 79 characters)
def get_query_results(query_name: str, limit: int = 20, offset: int = 0) -> Dict:
                                                                               ^
src/mock/mock_Wencai.py:209:1: D400 First line should end with a period
    """获取查询结果（对应/api/market/wencai/results/{queryName}）

    Args:
        query_name: str - 查询名称
        limit: int - 每页数量，默认20
        offset: int - 偏移量，默认0

    Returns:
        Dict: 查询结果数据
    """
^
src/mock/mock_Wencai.py:254:1: D400 First line should end with a period
    """生成问财筛选结果数据

    Args:
        count: int - 要生成的结果数量

    Returns:
        List[Dict]: 问财结果数据列表
    """
^
src/mock/mock_Wencai.py:299:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            base_price = random.uniform(20, 200)
^
src/mock/mock_Wencai.py:300:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            price_change = random.uniform(-5, 8)
^
src/mock/mock_Wencai.py:302:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            base_price = random.uniform(10, 150)
^
src/mock/mock_Wencai.py:303:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            price_change = random.uniform(-8, 12)
^
src/mock/mock_Wencai.py:305:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            base_price = random.uniform(5, 50)
^
src/mock/mock_Wencai.py:306:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            price_change = random.uniform(-6, 10)
^
src/mock/mock_Wencai.py:308:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            base_price = random.uniform(10, 100)
^
src/mock/mock_Wencai.py:309:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            price_change = random.uniform(-7, 9)
^
src/mock/mock_Wencai.py:320:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "涨停次数": random.randint(0, 5),
^
src/mock/mock_Wencai.py:321:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "量比": round(random.uniform(0.5, 5.0), 2),
^
src/mock/mock_Wencai.py:322:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "换手率": f"{random.uniform(1, 15):.2f}%",
^
src/mock/mock_Wencai.py:323:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "振幅": f"{random.uniform(2, 12):.2f}%",
^
src/mock/mock_Wencai.py:334:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_Wencai.py:343:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_Wencai.py:349:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_Wencai.py:354:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_Wencai.py:361:11: F541 f-string is missing placeholders
    print(f"get_wencai_queries() 调用测试:")
          ^
src/mock/mock_Wencai.py:365:11: F541 f-string is missing placeholders
    print(f"\nget_query_results() 调用测试:")
          ^
src/mock/mock_Wencai.py:369:11: F541 f-string is missing placeholders
    print(f"\nexecute_custom_query() 调用测试:")
          ^
src/mock/mock_strategy_BatchScan.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: strategy_BatchScan
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_BatchScan.py:1:1: D400 First line should end with a period
"""
Mock数据文件: strategy_BatchScan
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_BatchScan.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_strategy_BatchScan.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_strategy_BatchScan.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_strategy_BatchScan.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_strategy_BatchScan.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_strategy_BatchScan.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_strategy_BatchScan.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_strategy_BatchScan.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_strategy_ResultsQuery.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: strategy_ResultsQuery
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_ResultsQuery.py:1:1: D400 First line should end with a period
"""
Mock数据文件: strategy_ResultsQuery
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_ResultsQuery.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_strategy_ResultsQuery.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_strategy_ResultsQuery.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_strategy_ResultsQuery.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_strategy_ResultsQuery.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_strategy_ResultsQuery.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_strategy_ResultsQuery.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_strategy_ResultsQuery.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_strategy_SingleRun.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: strategy_SingleRun
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_SingleRun.py:1:1: D400 First line should end with a period
"""
Mock数据文件: strategy_SingleRun
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_SingleRun.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_strategy_SingleRun.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_strategy_SingleRun.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_strategy_SingleRun.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_strategy_SingleRun.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_strategy_SingleRun.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_strategy_SingleRun.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_strategy_SingleRun.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_strategy_StatsAnalysis.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: strategy_StatsAnalysis
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_StatsAnalysis.py:1:1: D400 First line should end with a period
"""
Mock数据文件: strategy_StatsAnalysis
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_StatsAnalysis.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_strategy_StatsAnalysis.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_strategy_StatsAnalysis.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_strategy_StatsAnalysis.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_strategy_StatsAnalysis.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_strategy_StatsAnalysis.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_strategy_StatsAnalysis.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_strategy_StatsAnalysis.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_strategy_StrategyList.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: strategy_StrategyList
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_StrategyList.py:1:1: D400 First line should end with a period
"""
Mock数据文件: strategy_StrategyList
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_strategy_StrategyList.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_strategy_StrategyList.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_strategy_StrategyList.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_strategy_StrategyList.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_strategy_StrategyList.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_strategy_StrategyList.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_strategy_StrategyList.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_strategy_StrategyList.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_system_Architecture.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: system_Architecture
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_system_Architecture.py:1:1: D400 First line should end with a period
"""
Mock数据文件: system_Architecture
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_system_Architecture.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_system_Architecture.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_system_Architecture.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_system_Architecture.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_system_Architecture.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_system_Architecture.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_system_Architecture.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_system_Architecture.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/mock/mock_system_DatabaseMonitor.py:1:1: D205 1 blank line required between summary line and description
"""
Mock数据文件: system_DatabaseMonitor
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_system_DatabaseMonitor.py:1:1: D400 First line should end with a period
"""
Mock数据文件: system_DatabaseMonitor
提供接口:
1. get_data_list() -> List[Dict] - 获取数据列表
2. get_data_detail() -> Dict - 获取数据详情
3. get_data_table() -> pd.DataFrame - 获取数据表格

使用说明:
- 所有函数参数需与真实API接口完全对齐
- 返回值字段名需与前端表格列字段一致
- 股票价格保留2位小数，百分比保留4位小数
- 时间字段使用datetime类型，格式：YYYY-MM-DD HH:MM:SS

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/mock/mock_system_DatabaseMonitor.py:26:1: D400 First line should end with a period
    """获取数据列表

    Args:


    Returns:
        List[Dict]: 获取数据列表数据列表
    """
^
src/mock/mock_system_DatabaseMonitor.py:41:80: E501 line too long (80 > 79 characters)
            "created_at": datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                                                                               ^
src/mock/mock_system_DatabaseMonitor.py:48:1: D400 First line should end with a period
    """获取数据详情

    Args:


    Returns:
        Dict: 获取数据详情数据
    """
^
src/mock/mock_system_DatabaseMonitor.py:67:1: D400 First line should end with a period
    """获取数据表格

    Args:


    Returns:
        pd.DataFrame: 获取数据表格数据表格，列名对应前端表格字段
    """
^
src/mock/mock_system_DatabaseMonitor.py:88:1: D400 First line should end with a period
    """生成真实感的价格数据

    Args:
        base_price: 基准价格
        volatility: 波动率

    Returns:
        float: 生成的价格（保留2位小数）
    """
^
src/mock/mock_system_DatabaseMonitor.py:97:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    change_rate = random.uniform(-volatility, volatility)
^
src/mock/mock_system_DatabaseMonitor.py:103:1: D400 First line should end with a period
    """生成真实感的成交量数据

    Returns:
        int: 成交量（股）
    """
^
src/mock/mock_system_DatabaseMonitor.py:108:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
    return random.randint(1000000, 100000000)
^
src/monitoring/__init__.py:1:1: D104 Missing docstring in public package
from .monitoring_database import MonitoringDatabase, get_monitoring_database
^
src/monitoring/ai_alert_manager.py:1:1: D400 First line should end with a period
"""
MyStocks AI告警管理器

完整的AI智能告警系统，支持多渠道告警、邮件、Webhook、日志等。
基于智能阈值算法和误报优化。

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0 (完整AI版本)
依赖: 详见requirements.txt或文件导入部分
注意事项: 本文件是MyStocks v3.0核心组件，遵循5-tier数据分类架构
版权: MyStocks Project © 2025
"""
^
src/monitoring/ai_alert_manager.py:37:1: D400 First line should end with a period
    """告警类型"""
^
src/monitoring/ai_alert_manager.py:51:1: D400 First line should end with a period
    """告警严重性"""
^
src/monitoring/ai_alert_manager.py:60:1: D400 First line should end with a period
    """告警规则"""
^
src/monitoring/ai_alert_manager.py:72:1: D400 First line should end with a period
        """转换为字典"""
^
src/monitoring/ai_alert_manager.py:81:1: D400 First line should end with a period
    """告警实例"""
^
src/monitoring/ai_alert_manager.py:97:1: D400 First line should end with a period
        """转换为字典"""
^
src/monitoring/ai_alert_manager.py:105:1: D400 First line should end with a period
    """告警处理器接口"""
^
src/monitoring/ai_alert_manager.py:109:1: D400 First line should end with a period
        """处理告警"""
^
src/monitoring/ai_alert_manager.py:114:1: D400 First line should end with a period
        """测试连接"""
^
src/monitoring/ai_alert_manager.py:120:1: D400 First line should end with a period
    """系统指标"""
^
src/monitoring/ai_alert_manager.py:134:1: D400 First line should end with a period
        """转换为字典"""
^
src/monitoring/ai_alert_manager.py:141:1: D400 First line should end with a period
    """邮件告警处理器"""
^
src/monitoring/ai_alert_manager.py:143:1: D107 Missing docstring in __init__
    def __init__(
^
src/monitoring/ai_alert_manager.py:158:1: D400 First line should end with a period
        """处理告警"""
^
src/monitoring/ai_alert_manager.py:164:80: E501 line too long (84 > 79 characters)
                f"[{alert.severity.value.upper()}] MyStocks AI告警: {alert.rule_name}"
                                                                               ^
src/monitoring/ai_alert_manager.py:176:80: E501 line too long (93 > 79 characters)
            body = f"""
            <html>
            <body>
                <h2>MyStocks AI系统告警</h2>
                <p><strong>告警ID:</strong> {alert.id}</p>
                <p><strong>规则名称:</strong> {alert.rule_name}</p>
                <p><strong>严重性:</strong> {alert.severity.value}</p>
                <p><strong>告警类型:</strong> {alert.alert_type.value}</p>
                <p><strong>发生时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                <p><strong>告警消息:</strong> {alert.message}</p>

                <h3>详细指标:</h3>
                <pre>{json.dumps(alert.metrics, indent=2, ensure_ascii=False)}</pre>

                <p>请及时处理此告警。</p>
                <p><small>此邮件由MyStocks AI监控系统自动发送</small></p>
            </body>
            </html>
            """



                 ^
src/monitoring/ai_alert_manager.py:178:1: W293 blank line contains whitespace
            body = f"""
            <html>
            <body>
                <h2>MyStocks AI系统告警</h2>
                <p><strong>告警ID:</strong> {alert.id}</p>
                <p><strong>规则名称:</strong> {alert.rule_name}</p>
                <p><strong>严重性:</strong> {alert.severity.value}</p>
                <p><strong>告警类型:</strong> {alert.alert_type.value}</p>
                <p><strong>发生时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                <p><strong>告警消息:</strong> {alert.message}</p>

                <h3>详细指标:</h3>
                <pre>{json.dumps(alert.metrics, indent=2, ensure_ascii=False)}</pre>

                <p>请及时处理此告警。</p>
                <p><small>此邮件由MyStocks AI监控系统自动发送</small></p>
            </body>
            </html>
            """
^
src/monitoring/ai_alert_manager.py:180:80: E501 line too long (84 > 79 characters)
            body = f"""
            <html>
            <body>
                <h2>MyStocks AI系统告警</h2>
                <p><strong>告警ID:</strong> {alert.id}</p>
                <p><strong>规则名称:</strong> {alert.rule_name}</p>
                <p><strong>严重性:</strong> {alert.severity.value}</p>
                <p><strong>告警类型:</strong> {alert.alert_type.value}</p>
                <p><strong>发生时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                <p><strong>告警消息:</strong> {alert.message}</p>

                <h3>详细指标:</h3>
                <pre>{json.dumps(alert.metrics, indent=2, ensure_ascii=False)}</pre>

                <p>请及时处理此告警。</p>
                <p><small>此邮件由MyStocks AI监控系统自动发送</small></p>
            </body>
            </html>
            """



                 ^
src/monitoring/ai_alert_manager.py:181:1: W293 blank line contains whitespace
            body = f"""
            <html>
            <body>
                <h2>MyStocks AI系统告警</h2>
                <p><strong>告警ID:</strong> {alert.id}</p>
                <p><strong>规则名称:</strong> {alert.rule_name}</p>
                <p><strong>严重性:</strong> {alert.severity.value}</p>
                <p><strong>告警类型:</strong> {alert.alert_type.value}</p>
                <p><strong>发生时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}</p>
                <p><strong>告警消息:</strong> {alert.message}</p>

                <h3>详细指标:</h3>
                <pre>{json.dumps(alert.metrics, indent=2, ensure_ascii=False)}</pre>

                <p>请及时处理此告警。</p>
                <p><small>此邮件由MyStocks AI监控系统自动发送</small></p>
            </body>
            </html>
            """
^
src/monitoring/ai_alert_manager.py:200:1: D400 First line should end with a period
        """发送邮件"""
^
src/monitoring/ai_alert_manager.py:212:1: D400 First line should end with a period
        """测试连接"""
^
src/monitoring/ai_alert_manager.py:230:1: D400 First line should end with a period
    """Webhook告警处理器"""
^
src/monitoring/ai_alert_manager.py:232:1: D107 Missing docstring in __init__
    def __init__(
^
src/monitoring/ai_alert_manager.py:244:1: D400 First line should end with a period
        """处理告警"""
^
src/monitoring/ai_alert_manager.py:267:80: E501 line too long (80 > 79 characters)
                        logger.error(f"❌ Webhook告警发送失败: HTTP {response.status}")
                                                                               ^
src/monitoring/ai_alert_manager.py:275:1: D400 First line should end with a period
        """测试连接"""
^
src/monitoring/ai_alert_manager.py:298:1: D400 First line should end with a period
    """本地日志告警处理器"""
^
src/monitoring/ai_alert_manager.py:300:1: D107 Missing docstring in __init__
    def __init__(self, log_file: str = "ai_alerts.log"):
^
src/monitoring/ai_alert_manager.py:315:80: E501 line too long (85 > 79 characters)
        if not any(isinstance(h, logging.FileHandler) for h in self.logger.handlers):
                                                                               ^
src/monitoring/ai_alert_manager.py:320:1: D400 First line should end with a period
        """处理告警"""
^
src/monitoring/ai_alert_manager.py:352:1: D400 First line should end with a period
        """测试连接"""
^
src/monitoring/ai_alert_manager.py:362:1: D400 First line should end with a period
    """AI告警管理器 - 完整版本"""
^
src/monitoring/ai_alert_manager.py:365:1: D400 First line should end with a period
        """初始化AI告警管理器"""
^
src/monitoring/ai_alert_manager.py:386:1: D400 First line should end with a period
        """加载默认告警规则"""
^
src/monitoring/ai_alert_manager.py:445:1: D400 First line should end with a period
        """添加告警处理器"""
^
src/monitoring/ai_alert_manager.py:450:1: D400 First line should end with a period
        """添加自定义告警规则"""
^
src/monitoring/ai_alert_manager.py:455:1: D400 First line should end with a period
        """移除告警规则"""
^
src/monitoring/ai_alert_manager.py:456:80: E501 line too long (88 > 79 characters)
        self.alert_rules = [rule for rule in self.alert_rules if rule.name != rule_name]
                                                                               ^
src/monitoring/ai_alert_manager.py:463:1: D400 First line should end with a period
        """检查告警条件"""
^
src/monitoring/ai_alert_manager.py:489:1: D400 First line should end with a period
        """获取指标值"""
^
src/monitoring/ai_alert_manager.py:510:1: D400 First line should end with a period
        """检查阈值"""
^
src/monitoring/ai_alert_manager.py:529:1: D400 First line should end with a period
        """触发告警"""
^
src/monitoring/ai_alert_manager.py:563:1: D400 First line should end with a period
        """解决告警"""
^
src/monitoring/ai_alert_manager.py:575:80: E501 line too long (83 > 79 characters)
    def _generate_alert_message(self, rule: AlertRule, metric_value: float) -> str:
                                                                               ^
src/monitoring/ai_alert_manager.py:576:1: D400 First line should end with a period
        """生成告警消息"""
^
src/monitoring/ai_alert_manager.py:591:1: D400 First line should end with a period
        """序列化指标"""
^
src/monitoring/ai_alert_manager.py:602:1: D400 First line should end with a period
        """保存告警历史"""
^
src/monitoring/ai_alert_manager.py:607:75: E203 whitespace before ':'
            self.alert_history = self.alert_history[-self.max_history_size :]
                                                                          ^
src/monitoring/ai_alert_manager.py:624:1: D400 First line should end with a period
        """更新告警统计"""
^
src/monitoring/ai_alert_manager.py:635:1: D400 First line should end with a period
        """处理告警"""
^
src/monitoring/ai_alert_manager.py:646:1: D400 First line should end with a period
        """获取活跃告警"""
^
src/monitoring/ai_alert_manager.py:649:80: E501 line too long (88 > 79 characters)
    def acknowledge_alert(self, alert_id: str, acknowledged_by: str = "system") -> bool:
                                                                               ^
src/monitoring/ai_alert_manager.py:650:1: D400 First line should end with a period
        """确认告警"""
^
src/monitoring/ai_alert_manager.py:661:1: D400 First line should end with a period
        """获取告警摘要"""
^
src/monitoring/ai_alert_manager.py:670:80: E501 line too long (83 > 79 characters)
            "enabled_rules_count": len([r for r in self.alert_rules if r.enabled]),
                                                                               ^
src/monitoring/ai_alert_manager.py:675:1: D400 First line should end with a period
        """测试所有告警处理器"""
^
src/monitoring/ai_alert_manager.py:688:1: D400 First line should end with a period
        """获取所有告警规则"""
^
src/monitoring/ai_alert_manager.py:691:80: E501 line too long (81 > 79 characters)
    def update_alert_rule(self, rule_name: str, updates: Dict[str, Any]) -> bool:
                                                                               ^
src/monitoring/ai_alert_manager.py:692:1: D400 First line should end with a period
        """更新告警规则"""
^
src/monitoring/ai_alert_manager.py:708:1: D400 First line should end with a period
    """获取全局AI告警管理器实例 (单例模式)"""
^
src/monitoring/ai_alert_manager.py:746:80: E501 line too long (81 > 79 characters)
        ai_strategy_metrics={"win_rate": 0.25, "active_strategies": 3},  # 触发策略告警
                                                                               ^
src/monitoring/ai_alert_manager.py:750:80: E501 line too long (98 > 79 characters)
        f"   创建完成: CPU={metrics.cpu_usage}%, AI胜率={metrics.ai_strategy_metrics['win_rate']:.1%}\n"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:1:1: D400 First line should end with a period
"""
MyStocks AI实时监控器

AI驱动的实时监控系统，负责系统性能、GPU状态、AI策略性能和交易指标的实时监控。
集成智能阈值算法和自适应监控间隔优化。

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0 (完整AI版本)
依赖: 详见requirements.txt或文件导入部分
注意事项: 本文件是MyStocks v3.0核心组件，遵循5-tier数据分类架构
版权: MyStocks Project © 2025
"""
^
src/monitoring/ai_realtime_monitor.py:44:1: D400 First line should end with a period
    """监控配置"""
^
src/monitoring/ai_realtime_monitor.py:55:1: D400 First line should end with a period
        """转换为字典"""
^
src/monitoring/ai_realtime_monitor.py:61:1: D400 First line should end with a period
    """性能阈值配置"""
^
src/monitoring/ai_realtime_monitor.py:76:1: D400 First line should end with a period
        """转换为字典"""
^
src/monitoring/ai_realtime_monitor.py:81:1: D400 First line should end with a period
    """指标收集器接口"""
^
src/monitoring/ai_realtime_monitor.py:85:1: D400 First line should end with a period
        """收集指标"""
^
src/monitoring/ai_realtime_monitor.py:90:1: D400 First line should end with a period
        """检查是否可用"""
^
src/monitoring/ai_realtime_monitor.py:95:1: D400 First line should end with a period
    """系统指标收集器"""
^
src/monitoring/ai_realtime_monitor.py:97:1: D107 Missing docstring in __init__
    def __init__(self, config: MonitoringConfig):
^
src/monitoring/ai_realtime_monitor.py:102:1: D400 First line should end with a period
        """收集系统指标"""
^
src/monitoring/ai_realtime_monitor.py:128:80: E501 line too long (80 > 79 characters)
                        network.bytes_sent - self.previous_network_io.bytes_sent
                                                                               ^
src/monitoring/ai_realtime_monitor.py:132:80: E501 line too long (80 > 79 characters)
                        network.bytes_recv - self.previous_network_io.bytes_recv
                                                                               ^
src/monitoring/ai_realtime_monitor.py:153:1: D400 First line should end with a period
        """检查是否可用"""
^
src/monitoring/ai_realtime_monitor.py:158:1: D400 First line should end with a period
    """GPU指标收集器"""
^
src/monitoring/ai_realtime_monitor.py:160:1: D107 Missing docstring in __init__
    def __init__(self, config: MonitoringConfig):
^
src/monitoring/ai_realtime_monitor.py:165:1: D400 First line should end with a period
        """收集GPU指标"""
^
src/monitoring/ai_realtime_monitor.py:189:1: D400 First line should end with a period
        """检查是否可用"""
^
src/monitoring/ai_realtime_monitor.py:194:1: D400 First line should end with a period
    """AI策略指标收集器"""
^
src/monitoring/ai_realtime_monitor.py:196:1: D107 Missing docstring in __init__
    def __init__(self, config: MonitoringConfig):
^
src/monitoring/ai_realtime_monitor.py:200:1: D400 First line should end with a period
        """收集AI策略指标"""
^
src/monitoring/ai_realtime_monitor.py:216:80: E501 line too long (83 > 79 characters)
                    "ML-Based": {"return": 1.78, "sharpe": 0.79, "drawdown": 2.42},
                                                                               ^
src/monitoring/ai_realtime_monitor.py:217:80: E501 line too long (83 > 79 characters)
                    "Momentum": {"return": 1.14, "sharpe": 0.60, "drawdown": 1.73},
                                                                               ^
src/monitoring/ai_realtime_monitor.py:232:1: D400 First line should end with a period
        """检查是否可用"""
^
src/monitoring/ai_realtime_monitor.py:237:1: D400 First line should end with a period
    """交易指标收集器"""
^
src/monitoring/ai_realtime_monitor.py:239:1: D107 Missing docstring in __init__
    def __init__(self, config: MonitoringConfig):
^
src/monitoring/ai_realtime_monitor.py:243:1: D400 First line should end with a period
        """收集交易指标"""
^
src/monitoring/ai_realtime_monitor.py:266:1: D400 First line should end with a period
        """检查是否可用"""
^
src/monitoring/ai_realtime_monitor.py:271:1: D400 First line should end with a period
    """自适应间隔管理器"""
^
src/monitoring/ai_realtime_monitor.py:273:1: D107 Missing docstring in __init__
    def __init__(
^
src/monitoring/ai_realtime_monitor.py:287:1: D400 First line should end with a period
        """根据系统负载计算下一个监控间隔"""
^
src/monitoring/ai_realtime_monitor.py:298:72: E203 whitespace before ':'
                self.load_history = self.load_history[-self.max_history :]
                                                                       ^
src/monitoring/ai_realtime_monitor.py:315:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            jitter = random.uniform(0.9, 1.1)
^
src/monitoring/ai_realtime_monitor.py:318:80: E501 line too long (88 > 79 characters)
            return max(self.min_interval, min(self.current_interval, self.max_interval))
                                                                               ^
src/monitoring/ai_realtime_monitor.py:325:1: D400 First line should end with a period
        """获取当前间隔"""
^
src/monitoring/ai_realtime_monitor.py:330:1: D400 First line should end with a period
    """AI实时监控器"""
^
src/monitoring/ai_realtime_monitor.py:337:1: D400 First line should end with a period
        """初始化AI实时监控器"""
^
src/monitoring/ai_realtime_monitor.py:358:80: E501 line too long (88 > 79 characters)
        self.adaptive_manager = AdaptiveIntervalManager(self.config.monitoring_interval)
                                                                               ^
src/monitoring/ai_realtime_monitor.py:371:80: E501 line too long (93 > 79 characters)
            f"✅ AIRealtimeMonitor initialized (interval: {self.config.monitoring_interval}s)"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:375:1: D400 First line should end with a period
        """启动实时监控"""
^
src/monitoring/ai_realtime_monitor.py:390:80: E501 line too long (87 > 79 characters)
            while self.running and (time.time() - monitoring_start) < duration_seconds:
                                                                               ^
src/monitoring/ai_realtime_monitor.py:404:80: E501 line too long (80 > 79 characters)
                        if cycle_count % self.config.alert_check_frequency == 0:
                                                                               ^
src/monitoring/ai_realtime_monitor.py:424:80: E501 line too long (83 > 79 characters)
                        if self.config.adaptive_intervals and self.current_metrics:
                                                                               ^
src/monitoring/ai_realtime_monitor.py:425:80: E501 line too long (83 > 79 characters)
                            system_metrics = self.current_metrics.get("system", {})
                                                                               ^
src/monitoring/ai_realtime_monitor.py:426:80: E501 line too long (85 > 79 characters)
                            interval = self.adaptive_manager.calculate_next_interval(
                                                                               ^
src/monitoring/ai_realtime_monitor.py:448:1: D400 First line should end with a period
        """停止监控"""
^
src/monitoring/ai_realtime_monitor.py:453:1: D400 First line should end with a period
        """收集所有指标"""
^
src/monitoring/ai_realtime_monitor.py:522:1: D400 First line should end with a period
        """保存指标历史"""
^
src/monitoring/ai_realtime_monitor.py:527:79: E203 whitespace before ':'
            self.metrics_history = self.metrics_history[-self.max_history_size :]
                                                                              ^
src/monitoring/ai_realtime_monitor.py:527:80: E501 line too long (81 > 79 characters)
            self.metrics_history = self.metrics_history[-self.max_history_size :]
                                                                               ^
src/monitoring/ai_realtime_monitor.py:530:1: D400 First line should end with a period
        """检查告警条件"""
^
src/monitoring/ai_realtime_monitor.py:533:80: E501 line too long (85 > 79 characters)
                await self.alert_manager.check_alert_conditions(self.current_metrics)
                                                                               ^
src/monitoring/ai_realtime_monitor.py:538:1: D400 First line should end with a period
        """更新循环统计"""
^
src/monitoring/ai_realtime_monitor.py:551:1: D400 First line should end with a period
        """打印监控状态"""
^
src/monitoring/ai_realtime_monitor.py:560:80: E501 line too long (81 > 79 characters)
            f"循环: {self.stats['successful_cycles']}/{self.stats['total_cycles']}"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:567:1: D400 First line should end with a period
        """打印最终统计"""
^
src/monitoring/ai_realtime_monitor.py:569:9: F841 local variable 'duration' is assigned to but never used
        duration = (
        ^
src/monitoring/ai_realtime_monitor.py:579:80: E501 line too long (90 > 79 characters)
            f"成功率: {stats['successful_cycles']/max(stats['total_cycles'], 1)*100:.1f}% | "
                                                                               ^
src/monitoring/ai_realtime_monitor.py:587:1: D400 First line should end with a period
        """获取指标摘要"""
^
src/monitoring/ai_realtime_monitor.py:600:80: E501 line too long (85 > 79 characters)
                    f"{metrics.gpu_memory_used:.0f}/{metrics.gpu_memory_total:.0f}MB"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:609:80: E501 line too long (80 > 79 characters)
                    f"{metrics.ai_strategy_metrics.get('win_rate', 0)*100:.1f}%"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:614:80: E501 line too long (80 > 79 characters)
                    f"{metrics.trading_metrics.get('daily_return', 0)*100:.2f}%"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:623:80: E501 line too long (113 > 79 characters)
                "success_rate": f"{self.stats['successful_cycles']/max(self.stats['total_cycles'], 1)*100:.1f}%",
                                                                               ^
src/monitoring/ai_realtime_monitor.py:627:80: E501 line too long (100 > 79 characters)
                    f"{(datetime.now() - self.stats['monitoring_start_time']).total_seconds():.0f}s"
                                                                               ^
src/monitoring/ai_realtime_monitor.py:633:80: E501 line too long (86 > 79 characters)
                "monitoring_interval": f"{self.adaptive_manager.get_interval():.1f}s",
                                                                               ^
src/monitoring/ai_realtime_monitor.py:636:80: E501 line too long (84 > 79 characters)
                "ai_strategy_monitoring": self.config.enable_ai_strategy_monitoring,
                                                                               ^
src/monitoring/ai_realtime_monitor.py:643:1: D400 First line should end with a period
        """获取活跃告警"""
^
src/monitoring/ai_realtime_monitor.py:644:80: E501 line too long (84 > 79 characters)
        return [alert.to_dict() for alert in self.alert_manager.get_active_alerts()]
                                                                               ^
src/monitoring/ai_realtime_monitor.py:647:1: D400 First line should end with a period
        """更新配置"""
^
src/monitoring/ai_realtime_monitor.py:655:1: D400 First line should end with a period
        """设置性能阈值"""
^
src/monitoring/ai_realtime_monitor.py:663:1: D400 First line should end with a period
        """运行健康检查"""
^
src/monitoring/ai_realtime_monitor.py:744:1: D400 First line should end with a period
    """获取全局AI实时监控器实例 (单例模式)"""
^
src/monitoring/ai_realtime_monitor.py:771:80: E501 line too long (87 > 79 characters)
        print(f"   {check_name}: {check_result['status']} - {check_result['message']}")
                                                                               ^
src/monitoring/alert_history.py:1:1: D205 1 blank line required between summary line and description
"""
Alert History and Analytics Database Layer
Provides comprehensive alert tracking, analytics, and reporting capabilities
"""
^
src/monitoring/alert_history.py:1:1: D400 First line should end with a period
"""
Alert History and Analytics Database Layer
Provides comprehensive alert tracking, analytics, and reporting capabilities
"""
^
src/monitoring/alert_history.py:17:1: D400 First line should end with a period
    """Alert lifecycle status"""
^
src/monitoring/alert_history.py:28:1: D400 First line should end with a period
    """Individual alert history record"""
^
src/monitoring/alert_history.py:54:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/alert_history.py:64:1: D400 First line should end with a period
    """Manages alert history and analytics"""
^
src/monitoring/alert_history.py:66:1: D107 Missing docstring in __init__
    def __init__(self, db_path: str = "alert_history.db"):
^
src/monitoring/alert_history.py:72:1: D400 First line should end with a period
        """Initialize database schema"""
^
src/monitoring/alert_history.py:221:1: D400 First line should end with a period
        """Save alert history record, return record ID"""
^
src/monitoring/alert_history.py:233:80: E501 line too long (81 > 79 characters)
            """
            INSERT INTO alert_history (
                alert_name, severity, service, category, instance,
                status, summary, description, start_time, end_time,
                duration_seconds, resolution_time_seconds,
                acknowledgment_time_seconds, escalation_level,
                notification_channels, notification_count,
                labels, annotations, root_cause, related_alerts
            ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
        """,


                       ^
src/monitoring/alert_history.py:263:1: D400 First line should end with a period
        """Update alert history record"""
^
src/monitoring/alert_history.py:270:1: S608 Possible SQL injection vector through string-based query construction.
            f"""
            UPDATE alert_history
            SET {set_clause}
            WHERE id = ?
        """,
^
src/monitoring/alert_history.py:284:1: D400 First line should end with a period
        """Mark alert as resolved"""
^
src/monitoring/alert_history.py:296:1: D400 First line should end with a period
        """Record alert acknowledgment"""
^
src/monitoring/alert_history.py:322:1: D400 First line should end with a period
        """Record alert escalation"""
^
src/monitoring/alert_history.py:327:80: E501 line too long (82 > 79 characters)
            "SELECT escalation_level FROM alert_history WHERE id = ?", (alert_id,)
                                                                               ^
src/monitoring/alert_history.py:344:80: E501 line too long (83 > 79 characters)
            alert_id, escalation_level=to_level, status=AlertStatus.ESCALATED.value
                                                                               ^
src/monitoring/alert_history.py:351:1: D400 First line should end with a period
        """Get alert history record by ID"""
^
src/monitoring/alert_history.py:370:1: D400 First line should end with a period
        """Query alerts with filters"""
^
src/monitoring/alert_history.py:408:1: D400 First line should end with a period
        """Get alert statistics for time period"""
^
src/monitoring/alert_history.py:483:80: E501 line too long (80 > 79 characters)
            "average_resolution_time_seconds": resolution_row["avg_resolution"],
                                                                               ^
src/monitoring/alert_history.py:496:1: D400 First line should end with a period
        """Get most impactful alerts"""
^
src/monitoring/alert_history.py:549:1: D400 First line should end with a period
        """Get alert trend data for charting"""
^
src/monitoring/alert_history.py:558:1: S608 Possible SQL injection vector through string-based query construction.
        query = f"""
            SELECT
                {date_format} as time_bucket,
                severity,
                COUNT(*) as count,
                AVG(resolution_time_seconds) as avg_resolution_time
            FROM alert_history
            WHERE start_time >= ?
        """
^
src/monitoring/alert_history.py:581:1: D400 First line should end with a period
        """Get alerts correlated with given alert"""
^
src/monitoring/alert_history.py:609:1: D400 First line should end with a period
        """Record correlation between two alerts"""
^
src/monitoring/alert_history.py:624:80: E501 line too long (80 > 79 characters)
    def get_service_health(self, service: str, days: int = 7) -> Dict[str, Any]:
                                                                               ^
src/monitoring/alert_history.py:625:1: D400 First line should end with a period
        """Get health metrics for a service"""
^
src/monitoring/alert_history.py:632:80: E501 line too long (89 > 79 characters)
        query = """
            SELECT
                COUNT(*) as total_alerts,
                SUM(CASE WHEN severity = 'critical' THEN 1 ELSE 0 END) as critical_count,
                SUM(CASE WHEN severity = 'warning' THEN 1 ELSE 0 END) as warning_count,
                SUM(CASE WHEN severity = 'info' THEN 1 ELSE 0 END) as info_count,
                AVG(resolution_time_seconds) as avg_resolution_time,
                SUM(CASE WHEN status = 'resolved' THEN 1 ELSE 0 END) as resolved_count
            FROM alert_history
            WHERE service = ? AND start_time >= ?
        """


                                        ^
src/monitoring/alert_history.py:633:80: E501 line too long (87 > 79 characters)
        query = """
            SELECT
                COUNT(*) as total_alerts,
                SUM(CASE WHEN severity = 'critical' THEN 1 ELSE 0 END) as critical_count,
                SUM(CASE WHEN severity = 'warning' THEN 1 ELSE 0 END) as warning_count,
                SUM(CASE WHEN severity = 'info' THEN 1 ELSE 0 END) as info_count,
                AVG(resolution_time_seconds) as avg_resolution_time,
                SUM(CASE WHEN status = 'resolved' THEN 1 ELSE 0 END) as resolved_count
            FROM alert_history
            WHERE service = ? AND start_time >= ?
        """


                                        ^
src/monitoring/alert_history.py:634:80: E501 line too long (81 > 79 characters)
        query = """
            SELECT
                COUNT(*) as total_alerts,
                SUM(CASE WHEN severity = 'critical' THEN 1 ELSE 0 END) as critical_count,
                SUM(CASE WHEN severity = 'warning' THEN 1 ELSE 0 END) as warning_count,
                SUM(CASE WHEN severity = 'info' THEN 1 ELSE 0 END) as info_count,
                AVG(resolution_time_seconds) as avg_resolution_time,
                SUM(CASE WHEN status = 'resolved' THEN 1 ELSE 0 END) as resolved_count
            FROM alert_history
            WHERE service = ? AND start_time >= ?
        """


                                        ^
src/monitoring/alert_history.py:636:80: E501 line too long (86 > 79 characters)
        query = """
            SELECT
                COUNT(*) as total_alerts,
                SUM(CASE WHEN severity = 'critical' THEN 1 ELSE 0 END) as critical_count,
                SUM(CASE WHEN severity = 'warning' THEN 1 ELSE 0 END) as warning_count,
                SUM(CASE WHEN severity = 'info' THEN 1 ELSE 0 END) as info_count,
                AVG(resolution_time_seconds) as avg_resolution_time,
                SUM(CASE WHEN status = 'resolved' THEN 1 ELSE 0 END) as resolved_count
            FROM alert_history
            WHERE service = ? AND start_time >= ?
        """


                                        ^
src/monitoring/alert_history.py:680:1: D400 First line should end with a period
        """Delete alert records older than specified days"""
^
src/monitoring/alert_history.py:684:80: E501 line too long (88 > 79 characters)
        cursor.execute("DELETE FROM alert_history WHERE start_time < ?", (cutoff_time,))
                                                                               ^
src/monitoring/alert_history.py:689:80: E501 line too long (84 > 79 characters)
        logger.info(f"Deleted {deleted_count} alert records older than {days} days")
                                                                               ^
src/monitoring/alert_history.py:693:1: D400 First line should end with a period
        """Close database connection"""
^
src/monitoring/alert_history.py:697:1: D105 Missing docstring in magic method
    def __enter__(self):
^
src/monitoring/alert_history.py:700:1: D105 Missing docstring in magic method
    def __exit__(self, exc_type, exc_val, exc_tb):
^
src/monitoring/alert_history.py:709:1: D400 First line should end with a period
    """Get global alert history database instance"""
^
src/monitoring/alert_manager.py:1:1: D400 First line should end with a period
"""
简化告警管理器 (Simplified Alert Manager)

删除复杂的多渠道告警系统 (邮件、Webhook),保留基础Python logging。
告警功能迁移到Grafana内置告警系统。

创建日期: 2025-11-08
版本: 2.0 (简化版)
代码行数: ~50行 (vs 原473行)
"""
^
src/monitoring/alert_manager.py:20:1: D400 First line should end with a period
    """告警级别"""
^
src/monitoring/alert_manager.py:28:1: D400 First line should end with a period
    """告警类型"""
^
src/monitoring/alert_manager.py:37:1: D400 First line should end with a period
    """
    简化告警管理器 - 仅使用Python logging

    复杂的告警功能 (邮件、Webhook、多渠道) 已迁移到Grafana。
    """
^
src/monitoring/alert_manager.py:44:1: D400 First line should end with a period
        """初始化简化告警管理器"""
^
src/monitoring/alert_manager.py:46:80: E501 line too long (80 > 79 characters)
            "✅ AlertManager initialized (logging-only mode, Grafana for alerts)"
                                                                               ^
src/monitoring/alert_manager.py:57:1: D400 First line should end with a period
        """
        发送告警 (记录到日志)

        Args:
            level: 告警级别
            alert_type: 告警类型
            title: 告警标题
            message: 告警消息
            details: 附加详情
        """
^
src/monitoring/alert_manager.py:92:1: D400 First line should end with a period
        """
        发送告警 (兼容旧接口)

        Args:
            alert_level: 告警级别 (WARNING, CRITICAL, INFO)
            alert_type: 告警类型
            alert_title: 告警标题
            alert_message: 告警消息
            source: 告警来源
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            additional_data: 附加数据
        """
^
src/monitoring/alert_manager.py:144:1: D400 First line should end with a period
    """获取告警管理器单例实例"""
^
src/monitoring/alert_notifier.py:1:1: D400 First line should end with a period
"""
Alert Notification System for MyStocks Monitoring

Multi-channel notification support:
- Email (SMTP)
- Slack
- SMS (Twilio)
- Webhooks
- PagerDuty

Features:
- Async notification delivery
- Retry logic with exponential backoff
- Template-based formatting
- Channel preference mapping
- Notification history tracking
"""
^
src/monitoring/alert_notifier.py:37:1: D400 First line should end with a period
    """Supported notification channels"""
^
src/monitoring/alert_notifier.py:48:1: D400 First line should end with a period
    """Alert severity levels"""
^
src/monitoring/alert_notifier.py:57:1: D400 First line should end with a period
    """Configuration for a notification channel"""
^
src/monitoring/alert_notifier.py:66:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/alert_notifier.py:73:1: D400 First line should end with a period
    """Alert data structure"""
^
src/monitoring/alert_notifier.py:89:1: D400 First line should end with a period
    """Result of notification delivery attempt"""
^
src/monitoring/alert_notifier.py:101:1: D400 First line should end with a period
    """Abstract base class for notification providers"""
^
src/monitoring/alert_notifier.py:103:1: D107 Missing docstring in __init__
    def __init__(self, config: NotificationConfig):
^
src/monitoring/alert_notifier.py:111:80: E501 line too long (84 > 79 characters)
        self, recipients: List[str], subject: str, body: str, alert: Alert, **kwargs
                                                                               ^
src/monitoring/alert_notifier.py:113:1: D400 First line should end with a period
        """Send notification via this channel"""
^
src/monitoring/alert_notifier.py:117:80: E501 line too long (84 > 79 characters)
        self, recipients: List[str], subject: str, body: str, alert: Alert, **kwargs
                                                                               ^
src/monitoring/alert_notifier.py:119:1: D400 First line should end with a period
        """Send with automatic retry logic"""
^
src/monitoring/alert_notifier.py:136:80: E501 line too long (83 > 79 characters)
                logger.error(f"Error sending via {self.config.channel.value}: {e}")
                                                                               ^
src/monitoring/alert_notifier.py:151:1: D400 First line should end with a period
    """Email notification via SMTP"""
^
src/monitoring/alert_notifier.py:154:80: E501 line too long (84 > 79 characters)
        self, recipients: List[str], subject: str, body: str, alert: Alert, **kwargs
                                                                               ^
src/monitoring/alert_notifier.py:156:1: D400 First line should end with a period
        """Send email notification"""
^
src/monitoring/alert_notifier.py:186:80: E501 line too long (80 > 79 characters)
            delivery_time = (datetime.now() - start_time).total_seconds() * 1000
                                                                               ^
src/monitoring/alert_notifier.py:207:1: D400 First line should end with a period
        """Format HTML email body"""
^
src/monitoring/alert_notifier.py:218:80: E501 line too long (97 > 79 characters)
        return f"""
        <html>
            <body style="font-family: Arial, sans-serif;">
                <div style="border-left: 5px solid {color}; padding: 10px; background: #f5f5f5;">
                    <h2 style="color: {color}; margin: 0;">
                        [{alert.severity.upper()}] {alert.alertname}
                    </h2>
                    <p><strong>Service:</strong> {alert.service}</p>
                    <p><strong>Category:</strong> {alert.category}</p>
                    <p><strong>Instance:</strong> {alert.instance}</p>
                    <p><strong>Time:</strong> {alert.timestamp}</p>
                    <hr>
                    <p><strong>Summary:</strong></p>
                    <p>{alert.summary}</p>
                    <p><strong>Description:</strong></p>
                    <pre style="background: #f0f0f0; padding: 10px; border-radius: 5px;">
{alert.description}
                    </pre>
                </div>
            </body>
        </html>
        """


                                            ^
src/monitoring/alert_notifier.py:230:80: E501 line too long (89 > 79 characters)
        return f"""
        <html>
            <body style="font-family: Arial, sans-serif;">
                <div style="border-left: 5px solid {color}; padding: 10px; background: #f5f5f5;">
                    <h2 style="color: {color}; margin: 0;">
                        [{alert.severity.upper()}] {alert.alertname}
                    </h2>
                    <p><strong>Service:</strong> {alert.service}</p>
                    <p><strong>Category:</strong> {alert.category}</p>
                    <p><strong>Instance:</strong> {alert.instance}</p>
                    <p><strong>Time:</strong> {alert.timestamp}</p>
                    <hr>
                    <p><strong>Summary:</strong></p>
                    <p>{alert.summary}</p>
                    <p><strong>Description:</strong></p>
                    <pre style="background: #f0f0f0; padding: 10px; border-radius: 5px;">
{alert.description}
                    </pre>
                </div>
            </body>
        </html>
        """


                                            ^
src/monitoring/alert_notifier.py:240:1: D400 First line should end with a period
    """Slack notification via Webhooks"""
^
src/monitoring/alert_notifier.py:243:80: E501 line too long (84 > 79 characters)
        self, recipients: List[str], subject: str, body: str, alert: Alert, **kwargs
                                                                               ^
src/monitoring/alert_notifier.py:245:1: D400 First line should end with a period
        """Send Slack notification"""
^
src/monitoring/alert_notifier.py:249:80: E501 line too long (82 > 79 characters)
            webhook_urls = recipients  # Slack channels are passed as webhook URLs
                                                                               ^
src/monitoring/alert_notifier.py:251:80: E501 line too long (83 > 79 characters)
                webhook_urls[0] if webhook_urls else os.getenv("SLACK_WEBHOOK_URL")
                                                                               ^
src/monitoring/alert_notifier.py:271:80: E501 line too long (88 > 79 characters)
                            {"title": "Service", "value": alert.service, "short": True},
                                                                               ^
src/monitoring/alert_notifier.py:292:80: E501 line too long (87 > 79 characters)
                            {"title": "Time", "value": alert.timestamp, "short": True},
                                                                               ^
src/monitoring/alert_notifier.py:312:80: E501 line too long (80 > 79 characters)
                            f"✅ Slack notification sent ({delivery_time:.0f}ms)"
                                                                               ^
src/monitoring/alert_notifier.py:323:80: E501 line too long (80 > 79 characters)
                        raise Exception(f"Slack API returned {response.status}")
                                                                               ^
src/monitoring/alert_notifier.py:330:1: D400 First line should end with a period
        """Get Slack color for severity level"""
^
src/monitoring/alert_notifier.py:340:1: D400 First line should end with a period
    """SMS notification via Twilio"""
^
src/monitoring/alert_notifier.py:343:80: E501 line too long (84 > 79 characters)
        self, recipients: List[str], subject: str, body: str, alert: Alert, **kwargs
                                                                               ^
src/monitoring/alert_notifier.py:345:1: D400 First line should end with a period
        """Send SMS notification"""
^
src/monitoring/alert_notifier.py:367:80: E501 line too long (99 > 79 characters)
                    url = f"https://api.twilio.com/2010-04-01/Accounts/{account_sid}/Messages.json"
                                                                               ^
src/monitoring/alert_notifier.py:370:80: E501 line too long (86 > 79 characters)
                    data = {"From": from_number, "To": phone_number, "Body": sms_body}
                                                                               ^
src/monitoring/alert_notifier.py:382:80: E501 line too long (90 > 79 characters)
                                f"Failed to send SMS to {phone_number}: {response.status}"
                                                                               ^
src/monitoring/alert_notifier.py:385:80: E501 line too long (80 > 79 characters)
            delivery_time = (datetime.now() - start_time).total_seconds() * 1000
                                                                               ^
src/monitoring/alert_notifier.py:397:80: E501 line too long (82 > 79 characters)
                    message=f"SMS sent to {sent_count}/{len(recipients)} numbers",
                                                                               ^
src/monitoring/alert_notifier.py:409:1: D400 First line should end with a period
    """Generic webhook notification"""
^
src/monitoring/alert_notifier.py:412:80: E501 line too long (84 > 79 characters)
        self, recipients: List[str], subject: str, body: str, alert: Alert, **kwargs
                                                                               ^
src/monitoring/alert_notifier.py:414:1: D400 First line should end with a period
        """Send webhook notification"""
^
src/monitoring/alert_notifier.py:443:80: E501 line too long (80 > 79 characters)
                                    f"Webhook returned {response.status}: {url}"
                                                                               ^
src/monitoring/alert_notifier.py:448:80: E501 line too long (80 > 79 characters)
            delivery_time = (datetime.now() - start_time).total_seconds() * 1000
                                                                               ^
src/monitoring/alert_notifier.py:452:80: E501 line too long (84 > 79 characters)
                    f"✅ Webhook sent to {sent_count}/{len(webhook_urls)} endpoints "
                                                                               ^
src/monitoring/alert_notifier.py:460:80: E501 line too long (95 > 79 characters)
                    message=f"Webhook delivered to {sent_count}/{len(webhook_urls)} endpoints",
                                                                               ^
src/monitoring/alert_notifier.py:472:1: D205 1 blank line required between summary line and description
    """
    Central notification manager for MyStocks alerts
    Coordinates multi-channel delivery with retry logic
    """
^
src/monitoring/alert_notifier.py:472:1: D400 First line should end with a period
    """
    Central notification manager for MyStocks alerts
    Coordinates multi-channel delivery with retry logic
    """
^
src/monitoring/alert_notifier.py:477:1: D107 Missing docstring in __init__
    def __init__(self, config_file: Optional[str] = None):
^
src/monitoring/alert_notifier.py:485:1: D400 First line should end with a period
        """Load severity/category to channel mapping"""
^
src/monitoring/alert_notifier.py:492:80: E501 line too long (85 > 79 characters)
            "critical_other": [NotificationChannel.SLACK, NotificationChannel.EMAIL],
                                                                               ^
src/monitoring/alert_notifier.py:498:1: D400 First line should end with a period
        """Initialize notification history database"""
^
src/monitoring/alert_notifier.py:522:1: D400 First line should end with a period
        """Initialize notification providers"""
^
src/monitoring/alert_notifier.py:551:80: E501 line too long (82 > 79 characters)
        self.providers[NotificationChannel.WEBHOOK] = WebhookNotificationProvider(
                                                                               ^
src/monitoring/alert_notifier.py:553:80: E501 line too long (80 > 79 characters)
                channel=NotificationChannel.WEBHOOK, enabled=True, retry_count=2
                                                                               ^
src/monitoring/alert_notifier.py:557:80: E501 line too long (82 > 79 characters)
        logger.info(f"✅ Initialized {len(self.providers)} notification providers")
                                                                               ^
src/monitoring/alert_notifier.py:560:80: E501 line too long (80 > 79 characters)
        self, alert: Alert, recipients_map: Dict[NotificationChannel, List[str]]
                                                                               ^
src/monitoring/alert_notifier.py:562:1: D200 One-line docstring should fit on one line with quotes
        """
        Send alert via multiple channels to specified recipients
        """
^
src/monitoring/alert_notifier.py:562:1: D400 First line should end with a period
        """
        Send alert via multiple channels to specified recipients
        """
^
src/monitoring/alert_notifier.py:606:1: D400 First line should end with a period
        """Send critical alert to on-call engineer"""
^
src/monitoring/alert_notifier.py:620:1: D400 First line should end with a period
        """Generate dashboard URL for alert context"""
^
src/monitoring/alert_notifier.py:628:80: E501 line too long (83 > 79 characters)
    def _save_notification_history(self, alert: Alert, result: NotificationResult):
                                                                               ^
src/monitoring/alert_notifier.py:629:1: D400 First line should end with a period
        """Save notification delivery record"""
^
src/monitoring/alert_notifier.py:637:80: E501 line too long (109 > 79 characters)
                """
                INSERT INTO notification_history
                (alert_name, channel, recipients, success, timestamp, delivery_time_ms, message, retry_count)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?)
            """,


          ^
src/monitoring/alert_notifier.py:660:1: D400 First line should end with a period
        """Retrieve notification history"""
^
src/monitoring/alert_notifier.py:701:1: D400 First line should end with a period
    """Get or create global notification manager instance"""
^
src/monitoring/alert_notifier.py:709:1: D400 First line should end with a period
    """Send test notification to verify channel configuration"""
^
src/monitoring/alert_notifier.py:719:80: E501 line too long (91 > 79 characters)
        description="If you received this, the notification channel is working correctly!",
                                                                               ^
src/monitoring/alert_notifier.py:735:1: D103 Missing docstring in public function
    async def test():
^
src/monitoring/alert_notifier.py:745:80: E501 line too long (98 > 79 characters)
            description="The API p95 response time has exceeded 1 second for the past 5 minutes.",
                                                                               ^
src/monitoring/data_quality_monitor.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：数据质量监控模块，检查完整性、新鲜度和准确性
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/monitoring/data_quality_monitor.py:1:1: D400 First line should end with a period
"""
# 功能：数据质量监控模块，检查完整性、新鲜度和准确性
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/monitoring/data_quality_monitor.py:25:1: D400 First line should end with a period
    """
    数据质量监控器

    负责检查数据完整性、新鲜度和准确性,
    自动生成质量报告和告警。
    """
^
src/monitoring/data_quality_monitor.py:38:1: D400 First line should end with a period
        """
        初始化数据质量监控器

        Args:
            monitoring_db: 监控数据库实例 (可选)
        """
^
src/monitoring/data_quality_monitor.py:59:1: D400 First line should end with a period
        """
        检查数据完整性

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            total_records: 总记录数
            null_records: 空值记录数
            required_columns: 必需列列表
            threshold: 缺失率阈值 (%)

        Returns:
            dict: 检查结果 {
                'check_status': 'PASS/FAIL/WARNING',
                'missing_rate': float,
                'message': str
            }
        """
^
src/monitoring/data_quality_monitor.py:75:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        检查数据完整性

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            total_records: 总记录数
            null_records: 空值记录数
            required_columns: 必需列列表
            threshold: 缺失率阈值 (%)

        Returns:
            dict: 检查结果 {
                'check_status': 'PASS/FAIL/WARNING',
                'missing_rate': float,
                'message': str
            }
        """
^
src/monitoring/data_quality_monitor.py:82:80: E501 line too long (87 > 79 characters)
        missing_rate = (null_records / total_records * 100) if total_records > 0 else 0
                                                                               ^
src/monitoring/data_quality_monitor.py:112:80: E501 line too long (80 > 79 characters)
                alert_level="CRITICAL" if check_status == "FAIL" else "WARNING",
                                                                               ^
src/monitoring/data_quality_monitor.py:141:1: D400 First line should end with a period
        """
        检查数据新鲜度

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            latest_timestamp: 最新数据时间戳
            expected_update_interval: 预期更新间隔
            threshold_seconds: 延迟阈值(秒)

        Returns:
            dict: 检查结果
        """
^
src/monitoring/data_quality_monitor.py:166:80: E501 line too long (90 > 79 characters)
            check_message = f"数据严重过期: 延迟 {data_delay_seconds}秒 (阈值: {threshold_seconds}秒)"
                                                                               ^
src/monitoring/data_quality_monitor.py:169:80: E501 line too long (90 > 79 characters)
            check_message = f"数据更新延迟: 延迟 {data_delay_seconds}秒 (阈值: {threshold_seconds}秒)"
                                                                               ^
src/monitoring/data_quality_monitor.py:190:80: E501 line too long (80 > 79 characters)
                alert_level="CRITICAL" if check_status == "FAIL" else "WARNING",
                                                                               ^
src/monitoring/data_quality_monitor.py:223:1: D400 First line should end with a period
        """
        检查数据准确性

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            total_records: 总记录数
            invalid_records: 无效记录数
            validation_rules: 验证规则描述
            threshold: 无效率阈值 (%)

        Returns:
            dict: 检查结果
        """
^
src/monitoring/data_quality_monitor.py:278:80: E501 line too long (80 > 79 characters)
                alert_level="CRITICAL" if check_status == "FAIL" else "WARNING",
                                                                               ^
src/monitoring/data_quality_monitor.py:299:80: E501 line too long (87 > 79 characters)
        self, classification: str, database_type: str, table_name: str, check_type: str
                                                                               ^
src/monitoring/data_quality_monitor.py:301:1: D400 First line should end with a period
        """
        从监控数据库获取最新的检查结果

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            check_type: 检查类型 (COMPLETENESS/FRESHNESS/ACCURACY)

        Returns:
            dict: 检查结果或None
        """
^
src/monitoring/data_quality_monitor.py:316:80: E501 line too long (82 > 79 characters)
            from src.monitoring.monitoring_database import get_monitoring_database
                                                                               ^
src/monitoring/data_quality_monitor.py:324:13: F841 local variable 'query_sql' is assigned to but never used
            query_sql = """
            SELECT check_status, check_message, timestamp
            FROM data_quality_checks
            WHERE classification = %s AND database_type = %s AND table_name = %s AND check_type = %s
            ORDER BY timestamp DESC
            LIMIT 1
            """
            ^
src/monitoring/data_quality_monitor.py:326:37: W291 trailing whitespace
            query_sql = """
            SELECT check_status, check_message, timestamp
            FROM data_quality_checks
            WHERE classification = %s AND database_type = %s AND table_name = %s AND check_type = %s
            ORDER BY timestamp DESC
            LIMIT 1
            """

        ^
src/monitoring/data_quality_monitor.py:327:80: E501 line too long (100 > 79 characters)
            query_sql = """
            SELECT check_status, check_message, timestamp
            FROM data_quality_checks
            WHERE classification = %s AND database_type = %s AND table_name = %s AND check_type = %s
            ORDER BY timestamp DESC
            LIMIT 1
            """

                                                   ^
src/monitoring/data_quality_monitor.py:328:36: W291 trailing whitespace
            query_sql = """
            SELECT check_status, check_message, timestamp
            FROM data_quality_checks
            WHERE classification = %s AND database_type = %s AND table_name = %s AND check_type = %s
            ORDER BY timestamp DESC
            LIMIT 1
            """

       ^
src/monitoring/data_quality_monitor.py:339:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
            status = random.choice(status_options)
^
src/monitoring/data_quality_monitor.py:344:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "timestamp": datetime.now() - timedelta(hours=random.randint(0, 24)),
^
src/monitoring/data_quality_monitor.py:344:80: E501 line too long (85 > 79 characters)
                "timestamp": datetime.now() - timedelta(hours=random.randint(0, 24)),
                                                                               ^
src/monitoring/data_quality_monitor.py:354:1: D400 First line should end with a period
        """
        生成数据质量报告

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名

        Returns:
            dict: 质量报告 {
                'overall_status': 'PASS/WARNING/FAIL',
                'completeness': {...},
                'freshness': {...},
                'accuracy': {...},
                'timestamp': datetime
            }
        """
^
src/monitoring/data_quality_monitor.py:368:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        生成数据质量报告

        Args:
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名

        Returns:
            dict: 质量报告 {
                'overall_status': 'PASS/WARNING/FAIL',
                'completeness': {...},
                'freshness': {...},
                'accuracy': {...},
                'timestamp': datetime
            }
        """
^
src/monitoring/data_quality_monitor.py:376:80: E501 line too long (82 > 79 characters)
            "checks": {"completeness": None, "freshness": None, "accuracy": None},
                                                                               ^
src/monitoring/data_quality_monitor.py:402:80: E501 line too long (86 > 79 characters)
                for result in [completeness_result, freshness_result, accuracy_result]
                                                                               ^
src/monitoring/data_quality_monitor.py:431:1: D400 First line should end with a period
        """创建质量告警"""
^
src/monitoring/data_quality_monitor.py:454:1: D400 First line should end with a period
        """
        设置质量检查阈值

        Args:
            missing_rate_threshold: 缺失率阈值 (%)
            delay_threshold_seconds: 延迟阈值 (秒)
            invalid_rate_threshold: 无效率阈值 (%)
        """
^
src/monitoring/data_quality_monitor.py:481:1: D400 First line should end with a period
    """获取全局数据质量监控器实例 (单例模式)"""
^
src/monitoring/decoupled_monitoring.py:1:1: D205 1 blank line required between summary line and description
"""
监控逻辑解耦方案 - 基于装饰器模式和观察者模式
将横切关注点(监控、日志、性能)从业务逻辑中分离出来

设计原则:
1. 装饰器模式: 透明地为业务方法添加监控功能
2. 观察者模式: 松耦合的事件通知机制
3. 依赖注入: 通过配置控制监控功能
4. 单一职责: 监控逻辑与业务逻辑彻底分离

作者: Claude Code
版本: 3.0.0
日期: 2025-11-14
"""
^
src/monitoring/decoupled_monitoring.py:1:1: D400 First line should end with a period
"""
监控逻辑解耦方案 - 基于装饰器模式和观察者模式
将横切关注点(监控、日志、性能)从业务逻辑中分离出来

设计原则:
1. 装饰器模式: 透明地为业务方法添加监控功能
2. 观察者模式: 松耦合的事件通知机制
3. 依赖注入: 通过配置控制监控功能
4. 单一职责: 监控逻辑与业务逻辑彻底分离

作者: Claude Code
版本: 3.0.0
日期: 2025-11-14
"""
^
src/monitoring/decoupled_monitoring.py:34:1: D400 First line should end with a period
    """监控事件类型"""
^
src/monitoring/decoupled_monitoring.py:46:1: D400 First line should end with a period
    """监控事件数据"""
^
src/monitoring/decoupled_monitoring.py:56:1: D400 First line should end with a period
    """监控事件监听器抽象基类"""
^
src/monitoring/decoupled_monitoring.py:60:1: D400 First line should end with a period
        """处理监控事件"""
^
src/monitoring/decoupled_monitoring.py:65:1: D400 First line should end with a period
    """事件总线 - 统一的事件分发机制"""
^
src/monitoring/decoupled_monitoring.py:67:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/monitoring/decoupled_monitoring.py:68:80: E501 line too long (81 > 79 characters)
        self._listeners: Dict[MonitoringEvent, List[MonitoringEventListener]] = (
                                                                               ^
src/monitoring/decoupled_monitoring.py:73:80: E501 line too long (88 > 79 characters)
    def subscribe(self, event_type: MonitoringEvent, listener: MonitoringEventListener):
                                                                               ^
src/monitoring/decoupled_monitoring.py:74:1: D400 First line should end with a period
        """订阅事件"""
^
src/monitoring/decoupled_monitoring.py:81:1: D400 First line should end with a period
        """取消订阅"""
^
src/monitoring/decoupled_monitoring.py:87:1: D400 First line should end with a period
        """发布事件"""
^
src/monitoring/decoupled_monitoring.py:103:1: D400 First line should end with a period
    """获取全局事件总线实例"""
^
src/monitoring/decoupled_monitoring.py:113:1: D400 First line should end with a period
    """监控上下文 - 管理当前操作的监控信息"""
^
src/monitoring/decoupled_monitoring.py:115:80: E501 line too long (87 > 79 characters)
    _context: ContextVar[Dict[str, Any]] = ContextVar("monitoring_context", default={})
                                                                               ^
src/monitoring/decoupled_monitoring.py:115:85: B039 ContextVar with mutable literal or function call as default. This is only evaluated once, and all subsequent calls to `.get()` will return the same instance of the default.
    _context: ContextVar[Dict[str, Any]] = ContextVar("monitoring_context", default={})
                                                                                    ^
src/monitoring/decoupled_monitoring.py:119:1: D400 First line should end with a period
        """获取当前监控上下文"""
^
src/monitoring/decoupled_monitoring.py:124:1: D400 First line should end with a period
        """设置当前监控上下文"""
^
src/monitoring/decoupled_monitoring.py:129:1: D400 First line should end with a period
        """更新当前监控上下文"""
^
src/monitoring/decoupled_monitoring.py:136:1: D400 First line should end with a period
        """清除当前监控上下文"""
^
src/monitoring/decoupled_monitoring.py:142:1: D400 First line should end with a period
    """操作上下文 - 记录操作相关信息"""
^
src/monitoring/decoupled_monitoring.py:153:1: D400 First line should end with a period
        """转换为字典"""
^
src/monitoring/decoupled_monitoring.py:172:1: D400 First line should end with a period
    """性能指标"""
^
src/monitoring/decoupled_monitoring.py:185:1: D400 First line should end with a period
    """数据质量指标"""
^
src/monitoring/decoupled_monitoring.py:203:1: D400 First line should end with a period
    """日志监控监听器"""
^
src/monitoring/decoupled_monitoring.py:205:1: D107 Missing docstring in __init__
    def __init__(self, logger: Optional[logging.Logger] = None):
^
src/monitoring/decoupled_monitoring.py:209:1: D400 First line should end with a period
        """记录监控事件到日志"""
^
src/monitoring/decoupled_monitoring.py:212:80: E501 line too long (98 > 79 characters)
                f"操作开始: {event.data.get('operation_name')} - ID: {event.data.get('operation_id')}"
                                                                               ^
src/monitoring/decoupled_monitoring.py:217:80: E501 line too long (81 > 79 characters)
                f"操作完成: {event.data.get('operation_name')} - 耗时: {duration:.3f}s"
                                                                               ^
src/monitoring/decoupled_monitoring.py:221:80: E501 line too long (99 > 79 characters)
                f"操作失败: {event.data.get('operation_name')} - 错误: {event.data.get('error_message')}"
                                                                               ^
src/monitoring/decoupled_monitoring.py:226:80: E501 line too long (80 > 79 characters)
                f"慢操作: {event.data.get('operation_name')} - 耗时: {duration:.3f}s"
                                                                               ^
src/monitoring/decoupled_monitoring.py:231:1: D400 First line should end with a period
    """性能监控监听器"""
^
src/monitoring/decoupled_monitoring.py:233:1: D107 Missing docstring in __init__
    def __init__(self, slow_operation_threshold: float = 5.0):
^
src/monitoring/decoupled_monitoring.py:238:1: D400 First line should end with a period
        """收集性能指标"""
^
src/monitoring/decoupled_monitoring.py:266:1: D400 First line should end with a period
    """数据质量监控监听器"""
^
src/monitoring/decoupled_monitoring.py:268:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/monitoring/decoupled_monitoring.py:272:1: D400 First line should end with a period
        """监控数据质量"""
^
src/monitoring/decoupled_monitoring.py:293:1: D400 First line should end with a period
    """监控装饰器基类"""
^
src/monitoring/decoupled_monitoring.py:295:1: D107 Missing docstring in __init__
    def __init__(self, enable_monitoring: bool = True):
^
src/monitoring/decoupled_monitoring.py:300:1: D400 First line should end with a period
        """判断是否应该监控此操作"""
^
src/monitoring/decoupled_monitoring.py:307:80: E501 line too long (88 > 79 characters)
    def extract_operation_info(self, func: Callable, *args, **kwargs) -> Dict[str, Any]:
                                                                               ^
src/monitoring/decoupled_monitoring.py:308:1: D400 First line should end with a period
        """从函数和参数中提取操作信息"""
^
src/monitoring/decoupled_monitoring.py:322:8: N801 class name 'operation_monitor' should use CapWords convention
class operation_monitor(BaseMonitoringDecorator):
       ^
src/monitoring/decoupled_monitoring.py:323:1: D400 First line should end with a period
    """操作监控装饰器"""
^
src/monitoring/decoupled_monitoring.py:325:1: D107 Missing docstring in __init__
    def __init__(self, operation_name: Optional[str] = None, **kwargs):
^
src/monitoring/decoupled_monitoring.py:330:1: D400 First line should end with a period
        """装饰函数"""
^
src/monitoring/decoupled_monitoring.py:382:80: E501 line too long (80 > 79 characters)
                                len(result) if hasattr(result, "__len__") else 0
                                                                               ^
src/monitoring/decoupled_monitoring.py:420:8: N801 class name 'performance_monitor' should use CapWords convention
class performance_monitor(BaseMonitoringDecorator):
       ^
src/monitoring/decoupled_monitoring.py:421:1: D400 First line should end with a period
    """性能监控装饰器"""
^
src/monitoring/decoupled_monitoring.py:423:1: D107 Missing docstring in __init__
    def __init__(self, threshold: float = 5.0, **kwargs):
^
src/monitoring/decoupled_monitoring.py:428:1: D400 First line should end with a period
        """装饰函数"""
^
src/monitoring/decoupled_monitoring.py:460:8: N801 class name 'data_quality_monitor' should use CapWords convention
class data_quality_monitor(BaseMonitoringDecorator):
       ^
src/monitoring/decoupled_monitoring.py:461:1: D400 First line should end with a period
    """数据质量监控装饰器"""
^
src/monitoring/decoupled_monitoring.py:463:1: D107 Missing docstring in __init__
    def __init__(self, table_name: Optional[str] = None, **kwargs):
^
src/monitoring/decoupled_monitoring.py:468:1: D400 First line should end with a period
        """装饰函数"""
^
src/monitoring/decoupled_monitoring.py:479:80: E501 line too long (80 > 79 characters)
                self._check_data_quality(result, func.__name__, self.table_name)
                                                                               ^
src/monitoring/decoupled_monitoring.py:488:1: D400 First line should end with a period
        """检查数据质量"""
^
src/monitoring/decoupled_monitoring.py:501:80: E501 line too long (86 > 79 characters)
            null_count / (record_count * len(data.columns)) if record_count > 0 else 0
                                                                               ^
src/monitoring/decoupled_monitoring.py:503:80: E501 line too long (83 > 79 characters)
        duplicate_ratio = duplicate_count / record_count if record_count > 0 else 0
                                                                               ^
src/monitoring/decoupled_monitoring.py:537:1: D400 First line should end with a period
    """监控配置管理"""
^
src/monitoring/decoupled_monitoring.py:539:1: D107 Missing docstring in __init__
    def __init__(self, config: Optional[Dict[str, Any]] = None):
^
src/monitoring/decoupled_monitoring.py:544:1: D400 First line should end with a period
        """加载默认配置"""
^
src/monitoring/decoupled_monitoring.py:550:80: E501 line too long (86 > 79 characters)
            "listeners": {"logging": True, "performance": True, "data_quality": True},
                                                                               ^
src/monitoring/decoupled_monitoring.py:554:1: D400 First line should end with a period
        """设置监控监听器"""
^
src/monitoring/decoupled_monitoring.py:557:80: E501 line too long (83 > 79 characters)
            _event_bus.subscribe(MonitoringEvent.OPERATION_START, logging_listener)
                                                                               ^
src/monitoring/decoupled_monitoring.py:558:80: E501 line too long (81 > 79 characters)
            _event_bus.subscribe(MonitoringEvent.OPERATION_END, logging_listener)
                                                                               ^
src/monitoring/decoupled_monitoring.py:559:80: E501 line too long (83 > 79 characters)
            _event_bus.subscribe(MonitoringEvent.OPERATION_ERROR, logging_listener)
                                                                               ^
src/monitoring/decoupled_monitoring.py:568:80: E501 line too long (81 > 79 characters)
            _event_bus.subscribe(MonitoringEvent.PERFORMANCE_SLOW, perf_listener)
                                                                               ^
src/monitoring/decoupled_monitoring.py:572:80: E501 line too long (86 > 79 characters)
            _event_bus.subscribe(MonitoringEvent.DATA_QUALITY_ISSUE, quality_listener)
                                                                               ^
src/monitoring/decoupled_monitoring.py:575:1: D400 First line should end with a period
        """检查监控是否启用"""
^
src/monitoring/decoupled_monitoring.py:584:1: D400 First line should end with a period
    """获取全局监控配置"""
^
src/monitoring/decoupled_monitoring.py:594:1: D400 First line should end with a period
    """便捷的操作监控装饰器"""
^
src/monitoring/decoupled_monitoring.py:603:1: D400 First line should end with a period
    """便捷的性能监控装饰器"""
^
src/monitoring/decoupled_monitoring.py:612:1: D400 First line should end with a period
    """便捷的数据质量监控装饰器"""
^
src/monitoring/decoupled_monitoring.py:626:1: D400 First line should end with a period
    """监控报告生成器"""
^
src/monitoring/decoupled_monitoring.py:628:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/monitoring/decoupled_monitoring.py:632:1: D400 First line should end with a period
        """生成性能报告"""
^
src/monitoring/decoupled_monitoring.py:643:1: D400 First line should end with a period
        """生成数据质量报告"""
^
src/monitoring/decoupled_monitoring.py:651:1: D400 First line should end with a period
        """生成监控摘要"""
^
src/monitoring/decoupled_monitoring.py:669:1: D400 First line should end with a period
        """模拟获取股票数据"""
^
src/monitoring/decoupled_monitoring.py:689:1: D400 First line should end with a period
        """模拟慢操作"""
^
src/monitoring/gpu_integration_manager.py:2:1: D205 1 blank line required between summary line and description
"""
GPU性能优化集成模块
将GPU性能优化管理器集成到MyStocks主系统中
提供与统一管理器和监控系统的无缝集成

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0
依赖: src.monitoring.gpu_performance_optimizer, src.gpu.accelerated.*
注意事项: 这是MyStocks v3.0 GPU集成核心模块
版权: MyStocks Project © 2025
"""
^
src/monitoring/gpu_integration_manager.py:2:1: D400 First line should end with a period
"""
GPU性能优化集成模块
将GPU性能优化管理器集成到MyStocks主系统中
提供与统一管理器和监控系统的无缝集成

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0
依赖: src.monitoring.gpu_performance_optimizer, src.gpu.accelerated.*
注意事项: 这是MyStocks v3.0 GPU集成核心模块
版权: MyStocks Project © 2025
"""
^
src/monitoring/gpu_integration_manager.py:46:1: D400 First line should end with a period
    """GPU集成的监控管理器"""
^
src/monitoring/gpu_integration_manager.py:55:1: D400 First line should end with a period
        """初始化GPU集成监控"""
^
src/monitoring/gpu_integration_manager.py:86:1: D400 First line should end with a period
        """初始化GPU集成"""
^
src/monitoring/gpu_integration_manager.py:91:80: E501 line too long (80 > 79 characters)
            self.gpu_optimizer = await initialize_gpu_optimizer(self.gpu_config)
                                                                               ^
src/monitoring/gpu_integration_manager.py:118:1: D400 First line should end with a period
        """增强统一管理器以支持GPU优化"""
^
src/monitoring/gpu_integration_manager.py:130:1: D400 First line should end with a period
                """GPU增强的数据保存"""
^
src/monitoring/gpu_integration_manager.py:137:80: E501 line too long (88 > 79 characters)
                result = await original_save(data, data_classification, *args, **kwargs)
                                                                               ^
src/monitoring/gpu_integration_manager.py:146:80: E501 line too long (83 > 79 characters)
            async def gpu_enhanced_load_data(data_classification, *args, **kwargs):
                                                                               ^
src/monitoring/gpu_integration_manager.py:147:1: D400 First line should end with a period
                """GPU增强的数据加载"""
^
src/monitoring/gpu_integration_manager.py:149:80: E501 line too long (82 > 79 characters)
                result = await original_load(data_classification, *args, **kwargs)
                                                                               ^
src/monitoring/gpu_integration_manager.py:159:80: E501 line too long (85 > 79 characters)
            self.unified_manager.save_data_by_classification = gpu_enhanced_save_data
                                                                               ^
src/monitoring/gpu_integration_manager.py:160:80: E501 line too long (85 > 79 characters)
            self.unified_manager.load_data_by_classification = gpu_enhanced_load_data
                                                                               ^
src/monitoring/gpu_integration_manager.py:180:1: D400 First line should end with a period
        """集成监控系统"""
^
src/monitoring/gpu_integration_manager.py:199:1: D400 First line should end with a period
        """启动连续监控"""
^
src/monitoring/gpu_integration_manager.py:220:1: D400 First line should end with a period
        """手动运行GPU性能优化"""
^
src/monitoring/gpu_integration_manager.py:227:80: E501 line too long (85 > 79 characters)
            self.integration_status["last_optimization"] = datetime.now().isoformat()
                                                                               ^
src/monitoring/gpu_integration_manager.py:244:1: D400 First line should end with a period
        """获取GPU性能报告"""
^
src/monitoring/gpu_integration_manager.py:262:1: D400 First line should end with a period
        """获取集成状态"""
^
src/monitoring/gpu_integration_manager.py:271:80: E501 line too long (86 > 79 characters)
            "monitoring_integrated": self.integration_status["monitoring_integrated"],
                                                                               ^
src/monitoring/gpu_integration_manager.py:273:80: E501 line too long (82 > 79 characters)
            "total_optimizations": self.integration_status["total_optimizations"],
                                                                               ^
src/monitoring/gpu_integration_manager.py:278:1: D400 First line should end with a period
        """手动优化GPU内存"""
^
src/monitoring/gpu_integration_manager.py:296:1: D400 First line should end with a period
        """获取GPU健康状态"""
^
src/monitoring/gpu_integration_manager.py:317:80: E501 line too long (82 > 79 characters)
                issues.append(f"GPU内存使用过高: {metrics.gpu_memory_utilization:.1f}%")
                                                                               ^
src/monitoring/gpu_integration_manager.py:342:80: E501 line too long (98 > 79 characters)
                "recommendations": await self.gpu_optimizer._generate_performance_recommendations(
                                                                               ^
src/monitoring/gpu_integration_manager.py:352:1: D400 First line should end with a period
        """关闭GPU集成"""
^
src/monitoring/gpu_integration_manager.py:390:1: D400 First line should end with a period
    """获取GPU集成监控管理器单例"""
^
src/monitoring/gpu_integration_manager.py:401:1: D400 First line should end with a period
    """初始化GPU集成"""
^
src/monitoring/gpu_integration_manager.py:423:1: D400 First line should end with a period
    """获取GPU集成状态"""
^
src/monitoring/gpu_integration_manager.py:429:1: D400 First line should end with a period
    """运行GPU优化"""
^
src/monitoring/gpu_integration_manager.py:435:1: D400 First line should end with a period
    """获取GPU性能报告"""
^
src/monitoring/gpu_integration_manager.py:441:1: D400 First line should end with a period
    """获取GPU健康状态"""
^
src/monitoring/gpu_integration_manager.py:447:1: D400 First line should end with a period
    """优化GPU内存"""
^
src/monitoring/gpu_integration_manager.py:454:1: D400 First line should end with a period
    """主函数 - 示例用法"""
^
src/monitoring/gpu_integration_manager.py:469:80: E501 line too long (83 > 79 characters)
    integrated_monitoring = await initialize_gpu_integration(gpu_config=gpu_config)
                                                                               ^
src/monitoring/gpu_integration_manager.py:503:80: E501 line too long (80 > 79 characters)
        print(f"内存使用率: {current_metrics.get('gpu_memory_utilization', 0):.1f}%")
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:2:1: D205 1 blank line required between summary line and description
"""
GPU性能优化管理器
集成GPU加速系统的智能性能优化和自动调优功能
为MyStocks AI交易系统提供GPU资源的智能化管理

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0
依赖: src.gpu.accelerated.*
注意事项: 这是MyStocks v3.0 GPU性能优化核心模块
版权: MyStocks Project © 2025
"""
^
src/monitoring/gpu_performance_optimizer.py:2:1: D400 First line should end with a period
"""
GPU性能优化管理器
集成GPU加速系统的智能性能优化和自动调优功能
为MyStocks AI交易系统提供GPU资源的智能化管理

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0
依赖: src.gpu.accelerated.*
注意事项: 这是MyStocks v3.0 GPU性能优化核心模块
版权: MyStocks Project © 2025
"""
^
src/monitoring/gpu_performance_optimizer.py:50:1: D400 First line should end with a period
    """GPU优化配置"""
^
src/monitoring/gpu_performance_optimizer.py:85:1: D400 First line should end with a period
    """GPU性能指标"""
^
src/monitoring/gpu_performance_optimizer.py:104:1: D400 First line should end with a period
    """优化结果"""
^
src/monitoring/gpu_performance_optimizer.py:117:1: D400 First line should end with a period
    """GPU性能优化管理器"""
^
src/monitoring/gpu_performance_optimizer.py:125:1: D400 First line should end with a period
        """初始化GPU性能优化管理器"""
^
src/monitoring/gpu_performance_optimizer.py:164:1: D400 First line should end with a period
        """初始化GPU环境"""
^
src/monitoring/gpu_performance_optimizer.py:192:1: D400 First line should end with a period
        """初始化性能基准"""
^
src/monitoring/gpu_performance_optimizer.py:209:1: D400 First line should end with a period
        """创建基准测试数据"""
^
src/monitoring/gpu_performance_optimizer.py:214:80: E501 line too long (86 > 79 characters)
        data = {f"feature_{i}": np.random.randn(n_samples) for i in range(n_features)}
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:216:80: E501 line too long (87 > 79 characters)
        data["timestamp"] = pd.date_range("2024-01-01", periods=n_samples, freq="1min")
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:220:80: E501 line too long (81 > 79 characters)
    async def _run_performance_benchmark(self, data: pd.DataFrame) -> GPUMetrics:
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:221:1: D400 First line should end with a period
        """运行性能基准测试"""
^
src/monitoring/gpu_performance_optimizer.py:232:17: F841 local variable 'result' is assigned to but never used
                result = data_gpu.mean()
                ^
src/monitoring/gpu_performance_optimizer.py:233:17: F841 local variable 'gpu_compute_time' is assigned to but never used
                gpu_compute_time = time.time() - gpu_start
                ^
src/monitoring/gpu_performance_optimizer.py:270:1: D400 First line should end with a period
        """收集GPU指标"""
^
src/monitoring/gpu_performance_optimizer.py:291:13: F841 local variable 'device' is assigned to but never used
            device = cp.cuda.Device(0)
            ^
src/monitoring/gpu_performance_optimizer.py:350:80: E501 line too long (82 > 79 characters)
        self, gpu_util: float, memory_util: float, pool_used: int, pool_total: int
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:352:1: D400 First line should end with a period
        """计算GPU效率评分"""
^
src/monitoring/gpu_performance_optimizer.py:375:1: D400 First line should end with a period
        """执行性能优化"""
^
src/monitoring/gpu_performance_optimizer.py:443:80: E501 line too long (86 > 79 characters)
                f"性能优化完成 - 改进评分: {improvement_score:.3f}, 操作: {len(applied_actions)}个"
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:462:1: D400 First line should end with a period
        """内存优化"""
^
src/monitoring/gpu_performance_optimizer.py:466:80: E501 line too long (86 > 79 characters)
            if metrics.gpu_memory_utilization > self.config.memory_gc_threshold * 100:
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:477:80: E501 line too long (85 > 79 characters)
                    return f"GPU内存清理 - 释放 {metrics.gpu_memory_utilization:.1f}% 内存使用"
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:488:1: D400 First line should end with a period
        """批次大小优化"""
^
src/monitoring/gpu_performance_optimizer.py:494:80: E501 line too long (80 > 79 characters)
                new_batch = min(current_batch * 1.2, self.config.max_batch_size)
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:499:80: E501 line too long (80 > 79 characters)
                new_batch = max(current_batch * 0.8, self.config.min_batch_size)
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:510:1: D400 First line should end with a period
        """CPU-GPU负载均衡优化"""
^
src/monitoring/gpu_performance_optimizer.py:526:80: E501 line too long (106 > 79 characters)
                return f"负载均衡优化: CPU ({cpu_usage:.1f}%) → GPU卸载因子 {balance_factor:.2f} → {new_factor:.2f}"
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:533:80: E501 line too long (124 > 79 characters)
                return f"负载均衡优化: GPU ({gpu_metrics.gpu_utilization:.1f}%) → CPU卸载因子 {balance_factor:.2f} → {new_factor:.2f}"
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:542:1: D400 First line should end with a period
        """获取CPU使用率"""
^
src/monitoring/gpu_performance_optimizer.py:554:1: D400 First line should end with a period
        """计算改进评分"""
^
src/monitoring/gpu_performance_optimizer.py:557:80: E501 line too long (85 > 79 characters)
            efficiency_improvement = after.efficiency_score - before.efficiency_score
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:587:1: D400 First line should end with a period
        """生成优化建议"""
^
src/monitoring/gpu_performance_optimizer.py:609:1: D400 First line should end with a period
        """发送性能告警"""
^
src/monitoring/gpu_performance_optimizer.py:614:13: F841 local variable 'alert_data' is assigned to but never used
            alert_data = {
            ^
src/monitoring/gpu_performance_optimizer.py:631:1: D400 First line should end with a period
        """生成性能报告"""
^
src/monitoring/gpu_performance_optimizer.py:645:80: E501 line too long (81 > 79 characters)
                np.mean([m.efficiency_score for m in self.metrics_history[-10:]])
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:673:80: E501 line too long (84 > 79 characters)
                "recommendations": await self._generate_performance_recommendations(
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:683:1: D400 First line should end with a period
        """计算利用率趋势"""
^
src/monitoring/gpu_performance_optimizer.py:687:80: E501 line too long (85 > 79 characters)
        recent_utilizations = [m.gpu_utilization for m in self.metrics_history[-10:]]
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:702:1: D400 First line should end with a period
        """计算内存使用趋势"""
^
src/monitoring/gpu_performance_optimizer.py:706:80: E501 line too long (86 > 79 characters)
        recent_memory = [m.gpu_memory_utilization for m in self.metrics_history[-10:]]
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:723:1: D400 First line should end with a period
        """生成性能建议"""
^
src/monitoring/gpu_performance_optimizer.py:764:1: D400 First line should end with a period
        """启动连续优化监控"""
^
src/monitoring/gpu_performance_optimizer.py:783:80: E501 line too long (86 > 79 characters)
                last_optimization = self.adaptive_params.get("last_optimization_time")
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:810:1: D400 First line should end with a period
        """保存优化状态"""
^
src/monitoring/gpu_performance_optimizer.py:838:1: D400 First line should end with a period
        """加载优化状态"""
^
src/monitoring/gpu_performance_optimizer.py:867:80: E501 line too long (82 > 79 characters)
                    OptimizationResult(**o) for o in state["optimization_history"]
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:871:80: E501 line too long (81 > 79 characters)
            if "performance_baseline" in state and state["performance_baseline"]:
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:872:80: E501 line too long (87 > 79 characters)
                self.performance_baseline = GPUMetrics(**state["performance_baseline"])
                                                                               ^
src/monitoring/gpu_performance_optimizer.py:885:1: D400 First line should end with a period
    """获取GPU性能优化管理器单例"""
^
src/monitoring/gpu_performance_optimizer.py:895:1: D400 First line should end with a period
    """初始化GPU优化管理器"""
^
src/monitoring/gpu_performance_optimizer.py:909:1: D400 First line should end with a period
    """主函数 - 示例用法"""
^
src/monitoring/intelligent_threshold_manager.py:2:1: D400 First line should end with a period
"""
智能阈值算法和误报优化模块

基于机器学习的智能阈值算法，自动学习和调整监控阈值，减少误报率。
集成历史数据分析和趋势预测，提供动态阈值优化功能。

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0
依赖: numpy, pandas, scikit-learn
版权: MyStocks Project © 2025
"""
^
src/monitoring/intelligent_threshold_manager.py:44:1: D400 First line should end with a period
    """阈值规则定义"""
^
src/monitoring/intelligent_threshold_manager.py:60:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/intelligent_threshold_manager.py:67:1: D400 First line should end with a period
    """阈值调整记录"""
^
src/monitoring/intelligent_threshold_manager.py:82:1: D400 First line should end with a period
    """优化结果"""
^
src/monitoring/intelligent_threshold_manager.py:86:80: E501 line too long (81 > 79 characters)
        str  # 'anomaly_detection', 'trend_analysis', 'clustering', 'statistical'
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:97:1: D400 First line should end with a period
    """数据分析器 - 基础阈值分析功能"""
^
src/monitoring/intelligent_threshold_manager.py:99:1: D107 Missing docstring in __init__
    def __init__(self, window_size: int = 100):
^
src/monitoring/intelligent_threshold_manager.py:104:80: E501 line too long (80 > 79 characters)
    def add_data_point(self, value: float, timestamp: datetime, rule_name: str):
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:105:1: D400 First line should end with a period
        """添加数据点"""
^
src/monitoring/intelligent_threshold_manager.py:111:1: D400 First line should end with a period
        """计算基本统计信息"""
^
src/monitoring/intelligent_threshold_manager.py:134:1: D400 First line should end with a period
        """计算偏度"""
^
src/monitoring/intelligent_threshold_manager.py:146:1: D400 First line should end with a period
        """计算峰度"""
^
src/monitoring/intelligent_threshold_manager.py:158:1: D400 First line should end with a period
        """检测异常值"""
^
src/monitoring/intelligent_threshold_manager.py:162:80: E501 line too long (88 > 79 characters)
        values = np.array([point["value"] for point in self.data_buffer]).reshape(-1, 1)
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:165:80: E501 line too long (82 > 79 characters)
        iso_forest = IsolationForest(contamination=contamination, random_state=42)
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:172:1: D400 First line should end with a period
        """分析趋势"""
^
src/monitoring/intelligent_threshold_manager.py:177:9: F841 local variable 'timestamps' is assigned to but never used
        timestamps = [point["timestamp"] for point in self.data_buffer]
        ^
src/monitoring/intelligent_threshold_manager.py:206:1: D400 First line should end with a period
    """统计优化器"""
^
src/monitoring/intelligent_threshold_manager.py:208:1: D107 Missing docstring in __init__
    def __init__(self, min_data_points: int = 30):
^
src/monitoring/intelligent_threshold_manager.py:217:1: D202 No blank lines allowed after function docstring
        """基于统计方法优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:217:1: D400 First line should end with a period
        """基于统计方法优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:249:41: F841 local variable 'q5' is assigned to but never used
                recommended_threshold = q5 = np.percentile(values_array, 5)
                                        ^
src/monitoring/intelligent_threshold_manager.py:279:17: F541 f-string is missing placeholders
                f"异常值检测使用IQR方法",
                ^
src/monitoring/intelligent_threshold_manager.py:293:1: D202 No blank lines allowed after function docstring
        """计算阈值置信度"""
^
src/monitoring/intelligent_threshold_manager.py:293:1: D400 First line should end with a period
        """计算阈值置信度"""
^
src/monitoring/intelligent_threshold_manager.py:317:1: D202 No blank lines allowed after function docstring
        """估计阈值改进效果"""
^
src/monitoring/intelligent_threshold_manager.py:317:1: D400 First line should end with a period
        """估计阈值改进效果"""
^
src/monitoring/intelligent_threshold_manager.py:324:80: E501 line too long (83 > 79 characters)
            1 for v in values if self._is_anomaly(v, old_threshold, threshold_type)
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:327:80: E501 line too long (83 > 79 characters)
            1 for v in values if self._is_anomaly(v, new_threshold, threshold_type)
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:341:80: E501 line too long (87 > 79 characters)
    def _is_anomaly(self, value: float, threshold: float, threshold_type: str) -> bool:
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:342:1: D400 First line should end with a period
        """判断值是否为异常"""
^
src/monitoring/intelligent_threshold_manager.py:353:1: D400 First line should end with a period
        """数据不足时的结果"""
^
src/monitoring/intelligent_threshold_manager.py:367:1: D400 First line should end with a period
    """趋势分析优化器"""
^
src/monitoring/intelligent_threshold_manager.py:376:1: D202 No blank lines allowed after function docstring
        """基于趋势分析优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:376:1: D400 First line should end with a period
        """基于趋势分析优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:397:80: E501 line too long (86 > 79 characters)
        correlation = np.corrcoef(time_values, values)[0, 1] if len(values) > 2 else 0
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:448:1: D400 First line should end with a period
    """聚类分析优化器"""
^
src/monitoring/intelligent_threshold_manager.py:450:1: D107 Missing docstring in __init__
    def __init__(self, min_cluster_size: int = 3):
^
src/monitoring/intelligent_threshold_manager.py:459:1: D202 No blank lines allowed after function docstring
        """基于聚类分析优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:459:1: D400 First line should end with a period
        """基于聚类分析优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:504:80: E501 line too long (86 > 79 characters)
        largest_cluster_values = values_array[cluster_labels == largest_cluster_label]
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:529:80: E501 line too long (83 > 79 characters)
                f"聚类数量: {len(unique_labels) - (1 if -1 in cluster_labels else 0)}",
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:535:80: E501 line too long (88 > 79 characters)
                "num_clusters": len(unique_labels) - (1 if -1 in cluster_labels else 0),
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:544:1: D400 First line should end with a period
    """智能阈值管理器 - 主控制器"""
^
src/monitoring/intelligent_threshold_manager.py:546:1: D107 Missing docstring in __init__
    def __init__(self, config: Optional[Dict[str, Any]] = None):
^
src/monitoring/intelligent_threshold_manager.py:571:1: D400 First line should end with a period
        """获取默认配置"""
^
src/monitoring/intelligent_threshold_manager.py:586:1: D400 First line should end with a period
        """初始化默认阈值规则"""
^
src/monitoring/intelligent_threshold_manager.py:632:1: D400 First line should end with a period
        """添加阈值规则"""
^
src/monitoring/intelligent_threshold_manager.py:638:1: D400 First line should end with a period
        """移除阈值规则"""
^
src/monitoring/intelligent_threshold_manager.py:648:80: E501 line too long (80 > 79 characters)
        self, rule_name: str, value: float, timestamp: Optional[datetime] = None
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:650:1: D202 No blank lines allowed after function docstring
        """处理指标值，评估是否触发告警"""
^
src/monitoring/intelligent_threshold_manager.py:650:1: D400 First line should end with a period
        """处理指标值，评估是否触发告警"""
^
src/monitoring/intelligent_threshold_manager.py:671:80: E501 line too long (84 > 79 characters)
            await self._handle_potential_false_positive(rule_name, value, timestamp)
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:686:1: D202 No blank lines allowed after function docstring
        """评估阈值触发条件"""
^
src/monitoring/intelligent_threshold_manager.py:686:1: D400 First line should end with a period
        """评估阈值触发条件"""
^
src/monitoring/intelligent_threshold_manager.py:695:80: E501 line too long (85 > 79 characters)
    def _record_metric_data(self, rule_name: str, value: float, timestamp: datetime):
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:696:1: D202 No blank lines allowed after function docstring
        """记录指标数据"""
^
src/monitoring/intelligent_threshold_manager.py:696:1: D400 First line should end with a period
        """记录指标数据"""
^
src/monitoring/intelligent_threshold_manager.py:703:13: F841 local variable 'record' is assigned to but never used
            record = {
            ^
src/monitoring/intelligent_threshold_manager.py:719:1: D202 No blank lines allowed after function docstring
        """处理可能的误报"""
^
src/monitoring/intelligent_threshold_manager.py:719:1: D400 First line should end with a period
        """处理可能的误报"""
^
src/monitoring/intelligent_threshold_manager.py:737:80: E501 line too long (84 > 79 characters)
                    self._flag_potential_false_positive(rule_name, value, timestamp)
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:742:80: E501 line too long (88 > 79 characters)
    def _confirm_true_positive(self, rule_name: str, value: float, timestamp: datetime):
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:743:1: D202 No blank lines allowed after function docstring
        """确认真正的正例"""
^
src/monitoring/intelligent_threshold_manager.py:743:1: D400 First line should end with a period
        """确认真正的正例"""
^
src/monitoring/intelligent_threshold_manager.py:766:1: D202 No blank lines allowed after function docstring
        """标记可能的误报"""
^
src/monitoring/intelligent_threshold_manager.py:766:1: D400 First line should end with a period
        """标记可能的误报"""
^
src/monitoring/intelligent_threshold_manager.py:775:80: E501 line too long (82 > 79 characters)
            if rule.false_positive_rate > self.config["false_positive_threshold"]:
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:777:80: E501 line too long (80 > 79 characters)
                    f"规则{rule_name}误报率过高({rule.false_positive_rate:.2f})，建议调整阈值"
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:792:80: E501 line too long (80 > 79 characters)
        self, rule_name: str, value: float, triggered: bool, timestamp: datetime
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:794:1: D202 No blank lines allowed after function docstring
        """更新规则统计信息"""
^
src/monitoring/intelligent_threshold_manager.py:794:1: D400 First line should end with a period
        """更新规则统计信息"""
^
src/monitoring/intelligent_threshold_manager.py:816:1: D202 No blank lines allowed after function docstring
        """添加到规则历史"""
^
src/monitoring/intelligent_threshold_manager.py:816:1: D400 First line should end with a period
        """添加到规则历史"""
^
src/monitoring/intelligent_threshold_manager.py:822:73: E203 whitespace before ':'
            rule.history = rule.history[-self.config["max_history_size"] :]
                                                                        ^
src/monitoring/intelligent_threshold_manager.py:825:1: D202 No blank lines allowed after function docstring
        """计算规则置信度"""
^
src/monitoring/intelligent_threshold_manager.py:825:1: D400 First line should end with a period
        """计算规则置信度"""
^
src/monitoring/intelligent_threshold_manager.py:855:1: D202 No blank lines allowed after function docstring
        """优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:855:1: D400 First line should end with a period
        """优化阈值"""
^
src/monitoring/intelligent_threshold_manager.py:878:80: E501 line too long (80 > 79 characters)
    async def _optimize_single_rule(self, rule_name: str) -> OptimizationResult:
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:879:1: D202 No blank lines allowed after function docstring
        """优化单个规则"""
^
src/monitoring/intelligent_threshold_manager.py:879:1: D400 First line should end with a period
        """优化单个规则"""
^
src/monitoring/intelligent_threshold_manager.py:885:9: F841 local variable 'analyzer' is assigned to but never used
        analyzer = self.data_analyzers[rule_name]
        ^
src/monitoring/intelligent_threshold_manager.py:914:80: E501 line too long (84 > 79 characters)
            stat_result = self.statistical_optimizer.optimize_threshold_statistical(
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:932:80: E501 line too long (85 > 79 characters)
            cluster_result = self.clustering_optimizer.optimize_threshold_clustering(
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:958:80: E501 line too long (105 > 79 characters)
            f"规则{rule_name}优化完成: {rule.current_threshold:.2f} -> {best_result.recommended_threshold:.2f}"
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:966:1: D202 No blank lines allowed after function docstring
        """应用优化结果"""
^
src/monitoring/intelligent_threshold_manager.py:966:1: D400 First line should end with a period
        """应用优化结果"""
^
src/monitoring/intelligent_threshold_manager.py:975:80: E501 line too long (86 > 79 characters)
        if optimization_result.confidence_score < self.config["confidence_threshold"]:
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1007:49: E203 whitespace before ':'
                -self.config["max_history_size"] :
                                                ^
src/monitoring/intelligent_threshold_manager.py:1011:80: E501 line too long (80 > 79 characters)
            f"✅ 已应用阈值优化: {rule_name} {old_threshold:.2f} -> {new_threshold:.2f}"
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1016:1: D202 No blank lines allowed after function docstring
        """获取阈值状态"""
^
src/monitoring/intelligent_threshold_manager.py:1016:1: D400 First line should end with a period
        """获取阈值状态"""
^
src/monitoring/intelligent_threshold_manager.py:1036:80: E501 line too long (86 > 79 characters)
                    rule.last_adjustment.isoformat() if rule.last_adjustment else None
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1042:80: E501 line too long (82 > 79 characters)
            rule_status["threshold合理性"] = self._evaluate_threshold_reasonableness(
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1056:80: E501 line too long (88 > 79 characters)
    def _evaluate_threshold_reasonableness(self, rule: ThresholdRule) -> Dict[str, Any]:
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1057:1: D202 No blank lines allowed after function docstring
        """评估阈值合理性"""
^
src/monitoring/intelligent_threshold_manager.py:1057:1: D400 First line should end with a period
        """评估阈值合理性"""
^
src/monitoring/intelligent_threshold_manager.py:1110:1: D202 No blank lines allowed after function docstring
        """获取调整统计信息"""
^
src/monitoring/intelligent_threshold_manager.py:1110:1: D400 First line should end with a period
        """获取调整统计信息"""
^
src/monitoring/intelligent_threshold_manager.py:1120:80: E501 line too long (86 > 79 characters)
            "avg_confidence": np.mean([adj.confidence for adj in recent_adjustments]),
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1135:1: D202 No blank lines allowed after function docstring
        """获取调整最多的规则"""
^
src/monitoring/intelligent_threshold_manager.py:1135:1: D400 First line should end with a period
        """获取调整最多的规则"""
^
src/monitoring/intelligent_threshold_manager.py:1150:1: D202 No blank lines allowed after function docstring
        """导出配置"""
^
src/monitoring/intelligent_threshold_manager.py:1150:1: D400 First line should end with a period
        """导出配置"""
^
src/monitoring/intelligent_threshold_manager.py:1155:80: E501 line too long (81 > 79 characters)
                name: asdict(rule) for name, rule in self.threshold_rules.items()
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1166:1: D202 No blank lines allowed after function docstring
        """导入配置"""
^
src/monitoring/intelligent_threshold_manager.py:1166:1: D400 First line should end with a period
        """导入配置"""
^
src/monitoring/intelligent_threshold_manager.py:1172:80: E501 line too long (82 > 79 characters)
            for name, rule_data in config_data.get("threshold_rules", {}).items():
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1179:80: E501 line too long (85 > 79 characters)
                adj_data["timestamp"] = datetime.fromisoformat(adj_data["timestamp"])
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1199:1: D400 First line should end with a period
    """获取智能阈值管理器单例"""
^
src/monitoring/intelligent_threshold_manager.py:1212:1: D400 First line should end with a period
    """创建智能阈值管理器"""
^
src/monitoring/intelligent_threshold_manager.py:1217:1: D400 First line should end with a period
    """优化所有阈值"""
^
src/monitoring/intelligent_threshold_manager.py:1225:1: D400 First line should end with a period
    """处理指标值"""
^
src/monitoring/intelligent_threshold_manager.py:1233:1: D103 Missing docstring in public function
    async def main():
^
src/monitoring/intelligent_threshold_manager.py:1246:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i in range(50):
            ^
src/monitoring/intelligent_threshold_manager.py:1261:80: E501 line too long (87 > 79 characters)
                f"  当前阈值: {status['rules_status'][rule_name]['current_threshold']:.2f}"
                                                                               ^
src/monitoring/intelligent_threshold_manager.py:1272:80: E501 line too long (86 > 79 characters)
            success = await manager.apply_optimization(rule_name, optimization_result)
                                                                               ^
src/monitoring/metrics_collector.py:1:1: D205 1 blank line required between summary line and description
"""
自定义监控指标收集器
Prometheus指标定义和收集

功能：
- 定义所有业务、技术和告警指标
- 提供统一的指标收集接口
- 支持自定义指标的实时更新

作者：Claude
创建日期：2025-11-12
版本：1.0.0
"""
^
src/monitoring/metrics_collector.py:1:1: D400 First line should end with a period
"""
自定义监控指标收集器
Prometheus指标定义和收集

功能：
- 定义所有业务、技术和告警指标
- 提供统一的指标收集接口
- 支持自定义指标的实时更新

作者：Claude
创建日期：2025-11-12
版本：1.0.0
"""
^
src/monitoring/metrics_collector.py:28:1: D400 First line should end with a period
    """
    统一的指标收集器

    管理所有Prometheus指标的定义和收集，
    提供统一的接口用于应用程序的各个部分。
    """
^
src/monitoring/metrics_collector.py:36:1: D400 First line should end with a period
        """
        初始化指标收集器

        Args:
            registry: Prometheus注册表（可选，默认使用全局）
        """
^
src/monitoring/metrics_collector.py:48:1: D400 First line should end with a period
        """初始化所有指标"""
^
src/monitoring/metrics_collector.py:60:1: D400 First line should end with a period
        """初始化API相关指标"""
^
src/monitoring/metrics_collector.py:88:1: D400 First line should end with a period
        """初始化WebSocket相关指标"""
^
src/monitoring/metrics_collector.py:122:1: D400 First line should end with a period
        """初始化缓存相关指标"""
^
src/monitoring/metrics_collector.py:163:1: D400 First line should end with a period
        """初始化数据库相关指标"""
^
src/monitoring/metrics_collector.py:219:1: D400 First line should end with a period
        """初始化业务相关指标"""
^
src/monitoring/metrics_collector.py:293:1: D400 First line should end with a period
        """初始化告警和系统健康指标"""
^
src/monitoring/metrics_collector.py:385:1: D400 First line should end with a period
        """记录API请求"""
^
src/monitoring/metrics_collector.py:393:80: E501 line too long (84 > 79 characters)
    def record_websocket_connection(self, namespace: str, version: str, count: int):
                                                                               ^
src/monitoring/metrics_collector.py:394:1: D400 First line should end with a period
        """更新WebSocket活跃连接数"""
^
src/monitoring/metrics_collector.py:402:1: D400 First line should end with a period
        """记录WebSocket消息"""
^
src/monitoring/metrics_collector.py:416:1: D400 First line should end with a period
        """记录缓存命中"""
^
src/monitoring/metrics_collector.py:422:1: D400 First line should end with a period
        """记录缓存未命中"""
^
src/monitoring/metrics_collector.py:428:1: D400 First line should end with a period
        """更新缓存命中率"""
^
src/monitoring/metrics_collector.py:429:80: E501 line too long (83 > 79 characters)
        self._metrics["cache_hit_rate"].labels(cache_type=cache_type).set(hit_rate)
                                                                               ^
src/monitoring/metrics_collector.py:438:1: D400 First line should end with a period
        """更新数据库连接状态"""
^
src/monitoring/metrics_collector.py:456:1: D400 First line should end with a period
        """记录数据库查询"""
^
src/monitoring/metrics_collector.py:468:1: D400 First line should end with a period
        """记录市场数据处理"""
^
src/monitoring/metrics_collector.py:477:1: D400 First line should end with a period
        """记录告警触发"""
^
src/monitoring/metrics_collector.py:488:1: D400 First line should end with a period
        """更新组件健康状态"""
^
src/monitoring/metrics_collector.py:499:1: D400 First line should end with a period
        """更新依赖项可用性"""
^
src/monitoring/metrics_collector.py:505:1: D400 First line should end with a period
        """获取所有已定义的指标"""
^
src/monitoring/metrics_collector.py:509:1: D400 First line should end with a period
        """获取所有指标名称"""
^
src/monitoring/metrics_collector.py:513:1: D400 First line should end with a period
        """获取Prometheus注册表"""
^
src/monitoring/metrics_collector.py:522:1: D400 First line should end with a period
    """获取全局指标收集器实例"""
^
src/monitoring/metrics_collector.py:536:1: D400 First line should end with a period
    """便捷函数：记录API请求"""
^
src/monitoring/metrics_collector.py:547:1: D400 First line should end with a period
    """便捷函数：记录缓存操作"""
^
src/monitoring/metrics_collector.py:561:1: D400 First line should end with a period
    """便捷函数：记录数据库查询"""
^
src/monitoring/metrics_collector.py:578:11: F541 f-string is missing placeholders
    print(f"\nMetrics list:\n")
          ^
src/monitoring/monitoring_database.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：监控数据库模块，独立记录所有操作日志和指标
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/monitoring/monitoring_database.py:1:1: D400 First line should end with a period
"""
# 功能：监控数据库模块，独立记录所有操作日志和指标
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/monitoring/monitoring_database.py:24:1: D400 First line should end with a period
    """
    监控数据库访问类

    负责将所有监控数据写入独立的监控数据库。
    """
^
src/monitoring/monitoring_database.py:31:1: D400 First line should end with a period
        """
        初始化监控数据库

        Args:
            enable_monitoring: 是否启用监控 (默认True)
        """
^
src/monitoring/monitoring_database.py:42:80: E501 line too long (86 > 79 characters)
        logger.info(f"✅ MonitoringDatabase initialized (enabled={enable_monitoring})")
                                                                               ^
src/monitoring/monitoring_database.py:46:1: D400 First line should end with a period
        """获取监控数据库连接的上下文管理器"""
^
src/monitoring/monitoring_database.py:77:1: D400 First line should end with a period
        """
        记录操作日志

        Args:
            operation_type: 操作类型 (SAVE/LOAD/DELETE/UPDATE)
            classification: 数据分类
            target_database: 目标数据库 (TDengine/PostgreSQL/MySQL/Redis)
            table_name: 目标表名
            record_count: 影响记录数
            operation_status: 状态 (SUCCESS/FAILED/PARTIAL)
            error_message: 错误信息 (失败时)
            execution_time_ms: 执行时间(毫秒)
            user_agent: 调用来源
            client_ip: 客户端IP
            additional_info: 额外信息 (字典,会转为JSONB)

        Returns:
            bool: 记录是否成功
        """
^
src/monitoring/monitoring_database.py:142:80: E501 line too long (93 > 79 characters)
                f"操作日志: {operation_type} {classification} -> {target_database}.{table_name} "
                                                                               ^
src/monitoring/monitoring_database.py:143:80: E501 line too long (86 > 79 characters)
                f"({record_count} records, {operation_status}, {execution_time_ms}ms)"
                                                                               ^
src/monitoring/monitoring_database.py:161:1: D400 First line should end with a period
        """
        记录性能指标

        Args:
            metric_name: 指标名称
            metric_value: 指标值
            metric_type: 指标类型 (QUERY_TIME/CONNECTION_TIME/BATCH_SIZE)
            metric_unit: 单位 (ms/seconds/count)
            classification: 关联数据分类
            database_type: 关联数据库类型
            table_name: 关联表名
            is_slow_query: 是否慢查询 (>5秒)
            query_sql: SQL语句 (慢查询时记录)
            execution_plan: 执行计划
            tags: 标签 (字典)

        Returns:
            bool: 记录是否成功
        """
^
src/monitoring/monitoring_database.py:238:1: D400 First line should end with a period
        """
        记录数据质量检查

        Args:
            check_type: 检查类型 (COMPLETENESS/FRESHNESS/ACCURACY)
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            check_status: 检查状态 (PASS/FAIL/WARNING)
            total_records: 总记录数
            null_records: 空值记录数
            missing_rate: 缺失率 (%)
            latest_timestamp: 最新时间戳
            data_delay_seconds: 数据延迟(秒)
            invalid_records: 无效记录数
            validation_rules: 验证规则
            check_message: 检查信息
            threshold_config: 阈值配置
            check_duration_ms: 检查耗时(毫秒)

        Returns:
            bool: 记录是否成功
        """
^
src/monitoring/monitoring_database.py:279:80: E501 line too long (86 > 79 characters)
                    """
                    INSERT INTO data_quality_checks (
                        check_id, check_type, classification, database_type,
                        table_name, check_status, total_records, null_records,
                        missing_rate, latest_timestamp, data_delay_seconds,
                        invalid_records, validation_rules, check_message,
                        threshold_config, check_duration_ms
                    ) VALUES (
                        %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s
                    )
                """,


 ^
src/monitoring/monitoring_database.py:323:1: D400 First line should end with a period
        """
        创建告警

        Args:
            alert_level: 告警级别 (CRITICAL/WARNING/INFO)
            alert_type: 告警类型 (SLOW_QUERY/DATA_QUALITY/SYSTEM_ERROR)
            alert_title: 告警标题
            alert_message: 告警详细信息
            source: 告警来源 (模块名称)
            classification: 关联数据分类
            database_type: 关联数据库类型
            table_name: 关联表名
            additional_data: 额外数据
            notification_channels: 通知渠道 ['email', 'webhook', 'log']

        Returns:
            str: 告警ID (失败返回None)
        """
^
src/monitoring/monitoring_database.py:386:80: E501 line too long (84 > 79 characters)
            logger.warning(f"告警内容: [{alert_level}] {alert_title} - {alert_message}")
                                                                               ^
src/monitoring/monitoring_database.py:396:1: D400 First line should end with a period
        """
        更新告警状态

        Args:
            alert_id: 告警ID
            alert_status: 新状态 (ACKNOWLEDGED/RESOLVED)
            operator: 操作人
            resolution_notes: 解决说明

        Returns:
            bool: 更新是否成功
        """
^
src/monitoring/monitoring_database.py:451:1: D400 First line should end with a period
        """
        获取慢查询数量

        Args:
            hours: 统计时间范围（小时）

        Returns:
            int: 慢查询数量
        """
^
src/monitoring/monitoring_database.py:469:36: W291 trailing whitespace
                    """
                    SELECT COUNT(*)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_value > 1000  -- 假设超过1秒的查询为慢查询
                    AND created_at > %s
                """,

           ^
src/monitoring/monitoring_database.py:470:45: W291 trailing whitespace
                    """
                    SELECT COUNT(*)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_value > 1000  -- 假设超过1秒的查询为慢查询
                    AND created_at > %s
                """,

                    ^
src/monitoring/monitoring_database.py:471:53: W291 trailing whitespace
                    """
                    SELECT COUNT(*)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_value > 1000  -- 假设超过1秒的查询为慢查询
                    AND created_at > %s
                """,

                            ^
src/monitoring/monitoring_database.py:488:1: D400 First line should end with a period
        """
        获取平均查询时间

        Args:
            hours: 统计时间范围（小时）

        Returns:
            float: 平均查询时间（毫秒）
        """
^
src/monitoring/monitoring_database.py:506:45: W291 trailing whitespace
                    """
                    SELECT AVG(metric_value)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                    ^
src/monitoring/monitoring_database.py:507:45: W291 trailing whitespace
                    """
                    SELECT AVG(metric_value)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                    ^
src/monitoring/monitoring_database.py:508:53: W291 trailing whitespace
                    """
                    SELECT AVG(metric_value)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                            ^
src/monitoring/monitoring_database.py:525:1: D400 First line should end with a period
        """
        获取最大查询时间

        Args:
            hours: 统计时间范围（小时）

        Returns:
            float: 最大查询时间（毫秒）
        """
^
src/monitoring/monitoring_database.py:543:45: W291 trailing whitespace
                    """
                    SELECT MAX(metric_value)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                    ^
src/monitoring/monitoring_database.py:544:45: W291 trailing whitespace
                    """
                    SELECT MAX(metric_value)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                    ^
src/monitoring/monitoring_database.py:545:53: W291 trailing whitespace
                    """
                    SELECT MAX(metric_value)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                            ^
src/monitoring/monitoring_database.py:562:1: D400 First line should end with a period
        """
        获取总查询数量

        Args:
            hours: 统计时间范围（小时）

        Returns:
            int: 总查询数量
        """
^
src/monitoring/monitoring_database.py:580:36: W291 trailing whitespace
                    """
                    SELECT COUNT(*)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

           ^
src/monitoring/monitoring_database.py:581:45: W291 trailing whitespace
                    """
                    SELECT COUNT(*)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                    ^
src/monitoring/monitoring_database.py:582:53: W291 trailing whitespace
                    """
                    SELECT COUNT(*)
                    FROM performance_metrics
                    WHERE metric_name LIKE '%query%'
                    AND metric_type = 'QUERY_TIME'
                    AND created_at > %s
                """,

                            ^
src/monitoring/monitoring_database.py:599:1: D400 First line should end with a period
        """
        获取监控统计信息

        Returns:
            dict: 统计信息
        """
^
src/monitoring/monitoring_database.py:613:80: E501 line too long (86 > 79 characters)
                (self._total_writes - self._write_failures) / self._total_writes * 100
                                                                               ^
src/monitoring/monitoring_database.py:621:1: D400 First line should end with a period
        """
        清理过期记录

        Args:
            days_to_keep: 各表保留天数配置 {
                'operation_logs': 30,
                'performance_metrics': 90,
                'data_quality_checks': 7,
                'alert_records': 90
            }

        Returns:
            dict: 各表删除的记录数
        """
^
src/monitoring/monitoring_database.py:629:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        清理过期记录

        Args:
            days_to_keep: 各表保留天数配置 {
                'operation_logs': 30,
                'performance_metrics': 90,
                'data_quality_checks': 7,
                'alert_records': 90
            }

        Returns:
            dict: 各表删除的记录数
        """
^
src/monitoring/monitoring_database.py:656:1: S608 Possible SQL injection vector through string-based query construction.
                        f"""
                        DELETE FROM {table_name}
                        WHERE created_at < %s
                    """,
^
src/monitoring/monitoring_database.py:681:80: E501 line too long (82 > 79 characters)
def get_monitoring_database(enable_monitoring: bool = True) -> MonitoringDatabase:
                                                                               ^
src/monitoring/monitoring_database.py:682:1: D400 First line should end with a period
    """获取全局监控数据库实例 (单例模式)"""
^
src/monitoring/monitoring_database.py:685:80: E501 line too long (80 > 79 characters)
        _monitoring_db = MonitoringDatabase(enable_monitoring=enable_monitoring)
                                                                               ^
src/monitoring/monitoring_service.py:3:1: D205 1 blank line required between summary line and description
"""
MyStocks 量化交易数据管理系统 - 监控与自动化模块
完整的监控体系、自动化运维和数据管理

基于原始设计理念：
1. 监控数据库与业务数据库完全分离
2. 完整记录所有数据库操作
3. 自动化维护和告警机制
4. 数据质量监控和性能优化

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-09-21
"""
^
src/monitoring/monitoring_service.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 监控与自动化模块
完整的监控体系、自动化运维和数据管理

基于原始设计理念：
1. 监控数据库与业务数据库完全分离
2. 完整记录所有数据库操作
3. 自动化维护和告警机制
4. 数据质量监控和性能优化

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-09-21
"""
^
src/monitoring/monitoring_service.py:42:1: D400 First line should end with a period
    """操作指标数据类"""
^
src/monitoring/monitoring_service.py:57:1: D400 First line should end with a period
        """标记操作完成"""
^
src/monitoring/monitoring_service.py:64:1: D400 First line should end with a period
        """标记操作失败"""
^
src/monitoring/monitoring_service.py:72:1: D400 First line should end with a period
    """告警级别"""
^
src/monitoring/monitoring_service.py:82:1: D400 First line should end with a period
    """告警数据类"""
^
src/monitoring/monitoring_service.py:95:1: D400 First line should end with a period
    """监控数据库管理器 - 与业务数据库完全分离"""
^
src/monitoring/monitoring_service.py:98:1: D400 First line should end with a period
        """
        初始化监控数据库

        Args:
            monitor_db_url: 监控数据库连接URL
        """
^
src/monitoring/monitoring_service.py:126:80: E501 line too long (92 > 79 characters)
            f"监控数据库初始化完成: {self.monitor_db_config['host']}:{self.monitor_db_config['port']}"
                                                                               ^
src/monitoring/monitoring_service.py:130:1: D400 First line should end with a period
        """获取监控数据库连接"""
^
src/monitoring/monitoring_service.py:139:1: D400 First line should end with a period
        """确保监控表结构存在"""
^
src/monitoring/monitoring_service.py:149:80: E501 line too long (110 > 79 characters)
                check_tables_sql = """
                SELECT COUNT(*) as table_count FROM information_schema.tables
                WHERE table_schema = %s AND table_name IN
                ('table_creation_log', 'column_definition_log', 'table_operation_log', 'table_validation_log')
                """

                                        ^
src/monitoring/monitoring_service.py:152:80: E501 line too long (87 > 79 characters)
                cursor.execute(check_tables_sql, (self.monitor_db_config["database"],))
                                                                               ^
src/monitoring/monitoring_service.py:184:1: D400 First line should end with a period
        """初始化监控表结构"""
^
src/monitoring/monitoring_service.py:200:1: D400 First line should end with a period
        """
        记录操作开始

        Returns:
            str: 操作ID
        """
^
src/monitoring/monitoring_service.py:207:80: E501 line too long (101 > 79 characters)
            operation_id = f"{datetime.now().strftime('%Y%m%d%H%M%S')}_{table_name}_{operation_type}"
                                                                               ^
src/monitoring/monitoring_service.py:239:1: D400 First line should end with a period
        """
        记录操作结果

        Args:
            operation_id: 操作ID
            success: 是否成功
            data_count: 数据条数
            error_message: 错误信息
        """
^
src/monitoring/monitoring_service.py:265:1: D400 First line should end with a period
        """插入操作日志到监控数据库"""
^
src/monitoring/monitoring_service.py:278:80: E501 line too long (91 > 79 characters)
                insert_sql = """
                INSERT INTO table_operation_log (
                    operation_id, table_name, database_type, database_name,
                    operation_type, operation_time, operation_status,
                    operation_details, ddl_command, error_message
                ) VALUES (
                    %(operation_id)s, %(table_name)s, %(database_type)s, %(database_name)s,
                    %(operation_type)s, %(operation_time)s, %(operation_status)s,
                    %(operation_details)s, %(ddl_command)s, %(error_message)s
                )
                """

                                              ^
src/monitoring/monitoring_service.py:279:80: E501 line too long (81 > 79 characters)
                insert_sql = """
                INSERT INTO table_operation_log (
                    operation_id, table_name, database_type, database_name,
                    operation_type, operation_time, operation_status,
                    operation_details, ddl_command, error_message
                ) VALUES (
                    %(operation_id)s, %(table_name)s, %(database_type)s, %(database_name)s,
                    %(operation_type)s, %(operation_time)s, %(operation_status)s,
                    %(operation_details)s, %(ddl_command)s, %(error_message)s
                )
                """

                                              ^
src/monitoring/monitoring_service.py:295:1: D400 First line should end with a period
        """更新操作日志"""
^
src/monitoring/monitoring_service.py:332:1: D400 First line should end with a period
        """
        获取操作统计信息

        Args:
            hours: 统计时间范围（小时）

        Returns:
            Dict: 统计信息
        """
^
src/monitoring/monitoring_service.py:355:80: E501 line too long (98 > 79 characters)
            total_sql = """
            SELECT
                COUNT(*) as total_operations,
                COUNT(CASE WHEN operation_status = 'success' THEN 1 END) as successful_operations,
                COUNT(CASE WHEN operation_status = 'failed' THEN 1 END) as failed_operations,
                AVG(duration_seconds) as average_duration
            FROM table_operation_log
            WHERE operation_time >= %s
            """


                                ^
src/monitoring/monitoring_service.py:356:80: E501 line too long (93 > 79 characters)
            total_sql = """
            SELECT
                COUNT(*) as total_operations,
                COUNT(CASE WHEN operation_status = 'success' THEN 1 END) as successful_operations,
                COUNT(CASE WHEN operation_status = 'failed' THEN 1 END) as failed_operations,
                AVG(duration_seconds) as average_duration
            FROM table_operation_log
            WHERE operation_time >= %s
            """


                                ^
src/monitoring/monitoring_service.py:393:80: E501 line too long (83 > 79 characters)
                "successful_operations": total_result[1] if total_result[1] else 0,
                                                                               ^
src/monitoring/monitoring_service.py:395:80: E501 line too long (84 > 79 characters)
                "database_breakdown": {db[0]: db[1] for db in db_breakdown_results},
                                                                               ^
src/monitoring/monitoring_service.py:399:80: E501 line too long (87 > 79 characters)
                "average_duration": float(total_result[3]) if total_result[3] else 0.0,
                                                                               ^
src/monitoring/monitoring_service.py:410:1: D400 First line should end with a period
        """
        获取表创建历史

        Args:
            limit: 返回记录数限制

        Returns:
            List[Dict]: 创建历史记录
        """
^
src/monitoring/monitoring_service.py:433:1: D400 First line should end with a period
    """数据质量监控器"""
^
src/monitoring/monitoring_service.py:436:1: D400 First line should end with a period
        """
        初始化数据质量监控器

        Args:
            config_manager: 配置管理器
        """
^
src/monitoring/monitoring_service.py:446:1: D400 First line should end with a period
        """加载数据质量规则"""
^
src/monitoring/monitoring_service.py:469:1: D400 First line should end with a period
        """
        检查数据完整性

        Args:
            classification: 数据分类

        Returns:
            Dict: 完整性检查结果
        """
^
src/monitoring/monitoring_service.py:501:1: D400 First line should end with a period
        """检查日线数据完整性"""
^
src/monitoring/monitoring_service.py:506:1: D400 First line should end with a period
        """检查股票信息完整性"""
^
src/monitoring/monitoring_service.py:511:1: D400 First line should end with a period
        """
        检查数据新鲜度

        Returns:
            Dict: 新鲜度检查结果
        """
^
src/monitoring/monitoring_service.py:544:1: D400 First line should end with a period
        """
        检查单个表的数据新鲜度

        Args:
            table_name: 表名
            threshold_hours: 阈值（小时）

        Returns:
            Dict: 新鲜度检查结果
        """
^
src/monitoring/monitoring_service.py:577:1: D400 First line should end with a period
        """
        检查数据准确性

        Args:
            classification: 数据分类
            sample_size: 采样大小

        Returns:
            Dict: 准确性检查结果
        """
^
src/monitoring/monitoring_service.py:609:1: D400 First line should end with a period
        """检查价格数据准确性"""
^
src/monitoring/monitoring_service.py:611:80: E501 line too long (83 > 79 characters)
        return {"accuracy_score": 0.99, "anomalies": [], "out_of_range_values": []}
                                                                               ^
src/monitoring/monitoring_service.py:614:1: D400 First line should end with a period
        """
        生成数据质量报告

        Returns:
            Dict: 质量报告
        """
^
src/monitoring/monitoring_service.py:642:80: E501 line too long (82 > 79 characters)
                completeness_result = self.check_data_completeness(classification)
                                                                               ^
src/monitoring/monitoring_service.py:643:80: E501 line too long (82 > 79 characters)
                report["completeness"][classification.value] = completeness_result
                                                                               ^
src/monitoring/monitoring_service.py:661:80: E501 line too long (86 > 79 characters)
                avg_completeness = sum(completeness_scores) / len(completeness_scores)
                                                                               ^
src/monitoring/monitoring_service.py:678:1: D400 First line should end with a period
        """
        根据报告生成改进建议

        Args:
            report: 质量报告

        Returns:
            List[str]: 改进建议列表
        """
^
src/monitoring/monitoring_service.py:708:1: D400 First line should end with a period
    """性能监控器"""
^
src/monitoring/monitoring_service.py:711:1: D400 First line should end with a period
        """初始化性能监控器"""
^
src/monitoring/monitoring_service.py:716:1: D400 First line should end with a period
        """
        记录操作指标

        Args:
            metrics: 操作指标
        """
^
src/monitoring/monitoring_service.py:730:80: E501 line too long (81 > 79 characters)
            if metrics.duration and metrics.duration > self.slow_query_threshold:
                                                                               ^
src/monitoring/monitoring_service.py:737:1: D400 First line should end with a period
        """告警慢操作"""
^
src/monitoring/monitoring_service.py:745:1: D400 First line should end with a period
        """
        获取性能摘要

        Args:
            hours: 统计时间范围（小时）

        Returns:
            Dict: 性能摘要
        """
^
src/monitoring/monitoring_service.py:796:80: E501 line too long (87 > 79 characters)
                op_metrics = [m for m in recent_metrics if m.operation_type == op_type]
                                                                               ^
src/monitoring/monitoring_service.py:814:1: D400 First line should end with a period
        """
        获取慢操作列表

        Args:
            hours: 时间范围（小时）
            limit: 返回数量限制

        Returns:
            List[Dict]: 慢操作列表
        """
^
src/monitoring/monitoring_service.py:855:1: D400 First line should end with a period
    """告警管理器"""
^
src/monitoring/monitoring_service.py:858:1: D400 First line should end with a period
        """
        初始化告警管理器

        Args:
            config: 告警配置
        """
^
src/monitoring/monitoring_service.py:869:1: D400 First line should end with a period
        """获取默认告警配置"""
^
src/monitoring/monitoring_service.py:885:1: D400 First line should end with a period
        """初始化告警渠道"""
^
src/monitoring/monitoring_service.py:900:80: E501 line too long (81 > 79 characters)
        self, level: AlertLevel, title: str, message: str, source: str = "system"
                                                                               ^
src/monitoring/monitoring_service.py:902:1: D400 First line should end with a period
        """
        创建告警

        Args:
            level: 告警级别
            title: 告警标题
            message: 告警消息
            source: 告警源

        Returns:
            Alert: 告警对象
        """
^
src/monitoring/monitoring_service.py:937:1: D400 First line should end with a period
        """
        发送告警到各个渠道

        Args:
            alert: 告警对象
        """
^
src/monitoring/monitoring_service.py:954:1: D400 First line should end with a period
        """
        解决告警

        Args:
            alert_id: 告警ID
        """
^
src/monitoring/monitoring_service.py:972:1: D400 First line should end with a period
        """
        获取活跃告警

        Args:
            level: 过滤告警级别

        Returns:
            List[Alert]: 活跃告警列表
        """
^
src/monitoring/monitoring_service.py:982:80: E501 line too long (82 > 79 characters)
            active = [alert for alert in self.active_alerts if not alert.resolved]
                                                                               ^
src/monitoring/monitoring_service.py:994:1: D400 First line should end with a period
        """
        清理旧告警

        Args:
            days: 保留天数
        """
^
src/monitoring/monitoring_service.py:1019:1: D400 First line should end with a period
    """告警渠道抽象基类"""
^
src/monitoring/monitoring_service.py:1023:1: D400 First line should end with a period
        """发送告警"""
^
src/monitoring/monitoring_service.py:1028:1: D400 First line should end with a period
    """日志告警渠道"""
^
src/monitoring/monitoring_service.py:1030:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict[str, Any]):
^
src/monitoring/monitoring_service.py:1034:1: D400 First line should end with a period
        """发送告警到日志"""
^
src/monitoring/monitoring_service.py:1036:80: E501 line too long (83 > 79 characters)
            f"[ALERT] {alert.level.value.upper()} - {alert.title}: {alert.message}"
                                                                               ^
src/monitoring/monitoring_service.py:1050:1: D400 First line should end with a period
    """邮件告警渠道"""
^
src/monitoring/monitoring_service.py:1052:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict[str, Any]):
^
src/monitoring/monitoring_service.py:1060:1: D400 First line should end with a period
        """发送告警邮件"""
^
src/monitoring/monitoring_service.py:1074:1: D400 First line should end with a period
    """Webhook告警渠道"""
^
src/monitoring/monitoring_service.py:1076:1: D107 Missing docstring in __init__
    def __init__(self, config: Dict[str, Any]):
^
src/monitoring/monitoring_service.py:1078:80: E501 line too long (82 > 79 characters)
        self.headers = config.get("headers", {"Content-Type": "application/json"})
                                                                               ^
src/monitoring/monitoring_service.py:1081:1: D400 First line should end with a period
        """发送告警到Webhook"""
^
src/monitoring/monitoring_service.py:1087:13: F841 local variable 'payload' is assigned to but never used
            payload = {
            ^
src/monitoring/multi_channel_alert_manager.py:2:1: D400 First line should end with a period
"""
多渠道告警处理器

支持邮件、Webhook、日志等多种告警渠道的统一处理器。
提供配置化的告警路由、格式化模板、错误处理和重试机制。

作者: MyStocks AI开发团队
创建日期: 2025-11-16
版本: 1.0.0
依赖: smtplib, requests, asyncio
版权: MyStocks Project © 2025
"""
^
src/monitoring/multi_channel_alert_manager.py:42:1: D400 First line should end with a period
    """告警渠道配置"""
^
src/monitoring/multi_channel_alert_manager.py:52:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/multi_channel_alert_manager.py:66:1: D400 First line should end with a period
    """邮件配置"""
^
src/monitoring/multi_channel_alert_manager.py:79:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/multi_channel_alert_manager.py:93:3: W291 trailing whitespace
            self.body_template = """
告警详情:

严重程度: {severity}
规则名称: {rule_name}
触发时间: {timestamp}
当前值: {current_value}
阈值: {threshold}
消息: {message}

请及时处理此告警。

--
MyStocks AI监控系统
"""
  ^
src/monitoring/multi_channel_alert_manager.py:100:1: D400 First line should end with a period
    """Webhook配置"""
^
src/monitoring/multi_channel_alert_manager.py:110:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/multi_channel_alert_manager.py:131:1: D400 First line should end with a period
    """日志配置"""
^
src/monitoring/multi_channel_alert_manager.py:139:1: D105 Missing docstring in magic method
    def __post_init__(self):
^
src/monitoring/multi_channel_alert_manager.py:155:1: D400 First line should end with a period
    """告警处理器基类"""
^
src/monitoring/multi_channel_alert_manager.py:157:1: D107 Missing docstring in __init__
    def __init__(self, config: AlertChannelConfig):
^
src/monitoring/multi_channel_alert_manager.py:168:1: D400 First line should end with a period
        """处理告警"""
^
src/monitoring/multi_channel_alert_manager.py:199:1: D400 First line should end with a period
        """更新统计信息"""
^
src/monitoring/multi_channel_alert_manager.py:208:1: D400 First line should end with a period
        """获取统计信息"""
^
src/monitoring/multi_channel_alert_manager.py:220:80: E501 line too long (80 > 79 characters)
                self.last_sent_time.isoformat() if self.last_sent_time else None
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:228:1: D400 First line should end with a period
        """发送告警 - 子类实现"""
^
src/monitoring/multi_channel_alert_manager.py:233:1: D400 First line should end with a period
    """邮件告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:235:1: D107 Missing docstring in __init__
    def __init__(self, config: AlertChannelConfig, email_config: EmailConfig):
^
src/monitoring/multi_channel_alert_manager.py:243:1: D202 No blank lines allowed after function docstring
        """发送邮件告警"""
^
src/monitoring/multi_channel_alert_manager.py:243:1: D400 First line should end with a period
        """发送邮件告警"""
^
src/monitoring/multi_channel_alert_manager.py:247:80: E501 line too long (86 > 79 characters)
            subject = self._format_template(self.email_config.subject_template, alert)
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:248:80: E501 line too long (80 > 79 characters)
            body = self._format_template(self.email_config.body_template, alert)
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:273:1: D202 No blank lines allowed after function docstring
        """格式化模板"""
^
src/monitoring/multi_channel_alert_manager.py:273:1: D400 First line should end with a period
        """格式化模板"""
^
src/monitoring/multi_channel_alert_manager.py:293:1: D202 No blank lines allowed after function docstring
        """创建HTML邮件内容"""
^
src/monitoring/multi_channel_alert_manager.py:293:1: D400 First line should end with a period
        """创建HTML邮件内容"""
^
src/monitoring/multi_channel_alert_manager.py:307:36: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


^
src/monitoring/multi_channel_alert_manager.py:308:52: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """



 ^
src/monitoring/multi_channel_alert_manager.py:309:38: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


  ^
src/monitoring/multi_channel_alert_manager.py:310:36: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


^
src/monitoring/multi_channel_alert_manager.py:311:44: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


        ^
src/monitoring/multi_channel_alert_manager.py:312:40: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


    ^
src/monitoring/multi_channel_alert_manager.py:314:27: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

      ^
src/monitoring/multi_channel_alert_manager.py:315:47: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


           ^
src/monitoring/multi_channel_alert_manager.py:316:34: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

             ^
src/monitoring/multi_channel_alert_manager.py:317:35: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

              ^
src/monitoring/multi_channel_alert_manager.py:318:48: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


            ^
src/monitoring/multi_channel_alert_manager.py:320:28: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

       ^
src/monitoring/multi_channel_alert_manager.py:321:35: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

              ^
src/monitoring/multi_channel_alert_manager.py:322:47: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


           ^
src/monitoring/multi_channel_alert_manager.py:324:27: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

      ^
src/monitoring/multi_channel_alert_manager.py:325:45: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


         ^
src/monitoring/multi_channel_alert_manager.py:326:35: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """

              ^
src/monitoring/multi_channel_alert_manager.py:327:36: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


^
src/monitoring/multi_channel_alert_manager.py:328:40: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """


    ^
src/monitoring/multi_channel_alert_manager.py:329:52: W291 trailing whitespace
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """



 ^
src/monitoring/multi_channel_alert_manager.py:342:80: E501 line too long (98 > 79 characters)
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """




         ^
src/monitoring/multi_channel_alert_manager.py:346:80: E501 line too long (93 > 79 characters)
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """




         ^
src/monitoring/multi_channel_alert_manager.py:347:80: E501 line too long (88 > 79 characters)
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """




         ^
src/monitoring/multi_channel_alert_manager.py:348:80: E501 line too long (90 > 79 characters)
        html = f"""
        <html>
        <head>
            <style>
                .alert-container {{
                    font-family: Arial, sans-serif;
                    max-width: 600px;
                    margin: 0 auto;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                }}
                .header {{
                    background-color: {color};
                    color: white;
                    padding: 20px;
                    border-radius: 5px 5px 0 0;
                }}
                .content {{
                    padding: 20px;
                    background-color: #f9f9f9;
                }}
                .metric {{
                    background-color: white;
                    padding: 10px;
                    margin: 10px 0;
                    border-radius: 3px;
                    border-left: 4px solid {color};
                }}
            </style>
        </head>
        <body>
            <div class="alert-container">
                <div class="header">
                    <h2>MyStocks AI监控告警</h2>
                    <p>严重程度: {alert.severity.value.upper()}</p>
                </div>
                <div class="content">
                    <div class="metric">
                        <strong>规则名称:</strong> {alert.rule_name}<br>
                        <strong>触发时间:</strong> {alert.timestamp.strftime('%Y-%m-%d %H:%M:%S')}<br>
                        <strong>告警消息:</strong> {alert.message}
                    </div>
                    <div class="metric">
                        <strong>当前值:</strong> {alert.metrics.get('current_value', 'N/A')}<br>
                        <strong>阈值:</strong> {alert.metrics.get('threshold', 'N/A')}<br>
                        <strong>持续时间:</strong> {alert.metrics.get('duration_seconds', 0)}秒
                    </div>
                </div>
            </div>
        </body>
        </html>
        """




         ^
src/monitoring/multi_channel_alert_manager.py:359:1: D400 First line should end with a period
        """异步发送邮件"""
^
src/monitoring/multi_channel_alert_manager.py:365:80: E501 line too long (82 > 79 characters)
                        self.email_config.smtp_server, self.email_config.smtp_port
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:369:80: E501 line too long (82 > 79 characters)
                        self.email_config.smtp_server, self.email_config.smtp_port
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:375:80: E501 line too long (84 > 79 characters)
                server.login(self.email_config.username, self.email_config.password)
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:389:1: D400 First line should end with a period
    """Webhook告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:391:1: D107 Missing docstring in __init__
    def __init__(self, config: AlertChannelConfig, webhook_config: WebhookConfig):
^
src/monitoring/multi_channel_alert_manager.py:391:80: E501 line too long (82 > 79 characters)
    def __init__(self, config: AlertChannelConfig, webhook_config: WebhookConfig):
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:401:1: D202 No blank lines allowed after function docstring
        """发送Webhook告警"""
^
src/monitoring/multi_channel_alert_manager.py:401:1: D400 First line should end with a period
        """发送Webhook告警"""
^
src/monitoring/multi_channel_alert_manager.py:409:80: E501 line too long (81 > 79 characters)
                timeout=aiohttp.ClientTimeout(total=self.webhook_config.timeout),
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:421:80: E501 line too long (81 > 79 characters)
                            f"Bearer {self.webhook_config.auth_config['bearer']}"
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:445:80: E501 line too long (80 > 79 characters)
                        logger.info(f"Webhook告警发送成功: {self.webhook_config.url}")
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:450:80: E501 line too long (81 > 79 characters)
                            f"Webhook请求失败: HTTP {response.status} - {error_text}"
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:462:1: D202 No blank lines allowed after function docstring
        """准备载荷数据"""
^
src/monitoring/multi_channel_alert_manager.py:462:1: D400 First line should end with a period
        """准备载荷数据"""
^
src/monitoring/multi_channel_alert_manager.py:495:1: D400 First line should end with a period
    """日志告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:497:1: D107 Missing docstring in __init__
    def __init__(self, config: AlertChannelConfig, log_config: LogConfig):
^
src/monitoring/multi_channel_alert_manager.py:509:1: D202 No blank lines allowed after function docstring
        """设置文件处理器"""
^
src/monitoring/multi_channel_alert_manager.py:509:1: D400 First line should end with a period
        """设置文件处理器"""
^
src/monitoring/multi_channel_alert_manager.py:535:80: E501 line too long (84 > 79 characters)
        log_level = getattr(logging, self.log_config.level.upper(), logging.WARNING)
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:539:1: D202 No blank lines allowed after function docstring
        """记录日志告警"""
^
src/monitoring/multi_channel_alert_manager.py:539:1: D400 First line should end with a period
        """记录日志告警"""
^
src/monitoring/multi_channel_alert_manager.py:560:1: D202 No blank lines allowed after function docstring
        """格式化日志消息"""
^
src/monitoring/multi_channel_alert_manager.py:560:1: D400 First line should end with a period
        """格式化日志消息"""
^
src/monitoring/multi_channel_alert_manager.py:579:1: D400 First line should end with a period
    """速率限制器"""
^
src/monitoring/multi_channel_alert_manager.py:581:1: D107 Missing docstring in __init__
    def __init__(self, max_requests: int):
^
src/monitoring/multi_channel_alert_manager.py:586:1: D400 First line should end with a period
        """检查是否允许请求"""
^
src/monitoring/multi_channel_alert_manager.py:591:80: E501 line too long (87 > 79 characters)
        self.requests = [req_time for req_time in self.requests if req_time > hour_ago]
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:602:1: D400 First line should end with a period
        """检查是否被限制"""
^
src/monitoring/multi_channel_alert_manager.py:612:1: D400 First line should end with a period
    """多渠道告警管理器"""
^
src/monitoring/multi_channel_alert_manager.py:614:1: D107 Missing docstring in __init__
    def __init__(self, config: Optional[Dict[str, Any]] = None):
^
src/monitoring/multi_channel_alert_manager.py:625:1: D400 First line should end with a period
        """获取默认配置"""
^
src/monitoring/multi_channel_alert_manager.py:635:1: D202 No blank lines allowed after function docstring
        """初始化默认处理器"""
^
src/monitoring/multi_channel_alert_manager.py:635:1: D400 First line should end with a period
        """初始化默认处理器"""
^
src/monitoring/multi_channel_alert_manager.py:648:1: D202 No blank lines allowed after function docstring
        """添加告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:648:1: D400 First line should end with a period
        """添加告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:659:1: D202 No blank lines allowed after function docstring
        """移除告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:659:1: D400 First line should end with a period
        """移除告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:668:1: D202 No blank lines allowed after function docstring
        """发送告警到所有启用的处理器"""
^
src/monitoring/multi_channel_alert_manager.py:668:1: D400 First line should end with a period
        """发送告警到所有启用的处理器"""
^
src/monitoring/multi_channel_alert_manager.py:681:80: E501 line too long (81 > 79 characters)
                task = asyncio.create_task(self._send_with_retry(handler, alert))
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:703:80: E501 line too long (82 > 79 characters)
    async def _send_with_retry(self, handler: AlertHandler, alert: Alert) -> bool:
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:704:1: D202 No blank lines allowed after function docstring
        """带重试的发送"""
^
src/monitoring/multi_channel_alert_manager.py:704:1: D400 First line should end with a period
        """带重试的发送"""
^
src/monitoring/multi_channel_alert_manager.py:730:1: D202 No blank lines allowed after function docstring
        """记录告警历史"""
^
src/monitoring/multi_channel_alert_manager.py:730:1: D400 First line should end with a period
        """记录告警历史"""
^
src/monitoring/multi_channel_alert_manager.py:741:80: E501 line too long (83 > 79 characters)
            "failure_count": sum(1 for success in results.values() if not success),
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:748:80: E501 line too long (87 > 79 characters)
            self.alert_history = self.alert_history[-self.config["max_history_size"] :]
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:748:85: E203 whitespace before ':'
            self.alert_history = self.alert_history[-self.config["max_history_size"] :]
                                                                                    ^
src/monitoring/multi_channel_alert_manager.py:751:1: D202 No blank lines allowed after function docstring
        """获取统计信息"""
^
src/monitoring/multi_channel_alert_manager.py:751:1: D400 First line should end with a period
        """获取统计信息"""
^
src/monitoring/multi_channel_alert_manager.py:785:80: E501 line too long (87 > 79 characters)
            "success_rate": f"{(successful_alerts / max(1, total_alerts) * 100):.1f}%",
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:802:1: D202 No blank lines allowed after function docstring
        """添加邮件处理器"""
^
src/monitoring/multi_channel_alert_manager.py:802:1: D400 First line should end with a period
        """添加邮件处理器"""
^
src/monitoring/multi_channel_alert_manager.py:826:1: D202 No blank lines allowed after function docstring
        """添加Webhook处理器"""
^
src/monitoring/multi_channel_alert_manager.py:826:1: D400 First line should end with a period
        """添加Webhook处理器"""
^
src/monitoring/multi_channel_alert_manager.py:833:80: E501 line too long (83 > 79 characters)
                severity_filter=severity_filter or ["critical", "warning", "info"],
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:850:1: D202 No blank lines allowed after function docstring
        """添加日志处理器"""
^
src/monitoring/multi_channel_alert_manager.py:850:1: D400 First line should end with a period
        """添加日志处理器"""
^
src/monitoring/multi_channel_alert_manager.py:857:80: E501 line too long (83 > 79 characters)
                severity_filter=severity_filter or ["critical", "warning", "info"],
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:868:1: D202 No blank lines allowed after function docstring
        """导出配置"""
^
src/monitoring/multi_channel_alert_manager.py:868:1: D400 First line should end with a period
        """导出配置"""
^
src/monitoring/multi_channel_alert_manager.py:893:80: E501 line too long (81 > 79 characters)
        return json.dumps(config_data, indent=2, default=str, ensure_ascii=False)
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:896:1: D202 No blank lines allowed after function docstring
        """导入配置"""
^
src/monitoring/multi_channel_alert_manager.py:896:1: D400 First line should end with a period
        """导入配置"""
^
src/monitoring/multi_channel_alert_manager.py:913:80: E501 line too long (82 > 79 characters)
                        email_config = EmailConfig(**handler_data["email_config"])
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:916:80: E501 line too long (88 > 79 characters)
                        webhook_config = WebhookConfig(**handler_data["webhook_config"])
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:947:1: D400 First line should end with a period
    """获取多渠道告警管理器单例"""
^
src/monitoring/multi_channel_alert_manager.py:958:1: D400 First line should end with a period
    """发送告警到所有渠道"""
^
src/monitoring/multi_channel_alert_manager.py:964:1: D400 First line should end with a period
    """添加邮件告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:969:80: E501 line too long (80 > 79 characters)
def add_webhook_alert_handler(name: str, webhook_config: WebhookConfig) -> bool:
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:970:1: D400 First line should end with a period
    """添加Webhook告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:976:1: D400 First line should end with a period
    """添加日志告警处理器"""
^
src/monitoring/multi_channel_alert_manager.py:984:1: D103 Missing docstring in public function
    async def main():
^
src/monitoring/multi_channel_alert_manager.py:1007:80: E501 line too long (84 > 79 characters)
            url="https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK", method="POST"
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:1016:1: S108 Probable insecure usage of temp file/directory.
            file_path="/tmp/mystocks_alerts.log",
^
src/monitoring/multi_channel_alert_manager.py:1022:80: E501 line too long (83 > 79 characters)
        from src.monitoring.ai_alert_manager import Alert, AlertSeverity, AlertType
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:1031:80: E501 line too long (88 > 79 characters)
            metrics={"current_value": 95.0, "threshold": 80.0, "duration_seconds": 120},
                                                                               ^
src/monitoring/multi_channel_alert_manager.py:1034:15: F541 f-string is missing placeholders
        print(f"\n🔔 发送测试告警...")
              ^
src/monitoring/multi_channel_alert_manager.py:1037:15: F541 f-string is missing placeholders
        print(f"发送结果:")
              ^
src/monitoring/multi_channel_alert_manager.py:1043:15: F541 f-string is missing placeholders
        print(f"\n📊 统计信息:")
              ^
src/monitoring/multi_channel_alert_manager.py:1049:15: F541 f-string is missing placeholders
        print(f"\n💾 导出配置...")
              ^
src/monitoring/multi_channel_alert_manager.py:1053:15: F541 f-string is missing placeholders
        print(f"\n🎉 演示完成!")
              ^
src/monitoring/performance_monitor.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：性能监控模块，跟踪查询时间、慢查询和性能指标
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/monitoring/performance_monitor.py:1:1: D400 First line should end with a period
"""
# 功能：性能监控模块，跟踪查询时间、慢查询和性能指标
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/monitoring/performance_monitor.py:27:1: D400 First line should end with a period
    """
    性能监控器

    负责跟踪和记录所有数据库操作的性能指标,
    自动检测慢查询并生成告警。
    """
^
src/monitoring/performance_monitor.py:41:1: D400 First line should end with a period
        """
        初始化性能监控器

        Args:
            monitoring_db: 监控数据库实例 (可选)
        """
^
src/monitoring/performance_monitor.py:63:1: D400 First line should end with a period
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:65:1: RST214 Inline literal start-string without end-string.
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:65:1: RST215 Inline interpreted text or phrase reference start-string without end-string.
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:68:1: RST301 Unexpected indentation.
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:68:80: E501 line too long (87 > 79 characters)
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """





              ^
src/monitoring/performance_monitor.py:70:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:70:1: RST214 Inline literal start-string without end-string.
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:70:1: RST215 Inline interpreted text or phrase reference start-string without end-string.
        """
        跟踪操作性能的上下文管理器

        用法:
        ```python
        with monitor.track_operation('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL'):
            # 执行数据库操作
            result = execute_query()
        ```

        Args:
            operation_name: 操作名称
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
            query_sql: SQL语句
            auto_alert: 是否自动告警慢查询
        """
^
src/monitoring/performance_monitor.py:89:13: F841 local variable 'error_message' is assigned to but never used
            error_message = str(e)
            ^
src/monitoring/performance_monitor.py:109:80: E501 line too long (80 > 79 characters)
            if auto_alert and execution_time_ms >= self.SLOW_QUERY_THRESHOLD_MS:
                                                                               ^
src/monitoring/performance_monitor.py:135:1: D400 First line should end with a period
        """记录性能指标"""
^
src/monitoring/performance_monitor.py:164:1: D400 First line should end with a period
        """告警慢查询"""
^
src/monitoring/performance_monitor.py:167:80: E501 line too long (87 > 79 characters)
            f"查询执行时间过长: {execution_time_ms}ms (阈值: {self.SLOW_QUERY_THRESHOLD_MS}ms)\n"
                                                                               ^
src/monitoring/performance_monitor.py:201:1: D400 First line should end with a period
        """
        记录数据库连接时间

        Args:
            database_type: 数据库类型
            connection_time_ms: 连接时间(毫秒)
            connection_status: 连接状态 (SUCCESS/FAILED)
        """
^
src/monitoring/performance_monitor.py:233:1: D400 First line should end with a period
        """
        记录批量操作性能

        Args:
            operation_name: 操作名称
            batch_size: 批量大小
            execution_time_ms: 执行时间(毫秒)
            classification: 数据分类
            database_type: 数据库类型
            table_name: 表名
        """
^
src/monitoring/performance_monitor.py:275:1: D400 First line should end with a period
        """
        获取性能摘要

        Args:
            hours: 统计时间范围（小时）

        Returns:
            dict: 性能摘要
        """
^
src/monitoring/performance_monitor.py:286:80: E501 line too long (82 > 79 characters)
            from src.monitoring.monitoring_database import get_monitoring_database
                                                                               ^
src/monitoring/performance_monitor.py:338:1: D400 First line should end with a period
        """
        记录操作性能 (兼容旧接口)

        Args:
            operation: 操作类型 (如 'save_data', 'load_data')
            classification: 数据分类
            duration_ms: 执行时间(毫秒)
            success: 操作是否成功
            **kwargs: 其他参数
        """
^
src/monitoring/performance_monitor.py:341:1: RST210 Inline strong start-string without end-string.
        """
        记录操作性能 (兼容旧接口)

        Args:
            operation: 操作类型 (如 'save_data', 'load_data')
            classification: 数据分类
            duration_ms: 执行时间(毫秒)
            success: 操作是否成功
            **kwargs: 其他参数
        """
^
src/monitoring/performance_monitor.py:373:1: D400 First line should end with a period
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:375:1: RST214 Inline literal start-string without end-string.
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:375:1: RST215 Inline interpreted text or phrase reference start-string without end-string.
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:378:80: E501 line too long (89 > 79 characters)
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """





                                    ^
src/monitoring/performance_monitor.py:379:1: RST301 Unexpected indentation.
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:381:1: RST201 Block quote ends without a blank line; unexpected unindent.
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:381:1: RST214 Inline literal start-string without end-string.
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:381:1: RST215 Inline interpreted text or phrase reference start-string without end-string.
    """
    性能跟踪装饰器

    用法:
    ```python
    @performance_tracked('query_daily_kline', 'DAILY_KLINE', 'PostgreSQL', 'daily_kline')
    def query_data():
        # 执行查询
        pass
    ```
    """
^
src/monitoring/performance_monitor.py:407:1: D400 First line should end with a period
    """获取全局性能监控器实例 (单例模式)"""
^
src/monitoring/performance_monitor.py:477:80: E501 line too long (87 > 79 characters)
    @performance_tracked("decorated_query", "DAILY_KLINE", "PostgreSQL", "daily_kline")
                                                                               ^
src/monitoring/performance_monitor.py:478:1: D103 Missing docstring in public function
    def test_decorated_function():
^
src/reporting/__init__.py:1:1: D400 First line should end with a period
"""
报告生成模块 (Reporting Module)

提供专业的PDF报告生成功能:
- 策略回测报告
- 月度/季度报告
- 性能分析报告

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/reporting/pdf_generator.py:1:1: D400 First line should end with a period
"""
PDF报告生成器 (PDF Report Generator)

功能说明:
- 自动生成专业的策略回测报告
- 包含性能指标、风险指标、图表
- 支持中文字体
- 自定义模板和样式

使用ReportLab库生成PDF报告

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/reporting/pdf_generator.py:22:1: E402 module level import not at top of file
from typing import Dict, List, Optional
^
src/reporting/pdf_generator.py:23:1: E402 module level import not at top of file
from datetime import datetime
^
src/reporting/pdf_generator.py:24:1: E402 module level import not at top of file
import logging
^
src/reporting/pdf_generator.py:28:5: F401 'reportlab.lib.pagesizes.letter' imported but unused
    from reportlab.lib.pagesizes import A4, letter
    ^
src/reporting/pdf_generator.py:32:5: F401 'reportlab.platypus.KeepTogether' imported but unused
    from reportlab.platypus import (
    ^
src/reporting/pdf_generator.py:42:5: F401 'reportlab.lib.enums.TA_LEFT' imported but unused
    from reportlab.lib.enums import TA_CENTER, TA_LEFT, TA_RIGHT
    ^
src/reporting/pdf_generator.py:42:5: F401 'reportlab.lib.enums.TA_RIGHT' imported but unused
    from reportlab.lib.enums import TA_CENTER, TA_LEFT, TA_RIGHT
    ^
src/reporting/pdf_generator.py:54:1: D400 First line should end with a period
    """
    PDF报告生成器

    功能:
    - 策略回测报告
    - 性能分析报告
    - 月度/季度报告
    - 自定义模板
    """
^
src/reporting/pdf_generator.py:65:1: D400 First line should end with a period
        """
        初始化PDF生成器

        参数:
            font_path: 中文字体路径（可选）
            page_size: 页面大小（默认A4）
        """
^
src/reporting/pdf_generator.py:89:1: D400 First line should end with a period
        """注册中文字体"""
^
src/reporting/pdf_generator.py:105:1: D400 First line should end with a period
        """设置样式"""
^
src/reporting/pdf_generator.py:115:80: E501 line too long (87 > 79 characters)
                fontName="SimSun" if self.chinese_font_available else "Helvetica-Bold",
                                                                               ^
src/reporting/pdf_generator.py:128:80: E501 line too long (87 > 79 characters)
                fontName="SimSun" if self.chinese_font_available else "Helvetica-Bold",
                                                                               ^
src/reporting/pdf_generator.py:139:80: E501 line too long (82 > 79 characters)
                fontName="SimSun" if self.chinese_font_available else "Helvetica",
                                                                               ^
src/reporting/pdf_generator.py:150:1: D400 First line should end with a period
        """
        生成回测报告PDF

        参数:
            result: 回测结果字典
            strategy_name: 策略名称
            output_path: 输出路径
            chart_paths: 图表路径字典

        返回:
            str: 生成的PDF路径
        """
^
src/reporting/pdf_generator.py:215:1: D400 First line should end with a period
        """构建封面"""
^
src/reporting/pdf_generator.py:220:80: E501 line too long (87 > 79 characters)
            f"Strategy Backtest Report<br/>{strategy_name}", self.styles["CustomTitle"]
                                                                               ^
src/reporting/pdf_generator.py:248:80: E501 line too long (80 > 79 characters)
                    ("BACKGROUND", (0, 0), (-1, 0), colors.HexColor("#1f77b4")),
                                                                               ^
src/reporting/pdf_generator.py:265:1: D400 First line should end with a period
        """构建执行摘要"""
^
src/reporting/pdf_generator.py:268:80: E501 line too long (84 > 79 characters)
        elements.append(Paragraph("Executive Summary", self.styles["SectionTitle"]))
                                                                               ^
src/reporting/pdf_generator.py:271:9: F841 local variable 'risk' is assigned to but never used
        risk = result.get("risk", {})
        ^
src/reporting/pdf_generator.py:274:80: E501 line too long (89 > 79 characters)
        summary_text = f"""
        The strategy achieved a total return of {metrics.get('total_return', 0)*100:.2f}%
        with a Sharpe ratio of {metrics.get('sharpe_ratio', 0):.2f}.
        The maximum drawdown was {metrics.get('max_drawdown', 0)*100:.2f}%,
        indicating {self._assess_risk(metrics.get('max_drawdown', 0))} risk level.

        Annual volatility: {metrics.get('annual_volatility', 0)*100:.2f}%<br/>
        Win rate: {metrics.get('win_rate', 0)*100:.2f}%<br/>
        Profit factor: {metrics.get('profit_factor', 0):.2f}
        """

                                                   ^
src/reporting/pdf_generator.py:277:80: E501 line too long (82 > 79 characters)
        summary_text = f"""
        The strategy achieved a total return of {metrics.get('total_return', 0)*100:.2f}%
        with a Sharpe ratio of {metrics.get('sharpe_ratio', 0):.2f}.
        The maximum drawdown was {metrics.get('max_drawdown', 0)*100:.2f}%,
        indicating {self._assess_risk(metrics.get('max_drawdown', 0))} risk level.

        Annual volatility: {metrics.get('annual_volatility', 0)*100:.2f}%<br/>
        Win rate: {metrics.get('win_rate', 0)*100:.2f}%<br/>
        Profit factor: {metrics.get('profit_factor', 0):.2f}
        """

                                                   ^
src/reporting/pdf_generator.py:289:1: D400 First line should end with a period
        """构建性能指标部分"""
^
src/reporting/pdf_generator.py:292:80: E501 line too long (86 > 79 characters)
        elements.append(Paragraph("Performance Metrics", self.styles["SectionTitle"]))
                                                                               ^
src/reporting/pdf_generator.py:304:80: E501 line too long (85 > 79 characters)
            ["Annual Volatility", f"{metrics.get('annual_volatility', 0)*100:.2f}%"],
                                                                               ^
src/reporting/pdf_generator.py:315:1: D400 First line should end with a period
        """构建风险指标部分"""
^
src/reporting/pdf_generator.py:325:80: E501 line too long (86 > 79 characters)
            ["Max Drawdown Duration", f"{risk.get('max_drawdown_duration', 0)} days"],
                                                                               ^
src/reporting/pdf_generator.py:328:80: E501 line too long (84 > 79 characters)
            ["Downside Deviation", f"{risk.get('downside_deviation', 0)*100:.2f}%"],
                                                                               ^
src/reporting/pdf_generator.py:339:1: D400 First line should end with a period
        """构建交易统计部分"""
^
src/reporting/pdf_generator.py:342:80: E501 line too long (85 > 79 characters)
        elements.append(Paragraph("Trading Statistics", self.styles["SectionTitle"]))
                                                                               ^
src/reporting/pdf_generator.py:365:1: D400 First line should end with a period
        """构建图表部分"""
^
src/reporting/pdf_generator.py:377:80: E501 line too long (85 > 79 characters)
                        chart_name.replace("_", " ").title(), self.styles["Heading3"]
                                                                               ^
src/reporting/pdf_generator.py:392:1: D400 First line should end with a period
        """构建页脚"""
^
src/reporting/pdf_generator.py:409:1: D400 First line should end with a period
        """获取表格样式"""
^
src/reporting/pdf_generator.py:430:1: D400 First line should end with a period
        """评估风险等级"""
^
src/reporting/pdf_generator.py:441:1: D400 First line should end with a period
        """
        生成月度报告

        参数:
            data: 月度数据
            output_path: 输出路径

        返回:
            str: PDF路径
        """
^
src/reporting/pdf_generator.py:527:1: S108 Probable insecure usage of temp file/directory.
    output_path = "/tmp/backtest_report.pdf"
^
src/routes/dashboard_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI路由文件：Dashboard相关API
提供Dashboard页面所需的全部API端点

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/dashboard_routes.py:1:1: D400 First line should end with a period
"""
FastAPI路由文件：Dashboard相关API
提供Dashboard页面所需的全部API端点

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/dashboard_routes.py:46:1: D103 Missing docstring in public function
    def get_market_stats():
^
src/routes/dashboard_routes.py:49:1: D103 Missing docstring in public function
    def get_market_heat_data():
^
src/routes/dashboard_routes.py:54:1: D103 Missing docstring in public function
    def get_leading_sectors():
^
src/routes/dashboard_routes.py:58:1: D103 Missing docstring in public function
    def get_price_distribution():
^
src/routes/dashboard_routes.py:62:1: D103 Missing docstring in public function
    def get_capital_flow_data():
^
src/routes/dashboard_routes.py:66:1: D103 Missing docstring in public function
    def get_industry_fund_flow(standard="csrc"):
^
src/routes/dashboard_routes.py:70:1: D103 Missing docstring in public function
    def get_favorite_stocks():
^
src/routes/dashboard_routes.py:74:1: D103 Missing docstring in public function
    def get_strategy_stocks():
^
src/routes/dashboard_routes.py:78:1: D103 Missing docstring in public function
    def get_industry_stocks():
^
src/routes/dashboard_routes.py:82:1: D103 Missing docstring in public function
    def get_concept_stocks():
^
src/routes/dashboard_routes.py:91:1: D400 First line should end with a period
    """
    获取市场概览数据（Dashboard核心API）

    返回：
        Dict: 包含市场统计、热度数据、板块表现等综合数据
    """
^
src/routes/dashboard_routes.py:136:1: D400 First line should end with a period
    """
    获取市场统计数据

    返回：
        Dict: 市场统计数据（对应Dashboard顶部4个卡片）
    """
^
src/routes/dashboard_routes.py:154:28: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: Optional[int] = Query(default=20, description="返回数量限制")
                           ^
src/routes/dashboard_routes.py:156:1: D400 First line should end with a period
    """
    获取市场热度数据

    参数：
        limit: int - 返回数量限制

    返回：
        List[Dict]: 市场热度数据
    """
^
src/routes/dashboard_routes.py:184:1: D400 First line should end with a period
    """
    获取领涨板块数据

    返回：
        List[Dict]: 领涨板块数据
    """
^
src/routes/dashboard_routes.py:206:1: D400 First line should end with a period
    """
    获取涨跌分布数据

    返回：
        List[Dict]: 涨跌分布数据
    """
^
src/routes/dashboard_routes.py:218:28: F541 f-string is missing placeholders
                "message": f"获取涨跌分布数据成功",
                           ^
src/routes/dashboard_routes.py:228:1: D400 First line should end with a period
    """
    获取资金流向数据

    返回：
        List[Dict]: 资金流向数据
    """
^
src/routes/dashboard_routes.py:240:28: F541 f-string is missing placeholders
                "message": f"获取资金流向数据成功",
                           ^
src/routes/dashboard_routes.py:249:1: F811 redefinition of unused 'get_industry_fund_flow' from line 66
async def get_industry_fund_flow(
^
src/routes/dashboard_routes.py:250:21: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    standard: str = Query(default="csrc", description="行业分类标准")
                    ^
src/routes/dashboard_routes.py:252:1: D400 First line should end with a period
    """
    获取行业资金流向数据

    参数：
        standard: str - 行业分类标准 (csrc/sw_l1/sw_l2)

    返回：
        Dict: 行业资金流向数据
    """
^
src/routes/dashboard_routes.py:283:28: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: Optional[int] = Query(default=10, description="返回数量限制"),
                           ^
src/routes/dashboard_routes.py:285:1: D400 First line should end with a period
    """
    获取特定类型的股票数据

    参数：
        stock_type: str - 股票类型 (favorite/strategy/industry/concept)
        limit: int - 返回数量限制

    返回：
        List[Dict]: 股票数据列表
    """
^
src/routes/monitoring_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI路由文件: Monitoring
功能: 实时监控相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/monitoring_routes.py:1:1: D400 First line should end with a period
"""
FastAPI路由文件: Monitoring
功能: 实时监控相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/monitoring_routes.py:23:1: D400 First line should end with a period
    """检查是否使用Mock数据

    Returns:
        bool: 是否使用Mock数据
    """
^
src/routes/monitoring_routes.py:32:1: D400 First line should end with a period
    """获取监控Mock数据模块

    Returns:
        module: Mock数据模块
    """
^
src/routes/monitoring_routes.py:55:1: D400 First line should end with a period
    """获取数据库服务（真实数据源）

    Returns:
        object: 数据库服务实例
    """
^
src/routes/monitoring_routes.py:72:1: D400 First line should end with a period
    """获取告警规则列表

    Returns:
        Dict: 告警规则列表
    """
^
src/routes/monitoring_routes.py:104:80: E501 line too long (80 > 79 characters)
                    "conditions": {"volume_multiplier": 2.0, "period": "daily"},
                                                                               ^
src/routes/monitoring_routes.py:133:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 监控告警列表")
                            ^
src/routes/monitoring_routes.py:161:1: D400 First line should end with a period
    """获取告警记录

    Returns:
        Dict: 告警记录列表
    """
^
src/routes/monitoring_routes.py:199:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 实时行情数据")
                            ^
src/routes/monitoring_routes.py:232:1: D400 First line should end with a period
    """获取实时行情数据

    Returns:
        Dict: 实时行情数据
    """
^
src/routes/monitoring_routes.py:244:25: F541 f-string is missing placeholders
            logger.info(f"Mock数据响应: 市场概览数据")
                        ^
src/routes/monitoring_routes.py:270:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 监控摘要")
                            ^
src/routes/monitoring_routes.py:298:1: D400 First line should end with a period
    """获取指定股票实时数据

    Args:
        symbol: str - 股票代码

    Returns:
        Dict: 指定股票实时数据
    """
^
src/routes/monitoring_routes.py:318:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "change": round(random.uniform(-5, 5), 2),
^
src/routes/monitoring_routes.py:319:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "change_pct": round(random.uniform(-3, 3), 2),
^
src/routes/monitoring_routes.py:320:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "volume": random.randint(10000, 1000000),
^
src/routes/monitoring_routes.py:321:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
                "turnover": round(random.uniform(1000000, 50000000), 2),
^
src/routes/monitoring_routes.py:350:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 龙虎榜数据")
                            ^
src/routes/monitoring_routes.py:383:1: D400 First line should end with a period
    """获取龙虎榜数据

    Returns:
        Dict: 龙虎榜数据
    """
^
src/routes/monitoring_routes.py:395:25: F541 f-string is missing placeholders
            logger.info(f"Mock数据响应: 龙虎榜数据")
                        ^
src/routes/monitoring_routes.py:421:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 个股监控数据")
                            ^
src/routes/monitoring_routes.py:454:1: D400 First line should end with a period
    """获取监控摘要

    Returns:
        Dict: 监控摘要数据
    """
^
src/routes/monitoring_routes.py:466:25: F541 f-string is missing placeholders
            logger.info(f"Mock数据响应: 市场统计")
                        ^
src/routes/monitoring_routes.py:492:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 监控统计")
                            ^
src/routes/monitoring_routes.py:520:1: D400 First line should end with a period
    """获取今日统计数据

    Returns:
        Dict: 今日统计数据
    """
^
src/routes/monitoring_routes.py:575:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 告警记录")
                            ^
src/routes/monitoring_routes.py:608:1: D400 First line should end with a period
    """启动监控

    Returns:
        Dict: 启动结果
    """
^
src/routes/monitoring_routes.py:669:1: D400 First line should end with a period
    """停止监控

    Returns:
        Dict: 停止结果
    """
^
src/routes/monitoring_routes.py:730:1: D400 First line should end with a period
    """获取监控状态

    Returns:
        Dict: 监控状态信息
    """
^
src/routes/monitoring_routes.py:774:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 实时监控数据")
                            ^
src/routes/monitoring_routes.py:802:1: D400 First line should end with a period
    """检查监控服务健康状态

    Returns:
        Dict: 健康状态信息
    """
^
src/routes/stocks_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI路由文件: Stocks
功能: 股票管理相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/stocks_routes.py:1:1: D400 First line should end with a period
"""
FastAPI路由文件: Stocks
功能: 股票管理相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/stocks_routes.py:24:1: D400 First line should end with a period
    """检查是否使用Mock数据

    Returns:
        bool: 是否使用Mock数据
    """
^
src/routes/stocks_routes.py:33:1: D400 First line should end with a period
    """获取股票管理Mock数据模块

    Returns:
        module: Mock数据模块
    """
^
src/routes/stocks_routes.py:66:1: D400 First line should end with a period
    """获取数据库服务（真实数据源）

    Returns:
        object: 数据库服务实例
    """
^
src/routes/stocks_routes.py:78:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    page: int = Query(1, description="页码"),
                ^
src/routes/stocks_routes.py:79:18: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: int = Query(20, description="每页数量"),
                 ^
src/routes/stocks_routes.py:80:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    exchange: Optional[str] = Query(None, description="交易所筛选"),
                              ^
src/routes/stocks_routes.py:81:31: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    industry: Optional[str] = Query(None, description="行业筛选"),
                              ^
src/routes/stocks_routes.py:83:1: D400 First line should end with a period
    """获取股票列表

    Args:
        page: int - 页码
        limit: int - 每页数量
        exchange: str - 交易所筛选
        industry: str - 行业筛选

    Returns:
        Dict: 股票列表数据
    """
^
src/routes/stocks_routes.py:96:80: E501 line too long (91 > 79 characters)
            f"获取股票列表: page={page}, limit={limit}, exchange={exchange}, industry={industry}"
                                                                               ^
src/routes/stocks_routes.py:175:1: D400 First line should end with a period
    """获取股票详细信息

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 股票详细信息
    """
^
src/routes/stocks_routes.py:244:1: D400 First line should end with a period
    """获取股票财务数据

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 股票财务数据
    """
^
src/routes/stocks_routes.py:258:80: E501 line too long (86 > 79 characters)
            result = mock_data["get_stock_financial_data"]({"stock_code": stock_code})
                                                                               ^
src/routes/stocks_routes.py:284:80: E501 line too long (84 > 79 characters)
                result = db_service.get_technical_indicators({"symbol": stock_code})
                                                                               ^
src/routes/stocks_routes.py:314:1: D400 First line should end with a period
    """获取股票技术指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 股票技术指标
    """
^
src/routes/stocks_routes.py:328:80: E501 line too long (82 > 79 characters)
            result = mock_data["get_stock_indicators"]({"stock_code": stock_code})
                                                                               ^
src/routes/stocks_routes.py:353:80: E501 line too long (84 > 79 characters)
                result = db_service.get_technical_indicators({"symbol": stock_code})
                                                                               ^
src/routes/stocks_routes.py:383:1: D400 First line should end with a period
    """获取实时行情数据

    Returns:
        Dict: 实时行情数据
    """
^
src/routes/stocks_routes.py:421:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 实时行情数据")
                            ^
src/routes/stocks_routes.py:449:14: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    q: str = Query(..., description="搜索关键词"),
             ^
src/routes/stocks_routes.py:450:18: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: int = Query(20, description="搜索结果数量"),
                 ^
src/routes/stocks_routes.py:452:1: D400 First line should end with a period
    """搜索股票

    Args:
        q: str - 搜索关键词
        limit: int - 搜索结果数量

    Returns:
        Dict: 搜索结果
    """
^
src/routes/stocks_routes.py:524:17: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    page: int = Query(1, description="页码"),
                ^
src/routes/stocks_routes.py:525:18: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: int = Query(20, description="每页数量"),
                 ^
src/routes/stocks_routes.py:527:1: D400 First line should end with a period
    """按行业获取股票

    Args:
        industry_name: str - 行业名称
        page: int - 页码
        limit: int - 每页数量

    Returns:
        Dict: 行业股票列表
    """
^
src/routes/stocks_routes.py:604:1: D400 First line should end with a period
    """获取自选股列表

    Returns:
        Dict: 自选股列表
    """
^
src/routes/stocks_routes.py:643:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 获取自选股列表")
                            ^
src/routes/stocks_routes.py:671:1: D400 First line should end with a period
    """添加到自选股

    Args:
        request: Dict - 请求参数：
                stock_code: str - 股票代码
                notes: str - 备注（可选）

    Returns:
        Dict: 添加结果
    """
^
src/routes/stocks_routes.py:746:1: D400 First line should end with a period
    """从自选股移除

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 移除结果
    """
^
src/routes/stocks_routes.py:760:80: E501 line too long (83 > 79 characters)
            result = mock_data["remove_from_watchlist"]({"stock_code": stock_code})
                                                                               ^
src/routes/stocks_routes.py:816:1: D400 First line should end with a period
    """检查股票服务健康状态

    Returns:
        Dict: 健康状态信息
    """
^
src/routes/strategy_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI路由文件: Strategy
功能: 策略管理相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/strategy_routes.py:1:1: D400 First line should end with a period
"""
FastAPI路由文件: Strategy
功能: 策略管理相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/strategy_routes.py:24:1: D400 First line should end with a period
    """检查是否使用Mock数据

    Returns:
        bool: 是否使用Mock数据
    """
^
src/routes/strategy_routes.py:33:1: D400 First line should end with a period
    """获取策略管理Mock数据模块

    Returns:
        module: Mock数据模块
    """
^
src/routes/strategy_routes.py:58:1: D400 First line should end with a period
    """获取数据库服务（真实数据源）

    Returns:
        object: 数据库服务实例
    """
^
src/routes/strategy_routes.py:70:1: D400 First line should end with a period
    """获取策略定义列表

    Returns:
        Dict: 策略定义列表
    """
^
src/routes/strategy_routes.py:108:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 策略定义列表")
                            ^
src/routes/strategy_routes.py:136:1: D400 First line should end with a period
    """运行单策略

    Args:
        request: Dict - 请求参数：
                strategy_code: str - 策略代码
                parameters: Dict - 策略参数
                date_range: Dict - 日期范围

    Returns:
        Dict: 策略运行结果
    """
^
src/routes/strategy_routes.py:183:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 单个策略执行")
                            ^
src/routes/strategy_routes.py:211:1: D400 First line should end with a period
    """批量运行策略

    Args:
        request: Dict - 请求参数：
                strategy_codes: List[str] - 策略代码列表
                parameters: Dict - 策略参数
                date_range: Dict - 日期范围

    Returns:
        Dict: 批量策略运行结果
    """
^
src/routes/strategy_routes.py:231:80: E501 line too long (106 > 79 characters)
                f"Mock数据响应: 处理{result.get('total_strategies', 0)}个策略，匹配{result.get('total_stocks', 0)}只股票"
                                                                               ^
src/routes/strategy_routes.py:260:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 批量策略执行")
                            ^
src/routes/strategy_routes.py:288:1: D400 First line should end with a period
    """获取策略结果

    Args:
        request: Dict - 请求参数：
                strategy_code: str - 策略代码
                limit: int - 限制数量
                offset: int - 偏移量

    Returns:
        Dict: 策略结果数据
    """
^
src/routes/strategy_routes.py:304:80: E501 line too long (81 > 79 characters)
        logger.info(f"获取策略结果: {strategy_code}, limit: {limit}, offset: {offset}")
                                                                               ^
src/routes/strategy_routes.py:336:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 策略执行结果")
                            ^
src/routes/strategy_routes.py:364:1: D400 First line should end with a period
    """获取匹配股票

    Args:
        request: Dict - 请求参数：
                strategy_code: str - 策略代码
                filters: Dict - 筛选条件

    Returns:
        Dict: 匹配股票数据
    """
^
src/routes/strategy_routes.py:410:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 匹配股票")
                            ^
src/routes/strategy_routes.py:438:1: D400 First line should end with a period
    """获取策略统计摘要

    Returns:
        Dict: 策略统计数据
    """
^
src/routes/strategy_routes.py:450:25: F541 f-string is missing placeholders
            logger.info(f"Mock数据响应: 统计成功")
                        ^
src/routes/strategy_routes.py:476:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 策略统计")
                            ^
src/routes/strategy_routes.py:504:1: D400 First line should end with a period
    """获取单个策略性能统计

    Args:
        strategy_code: str - 策略代码

    Returns:
        Dict: 策略性能数据
    """
^
src/routes/strategy_routes.py:532:80: E501 line too long (87 > 79 characters)
                        "date": (datetime.now() - datetime.timedelta(days=i)).strftime(
                                                                               ^
src/routes/strategy_routes.py:565:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 策略性能")
                            ^
src/routes/strategy_routes.py:593:1: D400 First line should end with a period
    """优化策略参数

    Args:
        strategy_code: str - 策略代码
        request: Dict - 优化参数

    Returns:
        Dict: 参数优化结果
    """
^
src/routes/strategy_routes.py:650:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 优化策略参数")
                            ^
src/routes/strategy_routes.py:678:1: D400 First line should end with a period
    """检查策略服务健康状态

    Returns:
        Dict: 健康状态信息
    """
^
src/routes/technical_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI路由文件: Technical
功能: 技术分析相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/technical_routes.py:1:1: D400 First line should end with a period
"""
FastAPI路由文件: Technical
功能: 技术分析相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/technical_routes.py:24:1: D400 First line should end with a period
    """检查是否使用Mock数据

    Returns:
        bool: 是否使用Mock数据
    """
^
src/routes/technical_routes.py:33:1: D400 First line should end with a period
    """获取技术分析Mock数据模块

    Returns:
        module: Mock数据模块
    """
^
src/routes/technical_routes.py:62:1: D400 First line should end with a period
    """获取数据库服务（真实数据源）

    Returns:
        object: 数据库服务实例
    """
^
src/routes/technical_routes.py:78:1: D400 First line should end with a period
    """获取所有技术指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 所有技术指标数据
    """
^
src/routes/technical_routes.py:92:80: E501 line too long (80 > 79 characters)
            result = mock_data["get_all_indicators"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:117:80: E501 line too long (84 > 79 characters)
                result = db_service.get_technical_indicators({"symbol": stock_code})
                                                                               ^
src/routes/technical_routes.py:147:1: D400 First line should end with a period
    """获取趋势指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 趋势指标数据
    """
^
src/routes/technical_routes.py:161:80: E501 line too long (82 > 79 characters)
            result = mock_data["get_trend_indicators"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:216:1: D400 First line should end with a period
    """获取动量指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 动量指标数据
    """
^
src/routes/technical_routes.py:230:80: E501 line too long (85 > 79 characters)
            result = mock_data["get_momentum_indicators"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:285:1: D400 First line should end with a period
    """获取波动性指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 波动性指标数据
    """
^
src/routes/technical_routes.py:299:80: E501 line too long (87 > 79 characters)
            result = mock_data["get_volatility_indicators"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:354:1: D400 First line should end with a period
    """获取成交量指标

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 成交量指标数据
    """
^
src/routes/technical_routes.py:368:80: E501 line too long (83 > 79 characters)
            result = mock_data["get_volume_indicators"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:423:1: D400 First line should end with a period
    """获取交易信号

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 交易信号数据
    """
^
src/routes/technical_routes.py:437:80: E501 line too long (81 > 79 characters)
            result = mock_data["get_trading_signals"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:492:1: D400 First line should end with a period
    """获取K线历史数据

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: K线历史数据
    """
^
src/routes/technical_routes.py:561:1: D400 First line should end with a period
    """获取形态识别结果

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 形态识别结果
    """
^
src/routes/technical_routes.py:575:80: E501 line too long (85 > 79 characters)
            result = mock_data["get_pattern_recognition"]({"stock_code": stock_code})
                                                                               ^
src/routes/technical_routes.py:600:80: E501 line too long (84 > 79 characters)
                # For pattern recognition, we'll use technical indicators as a proxy
                                                                               ^
src/routes/technical_routes.py:601:80: E501 line too long (84 > 79 characters)
                result = db_service.get_technical_indicators({"symbol": stock_code})
                                                                               ^
src/routes/technical_routes.py:637:1: D400 First line should end with a period
    """批量计算技术指标

    Args:
        request: Dict - 请求参数：
                stock_codes: List[str] - 股票代码列表
                indicators: List[str] - 指标类型列表

    Returns:
        Dict: 批量指标计算结果
    """
^
src/routes/technical_routes.py:699:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 批量计算技术指标")
                            ^
src/routes/technical_routes.py:727:1: D400 First line should end with a period
    """获取支撑阻力位

    Args:
        stock_code: str - 股票代码

    Returns:
        Dict: 支撑阻力位数据
    """
^
src/routes/technical_routes.py:781:80: E501 line too long (90 > 79 characters)
                # For support/resistance levels, we'll use technical indicators as a proxy
                                                                               ^
src/routes/technical_routes.py:793:80: E501 line too long (80 > 79 characters)
                    "support_levels": [95.0, 98.0, 101.0],  # Placeholder values
                                                                               ^
src/routes/technical_routes.py:794:80: E501 line too long (85 > 79 characters)
                    "resistance_levels": [105.0, 108.0, 112.0],  # Placeholder values
                                                                               ^
src/routes/technical_routes.py:826:1: D400 First line should end with a period
    """检查技术分析服务健康状态

    Returns:
        Dict: 健康状态信息
    """
^
src/routes/wencai_routes.py:1:1: D205 1 blank line required between summary line and description
"""
FastAPI路由文件: Wencai
功能: 问财筛选相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/wencai_routes.py:1:1: D400 First line should end with a period
"""
FastAPI路由文件: Wencai
功能: 问财筛选相关的API端点实现

作者: Claude Code
生成时间: 2025-11-13
"""
^
src/routes/wencai_routes.py:24:1: D400 First line should end with a period
    """检查是否使用Mock数据

    Returns:
        bool: 是否使用Mock数据
    """
^
src/routes/wencai_routes.py:33:1: D400 First line should end with a period
    """获取问财Mock数据模块

    Returns:
        module: Mock数据模块
    """
^
src/routes/wencai_routes.py:54:1: D400 First line should end with a period
    """获取数据库服务（真实数据源）

    Returns:
        object: 数据库服务实例
    """
^
src/routes/wencai_routes.py:66:1: D400 First line should end with a period
    """获取预定义查询列表

    Returns:
        Dict: 预定义查询列表
    """
^
src/routes/wencai_routes.py:107:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 预定义查询列表")
                            ^
src/routes/wencai_routes.py:135:1: D400 First line should end with a period
    """执行预定义查询

    Args:
        request: Dict - 查询参数：
                query_name: str - 查询名称
                pages: int - 页数

    Returns:
        Dict: 执行结果
    """
^
src/routes/wencai_routes.py:181:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 问财查询结果")
                            ^
src/routes/wencai_routes.py:209:1: D400 First line should end with a period
    """执行自定义问财查询

    Args:
        request: Dict - 查询参数：
                query_text: str - 自定义查询文本
                pages: int - 页数

    Returns:
        Dict: 自定义查询结果
    """
^
src/routes/wencai_routes.py:255:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 自定义查询结果")
                            ^
src/routes/wencai_routes.py:284:18: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    limit: int = Query(20, description="每页数量"),
                 ^
src/routes/wencai_routes.py:285:19: B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
    offset: int = Query(0, description="偏移量"),
                  ^
src/routes/wencai_routes.py:287:1: D400 First line should end with a period
    """获取问财查询结果

    Args:
        query_name: str - 查询名称
        limit: int - 每页数量
        offset: int - 偏移量

    Returns:
        Dict: 查询结果数据
    """
^
src/routes/wencai_routes.py:298:80: E501 line too long (80 > 79 characters)
        logger.info(f"获取问财查询结果: {query_name}, limit: {limit}, offset: {offset}")
                                                                               ^
src/routes/wencai_routes.py:336:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 获取查询结果")
                            ^
src/routes/wencai_routes.py:364:1: D400 First line should end with a period
    """刷新问财查询结果

    Args:
        query_name: str - 查询名称

    Returns:
        Dict: 刷新结果
    """
^
src/routes/wencai_routes.py:429:1: D400 First line should end with a period
    """获取问财查询历史记录

    Args:
        query_name: str - 查询名称

    Returns:
        Dict: 查询历史记录
    """
^
src/routes/wencai_routes.py:485:29: F541 f-string is missing placeholders
                logger.info(f"真实数据库查询成功: 获取查询历史")
                            ^
src/routes/wencai_routes.py:516:1: D400 First line should end with a period
    """检查问财服务健康状态

    Returns:
        Dict: 健康状态信息
    """
^
src/storage/__init__.py:1:1: D400 First line should end with a period
"""
Storage模块 - 数据存储和访问层

提供统一的数据存储访问接口：
- 数据库连接管理
- 连接池管理
- 数据访问层
"""
^
src/storage/__init__.py:10:80: E501 line too long (90 > 79 characters)
from .database.connection_manager import DatabaseConnectionManager, get_connection_manager
                                                                               ^
src/storage/__init__.py:17:2: W292 no newline at end of file
] ^
src/storage/access/__init__.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 数据访问层统一导出

向后兼容性模块，提供原始data_access.py的统一导入接口

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/__init__.py:46:1: D400 First line should end with a period
    """数据访问管理器 - 提供统一的数据访问入口"""
^
src/storage/access/__init__.py:49:1: D400 First line should end with a period
        """初始化数据访问管理器"""
^
src/storage/access/__init__.py:56:1: D400 First line should end with a period
        """初始化数据访问管理器"""
^
src/storage/access/__init__.py:63:1: D400 First line should end with a period
        """获取特定数据库类型的数据访问器"""
^
src/storage/access/__init__.py:85:1: D400 First line should end with a period
    """获取数据访问器"""
^
src/storage/access/__init__.py:91:1: D400 First line should end with a period
    """获取数据库名称 - 全局函数"""
^
src/storage/access/__init__.py:96:1: D400 First line should end with a period
    """标准化DataFrame - 全局函数"""
^
src/storage/access/akshare.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - Akshare数据访问器

专门处理从akshare获取的股票数据和市场信息

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/akshare.py:32:1: D400 First line should end with a period
    """Akshare数据访问器 - 从akshare获取股票数据和市场信息"""
^
src/storage/access/akshare.py:35:1: D400 First line should end with a period
        """
        初始化Akshare数据访问器

        Args:
            monitoring_db: 监控数据库实例
        """
^
src/storage/access/akshare.py:52:1: D400 First line should end with a period
        """
        保存从akshare获取的数据到数据库

        Args:
            data: 从akshare获取的数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/akshare.py:55:1: RST210 Inline strong start-string without end-string.
        """
        保存从akshare获取的数据到数据库

        Args:
            data: 从akshare获取的数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/akshare.py:65:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/akshare.py:75:80: E501 line too long (80 > 79 characters)
            processed_data = self._preprocess_akshare_data(data, classification)
                                                                               ^
src/storage/access/akshare.py:88:80: E501 line too long (80 > 79 characters)
                    normalized_data, classification, actual_table_name, **kwargs
                                                                               ^
src/storage/access/akshare.py:95:80: E501 line too long (80 > 79 characters)
                    normalized_data, classification, actual_table_name, **kwargs
                                                                               ^
src/storage/access/akshare.py:103:80: E501 line too long (83 > 79 characters)
                    f"保存akshare数据成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/storage/access/akshare.py:114:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/akshare.py:125:1: D400 First line should end with a period
        """
        从akshare获取数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 从akshare获取的数据
        """
^
src/storage/access/akshare.py:128:1: RST210 Inline strong start-string without end-string.
        """
        从akshare获取数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 从akshare获取的数据
        """
^
src/storage/access/akshare.py:138:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/akshare.py:156:80: E501 line too long (86 > 79 characters)
                end_date = kwargs.get("end_date", datetime.now().strftime("%Y-%m-%d"))
                                                                               ^
src/storage/access/akshare.py:163:80: E501 line too long (82 > 79 characters)
                data = self._fetch_generic_data(classification, filters, **kwargs)
                                                                               ^
src/storage/access/akshare.py:166:80: E501 line too long (81 > 79 characters)
            processed_data = self._postprocess_akshare_data(data, classification)
                                                                               ^
src/storage/access/akshare.py:172:80: E501 line too long (80 > 79 characters)
                f"从akshare获取数据成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/storage/access/akshare.py:179:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/akshare.py:191:1: D400 First line should end with a period
        """
        更新数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/storage/access/akshare.py:194:1: RST210 Inline strong start-string without end-string.
        """
        更新数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/storage/access/akshare.py:205:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/akshare.py:221:80: E501 line too long (80 > 79 characters)
            processed_data = self._preprocess_akshare_data(data, classification)
                                                                               ^
src/storage/access/akshare.py:264:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/akshare.py:275:1: D400 First line should end with a period
        """
        删除数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/storage/access/akshare.py:278:1: RST210 Inline strong start-string without end-string.
        """
        删除数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/storage/access/akshare.py:288:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/akshare.py:330:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/akshare.py:334:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/storage/access/akshare.py:335:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/storage/access/akshare.py:353:1: D400 First line should end with a period
        """
        根据数据分类确定目标数据库

        Args:
            classification: 数据分类

        Returns:
            数据库名称: "TDengine" 或 "PostgreSQL"
        """
^
src/storage/access/akshare.py:373:1: D400 First line should end with a period
        """应用请求频率限制"""
^
src/storage/access/akshare.py:385:1: D400 First line should end with a period
        """获取股票基本信息"""
^
src/storage/access/akshare.py:401:80: E501 line too long (82 > 79 characters)
    def _process_stock_basic_info(self, stock_info: pd.DataFrame) -> pd.DataFrame:
                                                                               ^
src/storage/access/akshare.py:402:1: D400 First line should end with a period
        """处理股票基本信息数据"""
^
src/storage/access/akshare.py:438:1: D400 First line should end with a period
        """获取日K线数据"""
^
src/storage/access/akshare.py:471:1: D400 First line should end with a period
        """处理日K线数据"""
^
src/storage/access/akshare.py:502:1: D400 First line should end with a period
        """获取实时行情数据"""
^
src/storage/access/akshare.py:536:80: E501 line too long (85 > 79 characters)
    def _process_realtime_quote_data(self, quote_data: pd.DataFrame) -> pd.DataFrame:
                                                                               ^
src/storage/access/akshare.py:537:1: D400 First line should end with a period
        """处理实时行情数据"""
^
src/storage/access/akshare.py:555:13: B041 Repeated key-value pair in dictionary literal.
            "涨跌幅": "change_pct",  # 注意这个字段可能有重复
            ^
src/storage/access/akshare.py:556:13: B041 Repeated key-value pair in dictionary literal.
            "涨跌额": "change",
            ^
src/storage/access/akshare.py:567:80: E501 line too long (80 > 79 characters)
        self, classification: DataClassification, filters: Dict = None, **kwargs
                                                                               ^
src/storage/access/akshare.py:569:1: D400 First line should end with a period
        """
        获取通用数据

        Args:
            classification: 数据分类
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 数据
        """
^
src/storage/access/akshare.py:572:1: RST210 Inline strong start-string without end-string.
        """
        获取通用数据

        Args:
            classification: 数据分类
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 数据
        """
^
src/storage/access/akshare.py:608:1: D400 First line should end with a period
        """获取技术指标数据"""
^
src/storage/access/akshare.py:655:1: D400 First line should end with a period
        """获取量化因子数据"""
^
src/storage/access/akshare.py:691:80: E501 line too long (85 > 79 characters)
                kline_data["volume_ma5"] = kline_data["成交量"].rolling(window=5).mean()
                                                                               ^
src/storage/access/akshare.py:710:1: D400 First line should end with a period
        """预处理akshare数据"""
^
src/storage/access/akshare.py:718:80: E501 line too long (80 > 79 characters)
                processed_data["symbol"] = processed_data["symbol"].str.replace(
                                                                               ^
src/storage/access/akshare.py:727:1: D400 First line should end with a period
        """后处理akshare数据"""
^
src/storage/access/akshare.py:732:80: E501 line too long (88 > 79 characters)
        timestamp_columns = ["fetch_timestamp", "ts", "timestamp", "trade_date", "date"]
                                                                               ^
src/storage/access/base.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 数据访问基础层

提供统一的数据访问接口和共享工具函数

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/base.py:28:1: D400 First line should end with a period
    """数据库类型枚举"""
^
src/storage/access/base.py:35:1: D400 First line should end with a period
    """数据访问层接口 - 所有数据访问器的抽象基类"""
^
src/storage/access/base.py:38:1: D400 First line should end with a period
        """
        初始化数据访问器

        Args:
            monitoring_db: 监控数据库实例
        """
^
src/storage/access/base.py:54:1: D400 First line should end with a period
        """
        保存数据到数据库

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/base.py:57:1: RST210 Inline strong start-string without end-string.
        """
        保存数据到数据库

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/base.py:76:1: D400 First line should end with a period
        """
        从数据库加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/base.py:79:1: RST210 Inline strong start-string without end-string.
        """
        从数据库加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/base.py:99:1: D400 First line should end with a period
        """
        更新数据库中的数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/storage/access/base.py:102:1: RST210 Inline strong start-string without end-string.
        """
        更新数据库中的数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/storage/access/base.py:122:1: D400 First line should end with a period
        """
        删除数据库中的数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/storage/access/base.py:125:1: RST210 Inline strong start-string without end-string.
        """
        删除数据库中的数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/storage/access/base.py:137:80: E501 line too long (85 > 79 characters)
def get_database_name_from_classification(classification: DataClassification) -> str:
                                                                               ^
src/storage/access/base.py:138:1: D400 First line should end with a period
    """
    从数据分类获取数据库名称

    Args:
        classification: 数据分类

    Returns:
        数据库名称字符串
    """
^
src/storage/access/base.py:162:1: D400 First line should end with a period
    """
    标准化DataFrame，确保所有必要字段存在且格式正确

    Args:
        data: 原始数据DataFrame

    Returns:
        pd.DataFrame: 标准化后的数据
    """
^
src/storage/access/base.py:197:1: D400 First line should end with a period
    """
    验证DataFrame是否符合特定数据分类的要求

    Args:
        data: 要验证的数据
        classification: 数据分类

    Returns:
        Tuple[bool, List[str]]: (验证是否通过, 错误消息列表)
    """
^
src/storage/access/base.py:226:1: D400 First line should end with a period
    """
    获取特定数据分类的必要字段

    Args:
        classification: 数据分类

    Returns:
        List[str]: 必要字段列表
    """
^
src/storage/access/base.py:256:80: E501 line too long (83 > 79 characters)
        DataClassification.REALTIME_QUOTES: ["symbol", "fetch_timestamp", "price"],
                                                                               ^
src/storage/access/base.py:299:80: E501 line too long (88 > 79 characters)
        DataClassification.ACCOUNT_FUNDS: ["account_id", "record_date", "cash_balance"],
                                                                               ^
src/storage/access/base.py:302:80: E501 line too long (86 > 79 characters)
    return required_fields_map.get(classification, ["id", "created_at", "updated_at"])
                                                                               ^
src/storage/access/base.py:306:1: D400 First line should end with a period
    """
    验证时序数据的有效性

    Args:
        data: 要验证的时序数据

    Returns:
        Tuple[bool, List[str]]: (验证是否通过, 错误消息列表)
    """
^
src/storage/access/base.py:345:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/access/data_access.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 统一数据访问层

向后兼容的接口，包含模块化拆分的数据访问器

设计理念：
1. 5大数据分类：市场数据、参考数据、衍生数据、交易数据、元数据
2. 自动路由：根据数据特性自动选择最适合的数据库
3. TDengine为高频数据核心：专门处理Tick和分钟级数据
4. 监控集成：所有操作自动记录到监控数据库
5. 配置驱动：表结构和访问模式完全由配置文件管理

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/__init__.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 数据访问模块

模块化拆分的数据访问层实现

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/base.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - 数据访问层基础模块

统一数据访问层的接口定义和公共工具函数

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/base.py:27:1: D400 First line should end with a period
    """数据访问层接口"""
^
src/storage/access/modules/base.py:37:1: D400 First line should end with a period
        """保存数据"""
^
src/storage/access/modules/base.py:48:1: D400 First line should end with a period
        """加载数据"""
^
src/storage/access/modules/base.py:60:1: D400 First line should end with a period
        """更新数据"""
^
src/storage/access/modules/base.py:71:1: D400 First line should end with a period
        """删除数据"""
^
src/storage/access/modules/base.py:76:1: D400 First line should end with a period
    """
    标准化DataFrame，确保列名和数据类型一致

    Args:
        data: 原始DataFrame

    Returns:
        标准化后的DataFrame
    """
^
src/storage/access/modules/base.py:100:80: E501 line too long (87 > 79 characters)
            normalized[col] = pd.to_numeric(normalized[col], errors="coerce").fillna(0)
                                                                               ^
src/storage/access/modules/base.py:106:80: E501 line too long (85 > 79 characters)
            normalized[col] = pd.to_numeric(normalized[col], errors="coerce").fillna(
                                                                               ^
src/storage/access/modules/base.py:110:80: E501 line too long (80 > 79 characters)
        elif any(name in col.lower() for name in ["timestamp", "date", "time"]):
                                                                               ^
src/storage/access/modules/base.py:128:1: D400 First line should end with a period
    """
    验证数据是否为有效的时序数据

    Args:
        data: 要验证的DataFrame

    Returns:
        bool: 是否为有效的时序数据
    """
^
src/storage/access/modules/base.py:144:80: E501 line too long (80 > 79 characters)
        if "time" in col.lower() or "date" in col.lower() or "ts" in col.lower()
                                                                               ^
src/storage/access/modules/base.py:157:80: E501 line too long (85 > 79 characters)
def get_database_name_from_classification(classification: DataClassification) -> str:
                                                                               ^
src/storage/access/modules/base.py:158:1: D400 First line should end with a period
    """
    根据数据分类获取数据库名称

    Args:
        classification: 数据分类

    Returns:
        数据库名称
    """
^
src/storage/access/modules/mysql.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - MySQL数据访问器

专门处理MySQL数据库的元数据和参考数据操作

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/mysql.py:22:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/storage/access/modules/mysql.py:30:1: D400 First line should end with a period
    """MySQL数据访问器 - 元数据与参考数据仓库"""
^
src/storage/access/modules/mysql.py:33:1: D400 First line should end with a period
        """
        初始化MySQL数据访问器

        Args:
            monitoring_db: 监控数据库
        """
^
src/storage/access/modules/mysql.py:50:1: D400 First line should end with a period
        """保存数据到MySQL，支持UPSERT操作"""
^
src/storage/access/modules/mysql.py:51:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/mysql.py:61:80: E501 line too long (82 > 79 characters)
            processed_data = self._preprocess_reference_data(data, classification)
                                                                               ^
src/storage/access/modules/mysql.py:107:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/mysql.py:118:1: D400 First line should end with a period
        """从MySQL加载数据"""
^
src/storage/access/modules/mysql.py:119:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/mysql.py:140:80: E501 line too long (83 > 79 characters)
            processed_data = self._postprocess_reference_data(data, classification)
                                                                               ^
src/storage/access/modules/mysql.py:153:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/mysql.py:165:1: D400 First line should end with a period
        """更新MySQL数据"""
^
src/storage/access/modules/mysql.py:167:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/mysql.py:179:80: E501 line too long (84 > 79 characters)
            update_columns = [col for col in data.columns if col not in key_columns]
                                                                               ^
src/storage/access/modules/mysql.py:188:1: S608 Possible SQL injection vector through string-based query construction.
                update_sql = f"""
                UPDATE {actual_table_name}
                SET {set_clause}
                WHERE {where_clause}
                """
^
src/storage/access/modules/mysql.py:189:43: W291 trailing whitespace
                update_sql = f"""
                UPDATE {actual_table_name}
                SET {set_clause}
                WHERE {where_clause}
                """

        ^
src/storage/access/modules/mysql.py:210:1: D400 First line should end with a period
        """删除MySQL数据（谨慎使用）"""
^
src/storage/access/modules/mysql.py:212:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/mysql.py:235:1: S608 Possible SQL injection vector through string-based query construction.
            delete_sql = f"DELETE FROM {actual_table_name} WHERE {where_clause}"
^
src/storage/access/modules/mysql.py:235:80: E501 line too long (80 > 79 characters)
            delete_sql = f"DELETE FROM {actual_table_name} WHERE {where_clause}"
                                                                               ^
src/storage/access/modules/mysql.py:246:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/storage/access/modules/mysql.py:247:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/storage/access/modules/mysql.py:258:1: D400 First line should end with a period
        """预处理参考数据"""
^
src/storage/access/modules/mysql.py:274:1: D400 First line should end with a period
        """后处理参考数据"""
^
src/storage/access/modules/mysql.py:287:1: D400 First line should end with a period
        """构建参考数据查询语句"""
^
src/storage/access/modules/mysql.py:288:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/storage/access/modules/mysql.py:332:1: D400 First line should end with a period
        """MySQL UPSERT操作 - 插入或更新数据"""
^
src/storage/access/modules/mysql.py:332:1: D403 First word of the first line should be properly capitalized
        """MySQL UPSERT操作 - 插入或更新数据"""
^
src/storage/access/modules/mysql.py:342:80: E501 line too long (84 > 79 characters)
            primary_key_columns = ["symbol"] if "symbol" in data.columns else ["id"]
                                                                               ^
src/storage/access/modules/mysql.py:354:80: E501 line too long (84 > 79 characters)
            set_columns = [col for col in columns if col not in primary_key_columns]
                                                                               ^
src/storage/access/modules/mysql.py:355:80: E501 line too long (85 > 79 characters)
            set_clause = ", ".join([f"{col} = VALUES({col})" for col in set_columns])
                                                                               ^
src/storage/access/modules/mysql.py:356:13: F841 local variable 'primary_key_clause' is assigned to but never used
            primary_key_clause = ", ".join(primary_key_columns)
            ^
src/storage/access/modules/mysql.py:359:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
            INSERT INTO {table_name} ({', '.join(columns)})
            VALUES ({placeholders})
            ON DUPLICATE KEY UPDATE {set_clause}
            """
^
src/storage/access/modules/mysql.py:377:80: E501 line too long (88 > 79 characters)
    def _get_primary_key_columns(self, classification: DataClassification) -> List[str]:
                                                                               ^
src/storage/access/modules/mysql.py:378:1: D400 First line should end with a period
        """根据数据分类获取主键列"""
^
src/storage/access/modules/mysql.py:386:80: E501 line too long (87 > 79 characters)
    def _get_constraint_columns(self, classification: DataClassification) -> List[str]:
                                                                               ^
src/storage/access/modules/mysql.py:387:1: D400 First line should end with a period
        """根据数据分类获取约束列"""
^
src/storage/access/modules/postgresql.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - PostgreSQL数据访问器

专门处理PostgreSQL数据库的历史数据和分析数据操作

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/postgresql.py:23:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/storage/access/modules/postgresql.py:31:1: D400 First line should end with a period
    """PostgreSQL数据访问器 - 历史数据仓库和分析"""
^
src/storage/access/modules/postgresql.py:34:1: D400 First line should end with a period
        """
        初始化PostgreSQL数据访问器

        Args:
            monitoring_db: 监控数据库
        """
^
src/storage/access/modules/postgresql.py:51:1: D400 First line should end with a period
        """
        保存数据到PostgreSQL

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/modules/postgresql.py:54:1: RST210 Inline strong start-string without end-string.
        """
        保存数据到PostgreSQL

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/modules/postgresql.py:64:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/postgresql.py:76:80: E501 line too long (83 > 79 characters)
            processed_data = self._preprocess_analytical_data(data, classification)
                                                                               ^
src/storage/access/modules/postgresql.py:110:80: E501 line too long (80 > 79 characters)
                f"PostgreSQL保存成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/storage/access/modules/postgresql.py:117:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/postgresql.py:128:1: D400 First line should end with a period
        """
        从PostgreSQL加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/modules/postgresql.py:131:1: RST210 Inline strong start-string without end-string.
        """
        从PostgreSQL加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/modules/postgresql.py:141:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/postgresql.py:162:80: E501 line too long (84 > 79 characters)
            processed_data = self._postprocess_analytical_data(data, classification)
                                                                               ^
src/storage/access/modules/postgresql.py:168:80: E501 line too long (80 > 79 characters)
                f"PostgreSQL加载成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/storage/access/modules/postgresql.py:175:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/postgresql.py:187:1: D400 First line should end with a period
        """更新PostgreSQL数据"""
^
src/storage/access/modules/postgresql.py:189:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/postgresql.py:201:80: E501 line too long (84 > 79 characters)
            update_columns = [col for col in data.columns if col not in key_columns]
                                                                               ^
src/storage/access/modules/postgresql.py:210:1: S608 Possible SQL injection vector through string-based query construction.
                update_sql = f"""
                UPDATE {actual_table_name}
                SET {set_clause}
                WHERE {where_clause}
                """
^
src/storage/access/modules/postgresql.py:211:43: W291 trailing whitespace
                update_sql = f"""
                UPDATE {actual_table_name}
                SET {set_clause}
                WHERE {where_clause}
                """

        ^
src/storage/access/modules/postgresql.py:232:1: D400 First line should end with a period
        """删除PostgreSQL数据（谨慎使用）"""
^
src/storage/access/modules/postgresql.py:234:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/postgresql.py:257:1: S608 Possible SQL injection vector through string-based query construction.
            delete_sql = f"DELETE FROM {actual_table_name} WHERE {where_clause}"
^
src/storage/access/modules/postgresql.py:257:80: E501 line too long (80 > 79 characters)
            delete_sql = f"DELETE FROM {actual_table_name} WHERE {where_clause}"
                                                                               ^
src/storage/access/modules/postgresql.py:268:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/storage/access/modules/postgresql.py:269:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/storage/access/modules/postgresql.py:282:1: D400 First line should end with a period
        """获取PostgreSQL引擎"""
^
src/storage/access/modules/postgresql.py:284:80: E501 line too long (84 > 79 characters)
        conn_info = self.db_manager.get_connection_info(self.db_type, database_name)
                                                                               ^
src/storage/access/modules/postgresql.py:287:80: E501 line too long (155 > 79 characters)
        connection_string = f"postgresql://{conn_info['username']}:{conn_info['password']}@{conn_info['host']}:{conn_info['port']}/{conn_info['database']}"
                                                                               ^
src/storage/access/modules/postgresql.py:295:1: D400 First line should end with a period
        """预处理分析数据"""
^
src/storage/access/modules/postgresql.py:310:1: D400 First line should end with a period
        """后处理分析数据"""
^
src/storage/access/modules/postgresql.py:329:1: D400 First line should end with a period
        """构建分析数据查询语句"""
^
src/storage/access/modules/postgresql.py:330:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/storage/access/modules/postgresql.py:377:1: D400 First line should end with a period
        """PostgreSQL的 IGNORE 逻辑实现 - 使用 ON CONFLICT DO NOTHING"""
^
src/storage/access/modules/postgresql.py:428:1: S608 Possible SQL injection vector through string-based query construction.
            sql = f"""
            INSERT INTO {table_name} ({columns_str})
            VALUES {values_str}
            ON CONFLICT ({conflict_columns_str}) DO NOTHING
            """
^
src/storage/access/modules/postgresql.py:448:80: E501 line too long (88 > 79 characters)
    def _get_primary_key_columns(self, classification: DataClassification) -> List[str]:
                                                                               ^
src/storage/access/modules/postgresql.py:449:1: D400 First line should end with a period
        """根据数据分类获取主键列"""
^
src/storage/access/modules/postgresql.py:465:80: E501 line too long (87 > 79 characters)
    def _get_constraint_columns(self, classification: DataClassification) -> List[str]:
                                                                               ^
src/storage/access/modules/postgresql.py:466:1: D400 First line should end with a period
        """根据数据分类获取约束列"""
^
src/storage/access/modules/redis.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - Redis数据访问器

专门处理Redis缓存和实时状态操作

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/redis.py:26:1: D400 First line should end with a period
    """Redis数据访问器 - 实时状态中心"""
^
src/storage/access/modules/redis.py:29:1: D400 First line should end with a period
        """
        初始化Redis数据访问器

        Args:
            monitoring_db: 监控数据库
        """
^
src/storage/access/modules/redis.py:40:1: D400 First line should end with a period
        """初始化Redis连接"""
^
src/storage/access/modules/redis.py:66:1: D400 First line should end with a period
        """保存实时数据到Redis"""
^
src/storage/access/modules/redis.py:67:80: E501 line too long (87 > 79 characters)
        operation_id = self.monitoring_db.log_operation_start(key, "Redis", "0", "SET")
                                                                               ^
src/storage/access/modules/redis.py:87:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/redis.py:97:1: D400 First line should end with a period
        """从Redis加载实时数据"""
^
src/storage/access/modules/redis.py:98:80: E501 line too long (87 > 79 characters)
        operation_id = self.monitoring_db.log_operation_start(key, "Redis", "0", "GET")
                                                                               ^
src/storage/access/modules/redis.py:124:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/redis.py:129:1: D400 First line should end with a period
        """从Redis删除数据"""
^
src/storage/access/modules/redis.py:144:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/redis.py:155:1: D400 First line should end with a period
        """将DataFrame保存为JSON格式到Redis"""
^
src/storage/access/modules/redis.py:176:1: D400 First line should end with a period
        """从Redis加载JSON数据为DataFrame"""
^
src/storage/access/modules/redis.py:203:1: D400 First line should end with a period
        """更新Redis中的Hash数据"""
^
src/storage/access/modules/redis.py:220:1: D400 First line should end with a period
        """获取符合模式的键名列表"""
^
src/storage/access/modules/redis.py:234:1: D400 First line should end with a period
        """根据模式清理Redis中的数据"""
^
src/storage/access/modules/redis.py:261:1: D400 First line should end with a period
        """通用数据缓存方法"""
^
src/storage/access/modules/redis.py:270:1: D400 First line should end with a period
        """通用数据获取方法"""
^
src/storage/access/modules/redis.py:280:1: D400 First line should end with a period
        """为快速访问缓存DataFrame"""
^
src/storage/access/modules/redis.py:289:1: D400 First line should end with a period
        """获取缓存的DataFrame"""
^
src/storage/access/modules/redis.py:301:1: D400 First line should end with a period
        """缓存计算结果"""
^
src/storage/access/modules/redis.py:320:1: D400 First line should end with a period
        """获取缓存的计算结果"""
^
src/storage/access/modules/tdengine.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - TDengine数据访问器

专门处理TDengine数据库的高频时序数据操作

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/modules/tdengine.py:22:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/storage/access/modules/tdengine.py:30:1: D400 First line should end with a period
    """TDengine数据访问器 - 高频时序数据专用"""
^
src/storage/access/modules/tdengine.py:33:1: D400 First line should end with a period
        """
        初始化TDengine数据访问器

        Args:
            monitoring_db: 监控数据库
        """
^
src/storage/access/modules/tdengine.py:50:1: D400 First line should end with a period
        """
        保存时序数据到TDengine，支持去重策略

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选，默认根据分类确定）
            **kwargs: 其他参数，支持 dedup_strategy 参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/modules/tdengine.py:53:1: RST210 Inline strong start-string without end-string.
        """
        保存时序数据到TDengine，支持去重策略

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选，默认根据分类确定）
            **kwargs: 其他参数，支持 dedup_strategy 参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/modules/tdengine.py:78:80: E501 line too long (83 > 79 characters)
            processed_data = self._preprocess_timeseries_data(data, classification)
                                                                               ^
src/storage/access/modules/tdengine.py:88:80: E501 line too long (81 > 79 characters)
                processed_data, actual_table_name, dedup_strategy, classification
                                                                               ^
src/storage/access/modules/tdengine.py:102:80: E501 line too long (87 > 79 characters)
                success = self._insert_tick_data(cursor, final_data, actual_table_name)
                                                                               ^
src/storage/access/modules/tdengine.py:117:80: E501 line too long (107 > 79 characters)
                    f"TDengine保存成功: {actual_table_name}, {len(final_data)}条记录，去重策略: {dedup_strategy.value}"
                                                                               ^
src/storage/access/modules/tdengine.py:128:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/tdengine.py:139:1: D400 First line should end with a period
        """
        从TDengine加载时序数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/modules/tdengine.py:142:1: RST210 Inline strong start-string without end-string.
        """
        从TDengine加载时序数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/modules/tdengine.py:152:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/modules/tdengine.py:173:80: E501 line too long (84 > 79 characters)
            processed_data = self._postprocess_timeseries_data(data, classification)
                                                                               ^
src/storage/access/modules/tdengine.py:186:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/modules/tdengine.py:198:1: D400 First line should end with a period
        """TDengine通常不支持更新操作，使用插入替代"""
^
src/storage/access/modules/tdengine.py:209:1: D400 First line should end with a period
        """TDengine删除数据（谨慎使用）"""
^
src/storage/access/modules/tdengine.py:213:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/storage/access/modules/tdengine.py:214:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/storage/access/modules/tdengine.py:229:1: D400 First line should end with a period
        """
        应用TDengine特定的去重策略

        Args:
            data: 原始数据
            table_name: 表名
            strategy: 去重策略
            classification: 数据分类

        Returns:
            处理后的数据
        """
^
src/storage/access/modules/tdengine.py:251:80: E501 line too long (84 > 79 characters)
                return self._handle_tdengine_merge(data, table_name, classification)
                                                                               ^
src/storage/access/modules/tdengine.py:253:80: E501 line too long (85 > 79 characters)
                return self._handle_tdengine_reject(data, table_name, classification)
                                                                               ^
src/storage/access/modules/tdengine.py:263:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/modules/tdengine.py:265:1: D400 First line should end with a period
        """TDengine最新覆盖策略：基于时间戳去重，保留最新记录"""
^
src/storage/access/modules/tdengine.py:299:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/modules/tdengine.py:301:1: D400 First line should end with a period
        """TDengine首次保留策略：查询已存在的数据，过滤重复"""
^
src/storage/access/modules/tdengine.py:319:1: S608 Possible SQL injection vector through string-based query construction.
                query = f"""
                SELECT DISTINCT {time_column}, symbol
                FROM {table_name}
                WHERE {time_column} BETWEEN '{min_time}' AND '{max_time}'
                AND symbol IN ('{symbols_str}')
                """
^
src/storage/access/modules/tdengine.py:326:1: S608 Possible SQL injection vector through string-based query construction.
                query = f"""
                SELECT DISTINCT {time_column}
                FROM {table_name}
                WHERE {time_column} BETWEEN '{min_time}' AND '{max_time}'
                """
^
src/storage/access/modules/tdengine.py:346:80: E501 line too long (82 > 79 characters)
            new_data = filtered_data[filtered_data["_merge"] == "left_only"].drop(
                                                                               ^
src/storage/access/modules/tdengine.py:363:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/modules/tdengine.py:365:1: D400 First line should end with a period
        """TDengine合并策略：时序数据通常使用最新覆盖"""
^
src/storage/access/modules/tdengine.py:367:80: E501 line too long (82 > 79 characters)
        return self._handle_tdengine_latest_wins(data, table_name, classification)
                                                                               ^
src/storage/access/modules/tdengine.py:370:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/modules/tdengine.py:372:1: D400 First line should end with a period
        """TDengine拒绝重复策略：检查重复并拒绝"""
^
src/storage/access/modules/tdengine.py:402:1: D400 First line should end with a period
        """预处理时序数据"""
^
src/storage/access/modules/tdengine.py:433:80: E501 line too long (80 > 79 characters)
            col for col in required_columns if col not in processed_data.columns
                                                                               ^
src/storage/access/modules/tdengine.py:443:1: D400 First line should end with a period
        """后处理时序数据"""
^
src/storage/access/modules/tdengine.py:454:80: E501 line too long (85 > 79 characters)
    def _insert_tick_data(self, cursor, data: pd.DataFrame, table_name: str) -> bool:
                                                                               ^
src/storage/access/modules/tdengine.py:455:1: D400 First line should end with a period
        """插入Tick数据"""
^
src/storage/access/modules/tdengine.py:458:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, price, volume, amount, exchange)
                VALUES (?, ?, ?, ?, ?, ?)
            """
^
src/storage/access/modules/tdengine.py:459:80: E501 line too long (86 > 79 characters)
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, price, volume, amount, exchange)
                VALUES (?, ?, ?, ?, ?, ?)
            """

                                                 ^
src/storage/access/modules/tdengine.py:485:80: E501 line too long (88 > 79 characters)
    def _insert_minute_kline(self, cursor, data: pd.DataFrame, table_name: str) -> bool:
                                                                               ^
src/storage/access/modules/tdengine.py:486:1: D400 First line should end with a period
        """插入分钟K线数据"""
^
src/storage/access/modules/tdengine.py:489:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, open, high, low, close, volume, amount, frequency)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """
^
src/storage/access/modules/tdengine.py:490:80: E501 line too long (104 > 79 characters)
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, open, high, low, close, volume, amount, frequency)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """

                                                 ^
src/storage/access/modules/tdengine.py:522:1: D400 First line should end with a period
        """插入通用时序数据"""
^
src/storage/access/modules/tdengine.py:527:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"INSERT INTO {table_name} ({', '.join(columns)}) VALUES ({placeholders})"
^
src/storage/access/modules/tdengine.py:527:80: E501 line too long (99 > 79 characters)
            insert_sql = f"INSERT INTO {table_name} ({', '.join(columns)}) VALUES ({placeholders})"
                                                                               ^
src/storage/access/modules/tdengine.py:547:1: D400 First line should end with a period
        """构建时序数据查询语句"""
^
src/storage/access/modules/tdengine.py:548:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/storage/access/modules/tdengine.py:566:80: E501 line too long (87 > 79 characters)
                    if isinstance(value, dict) and "start" in value and "end" in value:
                                                                               ^
src/storage/access/modules/tdengine.py:568:80: E501 line too long (82 > 79 characters)
                            f"ts >= '{value['start']}' AND ts <= '{value['end']}'"
                                                                               ^
src/storage/access/postgresql.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - PostgreSQL数据访问器

专门处理PostgreSQL数据库的长期分析和历史数据操作

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/postgresql.py:28:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/storage/access/postgresql.py:31:1: F401 'src.storage.database.connection_manager.get_connection_manager' imported but unused
from src.storage.database.connection_manager import get_connection_manager
^
src/storage/access/postgresql.py:37:1: D400 First line should end with a period
    """PostgreSQL数据访问器 - 历史数据仓库和分析"""
^
src/storage/access/postgresql.py:40:1: D400 First line should end with a period
        """
        初始化PostgreSQL数据访问器

        Args:
            monitoring_db: 监控数据库实例
        """
^
src/storage/access/postgresql.py:57:1: D400 First line should end with a period
        """
        保存数据到PostgreSQL

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/postgresql.py:60:1: RST210 Inline strong start-string without end-string.
        """
        保存数据到PostgreSQL

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            **kwargs: 其他参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/postgresql.py:70:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/postgresql.py:79:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/postgresql.py:82:80: E501 line too long (83 > 79 characters)
            processed_data = self._preprocess_analytical_data(data, classification)
                                                                               ^
src/storage/access/postgresql.py:116:80: E501 line too long (80 > 79 characters)
                f"PostgreSQL保存成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/storage/access/postgresql.py:123:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/postgresql.py:134:1: D400 First line should end with a period
        """
        从PostgreSQL加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/postgresql.py:137:1: RST210 Inline strong start-string without end-string.
        """
        从PostgreSQL加载数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/postgresql.py:147:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/postgresql.py:156:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/postgresql.py:168:80: E501 line too long (84 > 79 characters)
            processed_data = self._postprocess_analytical_data(data, classification)
                                                                               ^
src/storage/access/postgresql.py:174:80: E501 line too long (80 > 79 characters)
                f"PostgreSQL加载成功: {actual_table_name}, {len(processed_data)}条记录"
                                                                               ^
src/storage/access/postgresql.py:181:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/postgresql.py:193:1: D400 First line should end with a period
        """
        更新PostgreSQL数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/storage/access/postgresql.py:196:1: RST210 Inline strong start-string without end-string.
        """
        更新PostgreSQL数据

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选）
            key_columns: 主键列
            **kwargs: 其他参数

        Returns:
            bool: 更新是否成功
        """
^
src/storage/access/postgresql.py:207:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/postgresql.py:216:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/postgresql.py:217:80: E501 line too long (86 > 79 characters)
            key_columns = key_columns or self._get_default_key_columns(classification)
                                                                               ^
src/storage/access/postgresql.py:224:80: E501 line too long (88 > 79 characters)
            success = self._execute_update(cursor, data, actual_table_name, key_columns)
                                                                               ^
src/storage/access/postgresql.py:228:80: E501 line too long (86 > 79 characters)
                self.monitoring_db.log_operation_result(operation_id, True, len(data))
                                                                               ^
src/storage/access/postgresql.py:242:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/postgresql.py:253:1: D400 First line should end with a period
        """
        删除PostgreSQL数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/storage/access/postgresql.py:256:1: RST210 Inline strong start-string without end-string.
        """
        删除PostgreSQL数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            bool: 删除是否成功
        """
^
src/storage/access/postgresql.py:266:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/postgresql.py:279:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/postgresql.py:286:80: E501 line too long (85 > 79 characters)
            delete_sql, params = self._build_delete_query(actual_table_name, filters)
                                                                               ^
src/storage/access/postgresql.py:293:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, True, affected_rows)
                                                                               ^
src/storage/access/postgresql.py:302:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/postgresql.py:306:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/storage/access/postgresql.py:307:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/storage/access/postgresql.py:322:80: E501 line too long (88 > 79 characters)
    def _get_default_key_columns(self, classification: DataClassification) -> List[str]:
                                                                               ^
src/storage/access/postgresql.py:323:1: D400 First line should end with a period
        """根据数据分类获取默认主键列"""
^
src/storage/access/postgresql.py:340:80: E501 line too long (82 > 79 characters)
            DataClassification.MODEL_OUTPUTS: ["model_id", "symbol", "calc_date"],
                                                                               ^
src/storage/access/postgresql.py:352:1: D400 First line should end with a period
        """预处理分析数据"""
^
src/storage/access/postgresql.py:386:1: D400 First line should end with a period
        """获取PostgreSQL SQLAlchemy引擎"""
^
src/storage/access/postgresql.py:397:80: E501 line too long (84 > 79 characters)
            f"postgresql+psycopg2://{user}:{password}@{host}:{port}/{database_name}"
                                                                               ^
src/storage/access/postgresql.py:411:1: D400 First line should end with a period
        """使用SQLAlchemy引擎执行UPSERT操作"""
^
src/storage/access/postgresql.py:426:80: E501 line too long (87 > 79 characters)
                    table_name, engine, if_exists="append", index=False, method="multi"
                                                                               ^
src/storage/access/postgresql.py:442:1: D400 First line should end with a period
        """后处理分析数据"""
^
src/storage/access/postgresql.py:461:1: D400 First line should end with a period
        """PostgreSQL Upsert操作 - 使用ON CONFLICT实现"""
^
src/storage/access/postgresql.py:461:1: D403 First word of the first line should be properly capitalized
        """PostgreSQL Upsert操作 - 使用ON CONFLICT实现"""
^
src/storage/access/postgresql.py:481:1: S608 Possible SQL injection vector through string-based query construction.
            upsert_sql = f"""
            INSERT INTO {table_name} ({column_names})
            VALUES ({placeholders})
            ON CONFLICT ({conflict_columns})
            DO UPDATE SET
                {update_set},
                updated_at = CURRENT_TIMESTAMP
            """
^
src/storage/access/postgresql.py:510:80: E501 line too long (87 > 79 characters)
                f"PostgreSQL UPSERT操作完成: {table_name}, 处理记录数: {len(records_to_insert)}"
                                                                               ^
src/storage/access/postgresql.py:520:80: E501 line too long (81 > 79 characters)
        self, cursor, data: pd.DataFrame, table_name: str, key_columns: List[str]
                                                                               ^
src/storage/access/postgresql.py:522:1: D400 First line should end with a period
        """执行更新操作"""
^
src/storage/access/postgresql.py:541:1: S608 Possible SQL injection vector through string-based query construction.
                update_sql = f"""
                    UPDATE {table_name}
                    SET {', '.join(set_clauses)}
                    WHERE {' AND '.join(where_clauses)}
                """
^
src/storage/access/postgresql.py:542:40: W291 trailing whitespace
                update_sql = f"""
                    UPDATE {table_name}
                    SET {', '.join(set_clauses)}
                    WHERE {' AND '.join(where_clauses)}
                """

     ^
src/storage/access/postgresql.py:543:49: W291 trailing whitespace
                update_sql = f"""
                    UPDATE {table_name}
                    SET {', '.join(set_clauses)}
                    WHERE {' AND '.join(where_clauses)}
                """

              ^
src/storage/access/postgresql.py:564:1: D400 First line should end with a period
        """
        构建分析数据查询语句 - 使用参数化查询防止SQL注入

        返回值: (sql_string, bind_parameters)
        """
^
src/storage/access/postgresql.py:569:80: E501 line too long (85 > 79 characters)
        # SECURITY FIX: Whitelist table names to prevent injection through table_name
                                                                               ^
src/storage/access/postgresql.py:570:10: N806 variable 'ALLOWED_TABLES' in function should be lowercase
        ALLOWED_TABLES = {
         ^
src/storage/access/postgresql.py:588:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/storage/access/postgresql.py:591:9: F841 local variable 'param_counter' is assigned to but never used
        param_counter = 0
        ^
src/storage/access/postgresql.py:602:80: E501 line too long (91 > 79 characters)
                    # SECURITY FIX: Use parameterized query instead of string concatenation
                                                                               ^
src/storage/access/postgresql.py:606:80: E501 line too long (82 > 79 characters)
                    # SECURITY FIX: Even numeric values use parameterized approach
                                                                               ^
src/storage/access/postgresql.py:628:80: E501 line too long (93 > 79 characters)
        # 添加排序 - SECURITY: order_by should also be whitelisted, but for now document the risk
                                                                               ^
src/storage/access/postgresql.py:651:80: E501 line too long (82 > 79 characters)
                base_query += f" LIMIT {limit_val}"  # Integers are safe for LIMIT
                                                                               ^
src/storage/access/postgresql.py:659:80: E501 line too long (85 > 79 characters)
                base_query += f" OFFSET {offset_val}"  # Integers are safe for OFFSET
                                                                               ^
src/storage/access/postgresql.py:667:1: D400 First line should end with a period
        """
        构建删除查询语句 - 使用参数化查询防止SQL注入

        返回值: (sql_string, bind_parameters)
        """
^
src/storage/access/postgresql.py:672:80: E501 line too long (85 > 79 characters)
        # SECURITY FIX: Whitelist table names to prevent injection through table_name
                                                                               ^
src/storage/access/postgresql.py:673:10: N806 variable 'ALLOWED_TABLES' in function should be lowercase
        ALLOWED_TABLES = {
         ^
src/storage/access/postgresql.py:691:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"DELETE FROM {table_name}"
^
src/storage/access/postgresql.py:698:80: E501 line too long (87 > 79 characters)
                # SECURITY FIX: Use parameterized query instead of string concatenation
                                                                               ^
src/storage/access/tdengine.py:3:1: D400 First line should end with a period
"""
MyStocks 量化交易数据管理系统 - TDengine数据访问器

专门处理TDengine数据库的高频时序数据操作

作者: MyStocks项目组
版本: v2.0 重构版
日期: 2025-11-25
"""
^
src/storage/access/tdengine.py:28:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/storage/access/tdengine.py:34:1: D400 First line should end with a period
    """TDengine数据访问器 - 高频时序数据专用"""
^
src/storage/access/tdengine.py:37:1: D400 First line should end with a period
        """
        初始化TDengine数据访问器

        Args:
            monitoring_db: 监控数据库实例
        """
^
src/storage/access/tdengine.py:54:1: D400 First line should end with a period
        """
        保存时序数据到TDengine，支持去重策略

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选，默认根据分类确定）
            **kwargs: 其他参数，支持 dedup_strategy 参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/tdengine.py:57:1: RST210 Inline strong start-string without end-string.
        """
        保存时序数据到TDengine，支持去重策略

        Args:
            data: 数据DataFrame
            classification: 数据分类
            table_name: 表名（可选，默认根据分类确定）
            **kwargs: 其他参数，支持 dedup_strategy 参数

        Returns:
            bool: 保存是否成功
        """
^
src/storage/access/tdengine.py:79:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/tdengine.py:82:80: E501 line too long (83 > 79 characters)
            processed_data = self._preprocess_timeseries_data(data, classification)
                                                                               ^
src/storage/access/tdengine.py:92:80: E501 line too long (81 > 79 characters)
                processed_data, actual_table_name, dedup_strategy, classification
                                                                               ^
src/storage/access/tdengine.py:106:80: E501 line too long (87 > 79 characters)
                success = self._insert_tick_data(cursor, final_data, actual_table_name)
                                                                               ^
src/storage/access/tdengine.py:121:80: E501 line too long (101 > 79 characters)
                    f"TDengine保存成功: {actual_table_name}, {len(final_data)}条记录，去重策略: {dedup_strategy}"
                                                                               ^
src/storage/access/tdengine.py:132:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/tdengine.py:143:1: D400 First line should end with a period
        """
        从TDengine加载时序数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/tdengine.py:146:1: RST210 Inline strong start-string without end-string.
        """
        从TDengine加载时序数据

        Args:
            classification: 数据分类
            table_name: 表名（可选）
            filters: 过滤条件
            **kwargs: 其他参数

        Returns:
            pd.DataFrame: 加载的数据
        """
^
src/storage/access/tdengine.py:156:80: E501 line too long (86 > 79 characters)
        actual_table_name = table_name or self._get_default_table_name(classification)
                                                                               ^
src/storage/access/tdengine.py:165:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/tdengine.py:177:80: E501 line too long (84 > 79 characters)
            processed_data = self._postprocess_timeseries_data(data, classification)
                                                                               ^
src/storage/access/tdengine.py:190:80: E501 line too long (86 > 79 characters)
            self.monitoring_db.log_operation_result(operation_id, False, 0, error_msg)
                                                                               ^
src/storage/access/tdengine.py:202:1: D400 First line should end with a period
        """TDengine通常不支持更新操作，使用插入替代"""
^
src/storage/access/tdengine.py:213:1: D400 First line should end with a period
        """TDengine删除数据（谨慎使用）"""
^
src/storage/access/tdengine.py:217:80: E501 line too long (81 > 79 characters)
    def _get_default_table_name(self, classification: DataClassification) -> str:
                                                                               ^
src/storage/access/tdengine.py:218:1: D400 First line should end with a period
        """根据数据分类获取默认表名"""
^
src/storage/access/tdengine.py:233:1: D400 First line should end with a period
        """
        应用TDengine特定的去重策略

        Args:
            data: 原始数据
            table_name: 表名
            strategy: 去重策略
            classification: 数据分类

        Returns:
            处理后的数据
        """
^
src/storage/access/tdengine.py:256:80: E501 line too long (84 > 79 characters)
                return self._handle_tdengine_merge(data, table_name, classification)
                                                                               ^
src/storage/access/tdengine.py:258:80: E501 line too long (85 > 79 characters)
                return self._handle_tdengine_reject(data, table_name, classification)
                                                                               ^
src/storage/access/tdengine.py:268:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/tdengine.py:270:1: D400 First line should end with a period
        """TDengine最新覆盖策略：基于时间戳去重，保留最新记录"""
^
src/storage/access/tdengine.py:304:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/tdengine.py:306:1: D400 First line should end with a period
        """TDengine首次保留策略：查询已存在的数据，过滤重复"""
^
src/storage/access/tdengine.py:314:80: E501 line too long (81 > 79 characters)
            database_name = get_database_name_from_classification(classification)
                                                                               ^
src/storage/access/tdengine.py:324:1: S608 Possible SQL injection vector through string-based query construction.
                query = f"""
                SELECT DISTINCT {time_column}, symbol
                FROM {table_name}
                WHERE {time_column} BETWEEN '{min_time}' AND '{max_time}'
                AND symbol IN ('{symbols_str}')
                """
^
src/storage/access/tdengine.py:331:1: S608 Possible SQL injection vector through string-based query construction.
                query = f"""
                SELECT DISTINCT {time_column}
                FROM {table_name}
                WHERE {time_column} BETWEEN '{min_time}' AND '{max_time}'
                """
^
src/storage/access/tdengine.py:351:80: E501 line too long (82 > 79 characters)
            new_data = filtered_data[filtered_data["_merge"] == "left_only"].drop(
                                                                               ^
src/storage/access/tdengine.py:368:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/tdengine.py:370:1: D400 First line should end with a period
        """TDengine合并策略：时序数据通常使用最新覆盖"""
^
src/storage/access/tdengine.py:372:80: E501 line too long (82 > 79 characters)
        return self._handle_tdengine_latest_wins(data, table_name, classification)
                                                                               ^
src/storage/access/tdengine.py:375:80: E501 line too long (85 > 79 characters)
        self, data: pd.DataFrame, table_name: str, classification: DataClassification
                                                                               ^
src/storage/access/tdengine.py:377:1: D400 First line should end with a period
        """TDengine拒绝重复策略：检查重复并拒绝"""
^
src/storage/access/tdengine.py:407:1: D400 First line should end with a period
        """预处理时序数据"""
^
src/storage/access/tdengine.py:438:80: E501 line too long (80 > 79 characters)
            col for col in required_columns if col not in processed_data.columns
                                                                               ^
src/storage/access/tdengine.py:448:1: D400 First line should end with a period
        """后处理时序数据"""
^
src/storage/access/tdengine.py:459:80: E501 line too long (85 > 79 characters)
    def _insert_tick_data(self, cursor, data: pd.DataFrame, table_name: str) -> bool:
                                                                               ^
src/storage/access/tdengine.py:460:1: D400 First line should end with a period
        """插入Tick数据"""
^
src/storage/access/tdengine.py:463:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, price, volume, amount, exchange)
                VALUES (?, ?, ?, ?, ?, ?)
            """
^
src/storage/access/tdengine.py:464:80: E501 line too long (86 > 79 characters)
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, price, volume, amount, exchange)
                VALUES (?, ?, ?, ?, ?, ?)
            """

                                                 ^
src/storage/access/tdengine.py:490:80: E501 line too long (88 > 79 characters)
    def _insert_minute_kline(self, cursor, data: pd.DataFrame, table_name: str) -> bool:
                                                                               ^
src/storage/access/tdengine.py:491:1: D400 First line should end with a period
        """插入分钟K线数据"""
^
src/storage/access/tdengine.py:494:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, open, high, low, close, volume, amount, frequency)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """
^
src/storage/access/tdengine.py:495:80: E501 line too long (104 > 79 characters)
            insert_sql = f"""
                INSERT INTO {table_name} (ts, symbol, open, high, low, close, volume, amount, frequency)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """

                                                 ^
src/storage/access/tdengine.py:527:1: D400 First line should end with a period
        """插入通用时序数据"""
^
src/storage/access/tdengine.py:532:1: S608 Possible SQL injection vector through string-based query construction.
            insert_sql = f"INSERT INTO {table_name} ({', '.join(columns)}) VALUES ({placeholders})"
^
src/storage/access/tdengine.py:532:80: E501 line too long (99 > 79 characters)
            insert_sql = f"INSERT INTO {table_name} ({', '.join(columns)}) VALUES ({placeholders})"
                                                                               ^
src/storage/access/tdengine.py:552:1: D400 First line should end with a period
        """构建时序数据查询语句"""
^
src/storage/access/tdengine.py:553:1: S608 Possible SQL injection vector through string-based query construction.
        base_query = f"SELECT * FROM {table_name}"
^
src/storage/access/tdengine.py:571:80: E501 line too long (87 > 79 characters)
                    if isinstance(value, dict) and "start" in value and "end" in value:
                                                                               ^
src/storage/access/tdengine.py:573:80: E501 line too long (82 > 79 characters)
                            f"ts >= '{value['start']}' AND ts <= '{value['end']}'"
                                                                               ^
src/storage/database/__init__.py:1:1: D205 1 blank line required between summary line and description
"""
数据库存储层模块
提供数据库连接管理和表管理功能
"""
^
src/storage/database/__init__.py:1:1: D400 First line should end with a period
"""
数据库存储层模块
提供数据库连接管理和表管理功能
"""
^
src/storage/database/connection_context.py:3:1: D400 First line should end with a period
"""
数据库连接上下文管理器

提供安全的数据库连接管理，确保连接在使用后正确关闭，
并与内存管理系统集成，防止内存泄漏。

创建日期: 2025-12-11
版本: 1.0.0 - 内存管理集成版本
"""
^
src/storage/database/connection_context.py:15:1: F811 redefinition of unused 'Any' from line 15
from typing import Optional, Any, Generator, Dict, Any
^
src/storage/database/connection_context.py:24:5: F401 'src.core.memory_manager.get_memory_monitor' imported but unused
    from src.core.memory_manager import get_memory_monitor, get_memory_stats
    ^
src/storage/database/connection_context.py:33:5: F811 redefinition of unused 'os' from line 13
    import os
    ^
src/storage/database/connection_context.py:37:1: S102 Use of exec detected.
    exec(open('src/storage/database/connection_manager.py').read())
^
src/storage/database/connection_context.py:44:1: D400 First line should end with a period
    """数据库连接上下文管理器"""
^
src/storage/database/connection_context.py:47:1: D400 First line should end with a period
        """
        初始化连接上下文

        Args:
            db_type: 数据库类型 (tdengine, postgresql, mysql, redis)
        """
^
src/storage/database/connection_context.py:58:1: D400 First line should end with a period
        """异步进入上下文"""
^
src/storage/database/connection_context.py:62:24: F821 undefined name 'get_connection_manager'
        self.manager = get_connection_manager()
                       ^
src/storage/database/connection_context.py:67:80: E501 line too long (101 > 79 characters)
            print(f"获取{self.db_type}连接前内存使用: {memory_before['current']['process_memory_mb']:.2f} MB")
                                                                               ^
src/storage/database/connection_context.py:84:1: D400 First line should end with a period
        """异步退出上下文"""
^
src/storage/database/connection_context.py:88:80: E501 line too long (100 > 79 characters)
            print(f"释放{self.db_type}连接后内存使用: {memory_after['current']['process_memory_mb']:.2f} MB")
                                                                               ^
src/storage/database/connection_context.py:94:1: D400 First line should end with a period
        """清理连接"""
^
src/storage/database/connection_context.py:116:1: D400 First line should end with a period
        """获取连接"""
^
src/storage/database/connection_context.py:122:1: D400 First line should end with a period
    """
    同步数据库连接上下文管理器

    Args:
        db_type: 数据库类型

    Yields:
        数据库连接对象
    """
^
src/storage/database/connection_context.py:136:19: F821 undefined name 'get_connection_manager'
        manager = get_connection_manager()
                  ^
src/storage/database/connection_context.py:141:80: E501 line too long (98 > 79 characters)
            print(f"同步获取{db_type}连接前内存使用: {memory_before['current']['process_memory_mb']:.2f} MB")
                                                                               ^
src/storage/database/connection_context.py:161:80: E501 line too long (97 > 79 characters)
            print(f"同步释放{db_type}连接后内存使用: {memory_after['current']['process_memory_mb']:.2f} MB")
                                                                               ^
src/storage/database/connection_context.py:178:1: D400 First line should end with a period
    """
    异步数据库连接获取函数

    Args:
        db_type: 数据库类型

    Returns:
        数据库连接对象
    """
^
src/storage/database/connection_context.py:190:15: F821 undefined name 'get_connection_manager'
    manager = get_connection_manager()
              ^
src/storage/database/connection_context.py:195:80: E501 line too long (94 > 79 characters)
        print(f"异步获取{db_type}连接前内存使用: {memory_before['current']['process_memory_mb']:.2f} MB")
                                                                               ^
src/storage/database/connection_context.py:213:1: D400 First line should end with a period
    """连接池管理器 - 优化连接使用"""
^
src/storage/database/connection_context.py:216:1: D400 First line should end with a period
        """初始化连接池管理器"""
^
src/storage/database/connection_context.py:221:1: D400 First line should end with a period
        """
        获取连接并返回统计信息

        Args:
            db_type: 数据库类型

        Returns:
            包含连接和统计信息的字典
        """
^
src/storage/database/connection_context.py:244:80: E501 line too long (95 > 79 characters)
        stats['peak_connections'] = max(stats['peak_connections'], stats['active_connections'])
                                                                               ^
src/storage/database/connection_context.py:252:80: E501 line too long (85 > 79 characters)
            stats['current_memory_mb'] = memory_stats['current']['process_memory_mb']
                                                                               ^
src/storage/database/connection_context.py:253:80: E501 line too long (89 > 79 characters)
            stats['resource_count'] = memory_stats['resource_manager']['total_resources']
                                                                               ^
src/storage/database/connection_context.py:267:1: D400 First line should end with a period
        """释放连接资源"""
^
src/storage/database/connection_context.py:270:80: E501 line too long (81 > 79 characters)
            stats['active_connections'] = max(0, stats['active_connections'] - 1)
                                                                               ^
src/storage/database/connection_context.py:277:80: E501 line too long (96 > 79 characters)
            print(f"释放{db_type}连接后总内存使用: {memory_after['current']['process_memory_mb']:.2f} MB")
                                                                               ^
src/storage/database/connection_context.py:280:1: D400 First line should end with a period
        """获取连接池统计信息"""
^
src/storage/database/connection_context.py:292:1: D400 First line should end with a period
    """获取全局连接池管理器"""
^
src/storage/database/connection_context.py:298:1: D400 First line should end with a period
    """监控连接性能的装饰器"""
^
src/storage/database/connection_context.py:312:80: E501 line too long (119 > 79 characters)
                print(f"连接操作性能: 执行时间={execution_time:.3f}s, 内存使用={memory_stats['current']['process_memory_mb']:.2f}MB")
                                                                               ^
src/storage/database/connection_context.py:326:1: D400 First line should end with a period
    """测试连接上下文管理器"""
^
src/storage/database/connection_context.py:353:1: D400 First line should end with a period
    """测试同步连接上下文管理器"""
^
src/storage/database/connection_context.py:373:5: F811 redefinition of unused 'asyncio' from line 14
    import asyncio
    ^
src/storage/database/connection_context.py:391:80: E501 line too long (101 > 79 characters)
        print(f"  {db_type}: 请求次数={db_stats['total_requests']}, 峰值连接={db_stats['peak_connections']}")
                                                                               ^
src/storage/database/connection_context.py:393:24: W292 no newline at end of file
    print("\n✓ 所有测试完成")                       ^
src/storage/database/connection_manager.py:1:1: D400 First line should end with a period
"""
数据库连接管理器

管理4种数据库(TDengine/PostgreSQL/MySQL/Redis)的连接池和连接生命周期。
所有连接参数从环境变量读取,确保安全性。

创建日期: 2025-10-11
版本: 2.0.0 - 集成高性能连接池
"""
^
src/storage/database/connection_manager.py:12:1: F401 'asyncio' imported but unused
import asyncio
^
src/storage/database/connection_manager.py:13:1: F401 'typing.List' imported but unused
from typing import Optional, Dict, Any, List
^
src/storage/database/connection_manager.py:21:5: F401 'src.core.database_pool.DatabaseConnectionPool' imported but unused
    from src.core.database_pool import DatabaseConnectionPool
    ^
src/storage/database/connection_manager.py:29:5: F401 'src.core.memory_manager.register_resource' imported but unused
    from src.core.memory_manager import (
    ^
src/storage/database/connection_manager.py:29:5: F401 'src.core.memory_manager.unregister_resource' imported but unused
    from src.core.memory_manager import (
    ^
src/storage/database/connection_manager.py:29:5: F401 'src.core.memory_manager.cleanup_all_resources' imported but unused
    from src.core.memory_manager import (
    ^
src/storage/database/connection_manager.py:29:5: F401 'src.core.memory_manager.get_memory_monitor' imported but unused
    from src.core.memory_manager import (
    ^
src/storage/database/connection_manager.py:42:1: D400 First line should end with a period
    """
    数据库连接管理器基础类

    管理4种数据库的连接池,提供统一的连接获取接口
    """
^
src/storage/database/connection_manager.py:49:1: D400 First line should end with a period
        """初始化连接管理器,验证必需的环境变量"""
^
src/storage/database/connection_manager.py:63:26: F821 undefined name 'logging'
                logger = logging.getLogger("DatabaseConnectionManager")
                         ^
src/storage/database/connection_manager.py:69:1: D400 First line should end with a period
        """验证必需的环境变量是否存在 (US3: 移除MySQL和Redis依赖)"""
^
src/storage/database/connection_manager.py:102:1: D400 First line should end with a period
        """清理所有连接的回调方法"""
^
src/storage/database/connection_manager.py:113:1: D400 First line should end with a period
        """关闭单个TDengine连接"""
^
src/storage/database/connection_manager.py:120:80: E501 line too long (91 > 79 characters)
                    resource_manager.unregister_resource(f"tdengine_connection_{id(conn)}")
                                                                               ^
src/storage/database/connection_manager.py:125:1: D400 First line should end with a period
        """关闭PostgreSQL同步连接池"""
^
src/storage/database/connection_manager.py:132:80: E501 line too long (87 > 79 characters)
                    resource_manager.unregister_resource(f"postgresql_pool_{id(pool)}")
                                                                               ^
src/storage/database/connection_manager.py:137:1: D400 First line should end with a period
        """关闭PostgreSQL异步连接池"""
^
src/storage/database/connection_manager.py:140:17: F811 redefinition of unused 'asyncio' from line 12
                import asyncio
                ^
src/storage/database/connection_manager.py:151:80: E501 line too long (93 > 79 characters)
                    resource_manager.unregister_resource(f"async_postgresql_pool_{id(pool)}")
                                                                               ^
src/storage/database/connection_manager.py:156:1: D400 First line should end with a period
        """关闭MySQL连接"""
^
src/storage/database/connection_manager.py:163:80: E501 line too long (88 > 79 characters)
                    resource_manager.unregister_resource(f"mysql_connection_{id(conn)}")
                                                                               ^
src/storage/database/connection_manager.py:168:1: D400 First line should end with a period
        """关闭Redis连接"""
^
src/storage/database/connection_manager.py:175:80: E501 line too long (88 > 79 characters)
                    resource_manager.unregister_resource(f"redis_connection_{id(conn)}")
                                                                               ^
src/storage/database/connection_manager.py:180:1: D400 First line should end with a period
        """
        获取TDengine WebSocket连接

        Returns:
            TDengine连接对象

        Raises:
            ConnectionError: 连接失败
        """
^
src/storage/database/connection_manager.py:216:80: E501 line too long (87 > 79 characters)
                        cleanup_callback=lambda: self._close_tdengine_connection(conn),
                                                                               ^
src/storage/database/connection_manager.py:226:80: E501 line too long (87 > 79 characters)
                os.getenv("TDENGINE_REST_PORT") or os.getenv("TDENGINE_PORT") or "6030"
                                                                               ^
src/storage/database/connection_manager.py:234:1: D400 First line should end with a period
        """
        获取PostgreSQL连接池

        优先使用新的异步连接池，如果不可用则回退到同步连接池

        Returns:
            PostgreSQL连接池对象

        Raises:
            ConnectionError: 连接失败
        """
^
src/storage/database/connection_manager.py:255:25: F811 redefinition of unused 'asyncio' from line 12
                        import asyncio
                        ^
src/storage/database/connection_manager.py:271:80: E501 line too long (93 > 79 characters)
                            cleanup_callback=lambda: self._close_async_postgresql_pool(pool),
                                                                               ^
src/storage/database/connection_manager.py:282:13: F401 'psycopg2' imported but unused
            import psycopg2
            ^
src/storage/database/connection_manager.py:303:80: E501 line too long (94 > 79 characters)
                        cleanup_callback=lambda: self._close_postgresql_pool(connection_pool),
                                                                               ^
src/storage/database/connection_manager.py:316:80: E501 line too long (87 > 79 characters)
                f"请检查配置: {os.getenv('POSTGRESQL_HOST')}:{os.getenv('POSTGRESQL_PORT')}"
                                                                               ^
src/storage/database/connection_manager.py:320:1: D400 First line should end with a period
        """
        归还PostgreSQL连接到连接池

        Args:
            conn: PostgreSQL连接对象
        """
^
src/storage/database/connection_manager.py:330:1: D400 First line should end with a period
        """
        获取MySQL连接池

        Returns:
            MySQL连接池对象

        Raises:
            ConnectionError: 连接失败
        """
^
src/storage/database/connection_manager.py:361:80: E501 line too long (84 > 79 characters)
                        cleanup_callback=lambda: self._close_mysql_connection(conn),
                                                                               ^
src/storage/database/connection_manager.py:376:1: D400 First line should end with a period
        """
        获取Redis连接池

        使用1号数据库(避开0号,已被PAPERLESS占用)

        Returns:
            Redis连接对象

        Raises:
            ConnectionError: 连接失败
        """
^
src/storage/database/connection_manager.py:414:80: E501 line too long (84 > 79 characters)
                        cleanup_callback=lambda: self._close_redis_connection(conn),
                                                                               ^
src/storage/database/connection_manager.py:425:80: E501 line too long (104 > 79 characters)
                f"请检查配置: {os.getenv('REDIS_HOST')}:{os.getenv('REDIS_PORT')} DB={os.getenv('REDIS_DB')}"
                                                                               ^
src/storage/database/connection_manager.py:429:1: D400 First line should end with a period
        """关闭所有数据库连接"""
^
src/storage/database/connection_manager.py:439:21: F811 redefinition of unused 'asyncio' from line 12
                    import asyncio
                    ^
src/storage/database/connection_manager.py:455:1: D400 First line should end with a period
        """
        测试所有数据库连接 (US3架构: 只测试TDengine和PostgreSQL)

        Returns:
            dict: 每个数据库的连接状态 {'tdengine': True, 'postgresql': True}
        """
^
src/storage/database/connection_manager.py:477:17: F811 redefinition of unused 'asyncio' from line 12
                import asyncio
                ^
src/storage/database/connection_manager.py:504:1: D400 First line should end with a period
    """获取全局连接管理器实例 (单例模式)"""
^
src/storage/database/connection_manager.py:512:1: D400 First line should end with a period
    """
    测试所有数据库连接的便捷函数

    Returns:
        dict: 连接测试结果
    """
^
src/storage/database/database_manager.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：数据库管理器，负责连接管理、表创建和结构验证
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/storage/database/database_manager.py:1:1: D400 First line should end with a period
"""
# 功能：数据库管理器，负责连接管理、表创建和结构验证
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/storage/database/database_manager.py:87:1: D101 Missing docstring in public class
class DatabaseType(Enum):
^
src/storage/database/database_manager.py:96:1: D101 Missing docstring in public class
class TableCreationLog(Base):
^
src/storage/database/database_manager.py:114:80: E501 line too long (80 > 79 characters)
        "ColumnDefinitionLog", backref="table_log", cascade="all, delete-orphan"
                                                                               ^
src/storage/database/database_manager.py:118:1: D101 Missing docstring in public class
class ColumnDefinitionLog(Base):
^
src/storage/database/database_manager.py:134:1: D101 Missing docstring in public class
class TableOperationLog(Base):
^
src/storage/database/database_manager.py:153:1: D101 Missing docstring in public class
class TableValidationLog(Base):
^
src/storage/database/database_manager.py:166:1: D101 Missing docstring in public class
class DatabaseTableManager:
^
src/storage/database/database_manager.py:167:1: D107 Missing docstring in __init__
    def __init__(self) -> None:
^
src/storage/database/database_manager.py:171:10: N806 variable 'Session' in function should be lowercase
        Session = sessionmaker(bind=self.monitor_engine)
         ^
src/storage/database/database_manager.py:212:1: D400 First line should end with a period
        """获取数据库连接"""
^
src/storage/database/database_manager.py:226:80: E501 line too long (86 > 79 characters)
        missing_params = [param for param in required_params if not config.get(param)]
                                                                               ^
src/storage/database/database_manager.py:229:80: E501 line too long (86 > 79 characters)
                f"{db_type.value} 连接参数不完整，缺少: {", ".join(missing_params)}。请检查.env文件配置"
                                                                               ^
src/storage/database/database_manager.py:237:80: E501 line too long (99 > 79 characters)
                        "TDengine client library is not available. Please install TDengine client."
                                                                               ^
src/storage/database/database_manager.py:243:80: E501 line too long (115 > 79 characters)
                    dsn = f"ws://{config['user']}:{config['password']}@{config['host']}:{config.get('port', 6041)}"
                                                                               ^
src/storage/database/database_manager.py:250:80: E501 line too long (87 > 79 characters)
                        url=f"http://{config['host']}:{config.get('rest_port', 6041)}",
                                                                               ^
src/storage/database/database_manager.py:282:80: E501 line too long (87 > 79 characters)
                        str(config.get("password")) if config.get("password") else None
                                                                               ^
src/storage/database/database_manager.py:304:80: E501 line too long (84 > 79 characters)
                f"Failed to connect to {db_type.value} database {db_name}: {str(e)}"
                                                                               ^
src/storage/database/database_manager.py:319:1: D400 First line should end with a period
        """记录操作日志到监控数据库"""
^
src/storage/database/database_manager.py:342:1: D400 First line should end with a period
        """在指定数据库中创建表"""
^
src/storage/database/database_manager.py:344:9: F841 local variable 'operation_id' is assigned to but never used
        operation_id = self._log_operation(
        ^
src/storage/database/database_manager.py:365:80: E501 line too long (82 > 79 characters)
                ddl = self._generate_postgresql_ddl(table_name, columns, **kwargs)
                                                                               ^
src/storage/database/database_manager.py:387:80: E501 line too long (84 > 79 characters)
                table_parameters=json.dumps({"columns": columns, "kwargs": kwargs}),
                                                                               ^
src/storage/database/database_manager.py:424:80: E501 line too long (80 > 79 characters)
            self.validate_table_structure(db_type, db_name, table_name, columns)
                                                                               ^
src/storage/database/database_manager.py:456:1: D400 First line should end with a period
        """修改表结构"""
^
src/storage/database/database_manager.py:458:9: F841 local variable 'operation_id' is assigned to but never used
        operation_id = self._log_operation(
        ^
src/storage/database/database_manager.py:502:80: E501 line too long (91 > 79 characters)
                table_log.modification_time = datetime.utcnow()  # type: ignore[assignment]
                                                                               ^
src/storage/database/database_manager.py:527:1: D400 First line should end with a period
        """删除表"""
^
src/storage/database/database_manager.py:529:9: F841 local variable 'operation_id' is assigned to but never used
        operation_id = self._log_operation(
        ^
src/storage/database/database_manager.py:565:80: E501 line too long (88 > 79 characters)
                table_name, db_type, db_name, "DROP", {"kwargs": kwargs}, ddl, "success"
                                                                               ^
src/storage/database/database_manager.py:611:1: D400 First line should end with a period
        """验证表结构是否符合预期"""
^
src/storage/database/database_manager.py:637:80: E501 line too long (83 > 79 characters)
                    col["name"]: col for col in actual_structure.get("columns", [])
                                                                               ^
src/storage/database/database_manager.py:658:80: E501 line too long (82 > 79 characters)
                            if expected["type"].lower() != actual["type"].lower():
                                                                               ^
src/storage/database/database_manager.py:660:80: E501 line too long (121 > 79 characters)
                                    f"Column {col_name} type mismatch: expected {expected['type']}, got {actual['type']}"
                                                                               ^
src/storage/database/database_manager.py:667:80: E501 line too long (133 > 79 characters)
                                    f"Column {col_name} nullable mismatch: expected {expected['nullable']}, got {actual['nullable']}"
                                                                               ^
src/storage/database/database_manager.py:672:80: E501 line too long (87 > 79 characters)
                validation_status = "pass" if validation_details["matches"] else "fail"
                                                                               ^
src/storage/database/database_manager.py:695:1: D205 1 blank line required between summary line and description
        """通过配置文件table_config.yaml批量创建表,若yaml格式修改，这个函数也要改
        连接参数将从环境变量中自动获取，无需在YAML中配置
        """
^
src/storage/database/database_manager.py:695:1: D400 First line should end with a period
        """通过配置文件table_config.yaml批量创建表,若yaml格式修改，这个函数也要改
        连接参数将从环境变量中自动获取，无需在YAML中配置
        """
^
src/storage/database/database_manager.py:725:1: D400 First line should end with a period
        """生成ALTER TABLE语句"""
^
src/storage/database/database_manager.py:729:80: E501 line too long (80 > 79 characters)
            operation = alteration.get("operation")  # ADD, DROP, MODIFY, RENAME
                                                                               ^
src/storage/database/database_manager.py:741:80: E501 line too long (89 > 79 characters)
                    f"RENAME COLUMN {alteration['old_name']} TO {alteration['new_name']}"
                                                                               ^
src/storage/database/database_manager.py:747:1: D400 First line should end with a period
        """生成列定义字符串"""
^
src/storage/database/database_manager.py:751:80: E501 line too long (84 > 79 characters)
        if col_def.get("length") and col_def["type"].lower() in ["varchar", "char"]:
                                                                               ^
src/storage/database/database_manager.py:774:80: E501 line too long (82 > 79 characters)
    # 其他方法 (_generate_tdengine_ddl, _generate_postgresql_ddl, _generate_mysql_ddl,
                                                                               ^
src/storage/database/database_manager.py:780:1: D400 First line should end with a period
        """生成TDengine的DDL语句"""
^
src/storage/database/database_manager.py:810:80: E501 line too long (114 > 79 characters)
            ddl = f"CREATE STABLE IF NOT EXISTS {table_name} ({', '.join(col_defs)}) TAGS ({', '.join(tag_defs)})"
                                                                               ^
src/storage/database/database_manager.py:813:80: E501 line too long (95 > 79 characters)
            ddl = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(col_defs + tag_defs)})"
                                                                               ^
src/storage/database/database_manager.py:820:1: D400 First line should end with a period
        """生成PostgreSQL的DDL语句"""
^
src/storage/database/database_manager.py:828:80: E501 line too long (80 > 79 characters)
            if col.get("length") and col["type"].lower() in ["varchar", "char"]:
                                                                               ^
src/storage/database/database_manager.py:830:80: E501 line too long (88 > 79 characters)
            elif col.get("precision") and col["type"].lower() in ["numeric", "decimal"]:
                                                                               ^
src/storage/database/database_manager.py:852:80: E501 line too long (80 > 79 characters)
        ddl = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(col_defs)})"
                                                                               ^
src/storage/database/database_manager.py:857:80: E501 line too long (81 > 79 characters)
            ddl += f"; SELECT create_hypertable('{table_name}', '{time_column}')"
                                                                               ^
src/storage/database/database_manager.py:864:1: D400 First line should end with a period
        """生成MySQL的DDL语句"""
^
src/storage/database/database_manager.py:872:80: E501 line too long (80 > 79 characters)
            if col.get("length") and col["type"].lower() in ["varchar", "char"]:
                                                                               ^
src/storage/database/database_manager.py:874:80: E501 line too long (88 > 79 characters)
            elif col.get("precision") and col["type"].lower() in ["numeric", "decimal"]:
                                                                               ^
src/storage/database/database_manager.py:899:80: E501 line too long (80 > 79 characters)
        ddl = f"CREATE TABLE IF NOT EXISTS {table_name} ({', '.join(col_defs)})"
                                                                               ^
src/storage/database/database_manager.py:915:80: E501 line too long (86 > 79 characters)
    def _initialize_redis_structure(self, conn, key_prefix: str, columns: List[Dict]):
                                                                               ^
src/storage/database/database_manager.py:916:1: D400 First line should end with a period
        """初始化Redis数据结构"""
^
src/storage/database/database_manager.py:939:1: D400 First line should end with a period
        """获取表结构信息"""
^
src/storage/database/database_manager.py:960:1: S608 Possible SQL injection vector through string-based query construction.
                    f"""
                    SELECT column_name, data_type, is_nullable, column_default,
                           character_maximum_length, numeric_precision, numeric_scale
                    FROM information_schema.columns
                    WHERE table_name = '{table_name}'
                    ORDER BY ordinal_position
                """
^
src/storage/database/database_manager.py:961:80: W291 trailing whitespace
                    f"""
                    SELECT column_name, data_type, is_nullable, column_default,
                           character_maximum_length, numeric_precision, numeric_scale
                    FROM information_schema.columns
                    WHERE table_name = '{table_name}'
                    ORDER BY ordinal_position
                """

                                                      ^
src/storage/database/database_manager.py:962:80: E501 line too long (85 > 79 characters)
                    f"""
                    SELECT column_name, data_type, is_nullable, column_default,
                           character_maximum_length, numeric_precision, numeric_scale
                    FROM information_schema.columns
                    WHERE table_name = '{table_name}'
                    ORDER BY ordinal_position
                """

                                                      ^
src/storage/database/database_manager.py:963:52: W291 trailing whitespace
                    f"""
                    SELECT column_name, data_type, is_nullable, column_default,
                           character_maximum_length, numeric_precision, numeric_scale
                    FROM information_schema.columns
                    WHERE table_name = '{table_name}'
                    ORDER BY ordinal_position
                """

                          ^
src/storage/database/database_manager.py:996:65: E203 whitespace before ':'
                        params = type_str[type_str.find("(") + 1 : type_str.find(")")]
                                                                ^
src/storage/database/database_manager.py:996:80: E501 line too long (86 > 79 characters)
                        params = type_str[type_str.find("(") + 1 : type_str.find(")")]
                                                                               ^
src/storage/database/database_manager.py:1012:80: E501 line too long (80 > 79 characters)
            logger.error(f"Failed to get table info for {table_name}: {str(e)}")
                                                                               ^
src/storage/database/database_manager.py:1016:1: D400 First line should end with a period
        """关闭所有数据库连接"""
^
src/storage/database/database_manager.py:1024:80: E501 line too long (80 > 79 characters)
                logger.warning(f"Error closing connection {conn_key}: {str(e)}")
                                                                               ^
src/storage/database/database_manager.py:1032:1: D400 First line should end with a period
        """Context manager entry - 返回自身实例"""
^
src/storage/database/database_manager.py:1036:1: D400 First line should end with a period
        """Context manager exit - 确保关闭所有连接"""
^
src/storage/database/db_utils.py:1:1: D205 1 blank line required between summary line and description
"""
安全的数据库管理工具函数
避免在代码中硬编码敏感信息，统一从环境变量读取
"""
^
src/storage/database/db_utils.py:1:1: D400 First line should end with a period
"""
安全的数据库管理工具函数
避免在代码中硬编码敏感信息，统一从环境变量读取
"""
^
src/storage/database/db_utils.py:13:1: D205 1 blank line required between summary line and description
    """
    安全地创建所需的数据库
    所有连接参数从环境变量中读取
    """
^
src/storage/database/db_utils.py:13:1: D400 First line should end with a period
    """
    安全地创建所需的数据库
    所有连接参数从环境变量中读取
    """
^
src/storage/database/db_utils.py:79:1: D205 1 blank line required between summary line and description
    """
    安全地获取数据库配置
    :param db_type: 数据库类型 ('mysql', 'postgresql', 'tdengine', 'redis', 'mariadb')
    :return: 数据库配置字典或None
    """
^
src/storage/database/db_utils.py:79:1: D400 First line should end with a period
    """
    安全地获取数据库配置
    :param db_type: 数据库类型 ('mysql', 'postgresql', 'tdengine', 'redis', 'mariadb')
    :return: 数据库配置字典或None
    """
^
src/storage/database/db_utils.py:81:80: E501 line too long (81 > 79 characters)
    """
    安全地获取数据库配置
    :param db_type: 数据库类型 ('mysql', 'postgresql', 'tdengine', 'redis', 'mariadb')
    :return: 数据库配置字典或None
    """


                                                        ^
src/storage/database/df2sql.py:2:1: D205 1 blank line required between summary line and description
"""
Created on Mon May 15 10:01:46 2023
@author: CHENGJUN
update: 2025-09-12

功能介绍：这是用来把dataframe保存到mysql的必备转化工具，可根据dataframe生成SQL建表命令
          这个版本是更新过的，它支持设置primary_key和字符集utf8mb4

修改日期：2025-09-12
修改内容：增加了对大整数的支持，自动选择INT或BIGINT类型
"""
^
src/storage/database/df2sql.py:2:1: D400 First line should end with a period
"""
Created on Mon May 15 10:01:46 2023
@author: CHENGJUN
update: 2025-09-12

功能介绍：这是用来把dataframe保存到mysql的必备转化工具，可根据dataframe生成SQL建表命令
          这个版本是更新过的，它支持设置primary_key和字符集utf8mb4

修改日期：2025-09-12
修改内容：增加了对大整数的支持，自动选择INT或BIGINT类型
"""
^
src/storage/database/df2sql.py:16:1: D103 Missing docstring in public function
def create_sql_cmd(df, table_name, primary_key=None):
^
src/storage/database/df2sql.py:30:80: E501 line too long (86 > 79 characters)
        if pd.api.types.is_object_dtype(dtype) or pd.api.types.is_string_dtype(dtype):
                                                                               ^
src/storage/database/df2sql.py:55:80: E501 line too long (89 > 79 characters)
            create_table_query += f"{col} DECIMAL(10, 2), "  # 假设DECIMAL类型，精度和小数位数可根据需要调整
                                                                               ^
src/storage/database/df2sql.py:65:80: E501 line too long (84 > 79 characters)
    create_table_query = create_table_query.rstrip(", ") + ") CHARACTER SET utf8mb4"
                                                                               ^
src/storage/database/execute_example.py:1:1: D100 Missing docstring in public module
from database_manager import DatabaseTableManager, DatabaseType
^
src/storage/database/execute_example.py:41:80: E501 line too long (88 > 79 characters)
alterations = [{"operation": "ADD", "name": "new_col", "type": "INT", "nullable": True}]
                                                                               ^
src/storage/database/execute_example_mysql_only.py:1:1: D100 Missing docstring in public module
from database_manager import DatabaseTableManager, DatabaseType
^
src/storage/database/execute_example_mysql_only.py:40:80: E501 line too long (84 > 79 characters)
temp_config_file = os.path.join(os.path.dirname(__file__), "mysql_only_config.yaml")
                                                                               ^
src/storage/database/execute_example_mysql_only.py:57:80: E501 line too long (82 > 79 characters)
success = manager.create_table(DatabaseType.MYSQL, "test_db", "my_table", columns)
                                                                               ^
src/storage/database/execute_example_mysql_only.py:62:80: E501 line too long (88 > 79 characters)
alterations = [{"operation": "ADD", "name": "new_col", "type": "INT", "nullable": True}]
                                                                               ^
src/storage/database/execute_example_mysql_only.py:64:80: E501 line too long (85 > 79 characters)
success = manager.alter_table(DatabaseType.MYSQL, "test_db", "my_table", alterations)
                                                                               ^
src/storage/database/execute_example_mysql_only.py:80:1: S110 Try, Except, Pass detected.
except Exception:
^
src/storage/database/fix_database_connections.py:3:1: D205 1 blank line required between summary line and description
"""
数据库连接修复工具
用于解决MyStocks项目中的数据库连接问题
"""
^
src/storage/database/fix_database_connections.py:3:1: D400 First line should end with a period
"""
数据库连接修复工具
用于解决MyStocks项目中的数据库连接问题
"""
^
src/storage/database/fix_database_connections.py:17:1: E402 module level import not at top of file
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
^
src/storage/database/fix_database_connections.py:17:80: E501 line too long (84 > 79 characters)
from src.storage.database.database_manager import DatabaseTableManager, DatabaseType
                                                                               ^
src/storage/database/fix_database_connections.py:21:80: E501 line too long (85 > 79 characters)
    level=logging.INFO, format="%(asctime)s - %(name)s - %(levelname)s - %(message)s"
                                                                               ^
src/storage/database/fix_database_connections.py:27:1: D400 First line should end with a period
    """检查所有数据库连接配置"""
^
src/storage/database/fix_database_connections.py:50:1: D400 First line should end with a period
    """修复PostgreSQL中的hypertable问题"""
^
src/storage/database/fix_database_connections.py:65:80: E501 line too long (86 > 79 characters)
        cur.execute("SELECT extname FROM pg_extension WHERE extname = 'timescaledb';")
                                                                               ^
src/storage/database/fix_database_connections.py:87:1: D400 First line should end with a period
    """修复TDengine数据库指定问题"""
^
src/storage/database/fix_database_connections.py:107:1: D400 First line should end with a period
    """创建所需的数据库"""
^
src/storage/database/fix_database_connections.py:167:80: E501 line too long (81 > 79 characters)
            print(f"连接到MariaDB服务器: {mariadb_user}@{mariadb_host}:{mariadb_port}")
                                                                               ^
src/storage/database/fix_database_connections.py:178:80: E501 line too long (98 > 79 characters)
                f"CREATE DATABASE IF NOT EXISTS {os.getenv('MARIADB_DATABASE', 'quant_research')}"
                                                                               ^
src/storage/database/fix_database_connections.py:181:80: E501 line too long (89 > 79 characters)
                f"  ✓ MariaDB数据库 {os.getenv('MARIADB_DATABASE', 'quant_research')} 已确保存在"
                                                                               ^
src/storage/database/fix_database_connections.py:196:1: D400 First line should end with a period
    """验证所有数据库连接"""
^
src/storage/database/fix_database_connections.py:254:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/fixed_example.py:3:1: D205 1 blank line required between summary line and description
"""
修复后的数据库管理示例
只使用可用的数据库库进行测试
"""
^
src/storage/database/fixed_example.py:3:1: D400 First line should end with a period
"""
修复后的数据库管理示例
只使用可用的数据库库进行测试
"""
^
src/storage/database/fixed_example.py:17:1: D400 First line should end with a period
    """测试DatabaseTableManager导入"""
^
src/storage/database/fixed_example.py:31:1: D400 First line should end with a period
    """创建简单的MySQL示例（仅生成DDL，不连接数据库）"""
^
src/storage/database/fixed_example.py:43:15: F541 f-string is missing placeholders
        print(f"生成的MySQL DDL语句:")
              ^
src/storage/database/fixed_example.py:55:1: D400 First line should end with a period
    """测试YAML配置文件加载"""
^
src/storage/database/fixed_example.py:61:80: E501 line too long (82 > 79 characters)
        config_file = os.path.join(os.path.dirname(__file__), "table_config.yaml")
                                                                               ^
src/storage/database/fixed_example.py:81:1: D103 Missing docstring in public function
def main():
^
src/storage/database/init_db_monitor.py:1:1: D100 Missing docstring in public module
# 正常执行（不删除已有表）：python execute_sql_with_env.py
^
src/storage/database/init_db_monitor.py:19:80: E501 line too long (97 > 79 characters)
    format="{time:YYYY-MM-DD HH:mm:ss.SSS} | {level: <8} | {name}:{function}:{line} | {message}",
                                                                               ^
src/storage/database/init_db_monitor.py:25:80: E501 line too long (115 > 79 characters)
    format="<green>{time:HH:mm:ss.SSS}</green> | <level>{level: <8}</level> | <cyan>{function}</cyan> | {message}",
                                                                               ^
src/storage/database/init_db_monitor.py:30:1: D400 First line should end with a period
    """
    智能查找环境变量文件，支持多种工作目录

    Args:
        default_path (str): 默认相对路径

    Returns:
        str: 找到的环境文件绝对路径

    Raises:
        FileNotFoundError: 如果所有路径都找不到文件
    """
^
src/storage/database/init_db_monitor.py:86:80: E501 line too long (92 > 79 characters)
    error_msg = f"""
环境变量文件未找到！已尝试以下路径：
{''.join([f"  {i}. {os.path.abspath(path)}\n" for i, path in enumerate(possible_paths, 1)])}
请确保：
1. .env 文件存在于正确位置
2. 当前工作目录正确 (当前: {os.getcwd()})
3. 文件路径权限正确
"""


                                       ^
src/storage/database/init_db_monitor.py:98:1: D400 First line should end with a period
    """从环境变量文件加载配置"""
^
src/storage/database/init_db_monitor.py:135:80: E501 line too long (84 > 79 characters)
        required_keys = ["MYSQL_HOST", "MYSQL_USER", "MYSQL_PASSWORD", "MYSQL_PORT"]
                                                                               ^
src/storage/database/init_db_monitor.py:155:80: E501 line too long (94 > 79 characters)
            f"🔗 数据库连接信息: {config['MYSQL_USER']}@{config['MYSQL_HOST']}:{config['MYSQL_PORT']}"
                                                                               ^
src/storage/database/init_db_monitor.py:169:1: D400 First line should end with a period
    """生成SQL命令，支持删除已有表选项"""
^
src/storage/database/init_db_monitor.py:184:41: W291 trailing whitespace
    return f"""
CREATE DATABASE IF NOT EXISTS db_monitor
    CHARACTER SET {charset}
    COLLATE {collation};

USE db_monitor;

{drop_commands}

{create_table_prefix} table_creation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    creation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    modification_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    status ENUM('success', 'failed') NOT NULL COMMENT '创建状态',
    table_parameters JSON NOT NULL COMMENT '表参数配置（JSON格式）',
    ddl_command TEXT NOT NULL COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    INDEX idx_database_type (database_type),
    INDEX idx_creation_time (creation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表创建日志表';

{create_table_prefix} column_definition_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_log_id INT NOT NULL COMMENT '关联的表创建日志ID',
    column_name VARCHAR(255) NOT NULL COMMENT '列名',
    data_type VARCHAR(100) NOT NULL COMMENT '数据类型',
    col_length INT COMMENT '列长度',
    col_precision INT COMMENT '精度',
    col_scale INT COMMENT '小数位数',
    is_nullable BOOLEAN DEFAULT TRUE COMMENT '是否允许为空',
    is_primary_key BOOLEAN DEFAULT FALSE COMMENT '是否为主键',
    default_value VARCHAR(255) COMMENT '默认值',
    comment TEXT COMMENT '列备注',
    FOREIGN KEY (table_log_id) REFERENCES table_creation_log(id) ON DELETE CASCADE,
    INDEX idx_table_log_id (table_log_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='列定义日志表';

-- 新增表操作日志表
{create_table_prefix} table_operation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    operation_id VARCHAR(100) NOT NULL COMMENT '操作ID',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    operation_type ENUM('CREATE', 'ALTER', 'DROP', 'VALIDATE', 'save_data', 'save_data_with_dedup', 'load_data', 'upsert_data', 'insert_data') NOT NULL COMMENT '操作类型',
    operation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
    operation_status ENUM('success', 'failed', 'processing') NOT NULL COMMENT '操作状态',
    operation_details JSON NOT NULL COMMENT '操作详情（JSON格式）',
    ddl_command TEXT COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    data_count INT DEFAULT 0 COMMENT '数据记录数',
    duration_seconds DECIMAL(10,3) DEFAULT 0 COMMENT '执行耗时（秒）',
    end_time TIMESTAMP NULL COMMENT '结束时间',
    INDEX idx_operation_id (operation_id),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    UNIQUE KEY uk_operation_id (operation_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表操作日志表';

-- 新增表结构验证日志表
{create_table_prefix} table_validation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    validation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '验证时间',
    validation_status ENUM('pass', 'fail') NOT NULL COMMENT '验证状态',
    validation_details JSON NOT NULL COMMENT '验证详情（JSON格式）',
    issues_found TEXT COMMENT '发现的问题',
    INDEX idx_validation_time (validation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表结构验证日志表';
"""

                        ^
src/storage/database/init_db_monitor.py:185:28: W291 trailing whitespace
    return f"""
CREATE DATABASE IF NOT EXISTS db_monitor
    CHARACTER SET {charset}
    COLLATE {collation};

USE db_monitor;

{drop_commands}

{create_table_prefix} table_creation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    creation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    modification_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    status ENUM('success', 'failed') NOT NULL COMMENT '创建状态',
    table_parameters JSON NOT NULL COMMENT '表参数配置（JSON格式）',
    ddl_command TEXT NOT NULL COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    INDEX idx_database_type (database_type),
    INDEX idx_creation_time (creation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表创建日志表';

{create_table_prefix} column_definition_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_log_id INT NOT NULL COMMENT '关联的表创建日志ID',
    column_name VARCHAR(255) NOT NULL COMMENT '列名',
    data_type VARCHAR(100) NOT NULL COMMENT '数据类型',
    col_length INT COMMENT '列长度',
    col_precision INT COMMENT '精度',
    col_scale INT COMMENT '小数位数',
    is_nullable BOOLEAN DEFAULT TRUE COMMENT '是否允许为空',
    is_primary_key BOOLEAN DEFAULT FALSE COMMENT '是否为主键',
    default_value VARCHAR(255) COMMENT '默认值',
    comment TEXT COMMENT '列备注',
    FOREIGN KEY (table_log_id) REFERENCES table_creation_log(id) ON DELETE CASCADE,
    INDEX idx_table_log_id (table_log_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='列定义日志表';

-- 新增表操作日志表
{create_table_prefix} table_operation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    operation_id VARCHAR(100) NOT NULL COMMENT '操作ID',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    operation_type ENUM('CREATE', 'ALTER', 'DROP', 'VALIDATE', 'save_data', 'save_data_with_dedup', 'load_data', 'upsert_data', 'insert_data') NOT NULL COMMENT '操作类型',
    operation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
    operation_status ENUM('success', 'failed', 'processing') NOT NULL COMMENT '操作状态',
    operation_details JSON NOT NULL COMMENT '操作详情（JSON格式）',
    ddl_command TEXT COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    data_count INT DEFAULT 0 COMMENT '数据记录数',
    duration_seconds DECIMAL(10,3) DEFAULT 0 COMMENT '执行耗时（秒）',
    end_time TIMESTAMP NULL COMMENT '结束时间',
    INDEX idx_operation_id (operation_id),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    UNIQUE KEY uk_operation_id (operation_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表操作日志表';

-- 新增表结构验证日志表
{create_table_prefix} table_validation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    validation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '验证时间',
    validation_status ENUM('pass', 'fail') NOT NULL COMMENT '验证状态',
    validation_details JSON NOT NULL COMMENT '验证详情（JSON格式）',
    issues_found TEXT COMMENT '发现的问题',
    INDEX idx_validation_time (validation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表结构验证日志表';
"""

           ^
src/storage/database/init_db_monitor.py:198:80: E501 line too long (101 > 79 characters)
    return f"""
CREATE DATABASE IF NOT EXISTS db_monitor
    CHARACTER SET {charset}
    COLLATE {collation};

USE db_monitor;

{drop_commands}

{create_table_prefix} table_creation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    creation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    modification_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    status ENUM('success', 'failed') NOT NULL COMMENT '创建状态',
    table_parameters JSON NOT NULL COMMENT '表参数配置（JSON格式）',
    ddl_command TEXT NOT NULL COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    INDEX idx_database_type (database_type),
    INDEX idx_creation_time (creation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表创建日志表';

{create_table_prefix} column_definition_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_log_id INT NOT NULL COMMENT '关联的表创建日志ID',
    column_name VARCHAR(255) NOT NULL COMMENT '列名',
    data_type VARCHAR(100) NOT NULL COMMENT '数据类型',
    col_length INT COMMENT '列长度',
    col_precision INT COMMENT '精度',
    col_scale INT COMMENT '小数位数',
    is_nullable BOOLEAN DEFAULT TRUE COMMENT '是否允许为空',
    is_primary_key BOOLEAN DEFAULT FALSE COMMENT '是否为主键',
    default_value VARCHAR(255) COMMENT '默认值',
    comment TEXT COMMENT '列备注',
    FOREIGN KEY (table_log_id) REFERENCES table_creation_log(id) ON DELETE CASCADE,
    INDEX idx_table_log_id (table_log_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='列定义日志表';

-- 新增表操作日志表
{create_table_prefix} table_operation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    operation_id VARCHAR(100) NOT NULL COMMENT '操作ID',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    operation_type ENUM('CREATE', 'ALTER', 'DROP', 'VALIDATE', 'save_data', 'save_data_with_dedup', 'load_data', 'upsert_data', 'insert_data') NOT NULL COMMENT '操作类型',
    operation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
    operation_status ENUM('success', 'failed', 'processing') NOT NULL COMMENT '操作状态',
    operation_details JSON NOT NULL COMMENT '操作详情（JSON格式）',
    ddl_command TEXT COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    data_count INT DEFAULT 0 COMMENT '数据记录数',
    duration_seconds DECIMAL(10,3) DEFAULT 0 COMMENT '执行耗时（秒）',
    end_time TIMESTAMP NULL COMMENT '结束时间',
    INDEX idx_operation_id (operation_id),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    UNIQUE KEY uk_operation_id (operation_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表操作日志表';

-- 新增表结构验证日志表
{create_table_prefix} table_validation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    validation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '验证时间',
    validation_status ENUM('pass', 'fail') NOT NULL COMMENT '验证状态',
    validation_details JSON NOT NULL COMMENT '验证详情（JSON格式）',
    issues_found TEXT COMMENT '发现的问题',
    INDEX idx_validation_time (validation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表结构验证日志表';
"""


                     ^
src/storage/database/init_db_monitor.py:219:80: E501 line too long (83 > 79 characters)
    return f"""
CREATE DATABASE IF NOT EXISTS db_monitor
    CHARACTER SET {charset}
    COLLATE {collation};

USE db_monitor;

{drop_commands}

{create_table_prefix} table_creation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    creation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    modification_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    status ENUM('success', 'failed') NOT NULL COMMENT '创建状态',
    table_parameters JSON NOT NULL COMMENT '表参数配置（JSON格式）',
    ddl_command TEXT NOT NULL COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    INDEX idx_database_type (database_type),
    INDEX idx_creation_time (creation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表创建日志表';

{create_table_prefix} column_definition_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_log_id INT NOT NULL COMMENT '关联的表创建日志ID',
    column_name VARCHAR(255) NOT NULL COMMENT '列名',
    data_type VARCHAR(100) NOT NULL COMMENT '数据类型',
    col_length INT COMMENT '列长度',
    col_precision INT COMMENT '精度',
    col_scale INT COMMENT '小数位数',
    is_nullable BOOLEAN DEFAULT TRUE COMMENT '是否允许为空',
    is_primary_key BOOLEAN DEFAULT FALSE COMMENT '是否为主键',
    default_value VARCHAR(255) COMMENT '默认值',
    comment TEXT COMMENT '列备注',
    FOREIGN KEY (table_log_id) REFERENCES table_creation_log(id) ON DELETE CASCADE,
    INDEX idx_table_log_id (table_log_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='列定义日志表';

-- 新增表操作日志表
{create_table_prefix} table_operation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    operation_id VARCHAR(100) NOT NULL COMMENT '操作ID',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    operation_type ENUM('CREATE', 'ALTER', 'DROP', 'VALIDATE', 'save_data', 'save_data_with_dedup', 'load_data', 'upsert_data', 'insert_data') NOT NULL COMMENT '操作类型',
    operation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
    operation_status ENUM('success', 'failed', 'processing') NOT NULL COMMENT '操作状态',
    operation_details JSON NOT NULL COMMENT '操作详情（JSON格式）',
    ddl_command TEXT COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    data_count INT DEFAULT 0 COMMENT '数据记录数',
    duration_seconds DECIMAL(10,3) DEFAULT 0 COMMENT '执行耗时（秒）',
    end_time TIMESTAMP NULL COMMENT '结束时间',
    INDEX idx_operation_id (operation_id),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    UNIQUE KEY uk_operation_id (operation_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表操作日志表';

-- 新增表结构验证日志表
{create_table_prefix} table_validation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    validation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '验证时间',
    validation_status ENUM('pass', 'fail') NOT NULL COMMENT '验证状态',
    validation_details JSON NOT NULL COMMENT '验证详情（JSON格式）',
    issues_found TEXT COMMENT '发现的问题',
    INDEX idx_validation_time (validation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表结构验证日志表';
"""


                     ^
src/storage/database/init_db_monitor.py:230:80: E501 line too long (167 > 79 characters)
    return f"""
CREATE DATABASE IF NOT EXISTS db_monitor
    CHARACTER SET {charset}
    COLLATE {collation};

USE db_monitor;

{drop_commands}

{create_table_prefix} table_creation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    creation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    modification_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    status ENUM('success', 'failed') NOT NULL COMMENT '创建状态',
    table_parameters JSON NOT NULL COMMENT '表参数配置（JSON格式）',
    ddl_command TEXT NOT NULL COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    INDEX idx_database_type (database_type),
    INDEX idx_creation_time (creation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表创建日志表';

{create_table_prefix} column_definition_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_log_id INT NOT NULL COMMENT '关联的表创建日志ID',
    column_name VARCHAR(255) NOT NULL COMMENT '列名',
    data_type VARCHAR(100) NOT NULL COMMENT '数据类型',
    col_length INT COMMENT '列长度',
    col_precision INT COMMENT '精度',
    col_scale INT COMMENT '小数位数',
    is_nullable BOOLEAN DEFAULT TRUE COMMENT '是否允许为空',
    is_primary_key BOOLEAN DEFAULT FALSE COMMENT '是否为主键',
    default_value VARCHAR(255) COMMENT '默认值',
    comment TEXT COMMENT '列备注',
    FOREIGN KEY (table_log_id) REFERENCES table_creation_log(id) ON DELETE CASCADE,
    INDEX idx_table_log_id (table_log_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='列定义日志表';

-- 新增表操作日志表
{create_table_prefix} table_operation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    operation_id VARCHAR(100) NOT NULL COMMENT '操作ID',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    operation_type ENUM('CREATE', 'ALTER', 'DROP', 'VALIDATE', 'save_data', 'save_data_with_dedup', 'load_data', 'upsert_data', 'insert_data') NOT NULL COMMENT '操作类型',
    operation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
    operation_status ENUM('success', 'failed', 'processing') NOT NULL COMMENT '操作状态',
    operation_details JSON NOT NULL COMMENT '操作详情（JSON格式）',
    ddl_command TEXT COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    data_count INT DEFAULT 0 COMMENT '数据记录数',
    duration_seconds DECIMAL(10,3) DEFAULT 0 COMMENT '执行耗时（秒）',
    end_time TIMESTAMP NULL COMMENT '结束时间',
    INDEX idx_operation_id (operation_id),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    UNIQUE KEY uk_operation_id (operation_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表操作日志表';

-- 新增表结构验证日志表
{create_table_prefix} table_validation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    validation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '验证时间',
    validation_status ENUM('pass', 'fail') NOT NULL COMMENT '验证状态',
    validation_details JSON NOT NULL COMMENT '验证详情（JSON格式）',
    issues_found TEXT COMMENT '发现的问题',
    INDEX idx_validation_time (validation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表结构验证日志表';
"""


                     ^
src/storage/database/init_db_monitor.py:232:80: E501 line too long (85 > 79 characters)
    return f"""
CREATE DATABASE IF NOT EXISTS db_monitor
    CHARACTER SET {charset}
    COLLATE {collation};

USE db_monitor;

{drop_commands}

{create_table_prefix} table_creation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    creation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    modification_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    status ENUM('success', 'failed') NOT NULL COMMENT '创建状态',
    table_parameters JSON NOT NULL COMMENT '表参数配置（JSON格式）',
    ddl_command TEXT NOT NULL COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    INDEX idx_database_type (database_type),
    INDEX idx_creation_time (creation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表创建日志表';

{create_table_prefix} column_definition_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_log_id INT NOT NULL COMMENT '关联的表创建日志ID',
    column_name VARCHAR(255) NOT NULL COMMENT '列名',
    data_type VARCHAR(100) NOT NULL COMMENT '数据类型',
    col_length INT COMMENT '列长度',
    col_precision INT COMMENT '精度',
    col_scale INT COMMENT '小数位数',
    is_nullable BOOLEAN DEFAULT TRUE COMMENT '是否允许为空',
    is_primary_key BOOLEAN DEFAULT FALSE COMMENT '是否为主键',
    default_value VARCHAR(255) COMMENT '默认值',
    comment TEXT COMMENT '列备注',
    FOREIGN KEY (table_log_id) REFERENCES table_creation_log(id) ON DELETE CASCADE,
    INDEX idx_table_log_id (table_log_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='列定义日志表';

-- 新增表操作日志表
{create_table_prefix} table_operation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    operation_id VARCHAR(100) NOT NULL COMMENT '操作ID',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    operation_type ENUM('CREATE', 'ALTER', 'DROP', 'VALIDATE', 'save_data', 'save_data_with_dedup', 'load_data', 'upsert_data', 'insert_data') NOT NULL COMMENT '操作类型',
    operation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '操作时间',
    operation_status ENUM('success', 'failed', 'processing') NOT NULL COMMENT '操作状态',
    operation_details JSON NOT NULL COMMENT '操作详情（JSON格式）',
    ddl_command TEXT COMMENT '执行的DDL命令',
    error_message TEXT COMMENT '错误信息（如有）',
    data_count INT DEFAULT 0 COMMENT '数据记录数',
    duration_seconds DECIMAL(10,3) DEFAULT 0 COMMENT '执行耗时（秒）',
    end_time TIMESTAMP NULL COMMENT '结束时间',
    INDEX idx_operation_id (operation_id),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    UNIQUE KEY uk_operation_id (operation_id)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表操作日志表';

-- 新增表结构验证日志表
{create_table_prefix} table_validation_log (
    id INT AUTO_INCREMENT PRIMARY KEY COMMENT '自增主键',
    table_name VARCHAR(255) NOT NULL COMMENT '表名',
    database_type ENUM('TDengine', 'PostgreSQL') NOT NULL COMMENT '数据库类型',
    database_name VARCHAR(255) NOT NULL COMMENT '数据库名称',
    validation_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '验证时间',
    validation_status ENUM('pass', 'fail') NOT NULL COMMENT '验证状态',
    validation_details JSON NOT NULL COMMENT '验证详情（JSON格式）',
    issues_found TEXT COMMENT '发现的问题',
    INDEX idx_validation_time (validation_time)
) ENGINE=InnoDB DEFAULT CHARSET={charset} COMMENT='表结构验证日志表';
"""


                     ^
src/storage/database/init_db_monitor.py:261:1: D400 First line should end with a period
    """创建数据库和表结构"""
^
src/storage/database/init_db_monitor.py:277:80: E501 line too long (83 > 79 characters)
            f"🔗 连接数据库: {db_config['user']}@{db_config['host']}:{db_config['port']}"
                                                                               ^
src/storage/database/init_db_monitor.py:325:80: E501 line too long (81 > 79 characters)
                                f"📋 [{i}/{total_commands}] 执行 SQL: {cmd[:50]}..."
                                                                               ^
src/storage/database/init_db_monitor.py:339:80: E501 line too long (103 > 79 characters)
                            f"❌ [{i}/{total_commands}] SQL执行失败 (耗时: {cmd_time:.3f}s): {str(cmd_error)}"
                                                                               ^
src/storage/database/init_db_monitor.py:346:24: F541 f-string is missing placeholders
        logger.success(f"✓ 数据库初始化完成!")
                       ^
src/storage/database/init_db_monitor.py:348:80: E501 line too long (90 > 79 characters)
            f"📊 执行统计: 成功 {executed_commands} / 失败 {failed_commands} / 总计 {total_commands}"
                                                                               ^
src/storage/database/init_db_monitor.py:378:1: D400 First line should end with a period
    """
    初始化监控数据库（专用于 Jupyter 环境调用）

    Args:
        drop_existing (bool): 是否删除已存在的表

    Returns:
        bool: 初始化是否成功

    Examples:
        # 在 Jupyter 中使用
        success = init_monitoring_database()

        # 删除已存在的表并重建
        success = init_monitoring_database(drop_existing=True)
    """
^
src/storage/database/init_db_monitor.py:416:1: D400 First line should end with a period
    """从 CREATE TABLE 命令中提取表名"""
^
src/storage/database/save_realtime_market_data.py:3:1: D205 1 blank line required between summary line and description
"""
沪深市场A股实时数据保存系统 - efinance版本
严格按照MyStocks系统的统一接口规范和数据分类策略实现

核心设计理念：
1. 使用efinance的ef.stock.get_realtime_quotes()获取沪深A股实时数据
2. 使用统一管理器 (MyStocksUnifiedManager) - 隐藏底层数据库差异
3. 正确的数据分类 - 实时行情数据保存为REALTIME_POSITIONS (Redis) + DAILY_KLINE (PostgreSQL)
4. 自动路由保存 - 系统自动选择最优数据库存储
5. 完整监控集成 - 所有操作自动记录到监控数据库

数据分类策略：
- ef.stock.get_realtime_quotes() 获取的实时行情快照：
  * REALTIME_POSITIONS → Redis (热数据，快速访问)
  * DAILY_KLINE → PostgreSQL+TimescaleDB (持久化存储，分析查询)
- 双重保存确保数据的实时性和持久性

作者: MyStocks项目组
日期: 2025-09-23
修正: 使用efinance接口并保存到PostgreSQL
"""
^
src/storage/database/save_realtime_market_data.py:3:1: D400 First line should end with a period
"""
沪深市场A股实时数据保存系统 - efinance版本
严格按照MyStocks系统的统一接口规范和数据分类策略实现

核心设计理念：
1. 使用efinance的ef.stock.get_realtime_quotes()获取沪深A股实时数据
2. 使用统一管理器 (MyStocksUnifiedManager) - 隐藏底层数据库差异
3. 正确的数据分类 - 实时行情数据保存为REALTIME_POSITIONS (Redis) + DAILY_KLINE (PostgreSQL)
4. 自动路由保存 - 系统自动选择最优数据库存储
5. 完整监控集成 - 所有操作自动记录到监控数据库

数据分类策略：
- ef.stock.get_realtime_quotes() 获取的实时行情快照：
  * REALTIME_POSITIONS → Redis (热数据，快速访问)
  * DAILY_KLINE → PostgreSQL+TimescaleDB (持久化存储，分析查询)
- 双重保存确保数据的实时性和持久性

作者: MyStocks项目组
日期: 2025-09-23
修正: 使用efinance接口并保存到PostgreSQL
"""
^
src/storage/database/save_realtime_market_data.py:15:1: RST301 Unexpected indentation.
"""
沪深市场A股实时数据保存系统 - efinance版本
严格按照MyStocks系统的统一接口规范和数据分类策略实现

核心设计理念：
1. 使用efinance的ef.stock.get_realtime_quotes()获取沪深A股实时数据
2. 使用统一管理器 (MyStocksUnifiedManager) - 隐藏底层数据库差异
3. 正确的数据分类 - 实时行情数据保存为REALTIME_POSITIONS (Redis) + DAILY_KLINE (PostgreSQL)
4. 自动路由保存 - 系统自动选择最优数据库存储
5. 完整监控集成 - 所有操作自动记录到监控数据库

数据分类策略：
- ef.stock.get_realtime_quotes() 获取的实时行情快照：
  * REALTIME_POSITIONS → Redis (热数据，快速访问)
  * DAILY_KLINE → PostgreSQL+TimescaleDB (持久化存储，分析查询)
- 双重保存确保数据的实时性和持久性

作者: MyStocks项目组
日期: 2025-09-23
修正: 使用efinance接口并保存到PostgreSQL
"""
^
src/storage/database/save_realtime_market_data.py:17:1: RST201 Block quote ends without a blank line; unexpected unindent.
"""
沪深市场A股实时数据保存系统 - efinance版本
严格按照MyStocks系统的统一接口规范和数据分类策略实现

核心设计理念：
1. 使用efinance的ef.stock.get_realtime_quotes()获取沪深A股实时数据
2. 使用统一管理器 (MyStocksUnifiedManager) - 隐藏底层数据库差异
3. 正确的数据分类 - 实时行情数据保存为REALTIME_POSITIONS (Redis) + DAILY_KLINE (PostgreSQL)
4. 自动路由保存 - 系统自动选择最优数据库存储
5. 完整监控集成 - 所有操作自动记录到监控数据库

数据分类策略：
- ef.stock.get_realtime_quotes() 获取的实时行情快照：
  * REALTIME_POSITIONS → Redis (热数据，快速访问)
  * DAILY_KLINE → PostgreSQL+TimescaleDB (持久化存储，分析查询)
- 双重保存确保数据的实时性和持久性

作者: MyStocks项目组
日期: 2025-09-23
修正: 使用efinance接口并保存到PostgreSQL
"""
^
src/storage/database/save_realtime_market_data.py:38:1: E402 module level import not at top of file
from unified_manager import MyStocksUnifiedManager
^
src/storage/database/save_realtime_market_data.py:39:1: E402 module level import not at top of file
from src.core import DataClassification
^
src/storage/database/save_realtime_market_data.py:40:1: E402 module level import not at top of file
from src.adapters.customer_adapter import CustomerDataSource
^
src/storage/database/save_realtime_market_data.py:44:1: D400 First line should end with a period
    """沪深市场A股实时数据保存器 - 按照MyStocks统一接口规范实现"""
^
src/storage/database/save_realtime_market_data.py:47:1: D400 First line should end with a period
        """初始化数据保存器"""
^
src/storage/database/save_realtime_market_data.py:59:1: D400 First line should end with a period
        """配置日志系统"""
^
src/storage/database/save_realtime_market_data.py:66:80: E501 line too long (83 > 79 characters)
                logging.FileHandler("realtime_market_saver.log", encoding="utf-8"),
                                                                               ^
src/storage/database/save_realtime_market_data.py:75:1: D400 First line should end with a period
        """加载配置参数"""
^
src/storage/database/save_realtime_market_data.py:106:80: E501 line too long (85 > 79 characters)
            "add_timestamp_column": os.getenv("ADD_TIMESTAMP_COLUMN", "true").lower()
                                                                               ^
src/storage/database/save_realtime_market_data.py:124:80: E501 line too long (80 > 79 characters)
        self.logger.info(f"🔥 保存为实时数据(Redis): {self.config['save_as_realtime']}")
                                                                               ^
src/storage/database/save_realtime_market_data.py:128:80: E501 line too long (82 > 79 characters)
        self.logger.info(f"⏱️ 保存为Tick数据(TDengine): {self.config['save_as_tick']}")
                                                                               ^
src/storage/database/save_realtime_market_data.py:131:1: D400 First line should end with a period
        """初始化MyStocks统一管理器"""
^
src/storage/database/save_realtime_market_data.py:165:1: D400 First line should end with a period
        """初始化数据源适配器"""
^
src/storage/database/save_realtime_market_data.py:183:1: D400 First line should end with a period
        """使用efinance获取沪深市场A股实时数据"""
^
src/storage/database/save_realtime_market_data.py:231:1: D400 First line should end with a period
        """验证市场数据的基本结构"""
^
src/storage/database/save_realtime_market_data.py:240:80: E501 line too long (84 > 79 characters)
            has_symbol_column = any(col in data.columns for col in expected_columns)
                                                                               ^
src/storage/database/save_realtime_market_data.py:252:80: E501 line too long (80 > 79 characters)
                    f"📊 数据包含空值: {null_counts[null_counts > 0].head().to_dict()}"
                                                                               ^
src/storage/database/save_realtime_market_data.py:261:80: E501 line too long (87 > 79 characters)
    def save_data_using_unified_interface(self, data: pd.DataFrame) -> Dict[str, bool]:
                                                                               ^
src/storage/database/save_realtime_market_data.py:262:1: D400 First line should end with a period
        """使用MyStocks统一接口保存数据"""
^
src/storage/database/save_realtime_market_data.py:299:80: E501 line too long (83 > 79 characters)
                        success = self.unified_manager.save_data_by_classification(
                                                                               ^
src/storage/database/save_realtime_market_data.py:329:80: E501 line too long (83 > 79 characters)
                        success = self.unified_manager.save_data_by_classification(
                                                                               ^
src/storage/database/save_realtime_market_data.py:355:80: E501 line too long (87 > 79 characters)
    def _prepare_daily_data(self, market_data: pd.DataFrame) -> Optional[pd.DataFrame]:
                                                                               ^
src/storage/database/save_realtime_market_data.py:356:1: D400 First line should end with a period
        """将实时市场数据转换为日线数据格式（用于PostgreSQL存储）"""
^
src/storage/database/save_realtime_market_data.py:379:80: E501 line too long (87 > 79 characters)
                if old_col in daily_data.columns and new_col not in daily_data.columns:
                                                                               ^
src/storage/database/save_realtime_market_data.py:383:13: F841 local variable 'required_columns' is assigned to but never used
            required_columns = ["symbol", "trade_date"]
            ^
src/storage/database/save_realtime_market_data.py:398:80: E501 line too long (81 > 79 characters)
            if "close" not in daily_data.columns and "最新价" in daily_data.columns:
                                                                               ^
src/storage/database/save_realtime_market_data.py:402:80: E501 line too long (82 > 79 characters)
            numeric_columns = ["open", "high", "low", "close", "volume", "amount"]
                                                                               ^
src/storage/database/save_realtime_market_data.py:410:80: E501 line too long (85 > 79 characters)
                    daily_data[col] = pd.to_numeric(daily_data[col], errors="coerce")
                                                                               ^
src/storage/database/save_realtime_market_data.py:414:80: E501 line too long (83 > 79 characters)
                if col not in daily_data.columns and "close" in daily_data.columns:
                                                                               ^
src/storage/database/save_realtime_market_data.py:453:80: E501 line too long (86 > 79 characters)
    def _prepare_tick_data(self, market_data: pd.DataFrame) -> Optional[pd.DataFrame]:
                                                                               ^
src/storage/database/save_realtime_market_data.py:454:1: D400 First line should end with a period
        """将市场数据转换为Tick数据格式（用于TDengine存储）"""
^
src/storage/database/save_realtime_market_data.py:457:80: E501 line too long (84 > 79 characters)
            # 标准Tick格式通常包含: ts(时间戳), symbol(代码), price(价格), volume(成交量), amount(成交额)
                                                                               ^
src/storage/database/save_realtime_market_data.py:480:80: E501 line too long (85 > 79 characters)
                if old_col in tick_data.columns and new_col not in tick_data.columns:
                                                                               ^
src/storage/database/save_realtime_market_data.py:506:1: D400 First line should end with a period
        """执行完整的数据获取和保存流程"""
^
src/storage/database/save_realtime_market_data.py:537:80: E501 line too long (80 > 79 characters)
            success_count = sum(1 for result in save_results.values() if result)
                                                                               ^
src/storage/database/save_realtime_market_data.py:566:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/storage/database/save_realtime_market_data.py:586:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/save_realtime_market_data.py:609:80: E501 line too long (94 > 79 characters)
        "数据分类: REALTIME_POSITIONS → Redis, DAILY_KLINE → PostgreSQL, TICK_DATA → TDengine(可选)"
                                                                               ^
src/storage/database/save_realtime_market_data.py:631:80: E501 line too long (82 > 79 characters)
                    market_symbol=saver.config["market_symbol"], bypass_cache=True
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:3:1: D205 1 blank line required between summary line and description
"""
沪深市场A股实时数据保存系统 - 离线版
完全离线运行，只需要efinance库，数据保存到CSV文件

功能特点：
1. 从efinance获取沪深A股实时数据
2. 保存到CSV文件（带时间戳）
3. 自动创建备份目录
4. 支持强制更新
5. 无需任何数据库依赖

适用场景：
- 快速测试和验证
- 数据收集和备份
- 开发环境测试
- 离线数据分析

作者: MyStocks项目组
日期: 2025-09-21
版本: 离线版 v1.0
"""
^
src/storage/database/save_realtime_market_data_offline.py:3:1: D400 First line should end with a period
"""
沪深市场A股实时数据保存系统 - 离线版
完全离线运行，只需要efinance库，数据保存到CSV文件

功能特点：
1. 从efinance获取沪深A股实时数据
2. 保存到CSV文件（带时间戳）
3. 自动创建备份目录
4. 支持强制更新
5. 无需任何数据库依赖

适用场景：
- 快速测试和验证
- 数据收集和备份
- 开发环境测试
- 离线数据分析

作者: MyStocks项目组
日期: 2025-09-21
版本: 离线版 v1.0
"""
^
src/storage/database/save_realtime_market_data_offline.py:36:1: D400 First line should end with a period
    """离线版实时数据保存器 - 只使用CSV文件"""
^
src/storage/database/save_realtime_market_data_offline.py:39:1: D400 First line should end with a period
        """初始化离线版数据保存器"""
^
src/storage/database/save_realtime_market_data_offline.py:55:1: D400 First line should end with a period
        """配置日志系统"""
^
src/storage/database/save_realtime_market_data_offline.py:68:1: D400 First line should end with a period
        """创建备份目录"""
^
src/storage/database/save_realtime_market_data_offline.py:78:1: D400 First line should end with a period
        """检查依赖库"""
^
src/storage/database/save_realtime_market_data_offline.py:85:13: F401 'efinance' imported but unused
            import efinance
            ^
src/storage/database/save_realtime_market_data_offline.py:93:13: F401 'pandas' imported but unused
            import pandas
            ^
src/storage/database/save_realtime_market_data_offline.py:112:1: D400 First line should end with a period
        """获取实时市场数据"""
^
src/storage/database/save_realtime_market_data_offline.py:158:1: D400 First line should end with a period
        """验证数据质量"""
^
src/storage/database/save_realtime_market_data_offline.py:167:80: E501 line too long (85 > 79 characters)
            missing_columns = [col for col in key_columns if col not in data.columns]
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:172:30: F541 f-string is missing placeholders
            self.logger.info(f"📊 数据统计:")
                             ^
src/storage/database/save_realtime_market_data_offline.py:198:80: E501 line too long (80 > 79 characters)
    def save_to_csv(self, data: pd.DataFrame, market_symbol: str = None) -> str:
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:199:1: D400 First line should end with a period
        """保存数据到CSV文件"""
^
src/storage/database/save_realtime_market_data_offline.py:220:80: E501 line too long (81 > 79 characters)
    def save_to_json(self, data: pd.DataFrame, market_symbol: str = None) -> str:
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:221:1: D400 First line should end with a period
        """保存数据到JSON文件"""
^
src/storage/database/save_realtime_market_data_offline.py:237:80: E501 line too long (84 > 79 characters)
                    data_copy[col] = data_copy[col].dt.strftime("%Y-%m-%d %H:%M:%S")
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:251:80: E501 line too long (82 > 79 characters)
    def save_to_excel(self, data: pd.DataFrame, market_symbol: str = None) -> str:
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:252:1: D400 First line should end with a period
        """保存数据到Excel文件"""
^
src/storage/database/save_realtime_market_data_offline.py:277:1: D400 First line should end with a period
        """创建汇总报告"""
^
src/storage/database/save_realtime_market_data_offline.py:288:80: E501 line too long (82 > 79 characters)
                f.write(f"生成时间: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:290:25: F541 f-string is missing placeholders
                f.write(f"数据来源: efinance\n")
                        ^
src/storage/database/save_realtime_market_data_offline.py:301:80: E501 line too long (80 > 79 characters)
                            f"  价格范围: {prices.min():.2f} - {prices.max():.2f}\n"
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:318:80: E501 line too long (81 > 79 characters)
    def run(self, market_symbol: str = None, force_update: bool = False) -> bool:
                                                                               ^
src/storage/database/save_realtime_market_data_offline.py:319:1: D400 First line should end with a period
        """运行完整流程"""
^
src/storage/database/save_realtime_market_data_offline.py:395:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/save_realtime_market_data_offline.py:406:80: E501 line too long (80 > 79 characters)
    parser.add_argument("--export-excel", action="store_true", help="导出Excel格式")
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:3:1: D205 1 blank line required between summary line and description
"""
沪深市场A股实时数据保存系统 - 简化版
专注于实时数据获取和Redis存储，避免复杂的数据库依赖

核心功能：
1. 从efinance获取沪深A股实时数据
2. 保存到Redis热数据存储（5分钟过期）
3. 可选：导出到CSV文件作为备份
4. 支持强制更新（跳过缓存）

作者: MyStocks项目组
日期: 2025-09-21
版本: 简化版 v1.0
"""
^
src/storage/database/save_realtime_market_data_simple.py:3:1: D400 First line should end with a period
"""
沪深市场A股实时数据保存系统 - 简化版
专注于实时数据获取和Redis存储，避免复杂的数据库依赖

核心功能：
1. 从efinance获取沪深A股实时数据
2. 保存到Redis热数据存储（5分钟过期）
3. 可选：导出到CSV文件作为备份
4. 支持强制更新（跳过缓存）

作者: MyStocks项目组
日期: 2025-09-21
版本: 简化版 v1.0
"""
^
src/storage/database/save_realtime_market_data_simple.py:30:1: D400 First line should end with a period
    """简化版实时数据保存器 - 只使用Redis和CSV"""
^
src/storage/database/save_realtime_market_data_simple.py:33:1: D202 No blank lines allowed after function docstring
        """初始化简化版数据保存器"""
^
src/storage/database/save_realtime_market_data_simple.py:33:1: D400 First line should end with a period
        """初始化简化版数据保存器"""
^
src/storage/database/save_realtime_market_data_simple.py:54:1: D400 First line should end with a period
        """配置日志系统"""
^
src/storage/database/save_realtime_market_data_simple.py:67:1: D400 First line should end with a period
        """加载配置参数"""
^
src/storage/database/save_realtime_market_data_simple.py:88:80: E501 line too long (82 > 79 characters)
            "cache_expire_seconds": int(os.getenv("CACHE_EXPIRE_SECONDS", "300")),
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:90:80: E501 line too long (85 > 79 characters)
            "add_timestamp_column": os.getenv("ADD_TIMESTAMP_COLUMN", "true").lower()
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:111:80: E501 line too long (82 > 79 characters)
            f"💾 Redis服务器: {self.config['redis_host']}:{self.config['redis_port']}"
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:116:1: D400 First line should end with a period
        """初始化Redis连接"""
^
src/storage/database/save_realtime_market_data_simple.py:140:1: D400 First line should end with a period
        """获取实时市场数据"""
^
src/storage/database/save_realtime_market_data_simple.py:196:1: D400 First line should end with a period
        """验证市场数据的基本结构"""
^
src/storage/database/save_realtime_market_data_simple.py:215:80: E501 line too long (82 > 79 characters)
                    f"📊 数据包含空值统计: {null_counts[null_counts > 0].head().to_dict()}"
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:225:1: D400 First line should end with a period
        """保存数据到Redis"""
^
src/storage/database/save_realtime_market_data_simple.py:235:80: E501 line too long (88 > 79 characters)
            redis_key = f"realtime_positions:{self.config['market_symbol']}:{timestamp}"
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:246:80: E501 line too long (84 > 79 characters)
            latest_key = f"realtime_positions:{self.config['market_symbol']}:latest"
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:250:80: E501 line too long (80 > 79 characters)
            self.logger.info(f"⏰ 过期时间: {self.config['cache_expire_seconds']} 秒")
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:259:1: D400 First line should end with a period
        """保存数据到CSV文件"""
^
src/storage/database/save_realtime_market_data_simple.py:270:80: E501 line too long (88 > 79 characters)
            filename = f"realtime_market_{self.config['market_symbol']}_{timestamp}.csv"
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:284:1: D400 First line should end with a period
        """强制更新（清除缓存并获取最新数据）"""
^
src/storage/database/save_realtime_market_data_simple.py:290:80: E501 line too long (80 > 79 characters)
                pattern = f"realtime_positions:{self.config['market_symbol']}:*"
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:329:1: D400 First line should end with a period
        """保存数据到所有配置的目标"""
^
src/storage/database/save_realtime_market_data_simple.py:341:1: D400 First line should end with a period
        """执行完整的数据获取和保存流程"""
^
src/storage/database/save_realtime_market_data_simple.py:348:13: F841 local variable 'redis_available' is assigned to but never used
            redis_available = self.initialize_redis()
            ^
src/storage/database/save_realtime_market_data_simple.py:371:80: E501 line too long (80 > 79 characters)
            success_count = sum(1 for result in save_results.values() if result)
                                                                               ^
src/storage/database/save_realtime_market_data_simple.py:400:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/security_check.py:2:1: D205 1 blank line required between summary line and description
"""
数据库安全检查脚本
检查代码中是否存在硬编码的敏感信息
"""
^
src/storage/database/security_check.py:2:1: D400 First line should end with a period
"""
数据库安全检查脚本
检查代码中是否存在硬编码的敏感信息
"""
^
src/storage/database/security_check.py:12:1: D400 First line should end with a period
    """数据库安全检查器"""
^
src/storage/database/security_check.py:14:1: D107 Missing docstring in __init__
    def __init__(self, project_root: str):
^
src/storage/database/security_check.py:17:80: E501 line too long (102 > 79 characters)
            "ip_address": r"\b(?!127\.0\.0\.1)\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b",  # 排除localhost IP
                                                                               ^
src/storage/database/security_check.py:54:1: D400 First line should end with a period
        """检查文件是否应该被排除"""
^
src/storage/database/security_check.py:61:1: D400 First line should end with a period
        """检查是否是安全的代码行"""
^
src/storage/database/security_check.py:68:1: D400 First line should end with a period
        """扫描单个文件"""
^
src/storage/database/security_check.py:115:1: D400 First line should end with a period
        """扫描目录中的所有Python文件"""
^
src/storage/database/security_check.py:145:1: D400 First line should end with a period
        """生成安全检查报告"""
^
src/storage/database/security_check.py:159:80: E501 line too long (80 > 79 characters)
                report.append(f"     问题: {issue['pattern']} - {issue['match']}")
                                                                               ^
src/storage/database/security_check.py:167:80: E501 line too long (82 > 79 characters)
                report.append(f"     可能问题: {issue['pattern']} - {issue['match']}")
                                                                               ^
src/storage/database/security_check.py:181:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/test_database_menu.py:3:1: D205 1 blank line required between summary line and description
"""
数据库测试工具 - 交互式菜单版本
整合了路径查找、配置检查、连通性测试功能
"""
^
src/storage/database/test_database_menu.py:3:1: D400 First line should end with a period
"""
数据库测试工具 - 交互式菜单版本
整合了路径查找、配置检查、连通性测试功能
"""
^
src/storage/database/test_database_menu.py:15:1: D400 First line should end with a period
    """数据库测试工具类"""
^
src/storage/database/test_database_menu.py:18:1: D400 First line should end with a period
        """初始化测试工具"""
^
src/storage/database/test_database_menu.py:33:1: D400 First line should end with a period
        """查找.env文件路径"""
^
src/storage/database/test_database_menu.py:44:80: E501 line too long (80 > 79 characters)
            os.path.join(os.path.dirname(current_dir), ".env"),  # mystocks/.env
                                                                               ^
src/storage/database/test_database_menu.py:56:23: F541 f-string is missing placeholders
                print(f"   ✅ 找到文件!")
                      ^
src/storage/database/test_database_menu.py:84:23: F541 f-string is missing placeholders
                print(f"   ❌ 文件不存在")
                      ^
src/storage/database/test_database_menu.py:90:1: D400 First line should end with a period
        """从环境变量加载数据库配置"""
^
src/storage/database/test_database_menu.py:134:1: D400 First line should end with a period
        """测试数据库配置完整性"""
^
src/storage/database/test_database_menu.py:160:27: F541 f-string is missing placeholders
                    print(f"  ❌ 缺少配置: MONITOR_DB_URL")
                          ^
src/storage/database/test_database_menu.py:171:80: E501 line too long (83 > 79 characters)
                            f"  ✅ 密码: {'已设置' if config.get('password') else '未设置'}"
                                                                               ^
src/storage/database/test_database_menu.py:186:1: D400 First line should end with a period
        """检查数据库驱动安装情况"""
^
src/storage/database/test_database_menu.py:207:1: S102 Use of exec detected.
                    exec("from sqlalchemy import create_engine, text")
^
src/storage/database/test_database_menu.py:221:35: F541 f-string is missing placeholders
                            print(f"      提示: 请安装以下任意一种 TDengine 驱动:")
                                  ^
src/storage/database/test_database_menu.py:222:35: F541 f-string is missing placeholders
                            print(f"      - WebSocket(推荐): pip install taos-ws-py")
                                  ^
src/storage/database/test_database_menu.py:222:80: E501 line too long (83 > 79 characters)
                            print(f"      - WebSocket(推荐): pip install taos-ws-py")
                                                                               ^
src/storage/database/test_database_menu.py:223:35: F541 f-string is missing placeholders
                            print(f"      - REST连接: pip install taospy")
                                  ^
src/storage/database/test_database_menu.py:225:33: F541 f-string is missing placeholders
                                f"      - 原生连接: pip install taospy + 安装TDengine客户端"
                                ^
src/storage/database/test_database_menu.py:225:80: E501 line too long (83 > 79 characters)
                                f"      - 原生连接: pip install taospy + 安装TDengine客户端"
                                                                               ^
src/storage/database/test_database_menu.py:232:1: S102 Use of exec detected.
                    exec(f"import {driver_name}")
^
src/storage/database/test_database_menu.py:247:80: E501 line too long (87 > 79 characters)
            print("pip install pymysql psycopg2-binary redis sqlalchemy python-dotenv")
                                                                               ^
src/storage/database/test_database_menu.py:256:1: D400 First line should end with a period
        """检测 TDengine 的各种连接方式"""
^
src/storage/database/test_database_menu.py:261:1: S102 Use of exec detected.
            exec("import taosws")
^
src/storage/database/test_database_menu.py:265:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/database/test_database_menu.py:271:1: S102 Use of exec detected.
            exec("import taosrest")
^
src/storage/database/test_database_menu.py:275:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/database/test_database_menu.py:281:1: S102 Use of exec detected.
            exec("import taos")
^
src/storage/database/test_database_menu.py:285:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/database/test_database_menu.py:291:1: S404 Consider possible security implications associated with the subprocess module.
            import subprocess
^
src/storage/database/test_database_menu.py:295:1: S603 subprocess call - check for execution of untrusted input.
            result = subprocess.run(
^
src/storage/database/test_database_menu.py:310:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/database/test_database_menu.py:315:1: S404 Consider possible security implications associated with the subprocess module.
            import subprocess
^
src/storage/database/test_database_menu.py:319:1: S603 subprocess call - check for execution of untrusted input.
            result = subprocess.run(
^
src/storage/database/test_database_menu.py:339:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/database/test_database_menu.py:345:1: D400 First line should end with a period
        """测试数据库连通性"""
^
src/storage/database/test_database_menu.py:388:1: S110 Try, Except, Pass detected.
            except Exception:
^
src/storage/database/test_database_menu.py:398:1: S110 Try, Except, Pass detected.
            except Exception:
^
src/storage/database/test_database_menu.py:408:1: S110 Try, Except, Pass detected.
            except Exception:
^
src/storage/database/test_database_menu.py:444:80: E501 line too long (95 > 79 characters)
                                f"  ⚠️ 检测到TDengine包 ({', '.join(tdengine_lib_status)})，但无法导入模块"
                                                                               ^
src/storage/database/test_database_menu.py:446:35: F541 f-string is missing placeholders
                            print(f"  提示: 可能缺少TDengine客户端或环境配置问题")
                                  ^
src/storage/database/test_database_menu.py:449:35: F541 f-string is missing placeholders
                            print(f"  ⚠️ 跳过连接测试: 未安装 TDengine 驱动")
                                  ^
src/storage/database/test_database_menu.py:467:80: E501 line too long (114 > 79 characters)
            f"\n📊 连接测试结果: {successful_connections}/{len([k for k, v in self.test_results.items() if v])} 个数据库连接成功"
                                                                               ^
src/storage/database/test_database_menu.py:474:1: D400 First line should end with a period
        """简化版MySQL监控数据库测试"""
^
src/storage/database/test_database_menu.py:489:1: D400 First line should end with a period
        """简化版MySQL连接测试"""
^
src/storage/database/test_database_menu.py:509:80: E501 line too long (91 > 79 characters)
                f"  ✅ 连接成功 ({response_time}ms), 版本: {version[0] if version else 'Unknown'}"
                                                                               ^
src/storage/database/test_database_menu.py:517:1: D400 First line should end with a period
        """简化版Redis连接测试"""
^
src/storage/database/test_database_menu.py:543:1: D400 First line should end with a period
        """多种连接方式测试TDengine，只要有一种成功即可"""
^
src/storage/database/test_database_menu.py:545:80: E501 line too long (82 > 79 characters)
            f"  🔍 检测到 {len(methods)} 种 TDengine 连接方式: {', '.join(methods.keys())}"
                                                                               ^
src/storage/database/test_database_menu.py:593:19: F541 f-string is missing placeholders
            print(f"  ❌ 所有 TDengine 连接方式都失败")
                  ^
src/storage/database/test_database_menu.py:597:1: D400 First line should end with a period
        """测试TDengine WebSocket连接"""
^
src/storage/database/test_database_menu.py:600:80: E501 line too long (97 > 79 characters)
            dsn = f"ws://{config['user']}:{config['password']}@{config['host']}:{config['port']}"
                                                                               ^
src/storage/database/test_database_menu.py:617:1: D400 First line should end with a period
        """测试TDengine REST连接"""
^
src/storage/database/test_database_menu.py:642:1: D400 First line should end with a period
        """测试TDengine原生连接"""
^
src/storage/database/test_database_menu.py:667:1: D400 First line should end with a period
        """打印配置测试总结"""
^
src/storage/database/test_database_menu.py:689:1: D400 First line should end with a period
        """运行所有测试"""
^
src/storage/database/test_database_menu.py:722:1: D400 First line should end with a period
    """显示主菜单"""
^
src/storage/database/test_database_menu.py:738:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/test_jupyter_compatibility.py:3:1: D200 One-line docstring should fit on one line with quotes
"""
测试 Jupyter 环境兼容性
"""
^
src/storage/database/test_jupyter_compatibility.py:3:1: D400 First line should end with a period
"""
测试 Jupyter 环境兼容性
"""
^
src/storage/database/test_jupyter_compatibility.py:13:1: E402 module level import not at top of file
from init_db_monitor import init_monitoring_database
^
src/storage/database/test_jupyter_compatibility.py:17:1: D400 First line should end with a period
    """测试 Jupyter API 调用"""
^
src/storage/database/test_multi_directory.py:3:1: D200 One-line docstring should fit on one line with quotes
"""
模拟不同工作目录下运行的测试
"""
^
src/storage/database/test_multi_directory.py:3:1: D400 First line should end with a period
"""
模拟不同工作目录下运行的测试
"""
^
src/storage/database/test_multi_directory.py:20:1: D400 First line should end with a period
    """从指定目录测试初始化"""
^
src/storage/database/test_multi_directory.py:54:1: D400 First line should end with a period
    """主测试函数"""
^
src/storage/database/test_simple.py:3:1: D205 1 blank line required between summary line and description
"""
简化的数据库连接测试脚本
用于验证TDengine导入问题是否已解决
"""
^
src/storage/database/test_simple.py:3:1: D400 First line should end with a period
"""
简化的数据库连接测试脚本
用于验证TDengine导入问题是否已解决
"""
^
src/storage/database/test_simple.py:16:1: D400 First line should end with a period
    """测试TDengine导入"""
^
src/storage/database/test_simple.py:20:9: F401 'taos' imported but unused
        import taos
        ^
src/storage/database/test_simple.py:34:1: D400 First line should end with a period
    """测试其他数据库库的导入"""
^
src/storage/database/test_simple.py:39:9: F401 'pymysql' imported but unused
        import pymysql
        ^
src/storage/database/test_simple.py:47:9: F401 'psycopg2' imported but unused
        import psycopg2
        ^
src/storage/database/test_simple.py:55:9: F401 'redis' imported but unused
        import redis
        ^
src/storage/database/test_simple.py:63:1: D400 First line should end with a period
    """测试条件导入机制"""
^
src/storage/database/test_simple.py:70:10: N806 variable 'TAOS_AVAILABLE' in function should be lowercase
        TAOS_AVAILABLE = True
         ^
src/storage/database/test_simple.py:73:9: F841 local variable 'taos' is assigned to but never used
        taos = None
        ^
src/storage/database/test_simple.py:74:10: N806 variable 'TAOS_AVAILABLE' in function should be lowercase
        TAOS_AVAILABLE = False
         ^
src/storage/database/test_tdengine.py:3:1: D205 1 blank line required between summary line and description
"""
TDengine连接测试脚本
包含条件导入和错误处理机制
"""
^
src/storage/database/test_tdengine.py:3:1: D400 First line should end with a period
"""
TDengine连接测试脚本
包含条件导入和错误处理机制
"""
^
src/storage/database/test_tdengine.py:17:1: D400 First line should end with a period
    """测试TDengine导入和连接"""
^
src/storage/database/test_tdengine.py:49:1: D400 First line should end with a period
    """测试TDengine数据库连接"""
^
src/storage/database/test_tdengine.py:76:80: E501 line too long (93 > 79 characters)
            dsn = f"ws://{tdengine_user}:{tdengine_password}@{tdengine_host}:{tdengine_port}"
                                                                               ^
src/storage/database/test_tdengine.py:105:80: E501 line too long (88 > 79 characters)
                "create table db.tb(ts timestamp, n int, bin binary(10), nc nchar(10))",
                                                                               ^
src/storage/database/test_tdengine.py:107:80: E501 line too long (82 > 79 characters)
            ("插入数据1", "insert into db.tb values (1650000000000, 1, 'abc', '北京')"),
                                                                               ^
src/storage/database/test_tdengine.py:108:80: E501 line too long (84 > 79 characters)
            ("插入数据2", "insert into db.tb values (1650000000001, null, null, null)"),
                                                                               ^
src/storage/database/test_tdengine.py:141:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/test_tdengine.py:153:80: E501 line too long (103 > 79 characters)
            f"- 当前Python版本: {sys.version_info.major}.{sys.version_info.minor}.{sys.version_info.micro}"
                                                                               ^
src/storage/database/test_tdengine.py:161:80: E501 line too long (102 > 79 characters)
            "   https://www.taosdata.com/assets-download/3.0/TDengine-client-3.3.6.13-Windows-x64.exe"
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:3:1: D205 1 blank line required between summary line and description
"""
MyStocks统一接口验证脚本
验证实时市场数据保存系统是否符合MyStocks架构设计

验证内容：
1. 统一管理器初始化
2. 数据分类路由正确性
3. 自动数据库选择
4. 监控系统集成
5. 与系统架构的一致性

作者: MyStocks项目组
日期: 2025-09-21
"""
^
src/storage/database/validate_mystocks_architecture.py:3:1: D400 First line should end with a period
"""
MyStocks统一接口验证脚本
验证实时市场数据保存系统是否符合MyStocks架构设计

验证内容：
1. 统一管理器初始化
2. 数据分类路由正确性
3. 自动数据库选择
4. 监控系统集成
5. 与系统架构的一致性

作者: MyStocks项目组
日期: 2025-09-21
"""
^
src/storage/database/validate_mystocks_architecture.py:27:1: E402 module level import not at top of file
from unified_manager import MyStocksUnifiedManager
^
src/storage/database/validate_mystocks_architecture.py:28:1: E402 module level import not at top of file
from src.core import DataClassification, DataManager, DatabaseTarget
^
src/storage/database/validate_mystocks_architecture.py:29:1: E402 module level import not at top of file
from src.adapters.customer_adapter import CustomerDataSource
^
src/storage/database/validate_mystocks_architecture.py:33:1: D400 First line should end with a period
    """配置日志系统"""
^
src/storage/database/validate_mystocks_architecture.py:43:1: D400 First line should end with a period
    """测试数据分类策略"""
^
src/storage/database/validate_mystocks_architecture.py:51:80: E501 line too long (81 > 79 characters)
    tick_target = DataManager().get_target_database(DataClassification.TICK_DATA)
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:52:80: E501 line too long (84 > 79 characters)
    daily_target = DataManager().get_target_database(DataClassification.DAILY_KLINE)
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:53:80: E501 line too long (87 > 79 characters)
    symbols_target = DataManager().get_target_database(DataClassification.SYMBOLS_INFO)
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:55:17: F541 f-string is missing placeholders
    logger.info(f"📊 数据分类路由验证:")
                ^
src/storage/database/validate_mystocks_architecture.py:63:80: E501 line too long (87 > 79 characters)
        DataClassification.REALTIME_POSITIONS: DatabaseTarget.REDIS,  # 实时数据 → Redis热数据
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:64:80: E501 line too long (85 > 79 characters)
        DataClassification.TICK_DATA: DatabaseTarget.TDENGINE,  # Tick数据 → TDengine时序
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:65:80: E501 line too long (89 > 79 characters)
        DataClassification.DAILY_KLINE: DatabaseTarget.POSTGRESQL,  # 日线数据 → PostgreSQL分析
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:66:80: E501 line too long (80 > 79 characters)
        DataClassification.SYMBOLS_INFO: DatabaseTarget.MYSQL,  # 股票信息 → MySQL参考
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:74:80: E501 line too long (102 > 79 characters)
                f"❌ 路由错误: {classification.value} 期望→{expected_target.value}, 实际→{actual_target.value}"
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:87:1: D400 First line should end with a period
    """测试统一管理器初始化"""
^
src/storage/database/validate_mystocks_architecture.py:107:80: E501 line too long (80 > 79 characters)
        success_count = sum(1 for success in tables_created.values() if success)
                                                                               ^
src/storage/database/validate_mystocks_architecture.py:140:1: D400 First line should end with a period
    """测试数据源集成"""
^
src/storage/database/validate_mystocks_architecture.py:177:1: D400 First line should end with a period
    """测试统一接口保存功能"""
^
src/storage/database/validate_mystocks_architecture.py:240:1: D400 First line should end with a period
    """测试架构一致性"""
^
src/storage/database/validate_mystocks_architecture.py:287:1: D400 First line should end with a period
    """主函数"""
^
src/storage/database/validate_mystocks_architecture.py:326:1: S110 Try, Except, Pass detected.
        except Exception:
^
src/storage/models/__init__.py:1:1: D104 Missing docstring in public package
src/unified_manager.py:1:1: D205 1 blank line required between summary line and description
"""
MyStocks统一数据管理器 - 根级别导入模块
重定向到核心模块以保持向后兼容性
"""
^
src/unified_manager.py:1:1: D400 First line should end with a period
"""
MyStocks统一数据管理器 - 根级别导入模块
重定向到核心模块以保持向后兼容性
"""
^
src/utils/__init__.py:1:1: D400 First line should end with a period
"""MyStocks package modules"""
^
src/utils/add_doc_metadata.py:2:1: D400 First line should end with a period
"""
批量为MD文档添加元数据标记

用法:
    python utils/add_doc_metadata.py --doc README.md --creator "JohnC & Claude" --version "2.1.0"
"""
^
src/utils/add_doc_metadata.py:6:80: E501 line too long (97 > 79 characters)
"""
批量为MD文档添加元数据标记

用法:
    python utils/add_doc_metadata.py --doc README.md --creator "JohnC & Claude" --version "2.1.0"
"""




                                                       ^
src/utils/add_doc_metadata.py:32:1: D400 First line should end with a period
    """
    为MD文档添加元数据

    Args:
        file_path: 文档路径
        creator: 创建人
        version: 版本号
        approved_date: 批准日期 (可选，默认今天)
        revision_notes: 修订内容描述
    """
^
src/utils/add_doc_metadata.py:90:1: D202 No blank lines allowed after function docstring
    """批量为核心文档添加元数据"""
^
src/utils/add_doc_metadata.py:90:1: D400 First line should end with a period
    """批量为核心文档添加元数据"""
^
src/utils/add_doc_metadata.py:188:1: D103 Missing docstring in public function
def main():
^
src/utils/add_python_headers.py:3:1: D205 1 blank line required between summary line and description
"""
# 功能：批量为Python核心文件添加规范化头注释
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：1.0.0
# 依赖：无外部依赖
# 注意事项：
#   - 自动检测已有头注释，避免重复添加
#   - 支持7组件Python头注释标准
#   - 备份原文件到.backup
# 版权：MyStocks Project © 2025
"""
^
src/utils/add_python_headers.py:3:1: D400 First line should end with a period
"""
# 功能：批量为Python核心文件添加规范化头注释
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：1.0.0
# 依赖：无外部依赖
# 注意事项：
#   - 自动检测已有头注释，避免重复添加
#   - 支持7组件Python头注释标准
#   - 备份原文件到.backup
# 版权：MyStocks Project © 2025
"""
^
src/utils/add_python_headers.py:35:1: D400 First line should end with a period
    """批量添加Python头注释的工具类"""
^
src/utils/add_python_headers.py:37:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/utils/add_python_headers.py:43:1: D400 First line should end with a period
        """检查文件是否已有标准头注释"""
^
src/utils/add_python_headers.py:57:80: E501 line too long (81 > 79 characters)
    def extract_shebang_and_encoding(self, content: str) -> Tuple[str, str, str]:
                                                                               ^
src/utils/add_python_headers.py:58:1: D400 First line should end with a period
        """提取文件的shebang和编码声明"""
^
src/utils/add_python_headers.py:90:1: D202 No blank lines allowed after function docstring
        """为单个Python文件添加头注释"""
^
src/utils/add_python_headers.py:90:1: D400 First line should end with a period
        """为单个Python文件添加头注释"""
^
src/utils/add_python_headers.py:109:80: E501 line too long (85 > 79 characters)
            shebang, encoding, remaining = self.extract_shebang_and_encoding(content)
                                                                               ^
src/utils/add_python_headers.py:149:1: D400 First line should end with a period
        """移除简单的docstring，保留复杂的类/函数说明"""
^
src/utils/add_python_headers.py:172:45: E203 whitespace before ':'
                return "\n".join(lines[i + 1 :])
                                            ^
src/utils/add_python_headers.py:179:1: D202 No blank lines allowed after function docstring
    """批量为核心文件添加头注释"""
^
src/utils/add_python_headers.py:179:1: D400 First line should end with a period
    """批量为核心文件添加头注释"""
^
src/utils/check_api_health.py:2:1: D400 First line should end with a period
"""
Web API健康检查脚本

验证10个关键页面的数据接口可用性
"""
^
src/utils/check_api_health.py:65:80: E501 line too long (82 > 79 characters)
        "url": "/api/data/kline/600519?start_date=2025-10-01&end_date=2025-10-15",
                                                                               ^
src/utils/check_api_health.py:111:1: D400 First line should end with a period
    """检查Backend服务是否运行"""
^
src/utils/check_api_health.py:120:1: D400 First line should end with a period
    """获取认证Token"""
^
src/utils/check_api_health.py:137:1: D400 First line should end with a period
    """
    测试单个API端点

    Returns:
        (成功, 错误消息, 状态码)
    """
^
src/utils/check_api_health.py:185:1: D400 First line should end with a period
    """主函数"""
^
src/utils/check_api_health.py:195:15: F541 f-string is missing placeholders
        print(f"❌ Backend服务未运行")
              ^
src/utils/check_api_health.py:196:15: F541 f-string is missing placeholders
        print(f"\n启动方法:")
              ^
src/utils/check_api_health.py:197:15: F541 f-string is missing placeholders
        print(f"  cd web/backend")
              ^
src/utils/check_api_health.py:198:15: F541 f-string is missing placeholders
        print(f"  python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload")
              ^
src/utils/check_api_health.py:198:80: E501 line too long (86 > 79 characters)
        print(f"  python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload")
                                                                               ^
src/utils/check_api_health.py:199:15: F541 f-string is missing placeholders
        print(f"\n或检查是否运行在其他端口:")
              ^
src/utils/check_api_health.py:200:15: F541 f-string is missing placeholders
        print(f"  lsof -i :8000")
              ^
src/utils/check_api_health.py:201:15: F541 f-string is missing placeholders
        print(f"  ps aux | grep uvicorn")
              ^
src/utils/check_api_health.py:207:11: F541 f-string is missing placeholders
    print(f"\n【Step 2】获取认证Token...")
          ^
src/utils/check_api_health.py:213:15: F541 f-string is missing placeholders
        print(f"⚠️  Token获取失败 (将跳过需要认证的API)")
              ^
src/utils/check_api_health.py:216:11: F541 f-string is missing placeholders
    print(f"\n【Step 3】测试10个关键API端点...")
          ^
src/utils/check_api_health.py:217:11: F541 f-string is missing placeholders
    print(f"\n" + "-" * 80)
          ^
src/utils/check_api_health.py:237:80: E501 line too long (92 > 79 characters)
            f"{i:2d}. {icon} [{priority}] {endpoint['name']:15s} {status_str:10s} {message}"
                                                                               ^
src/utils/check_api_health.py:273:80: E501 line too long (86 > 79 characters)
                "✅" if r["passed"] == r["total"] else "⚠️" if r["passed"] > 0 else "❌"
                                                                               ^
src/utils/check_api_health.py:276:80: E501 line too long (90 > 79 characters)
                f"{icon} {priority}: {r['passed']}/{r['total']} 通过 ({priority_rate:.0f}%)"
                                                                               ^
src/utils/check_api_health.py:311:23: F541 f-string is missing placeholders
                print(f"   修复: 启动Backend服务")
                      ^
src/utils/check_api_health.py:313:23: F541 f-string is missing placeholders
                print(f"   修复: 检查路由注册，确认API端点已实现")
                      ^
src/utils/check_api_health.py:315:23: F541 f-string is missing placeholders
                print(f"   修复: 检查JWT配置，重新获取Token")
                      ^
src/utils/check_api_health.py:317:23: F541 f-string is missing placeholders
                print(f"   修复: 查看Backend日志，检查代码异常")
                      ^
src/utils/check_api_health.py:319:23: F541 f-string is missing placeholders
                print(f"   修复: 检查数据库连接 (运行 python utils/check_db_health.py)")
                      ^
src/utils/check_api_health_v2.py:3:1: D205 1 blank line required between summary line and description
"""
# 功能：Web API健康检查工具 v2.0 - 验证短期优化改进后的API端点
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.0.0
# 依赖：requests
# 注意事项：
#   - 测试10个关键API端点（包含6个新增端点）
#   - 自动获取JWT token进行认证测试
#   - 生成详细的测试报告
# 版权：MyStocks Project © 2025
"""
^
src/utils/check_api_health_v2.py:3:1: D400 First line should end with a period
"""
# 功能：Web API健康检查工具 v2.0 - 验证短期优化改进后的API端点
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.0.0
# 依赖：requests
# 注意事项：
#   - 测试10个关键API端点（包含6个新增端点）
#   - 自动获取JWT token进行认证测试
#   - 生成详细的测试报告
# 版权：MyStocks Project © 2025
"""
^
src/utils/check_api_health_v2.py:27:1: D400 First line should end with a period
    """终端颜色"""
^
src/utils/check_api_health_v2.py:38:1: D400 First line should end with a period
    """API健康检查器"""
^
src/utils/check_api_health_v2.py:40:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/utils/check_api_health_v2.py:45:1: D400 First line should end with a period
        """打印标题"""
^
src/utils/check_api_health_v2.py:51:1: D400 First line should end with a period
        """打印测试结果"""
^
src/utils/check_api_health_v2.py:64:1: D400 First line should end with a period
        """检查Backend服务是否运行"""
^
src/utils/check_api_health_v2.py:72:1: D400 First line should end with a period
        """获取JWT token"""
^
src/utils/check_api_health_v2.py:100:1: D400 First line should end with a period
        """测试单个API端点"""
^
src/utils/check_api_health_v2.py:107:80: E501 line too long (84 > 79 characters)
                resp = requests.get(url, headers=headers, params=params, timeout=10)
                                                                               ^
src/utils/check_api_health_v2.py:110:80: E501 line too long (81 > 79 characters)
                resp = requests.post(url, headers=headers, json=data, timeout=10)
                                                                               ^
src/utils/check_api_health_v2.py:137:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/utils/check_api_health_v2.py:180:1: D400 First line should end with a period
        """运行所有API测试"""
^
src/utils/check_api_health_v2.py:197:80: E501 line too long (82 > 79 characters)
            self.print_result("JWT Token", "PASS", f"Token: {self.token[:20]}...")
                                                                               ^
src/utils/check_api_health_v2.py:252:80: E501 line too long (85 > 79 characters)
                "params": {"symbol": "000001", "report_type": "balance", "limit": 5},
                                                                               ^
src/utils/check_api_health_v2.py:319:1: D400 First line should end with a period
        """生成测试报告"""
^
src/utils/check_api_health_v2.py:343:80: E501 line too long (84 > 79 characters)
                p_passed = sum(1 for r in priority_results if r["status"] == "PASS")
                                                                               ^
src/utils/check_api_health_v2.py:350:80: E501 line too long (84 > 79 characters)
            r.get("response_time", 0) for r in self.results if r["status"] == "PASS"
                                                                               ^
src/utils/check_api_health_v2.py:400:80: E501 line too long (81 > 79 characters)
                f"{Colors.GREEN}{Colors.BOLD}🎉 所有验收标准通过！短期优化API改进成功！{Colors.END}"
                                                                               ^
src/utils/check_api_health_v2.py:409:1: D400 First line should end with a period
    """主函数"""
^
src/utils/check_db_health.py:2:1: D400 First line should end with a period
"""
数据库健康检查脚本

验证4个数据库的连接状态，为修复Web页面问题做准备
"""
^
src/utils/check_db_health.py:16:1: D400 First line should end with a period
    """验证MySQL连接"""
^
src/utils/check_db_health.py:37:15: F541 f-string is missing placeholders
        print(f"✅ MySQL连接成功")
              ^
src/utils/check_db_health.py:53:15: F541 f-string is missing placeholders
        print(f"❌ MySQL连接失败")
              ^
src/utils/check_db_health.py:59:1: D400 First line should end with a period
    """验证PostgreSQL连接"""
^
src/utils/check_db_health.py:81:15: F541 f-string is missing placeholders
        print(f"✅ PostgreSQL连接成功 (mystocks)")
              ^
src/utils/check_db_health.py:120:19: F541 f-string is missing placeholders
            print(f"✅ PostgreSQL监控数据库连接成功")
                  ^
src/utils/check_db_health.py:121:19: F541 f-string is missing placeholders
            print(f"   数据库: mystocks_monitoring")
                  ^
src/utils/check_db_health.py:131:15: F541 f-string is missing placeholders
        print(f"❌ PostgreSQL连接失败")
              ^
src/utils/check_db_health.py:137:1: D400 First line should end with a period
    """验证TDengine连接"""
^
src/utils/check_db_health.py:166:15: F541 f-string is missing placeholders
        print(f"✅ TDengine连接成功")
              ^
src/utils/check_db_health.py:183:80: E501 line too long (81 > 79 characters)
            print(f"   建议: 创建数据库 - CREATE DATABASE {settings.tdengine_database}")
                                                                               ^
src/utils/check_db_health.py:190:15: F541 f-string is missing placeholders
        print(f"❌ TDengine连接失败")
              ^
src/utils/check_db_health.py:192:15: F541 f-string is missing placeholders
        print(f"   检查项:")
              ^
src/utils/check_db_health.py:193:15: F541 f-string is missing placeholders
        print(f"   1. TDengine服务是否启动: systemctl status taosd")
              ^
src/utils/check_db_health.py:195:15: F541 f-string is missing placeholders
        print(f"   3. 防火墙是否开放")
              ^
src/utils/check_db_health.py:200:1: D400 First line should end with a period
    """验证Redis连接"""
^
src/utils/check_db_health.py:212:80: E501 line too long (82 > 79 characters)
            password=settings.redis_password if settings.redis_password else None,
                                                                               ^
src/utils/check_db_health.py:220:15: F541 f-string is missing placeholders
        print(f"✅ Redis连接成功")
              ^
src/utils/check_db_health.py:229:15: F541 f-string is missing placeholders
        print(f"❌ Redis连接失败")
              ^
src/utils/check_db_health.py:235:1: D400 First line should end with a period
    """主函数"""
^
src/utils/column_mapper.py:1:1: D205 1 blank line required between summary line and description
"""
统一列名管理器
提供DataFrame列名的标准化映射功能

作用：
- 统一不同数据源的列名格式
- 支持中英文列名转换
- 提供标准的列名映射规则
- 简化数据源适配器的列名处理逻辑

功能：
- 标准化DataFrame列名
- 中英文列名互转
- 自动识别和映射常见列名
- 支持自定义列名映射规则
"""
^
src/utils/column_mapper.py:1:1: D400 First line should end with a period
"""
统一列名管理器
提供DataFrame列名的标准化映射功能

作用：
- 统一不同数据源的列名格式
- 支持中英文列名转换
- 提供标准的列名映射规则
- 简化数据源适配器的列名处理逻辑

功能：
- 标准化DataFrame列名
- 中英文列名互转
- 自动识别和映射常见列名
- 支持自定义列名映射规则
"""
^
src/utils/column_mapper.py:23:1: D400 First line should end with a period
    """统一列名管理器"""
^
src/utils/column_mapper.py:57:9: F601 dictionary key 'turnover' repeated with different values
        "turnover": "amount",
        ^
src/utils/column_mapper.py:69:9: F601 dictionary key 'turnover' repeated with different values
        "turnover": "turnover_rate",
        ^
src/utils/column_mapper.py:135:1: D400 First line should end with a period
        """
        标准化DataFrame列名

        Args:
            df: 输入的DataFrame
            target_lang: 目标语言，"en"(英文)或"cn"(中文)
            custom_mapping: 自定义映射规则，会覆盖默认规则

        Returns:
            pd.DataFrame: 列名标准化后的DataFrame
        """
^
src/utils/column_mapper.py:175:80: E501 line too long (86 > 79 characters)
                    old_col.replace(" ", "").replace("_", "").replace("-", "").lower()
                                                                               ^
src/utils/column_mapper.py:199:1: D400 First line should end with a period
        """
        将DataFrame列名转换为英文

        Args:
            df: 输入的DataFrame
            custom_mapping: 自定义映射规则

        Returns:
            pd.DataFrame: 英文列名的DataFrame
        """
^
src/utils/column_mapper.py:217:1: D400 First line should end with a period
        """
        将DataFrame列名转换为中文

        Args:
            df: 输入的DataFrame
            custom_mapping: 自定义映射规则

        Returns:
            pd.DataFrame: 中文列名的DataFrame
        """
^
src/utils/column_mapper.py:235:1: D400 First line should end with a period
        """
        获取特定数据类型的标准列名

        Args:
            data_type: 数据类型，如"stock_daily", "index_daily", "stock_basic"等
            lang: 语言，"en"或"cn"

        Returns:
            list: 标准列名列表
        """
^
src/utils/column_mapper.py:324:1: D400 First line should end with a period
        """
        验证DataFrame是否包含必需的列

        Args:
            df: 输入的DataFrame
            required_columns: 必需的列名列表
            strict: 是否严格模式（必须完全匹配）

        Returns:
            tuple: (是否通过验证, 缺失的列, 额外的列)
        """
^
src/utils/column_mapper.py:341:80: E501 line too long (88 > 79 characters)
        is_valid = len(missing_columns) == 0 and (not strict or len(extra_columns) == 0)
                                                                               ^
src/utils/column_mapper.py:349:1: D400 First line should end with a period
        """
        添加自定义映射规则到默认映射表

        Args:
            custom_mapping: 自定义映射字典
            target_lang: 目标语言
        """
^
src/utils/column_mapper.py:372:1: D400 First line should end with a period
    """
    便捷函数：标准化DataFrame列名

    Args:
        df: 输入的DataFrame
        target_lang: 目标语言，"en"或"cn"
        custom_mapping: 自定义映射规则

    Returns:
        pd.DataFrame: 标准化后的DataFrame
    """
^
src/utils/column_mapper.py:387:1: D400 First line should end with a period
    """便捷函数：转换为英文列名"""
^
src/utils/column_mapper.py:392:1: D400 First line should end with a period
    """便捷函数：转换为中文列名"""
^
src/utils/column_mapper.py:425:80: E501 line too long (84 > 79 characters)
    is_valid, missing, extra = ColumnMapper.validate_columns(en_data, required_cols)
                                                                               ^
src/utils/data_format_converter.py:1:1: D205 1 blank line required between summary line and description
"""
Data Format Converter Middleware
Unify Mock data and real database data format to ensure field names and data structure consistency
"""
^
src/utils/data_format_converter.py:1:1: D400 First line should end with a period
"""
Data Format Converter Middleware
Unify Mock data and real database data format to ensure field names and data structure consistency
"""
^
src/utils/data_format_converter.py:3:80: E501 line too long (98 > 79 characters)
"""
Data Format Converter Middleware
Unify Mock data and real database data format to ensure field names and data structure consistency
"""


                                          ^
src/utils/data_format_converter.py:14:1: D400 First line should end with a period
    """
    标准化股票数据格式，统一字段名称和数据结构

    Args:
        df: 原始数据DataFrame

    Returns:
        标准化后的DataFrame
    """
^
src/utils/data_format_converter.py:76:80: E501 line too long (83 > 79 characters)
            if standard_name != col and standard_name not in normalized_df.columns:
                                                                               ^
src/utils/data_format_converter.py:84:21: F541 f-string is missing placeholders
        logger.info(f"字段重命名完成", rename_dict=rename_dict)
                    ^
src/utils/data_format_converter.py:87:80: E501 line too long (83 > 79 characters)
    required_fields = ["symbol", "name", "industry", "area", "market", "list_date"]
                                                                               ^
src/utils/data_format_converter.py:90:28: F541 f-string is missing placeholders
            logger.warning(f"关键字段缺失，使用默认值", field=field)
                           ^
src/utils/data_format_converter.py:107:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/utils/data_format_converter.py:128:1: S110 Try, Except, Pass detected.
                except Exception:
^
src/utils/data_format_converter.py:136:1: D400 First line should end with a period
    """
    标准化API响应格式

    Args:
        data: 原始API响应数据

    Returns:
        标准化后的API响应数据
    """
^
src/utils/data_format_converter.py:151:80: E501 line too long (87 > 79 characters)
    if "data" in normalized_data and isinstance(normalized_data["data"], pd.DataFrame):
                                                                               ^
src/utils/data_format_converter.py:152:80: E501 line too long (86 > 79 characters)
        normalized_data["data"] = normalize_stock_data_format(normalized_data["data"])
                                                                               ^
src/utils/data_format_converter.py:153:80: E501 line too long (81 > 79 characters)
    elif "data" in normalized_data and isinstance(normalized_data["data"], list):
                                                                               ^
src/utils/data_format_converter.py:183:1: D400 First line should end with a period
    """
    标准化股票列表格式

    Args:
        stock_list: 原始股票列表

    Returns:
        标准化后的股票列表
    """
^
src/utils/data_format_converter.py:226:80: E501 line too long (87 > 79 characters)
        required_fields = ["symbol", "name", "industry", "area", "market", "list_date"]
                                                                               ^
src/utils/data_format_converter.py:243:80: E501 line too long (86 > 79 characters)
def normalize_indicator_data_format(indicator_data: Dict[str, Any]) -> Dict[str, Any]:
                                                                               ^
src/utils/data_format_converter.py:244:1: D400 First line should end with a period
    """
    标准化技术指标数据格式

    Args:
        indicator_data: 原始技术指标数据

    Returns:
        标准化后的技术指标数据
    """
^
src/utils/data_format_converter.py:260:13: B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
        for i, indicator in enumerate(normalized_data["indicators"]):
            ^
src/utils/data_format_converter.py:277:1: D400 First line should end with a period
    """测试数据格式标准化功能"""
^
src/utils/data_source_logger.py:1:1: D205 1 blank line required between summary line and description
"""
数据源调用日志记录模块
提供统一的数据源调用日志记录功能
"""
^
src/utils/data_source_logger.py:1:1: D400 First line should end with a period
"""
数据源调用日志记录模块
提供统一的数据源调用日志记录功能
"""
^
src/utils/data_source_logger.py:13:1: D400 First line should end with a period
    """数据源调用日志记录器"""
^
src/utils/data_source_logger.py:16:1: D400 First line should end with a period
        """初始化日志记录器"""
^
src/utils/data_source_logger.py:42:80: E501 line too long (88 > 79 characters)
        self, adapter_type: str, method: str, params: Dict, result: Any, duration: float
                                                                               ^
src/utils/data_source_logger.py:44:1: D400 First line should end with a period
        """记录数据源调用"""
^
src/utils/data_source_logger.py:57:80: E501 line too long (82 > 79 characters)
    def log_error(self, adapter_type: str, method: str, params: Dict, error: str):
                                                                               ^
src/utils/data_source_logger.py:58:1: D400 First line should end with a period
        """记录数据源调用错误"""
^
src/utils/data_source_logger.py:71:1: D400 First line should end with a period
    """数据源调用日志装饰器"""
^
src/utils/data_source_logger.py:117:1: D400 First line should end with a period
    """记录特定方法调用的装饰器"""
^
src/utils/data_source_logger.py:130:80: E501 line too long (84 > 79 characters)
                            args[1] if len(args) > 1 else kwargs.get("adapter_type")
                                                                               ^
src/utils/data_source_logger.py:132:80: E501 line too long (85 > 79 characters)
                        "method": args[2] if len(args) > 2 else kwargs.get("method"),
                                                                               ^
src/utils/data_source_logger.py:136:80: E501 line too long (86 > 79 characters)
                params = {"args": args[1:] if len(args) > 1 else (), "kwargs": kwargs}
                                                                               ^
src/utils/data_source_logger.py:161:80: E501 line too long (96 > 79 characters)
                    f"Params: {params if len(str(params)) < 200 else str(params)[:200] + '...'}"
                                                                               ^
src/utils/data_source_logger.py:171:80: E501 line too long (96 > 79 characters)
                    f"Params: {params if len(str(params)) < 200 else str(params)[:200] + '...'}"
                                                                               ^
src/utils/data_source_validator.py:1:1: D205 1 blank line required between summary line and description
"""
数据源格式兼容性校验工具
用于批量校验Mock数据源和真实数据源的输出格式是否一致
"""
^
src/utils/data_source_validator.py:1:1: D400 First line should end with a period
"""
数据源格式兼容性校验工具
用于批量校验Mock数据源和真实数据源的输出格式是否一致
"""
^
src/utils/data_source_validator.py:15:1: D400 First line should end with a period
    """
    比较两个数据结构是否一致

    Args:
        mock_result: Mock数据结果
        real_result: 真实数据结果
        field_path: 当前字段路径，用于错误定位

    Returns:
        List[str]: 不一致的字段列表
    """
^
src/utils/data_source_validator.py:29:8: E721 do not compare types, for exact checks use `is` / `is not`, for instance checks use `isinstance()`
    if type(mock_result) != type(real_result):
       ^
src/utils/data_source_validator.py:31:80: E501 line too long (89 > 79 characters)
            f"类型不一致: {field_path} - Mock: {type(mock_result)}, Real: {type(real_result)}"
                                                                               ^
src/utils/data_source_validator.py:48:80: E501 line too long (80 > 79 characters)
            errors.append(f"Mock数据缺少字段: {field_path} - {list(missing_in_mock)}")
                                                                               ^
src/utils/data_source_validator.py:64:80: E501 line too long (93 > 79 characters)
                f"列表长度不一致: {field_path} - Mock: {len(mock_result)}, Real: {len(real_result)}"
                                                                               ^
src/utils/data_source_validator.py:79:80: E501 line too long (83 > 79 characters)
                f"类型不一致: {field_path} - Mock: DataFrame, Real: {type(real_result)}"
                                                                               ^
src/utils/data_source_validator.py:95:80: E501 line too long (80 > 79 characters)
                    f"Mock DataFrame缺少列: {field_path} - {list(missing_in_mock)}"
                                                                               ^
src/utils/data_source_validator.py:106:1: D400 First line should end with a period
    """
    验证数据源兼容性

    Args:
        mock_source: Mock数据源
        real_source: 真实数据源
        test_stock: 测试股票代码

    Returns:
        Dict[str, Any]: 校验结果
    """
^
src/utils/data_source_validator.py:151:80: E501 line too long (82 > 79 characters)
            errors = compare_data_structure(mock_result, real_result, method_name)
                                                                               ^
src/utils/data_source_validator.py:154:80: E501 line too long (88 > 79 characters)
                results["details"][method_name] = {"status": "failed", "errors": errors}
                                                                               ^
src/utils/data_source_validator.py:167:80: E501 line too long (82 > 79 characters)
            results["details"][method_name] = {"status": "error", "error": str(e)}
                                                                               ^
src/utils/data_source_validator.py:176:1: D400 First line should end with a period
    """
    运行完整的兼容性检查

    Returns:
        Dict[str, Any]: 检查结果
    """
^
src/utils/data_source_validator.py:207:80: E501 line too long (86 > 79 characters)
            print(f"    详情: {detail.get('error', detail.get('errors', ['Unknown']))}")
                                                                               ^
src/utils/date_utils.py:1:1: D205 1 blank line required between summary line and description
"""
日期处理工具
提供日期格式化和转换功能
"""
^
src/utils/date_utils.py:1:1: D400 First line should end with a period
"""
日期处理工具
提供日期格式化和转换功能
"""
^
src/utils/date_utils.py:10:80: E501 line too long (82 > 79 characters)
def normalize_date(date_str: Union[str, datetime.date, datetime.datetime]) -> str:
                                                                               ^
src/utils/date_utils.py:11:1: D400 First line should end with a period
    """
    将各种格式的日期转换为标准格式 YYYY-MM-DD

    支持的输入格式:
    - YYYY-MM-DD (标准格式)
    - YYYYMMDD (紧凑格式)
    - YYYY/MM/DD (斜杠分隔)
    - datetime.date 对象
    - datetime.datetime 对象

    Args:
        date_str: 需要格式化的日期字符串或日期对象

    Returns:
        str: 格式化后的日期字符串 (YYYY-MM-DD)

    Raises:
        ValueError: 如果日期格式无法识别
    """
^
src/utils/date_utils.py:57:80: E501 line too long (82 > 79 characters)
            for fmt in ["%Y-%m-%d", "%Y%m%d", "%Y/%m/%d", "%d-%m-%Y", "%m/%d/%Y"]:
                                                                               ^
src/utils/date_utils.py:85:1: D400 First line should end with a period
    """
    获取标准化的日期范围

    Args:
        start_date: 开始日期
        end_date: 结束日期 (如果提供了days参数，则忽略此参数)
        days: 从开始日期算起的天数 (可选)，可以是整数或字符串

    Returns:
        tuple: (标准化开始日期, 标准化结束日期)
    """
^
src/utils/date_utils.py:122:1: D400 First line should end with a period
    """
    检查日期字符串是否有效

    Args:
        date_str: 日期字符串

    Returns:
        bool: 日期是否有效
    """
^
src/utils/db_connection_retry.py:1:1: D205 1 blank line required between summary line and description
"""
数据库连接重试工具模块
为数据库连接操作添加重试逻辑，提高连接稳定性
"""
^
src/utils/db_connection_retry.py:1:1: D400 First line should end with a period
"""
数据库连接重试工具模块
为数据库连接操作添加重试逻辑，提高连接稳定性
"""
^
src/utils/db_connection_retry.py:15:1: D400 First line should end with a period
    """
    数据库连接重试装饰器

    Args:
        max_retries: 最大重试次数
        delay: 初始延迟时间（秒）
        backoff: 延迟倍数
    """
^
src/utils/db_connection_retry.py:51:80: E501 line too long (89 > 79 characters)
                                f"数据库连接失败，{current_delay}秒后重试 ({retries}/{max_retries})",
                                                                               ^
src/utils/db_connection_retry.py:77:1: D400 First line should end with a period
    """数据库连接处理器，提供统一的连接管理"""
^
src/utils/db_connection_retry.py:79:1: D107 Missing docstring in __init__
    def __init__(self):
^
src/utils/db_connection_retry.py:84:1: D400 First line should end with a period
        """延迟加载连接管理器，避免在没有环境变量时出错"""
^
src/utils/db_connection_retry.py:86:80: E501 line too long (86 > 79 characters)
            from src.storage.database.connection_manager import get_connection_manager
                                                                               ^
src/utils/db_connection_retry.py:93:1: D400 First line should end with a period
        """获取TDengine连接（带重试）"""
^
src/utils/db_connection_retry.py:98:1: D400 First line should end with a period
        """获取PostgreSQL连接（带重试）"""
^
src/utils/db_connection_retry.py:103:1: D400 First line should end with a period
        """归还PostgreSQL连接"""
^
src/utils/db_connection_retry.py:111:1: D400 First line should end with a period
        """关闭所有连接"""
^
src/utils/db_connection_retry.py:121:1: D400 First line should end with a period
    """获取TDengine连接（带重试）"""
^
src/utils/db_connection_retry.py:126:1: D400 First line should end with a period
    """获取PostgreSQL连接（带重试）"""
^
src/utils/db_connection_retry.py:131:1: D400 First line should end with a period
    """归还PostgreSQL连接"""
^
src/utils/error_handler.py:1:1: D205 1 blank line required between summary line and description
"""
统一错误处理工具
提供一致的错误处理策略和日志记录功能
"""
^
src/utils/error_handler.py:1:1: D400 First line should end with a period
"""
统一错误处理工具
提供一致的错误处理策略和日志记录功能
"""
^
src/utils/error_handler.py:16:1: D400 First line should end with a period
    """
    统一错误处理器

    提供一致的错误处理策略，包括重试机制、日志记录和错误转换
    """
^
src/utils/error_handler.py:26:1: D400 First line should end with a period
        """
        统一日志记录

        Args:
            error: 异常对象
            context: 错误上下文
            level: 日志级别
        """
^
src/utils/error_handler.py:36:80: E501 line too long (83 > 79 characters)
            f"错误发生 - 上下文: {context}, 错误: {str(error)}, 类型: {type(error).__name__}",
                                                                               ^
src/utils/error_handler.py:47:1: D400 First line should end with a period
        """
        安全执行函数

        Args:
            func: 要执行的函数
            context: 执行上下文
            default_return: 默认返回值
            log_error: 是否记录错误
            reraise: 是否重新抛出异常

        Returns:
            函数返回值或默认返回值
        """
^
src/utils/error_handler.py:79:1: D400 First line should end with a period
        """
        重试装饰器

        Args:
            max_retries: 最大重试次数
            delay: 初始延迟时间
            backoff: 延迟倍数
            exceptions: 需要重试的异常类型
            context: 执行上下文
        """
^
src/utils/error_handler.py:122:80: E501 line too long (80 > 79 characters)
def safe_execute(func: Callable, context: str = "", default_return: Any = None):
                                                                               ^
src/utils/error_handler.py:123:1: D400 First line should end with a period
    """安全执行函数的便捷函数"""
^
src/utils/error_handler.py:134:1: D400 First line should end with a period
    """重试装饰器的便捷函数"""
^
src/utils/error_handler.py:142:1: D400 First line should end with a period
    """数据相关错误"""
^
src/utils/error_handler.py:148:1: D400 First line should end with a period
    """连接相关错误"""
^
src/utils/error_handler.py:154:1: D400 First line should end with a period
    """验证相关错误"""
^
src/utils/error_handler.py:160:1: D400 First line should end with a period
    """处理相关错误"""
^
src/utils/failure_recovery_queue.py:1:1: D400 First line should end with a period
"""
故障恢复队列

基于SQLite的Outbox持久化队列,用于数据库故障时的数据缓冲和重试。

创建日期: 2025-10-11
版本: 1.0.0
"""
^
src/utils/failure_recovery_queue.py:16:1: D400 First line should end with a period
    """
    故障恢复队列

    当目标数据库不可用时,将数据持久化到本地SQLite队列,
    待数据库恢复后自动重试。
    """
^
src/utils/failure_recovery_queue.py:23:1: S108 Probable insecure usage of temp file/directory.
    def __init__(self, db_path: str = "/tmp/mystocks_recovery_queue.db"):
^
src/utils/failure_recovery_queue.py:24:1: D400 First line should end with a period
        """
        初始化队列

        Args:
            db_path: SQLite数据库文件路径
        """
^
src/utils/failure_recovery_queue.py:37:1: D400 First line should end with a period
        """初始化SQLite数据库表"""
^
src/utils/failure_recovery_queue.py:38:80: E501 line too long (87 > 79 characters)
        conn = sqlite3.connect(self.db_path, timeout=10.0, isolation_level="IMMEDIATE")
                                                                               ^
src/utils/failure_recovery_queue.py:58:80: E501 line too long (87 > 79 characters)
    def enqueue(self, classification: str, target_database: str, data: Dict[str, Any]):
                                                                               ^
src/utils/failure_recovery_queue.py:59:1: D400 First line should end with a period
        """
        将失败的数据操作加入队列

        Args:
            classification: 数据分类
            target_database: 目标数据库
            data: 数据内容 (将转为JSON)
        """
^
src/utils/failure_recovery_queue.py:72:80: E501 line too long (81 > 79 characters)
            """
            INSERT INTO outbox_queue (classification, target_database, data_json)
            VALUES (?, ?, ?)
        """,

                                                               ^
src/utils/failure_recovery_queue.py:82:1: D400 First line should end with a period
        """
        获取待重试的队列项

        Args:
            limit: 最大返回数量

        Returns:
            待处理的队列项列表
        """
^
src/utils/logging_config.py:1:1: D400 First line should end with a period
"""
MyStocks 统一日志配置

提供统一的日志配置和管理
"""
^
src/utils/logging_config.py:15:1: D400 First line should end with a period
    """彩色日志格式化器"""
^
src/utils/logging_config.py:27:1: D102 Missing docstring in public method
    def format(self, record):
^
src/utils/logging_config.py:31:80: E501 line too long (81 > 79 characters)
            record.levelname = f"{color}{record.levelname}{self.COLORS['RESET']}"
                                                                               ^
src/utils/logging_config.py:37:80: E501 line too long (80 > 79 characters)
    level: str = "INFO", log_file: Optional[str] = None, use_colors: bool = True
                                                                               ^
src/utils/logging_config.py:39:1: D202 No blank lines allowed after function docstring
    """
    设置项目日志配置

    Args:
        level: 日志级别 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
        log_file: 日志文件路径 (可选)
        use_colors: 是否使用彩色输出
    """
^
src/utils/logging_config.py:39:1: D400 First line should end with a period
    """
    设置项目日志配置

    Args:
        level: 日志级别 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
        log_file: 日志文件路径 (可选)
        use_colors: 是否使用彩色输出
    """
^
src/utils/logging_config.py:84:80: E501 line too long (92 > 79 characters)
            "%(asctime)s - %(name)s - %(levelname)s - %(funcName)s:%(lineno)d - %(message)s"
                                                                               ^
src/utils/logging_config.py:91:1: D400 First line should end with a period
    """
    获取logger实例

    Args:
        name: logger名称，通常使用 __name__

    Returns:
        配置好的logger实例
    """
^
src/utils/logging_config.py:110:1: D400 First line should end with a period
    """记录INFO级别日志"""
^
src/utils/logging_config.py:118:1: D400 First line should end with a period
    """记录ERROR级别日志"""
^
src/utils/logging_config.py:126:1: D400 First line should end with a period
    """记录WARNING级别日志"""
^
src/utils/logging_config.py:134:1: D400 First line should end with a period
    """记录DEBUG级别日志"""
^
src/utils/symbol_utils.py:1:1: D205 1 blank line required between summary line and description
"""
股票代码处理工具
提供股票代码格式化和转换功能
"""
^
src/utils/symbol_utils.py:1:1: D400 First line should end with a period
"""
股票代码处理工具
提供股票代码格式化和转换功能
"""
^
src/utils/symbol_utils.py:10:1: D205 1 blank line required between summary line and description
    """
    标准化股票代码格式
    支持格式:
    - 基本格式: 000001, 600000
    - 后缀格式: 000001.SZ, 600000.SH
    - 前缀格式: sz000001, SH600000
    - 点分隔格式: sz.000001, sh.600000
    - Baostock格式: sh.600000, sz.000001
    - AKShare格式: 600000

    返回格式: 6位纯数字代码

    参数:
        code: 输入的股票代码(可以是字符串、整数或浮点数)

    返回:
        标准化后的6位数字股票代码

    异常:
        ValueError: 当输入为空或无法识别的格式时抛出
    """
^
src/utils/symbol_utils.py:10:1: D400 First line should end with a period
    """
    标准化股票代码格式
    支持格式:
    - 基本格式: 000001, 600000
    - 后缀格式: 000001.SZ, 600000.SH
    - 前缀格式: sz000001, SH600000
    - 点分隔格式: sz.000001, sh.600000
    - Baostock格式: sh.600000, sz.000001
    - AKShare格式: 600000

    返回格式: 6位纯数字代码

    参数:
        code: 输入的股票代码(可以是字符串、整数或浮点数)

    返回:
        标准化后的6位数字股票代码

    异常:
        ValueError: 当输入为空或无法识别的格式时抛出
    """
^
src/utils/symbol_utils.py:100:1: D400 First line should end with a period
    """
    根据股票代码获取交易所代码

    参数:
        code: 股票代码(可以是任何支持的格式)

    返回:
        str: 交易所代码 (SH/SZ/BJ)
    """
^
src/utils/symbol_utils.py:129:1: D400 First line should end with a period
    """
    根据数据源类型格式化股票代码

    参数:
        code: 股票代码(可以是任何支持的格式)
        source_type: 数据源类型
            - 'akshare': AKShare格式 (600000) - 6位纯数字
            - 'baostock': Baostock格式 (sh.600000) - 交易所.代码

    返回:
        str: 适合指定数据源的股票代码格式

    异常:
        ValueError: 当数据源类型无效时抛出
    """
^
src/utils/symbol_utils.py:134:1: RST301 Unexpected indentation.
    """
    根据数据源类型格式化股票代码

    参数:
        code: 股票代码(可以是任何支持的格式)
        source_type: 数据源类型
            - 'akshare': AKShare格式 (600000) - 6位纯数字
            - 'baostock': Baostock格式 (sh.600000) - 交易所.代码

    返回:
        str: 适合指定数据源的股票代码格式

    异常:
        ValueError: 当数据源类型无效时抛出
    """
^
src/utils/symbol_utils.py:161:1: D400 First line should end with a period
    """
    根据指定格式格式化股票代码（保持向后兼容）

    参数:
        code: 股票代码(可以是任何支持的格式)
        format_type: 格式类型
            - 'numeric': 纯数字格式 (600001)
            - 'prefix': 前缀格式 (sh600001)
            - 'suffix': 后缀格式 (600001.SH)
            - 'baostock': Baostock格式 (sh.600000)
            - 'akshare': AKShare格式 (600000)

    返回:
        str: 格式化后的股票代码

    异常:
        ValueError: 当格式类型无效时抛出
    """
^
src/utils/symbol_utils.py:166:1: RST301 Unexpected indentation.
    """
    根据指定格式格式化股票代码（保持向后兼容）

    参数:
        code: 股票代码(可以是任何支持的格式)
        format_type: 格式类型
            - 'numeric': 纯数字格式 (600001)
            - 'prefix': 前缀格式 (sh600001)
            - 'suffix': 后缀格式 (600001.SH)
            - 'baostock': Baostock格式 (sh.600000)
            - 'akshare': AKShare格式 (600000)

    返回:
        str: 格式化后的股票代码

    异常:
        ValueError: 当格式类型无效时抛出
    """
^
src/utils/symbol_utils.py:198:1: D400 First line should end with a period
    """
    检查股票代码是否有效

    参数:
        code: 股票代码

    返回:
        bool: 股票代码是否有效
    """
^
src/utils/symbol_utils.py:217:1: D400 First line should end with a period
    """
    根据数据源类型格式化指数代码

    参数:
        code: 指数代码(可以是任何支持的格式)
        source_type: 数据源类型
            - 'akshare': AKShare格式 (通常是 sh000001, sz399001 或 000001, 399001)
            - 'baostock': Baostock格式 (sh.000001, sz.399001)

    返回:
        str: 适合指定数据源的指数代码格式

    异常:
        ValueError: 当数据源类型无效时抛出
    """
^
src/utils/symbol_utils.py:222:1: RST301 Unexpected indentation.
    """
    根据数据源类型格式化指数代码

    参数:
        code: 指数代码(可以是任何支持的格式)
        source_type: 数据源类型
            - 'akshare': AKShare格式 (通常是 sh000001, sz399001 或 000001, 399001)
            - 'baostock': Baostock格式 (sh.000001, sz.399001)

    返回:
        str: 适合指定数据源的指数代码格式

    异常:
        ValueError: 当数据源类型无效时抛出
    """
^
src/utils/symbol_utils.py:254:1: D205 1 blank line required between summary line and description
    """
    标准化指数代码格式
    支持格式:
    - 基本格式: 000001, 399001
    - 后缀格式: 000001.SH, 399001.SZ
    - 前缀格式: sh000001, SZ399001
    - 点分隔格式: sh.000001, sz.399001

    返回格式: 6位纯数字代码

    参数:
        code: 输入的指数代码(可以是字符串、整数或浮点数)

    返回:
        标准化后的6位数字指数代码

    异常:
        ValueError: 当输入为空或无法识别的格式时抛出
    """
^
src/utils/symbol_utils.py:254:1: D400 First line should end with a period
    """
    标准化指数代码格式
    支持格式:
    - 基本格式: 000001, 399001
    - 后缀格式: 000001.SH, 399001.SZ
    - 前缀格式: sh000001, SZ399001
    - 点分隔格式: sh.000001, sz.399001

    返回格式: 6位纯数字代码

    参数:
        code: 输入的指数代码(可以是字符串、整数或浮点数)

    返回:
        标准化后的6位数字指数代码

    异常:
        ValueError: 当输入为空或无法识别的格式时抛出
    """
^
src/utils/symbol_utils.py:304:80: E501 line too long (85 > 79 characters)
        if market_part in ["SH", "SZ"] and num_part.isdigit() and len(num_part) == 6:
                                                                               ^
src/utils/symbol_utils.py:359:80: E501 line too long (86 > 79 characters)
            print(f"  -> AKShare格式: {format_stock_code_for_source(stock, 'akshare')}")
                                                                               ^
src/utils/symbol_utils.py:361:80: E501 line too long (85 > 79 characters)
                f"  -> Baostock格式: {format_stock_code_for_source(stock, 'baostock')}"
                                                                               ^
src/utils/symbol_utils.py:373:80: E501 line too long (86 > 79 characters)
            print(f"  -> AKShare格式: {format_index_code_for_source(index, 'akshare')}")
                                                                               ^
src/utils/symbol_utils.py:375:80: E501 line too long (85 > 79 characters)
                f"  -> Baostock格式: {format_index_code_for_source(index, 'baostock')}"
                                                                               ^
src/utils/tdx_server_config.py:1:1: D205 1 blank line required between summary line and description
"""
# 功能：TDX服务器配置模块，管理通达信服务器列表和连接参数
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/utils/tdx_server_config.py:1:1: D400 First line should end with a period
"""
# 功能：TDX服务器配置模块，管理通达信服务器列表和连接参数
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：2.1.0
# 依赖：详见requirements.txt或文件导入部分
# 注意事项：
#   本文件是MyStocks v2.1核心组件，遵循5-tier数据分类架构
# 版权：MyStocks Project © 2025
"""
^
src/utils/tdx_server_config.py:24:1: D400 First line should end with a period
    """
    TDX服务器配置管理器

    功能:
    - 解析connect.cfg文件提取服务器列表
    - 支持主服务器配置(PrimaryHost)
    - 支持随机服务器选择(负载均衡)
    - 支持故障转移(fallback到备用服务器)

    示例:
        >>> config = TdxServerConfig('/path/to/connect.cfg')
        >>> primary_host, primary_port = config.get_primary_server()
        >>> all_servers = config.get_all_servers()
        >>> random_server = config.get_random_server()
    """
^
src/utils/tdx_server_config.py:41:1: D400 First line should end with a period
        """
        初始化TDX服务器配置管理器

        Args:
            config_file: connect.cfg文件路径
                        如果为None,使用项目默认路径: temp/connect.cfg
        """
^
src/utils/tdx_server_config.py:69:1: D400 First line should end with a period
        """
        加载并解析connect.cfg文件

        解析[HQHOST]部分:
        - HostNum: 服务器总数
        - PrimaryHost: 主服务器索引(从1开始)
        - HostName##, IPAddress##, Port##: 服务器信息

        编码处理: connect.cfg使用GBK编码(中文Windows默认)
        """
^
src/utils/tdx_server_config.py:141:80: E501 line too long (83 > 79 characters)
                self.logger.info(f"主服务器: {primary[2]} ({primary[0]}:{primary[1]})")
                                                                               ^
src/utils/tdx_server_config.py:150:1: D400 First line should end with a period
        """
        获取主服务器(根据PrimaryHost配置)

        Returns:
            (host, port) 元组

        Example:
            >>> config = TdxServerConfig()
            >>> host, port = config.get_primary_server()
            >>> print(f"主服务器: {host}:{port}")
        """
^
src/utils/tdx_server_config.py:168:1: D400 First line should end with a period
        """
        随机选择一个服务器(负载均衡)

        Returns:
            (host, port) 元组

        适用场景:
            - 多个客户端同时连接,分散负载
            - 主服务器繁忙时的备选方案
        """
^
src/utils/tdx_server_config.py:181:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
        host, port, _ = random.choice(self.servers)
^
src/utils/tdx_server_config.py:185:1: D400 First line should end with a period
        """
        获取所有可用服务器列表

        Returns:
            List of (host, port, name) 元组

        适用场景:
            - 实现自定义负载均衡策略
            - 故障转移(依次尝试所有服务器)
            - 服务器状态监控
        """
^
src/utils/tdx_server_config.py:199:1: D400 First line should end with a period
        """
        根据索引获取服务器

        Args:
            index: 服务器索引(从0开始)

        Returns:
            (host, port) 元组,如果索引无效返回None
        """
^
src/utils/tdx_server_config.py:213:80: E501 line too long (80 > 79 characters)
    def get_failover_servers(self, max_count: int = 3) -> List[Tuple[str, int]]:
                                                                               ^
src/utils/tdx_server_config.py:214:1: D400 First line should end with a period
        """
        获取故障转移服务器列表(主服务器+备用服务器)

        Args:
            max_count: 最多返回的服务器数量(包括主服务器)

        Returns:
            List of (host, port) 元组

        适用场景:
            - 主服务器连接失败时,自动尝试备用服务器
            - 实现重试机制

        策略:
            1. 首先返回主服务器
            2. 然后随机选择其他服务器作为备用

        Example:
            >>> config = TdxServerConfig()
            >>> servers = config.get_failover_servers(max_count=3)
            >>> for host, port in servers:
            >>>     try:
            >>>         connect(host, port)
            >>>         break
            >>>     except:
            >>>         continue  # 尝试下一个服务器
        """
^
src/utils/tdx_server_config.py:252:80: E501 line too long (80 > 79 characters)
                s for i, s in enumerate(self.servers) if i != self.primary_index
                                                                               ^
src/utils/tdx_server_config.py:265:1: D400 First line should end with a period
        """获取可用服务器总数"""
^
src/utils/tdx_server_config.py:269:1: D400 First line should end with a period
        """字符串表示"""
^
src/utils/tdx_server_config.py:285:1: D400 First line should end with a period
    """
    获取全局TDX服务器配置单例

    Returns:
        TdxServerConfig单例实例

    示例:
        >>> config = get_global_config()
        >>> host, port = config.get_primary_server()
    """
^
src/utils/test_logs_api.py:2:1: D205 1 blank line required between summary line and description
"""
测试系统运行日志API端点
验证日志查询和筛选功能
"""
^
src/utils/test_logs_api.py:2:1: D400 First line should end with a period
"""
测试系统运行日志API端点
验证日志查询和筛选功能
"""
^
src/utils/test_logs_api.py:15:1: D400 First line should end with a period
    """打印分隔线"""
^
src/utils/test_logs_api.py:20:1: D400 First line should end with a period
    """测试1: 获取所有日志"""
^
src/utils/test_logs_api.py:35:19: F541 f-string is missing placeholders
            print(f"\n前3条日志:")
                  ^
src/utils/test_logs_api.py:37:80: E501 line too long (83 > 79 characters)
                print(f"  - [{log['level']}] {log['timestamp']}: {log['message']}")
                                                                               ^
src/utils/test_logs_api.py:46:15: F541 f-string is missing placeholders
        print(f"   请确保Backend服务正在运行")
              ^
src/utils/test_logs_api.py:54:1: D400 First line should end with a period
    """测试2: 只获取有问题的日志"""
^
src/utils/test_logs_api.py:73:80: E501 line too long (86 > 79 characters)
                log["level"] in ["WARNING", "ERROR", "CRITICAL"] for log in error_logs
                                                                               ^
src/utils/test_logs_api.py:77:23: F541 f-string is missing placeholders
                print(f"✅ 验证通过: 所有日志都是问题日志")
                      ^
src/utils/test_logs_api.py:79:23: F541 f-string is missing placeholders
                print(f"⚠️  警告: 存在非问题日志")
                      ^
src/utils/test_logs_api.py:81:19: F541 f-string is missing placeholders
            print(f"\n问题日志详情:")
                  ^
src/utils/test_logs_api.py:83:80: E501 line too long (82 > 79 characters)
                print(f"  - [{log['level']}] {log['category']}: {log['message']}")
                                                                               ^
src/utils/test_logs_api.py:96:1: D400 First line should end with a period
    """测试3: 按日志级别筛选"""
^
src/utils/test_logs_api.py:111:80: E501 line too long (80 > 79 characters)
            all_error_level = all(log["level"] == "ERROR" for log in error_logs)
                                                                               ^
src/utils/test_logs_api.py:114:23: F541 f-string is missing placeholders
                print(f"✅ 验证通过: 所有日志都是ERROR级别")
                      ^
src/utils/test_logs_api.py:116:23: F541 f-string is missing placeholders
                print(f"⚠️  警告: 存在其他级别日志")
                      ^
src/utils/test_logs_api.py:132:1: D400 First line should end with a period
    """测试4: 按分类筛选"""
^
src/utils/test_logs_api.py:147:80: E501 line too long (80 > 79 characters)
            all_database = all(log["category"] == "database" for log in db_logs)
                                                                               ^
src/utils/test_logs_api.py:150:23: F541 f-string is missing placeholders
                print(f"✅ 验证通过: 所有日志都是database分类")
                      ^
src/utils/test_logs_api.py:152:23: F541 f-string is missing placeholders
                print(f"⚠️  警告: 存在其他分类日志")
                      ^
src/utils/test_logs_api.py:168:1: D400 First line should end with a period
    """测试5: 分页功能"""
^
src/utils/test_logs_api.py:185:23: F541 f-string is missing placeholders
                print(f"✅ 验证通过: 返回日志数 <= limit (5)")
                      ^
src/utils/test_logs_api.py:187:23: F541 f-string is missing placeholders
                print(f"❌ 验证失败: 返回日志数 > limit")
                      ^
src/utils/test_logs_api.py:200:1: D400 First line should end with a period
    """测试6: 日志统计摘要"""
^
src/utils/test_logs_api.py:215:19: F541 f-string is missing placeholders
            print(f"\n日志统计:")
                  ^
src/utils/test_logs_api.py:218:19: F541 f-string is missing placeholders
            print(f"\n各级别统计:")
                  ^
src/utils/test_logs_api.py:222:19: F541 f-string is missing placeholders
            print(f"\n各分类统计:")
                  ^
src/utils/test_logs_api.py:238:1: D400 First line should end with a period
    """主函数"""
^
src/utils/validate_gitignore.py:3:1: D205 1 blank line required between summary line and description
"""
# 功能：验证.gitignore配置是否正确排除应忽略的文件
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：1.0.0
# 依赖：无外部依赖
# 注意事项：
#   - 检查git status中不应出现的文件类型
#   - 验证.env.example等例外文件可见
#   - 提供清理建议
# 版权：MyStocks Project © 2025
"""
^
src/utils/validate_gitignore.py:3:1: D400 First line should end with a period
"""
# 功能：验证.gitignore配置是否正确排除应忽略的文件
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：1.0.0
# 依赖：无外部依赖
# 注意事项：
#   - 检查git status中不应出现的文件类型
#   - 验证.env.example等例外文件可见
#   - 提供清理建议
# 版权：MyStocks Project © 2025
"""
^
src/utils/validate_gitignore.py:17:1: S404 Consider possible security implications associated with the subprocess module.
import subprocess
^
src/utils/validate_gitignore.py:23:1: D400 First line should end with a period
    """Git忽略规则验证器"""
^
src/utils/validate_gitignore.py:25:1: D107 Missing docstring in __init__
    def __init__(self, root_dir: str = "."):
^
src/utils/validate_gitignore.py:55:1: D400 First line should end with a period
        """执行git命令"""
^
src/utils/validate_gitignore.py:57:1: S603 subprocess call - check for execution of untrusted input.
            result = subprocess.run(
^
src/utils/validate_gitignore.py:69:1: D400 First line should end with a period
        """获取未跟踪的文件列表"""
^
src/utils/validate_gitignore.py:70:80: E501 line too long (85 > 79 characters)
        output = self.run_git_command(["status", "--short", "--untracked-files=all"])
                                                                               ^
src/utils/validate_gitignore.py:81:1: D400 First line should end with a period
        """检查应该被忽略的文件模式"""
^
src/utils/validate_gitignore.py:104:1: D400 First line should end with a period
        """检查排除规则文件是否可见"""
^
src/utils/validate_gitignore.py:120:36: F541 f-string is missing placeholders
                        "message": f"应该可见但被忽略",
                                   ^
src/utils/validate_gitignore.py:127:1: D400 First line should end with a period
        """检查.gitignore文件是否存在"""
^
src/utils/validate_gitignore.py:152:1: D400 First line should end with a period
        """生成清理命令"""
^
src/utils/validate_gitignore.py:162:80: E501 line too long (90 > 79 characters)
                        "find . -type d -name '__pycache__' -exec rm -rf {} + 2>/dev/null"
                                                                               ^
src/utils/validate_gitignore.py:173:80: E501 line too long (81 > 79 characters)
                        "# find . -type d -name 'node_modules' -exec rm -rf {} +"
                                                                               ^
src/utils/validate_gitignore.py:179:1: D400 First line should end with a period
        """生成验证报告"""
^
src/utils/validate_gitignore.py:195:23: F541 f-string is missing placeholders
        report.append(f"📊 验证统计:")
                      ^
src/utils/validate_gitignore.py:219:80: E501 line too long (83 > 79 characters)
                    report.append(f"\n  {i}. {issue['file']} - {issue['message']}")
                                                                               ^
src/utils/validate_gitignore.py:221:80: E501 line too long (83 > 79 characters)
                    report.append(f"\n  {i}. {issue['file']} - {issue['message']}")
                                                                               ^
src/utils/validate_gitignore.py:248:80: E501 line too long (80 > 79 characters)
                    i["type"] == "NOT_IGNORED" and i["pattern"] == "__pycache__"
                                                                               ^
src/utils/validate_gitignore.py:300:1: D400 First line should end with a period
    """主函数"""
^
src/utils/validate_test_naming.py:3:1: D205 1 blank line required between summary line and description
"""
# 功能：验证测试文件命名规范是否符合pytest约定
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：1.0.0
# 依赖：无外部依赖
# 注意事项：
#   - 检查所有测试文件是否以test_开头
#   - 统计符合/不符合pytest规范的文件
#   - 提供修复建议
# 版权：MyStocks Project © 2025
"""
^
src/utils/validate_test_naming.py:3:1: D400 First line should end with a period
"""
# 功能：验证测试文件命名规范是否符合pytest约定
# 作者：JohnC (ninjas@sina.com) & Claude
# 创建日期：2025-10-16
# 版本：1.0.0
# 依赖：无外部依赖
# 注意事项：
#   - 检查所有测试文件是否以test_开头
#   - 统计符合/不符合pytest规范的文件
#   - 提供修复建议
# 版权：MyStocks Project © 2025
"""
^
src/utils/validate_test_naming.py:21:1: D400 First line should end with a period
    """测试文件命名规范验证器"""
^
src/utils/validate_test_naming.py:23:1: D107 Missing docstring in __init__
    def __init__(self, root_dir: str = "."):
^
src/utils/validate_test_naming.py:39:1: D400 First line should end with a period
        """查找所有测试文件（包含'test'关键字的.py文件）"""
^
src/utils/validate_test_naming.py:65:1: D400 First line should end with a period
        """验证单个文件是否符合pytest命名规范"""
^
src/utils/validate_test_naming.py:76:1: D400 First line should end with a period
        """验证所有测试文件"""
^
src/utils/validate_test_naming.py:97:1: D400 First line should end with a period
        """为不符合规范的文件建议新名称"""
^
src/utils/validate_test_naming.py:117:50: E203 whitespace before ':'
                    "_".join(parts[test_index + 1 :])
                                                 ^
src/utils/validate_test_naming.py:131:1: D400 First line should end with a period
        """生成验证报告"""
^
src/utils/validate_test_naming.py:140:23: F541 f-string is missing placeholders
        report.append(f"📊 统计信息:")
                      ^
src/utils/validate_test_naming.py:148:27: F541 f-string is missing placeholders
            report.append(f"✅ 符合规范的文件 (前10个):")
                          ^
src/utils/validate_test_naming.py:157:27: F541 f-string is missing placeholders
            report.append(f"❌ 不符合规范的文件及修复建议:")
                          ^
src/utils/validate_test_naming.py:164:80: E501 line too long (85 > 79 characters)
                    f"     命令: git mv {rel_path} {file_path.parent}/{suggested_name}"
                                                                               ^
src/utils/validate_test_naming.py:199:1: D400 First line should end with a period
    """主函数"""
^
src/utils/validate_test_naming.py:209:80: E501 line too long (85 > 79 characters)
        "total": len(validator.compliant_files) + len(validator.non_compliant_files),
                                                                               ^
src/visualization/__init__.py:1:1: D104 Missing docstring in public package
src/visualization/backtest_visualizer.py:1:1: D400 First line should end with a period
"""
回测性能可视化 (Backtest Visualizer)

功能说明:
- 权益曲线图
- 回撤分析图
- 收益分布图
- 月度/年度收益表
- 综合性能仪表盘

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/visualization/backtest_visualizer.py:26:1: D400 First line should end with a period
    """
    回测性能可视化器

    功能:
    - 生成权益曲线
    - 回撤分析
    - 收益分布
    - 性能仪表盘
    """
^
src/visualization/backtest_visualizer.py:37:1: D400 First line should end with a period
        """
        初始化可视化器

        参数:
            figsize: 默认图表大小
        """
^
src/visualization/backtest_visualizer.py:58:1: D400 First line should end with a period
        """
        绘制权益曲线

        参数:
            equity_curve: 权益曲线DataFrame，包含'equity'列
            benchmark: 基准收益率（可选）
            title: 图表标题
            show: 是否显示图表
            save_path: 保存路径

        示例:
            >>> visualizer = BacktestVisualizer()
            >>> visualizer.plot_equity_curve(
            ...     equity_curve,
            ...     benchmark=benchmark_returns,
            ...     save_path="equity_curve.png"
            ... )
        """
^
src/visualization/backtest_visualizer.py:131:1: D400 First line should end with a period
        """
        绘制回撤分析图

        参数:
            equity_curve: 权益曲线DataFrame
            title: 图表标题
            show: 是否显示图表
            save_path: 保存路径
        """
^
src/visualization/backtest_visualizer.py:169:80: E501 line too long (87 > 79 characters)
        ax2.fill_between(equity_curve.index, drawdown * 100, 0, color="red", alpha=0.3)
                                                                               ^
src/visualization/backtest_visualizer.py:170:80: E501 line too long (84 > 79 characters)
        ax2.plot(equity_curve.index, drawdown * 100, linewidth=1.5, color="darkred")
                                                                               ^
src/visualization/backtest_visualizer.py:178:80: E501 line too long (85 > 79 characters)
        ax2.scatter([max_dd_idx], [max_dd_value * 100], color="red", s=100, zorder=5)
                                                                               ^
src/visualization/backtest_visualizer.py:212:1: D400 First line should end with a period
        """
        绘制收益分布图

        参数:
            daily_returns: 每日收益率
            title: 图表标题
            show: 是否显示图表
            save_path: 保存路径
        """
^
src/visualization/backtest_visualizer.py:225:80: E501 line too long (85 > 79 characters)
        ax1.hist(returns_pct, bins=50, color="skyblue", alpha=0.7, edgecolor="black")
                                                                               ^
src/visualization/backtest_visualizer.py:244:80: E501 line too long (82 > 79 characters)
        ax2.set_title("Q-Q Plot (Normality Test)", fontsize=14, fontweight="bold")
                                                                               ^
src/visualization/backtest_visualizer.py:267:1: D400 First line should end with a period
        """
        绘制月度收益热力图

        参数:
            daily_returns: 每日收益率
            title: 图表标题
            show: 是否显示图表
            save_path: 保存路径
        """
^
src/visualization/backtest_visualizer.py:291:80: E501 line too long (87 > 79 characters)
        heatmap_data = monthly_df.pivot(index="year", columns="month", values="return")
                                                                               ^
src/visualization/backtest_visualizer.py:299:80: E501 line too long (88 > 79 characters)
        im = ax.imshow(heatmap_data.values, cmap=cmap, aspect="auto", vmin=-10, vmax=10)
                                                                               ^
src/visualization/backtest_visualizer.py:320:80: E501 line too long (81 > 79 characters)
        actual_month_labels = [month_labels[m - 1] for m in heatmap_data.columns]
                                                                               ^
src/visualization/backtest_visualizer.py:329:21: F841 local variable 'text' is assigned to but never used
                    text = ax.text(
                    ^
src/visualization/backtest_visualizer.py:366:1: D400 First line should end with a period
        """
        绘制综合性能仪表盘

        参数:
            result: 回测结果字典，包含:
                   - backtest: 回测基础结果
                   - performance: 性能指标
                   - risk: 风险指标
            title: 图表标题
            show: 是否显示图表
            save_path: 保存路径

        示例:
            >>> from backtest.backtest_engine import BacktestEngine
            >>> engine = BacktestEngine()
            >>> result = engine.run(price_data, signals)
            >>> visualizer = BacktestVisualizer()
            >>> visualizer.plot_dashboard(result, save_path="dashboard.png")
        """
^
src/visualization/backtest_visualizer.py:373:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        绘制综合性能仪表盘

        参数:
            result: 回测结果字典，包含:
                   - backtest: 回测基础结果
                   - performance: 性能指标
                   - risk: 风险指标
            title: 图表标题
            show: 是否显示图表
            save_path: 保存路径

        示例:
            >>> from backtest.backtest_engine import BacktestEngine
            >>> engine = BacktestEngine()
            >>> result = engine.run(price_data, signals)
            >>> visualizer = BacktestVisualizer()
            >>> visualizer.plot_dashboard(result, save_path="dashboard.png")
        """
^
src/visualization/backtest_visualizer.py:396:80: E501 line too long (87 > 79 characters)
        ax1.plot(equity_curve.index, equity_curve["equity"], linewidth=2, color="blue")
                                                                               ^
src/visualization/backtest_visualizer.py:436:80: E501 line too long (87 > 79 characters)
        ax3.fill_between(equity_curve.index, drawdown * 100, 0, color="red", alpha=0.3)
                                                                               ^
src/visualization/backtest_visualizer.py:437:80: E501 line too long (84 > 79 characters)
        ax3.plot(equity_curve.index, drawdown * 100, linewidth=1.5, color="darkred")
                                                                               ^
src/visualization/backtest_visualizer.py:447:80: E501 line too long (85 > 79 characters)
        ax4.hist(returns_pct, bins=40, color="skyblue", alpha=0.7, edgecolor="black")
                                                                               ^
src/visualization/backtest_visualizer.py:448:80: E501 line too long (81 > 79 characters)
        ax4.axvline(returns_pct.mean(), color="red", linestyle="--", linewidth=2)
                                                                               ^
src/visualization/backtest_visualizer.py:458:80: E501 line too long (82 > 79 characters)
            daily_returns.resample("ME").apply(lambda x: (1 + x).prod() - 1) * 100
                                                                               ^
src/visualization/backtest_visualizer.py:461:80: E501 line too long (86 > 79 characters)
        ax5.bar(range(len(monthly_returns)), monthly_returns, color=colors, alpha=0.7)
                                                                               ^
src/visualization/backtest_visualizer.py:471:80: E501 line too long (81 > 79 characters)
        ax6.set_title("Rolling Volatility (20d)", fontsize=13, fontweight="bold")
                                                                               ^
src/visualization/backtest_visualizer.py:506:80: E501 line too long (85 > 79 characters)
        {"equity": equity, "cash": 50000, "position": 500, "price": 100}, index=dates
                                                                               ^
src/visualization/chart_generator.py:1:1: D400 First line should end with a period
"""
K线图和信号可视化 (Chart Generator)

功能说明:
- 生成专业K线图（使用mplfinance）
- 标记买卖信号
- 叠加技术指标
- 支持多种图表样式

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/visualization/chart_generator.py:25:1: D400 First line should end with a period
    """图表样式配置"""
^
src/visualization/chart_generator.py:36:80: E501 line too long (86 > 79 characters)
        up="red", down="green", edge="inherit", wick="inherit", volume="in", alpha=0.9
                                                                               ^
src/visualization/chart_generator.py:41:1: D400 First line should end with a period
        """获取中国风格（红涨绿跌）"""
^
src/visualization/chart_generator.py:52:1: D400 First line should end with a period
    """
    K线图生成器

    功能:
    - 生成K线图
    - 标记交易信号
    - 叠加技术指标
    - 自定义样式
    """
^
src/visualization/chart_generator.py:63:1: D400 First line should end with a period
        """
        初始化图表生成器

        参数:
            style: 图表样式，可选值:
                  - 'china': 中国风格（红涨绿跌）
                  - 'charles': 经典风格
                  - 'yahoo': Yahoo风格
                  - 'binance': 币安风格
        """
^
src/visualization/chart_generator.py:91:1: D400 First line should end with a period
        """
        绘制基础K线图

        参数:
            data: K线数据，必须包含 open, high, low, close, volume
                  index必须是DatetimeIndex
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径（可选）
            figsize: 图表大小

        示例:
            >>> generator = ChartGenerator()
            >>> generator.plot_kline(price_data, title="平安银行", save_path="kline.png")
        """
^
src/visualization/chart_generator.py:96:1: RST203 Definition list ends without a blank line; unexpected unindent.
        """
        绘制基础K线图

        参数:
            data: K线数据，必须包含 open, high, low, close, volume
                  index必须是DatetimeIndex
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径（可选）
            figsize: 图表大小

        示例:
            >>> generator = ChartGenerator()
            >>> generator.plot_kline(price_data, title="平安银行", save_path="kline.png")
        """
^
src/visualization/chart_generator.py:105:80: E501 line too long (85 > 79 characters)
        """
        绘制基础K线图

        参数:
            data: K线数据，必须包含 open, high, low, close, volume
                  index必须是DatetimeIndex
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径（可选）
            figsize: 图表大小

        示例:
            >>> generator = ChartGenerator()
            >>> generator.plot_kline(price_data, title="平安银行", save_path="kline.png")
        """




                                      ^
src/visualization/chart_generator.py:143:1: D400 First line should end with a period
        """
        绘制带交易信号的K线图

        参数:
            data: K线数据
            signals: 信号数据，包含 signal ('buy'/'sell'), entry_price
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径
            figsize: 图表大小

        示例:
            >>> generator = ChartGenerator()
            >>> generator.plot_with_signals(
            ...     price_data, signals,
            ...     title="动量策略信号",
            ...     save_path="signals.png"
            ... )
        """
^
src/visualization/chart_generator.py:243:80: E501 line too long (81 > 79 characters)
                    mpatches.Patch(color="red", label=f"买入 ({len(buy_markers)})")
                                                                               ^
src/visualization/chart_generator.py:248:80: E501 line too long (84 > 79 characters)
                    mpatches.Patch(color="green", label=f"卖出 ({len(sell_markers)})")
                                                                               ^
src/visualization/chart_generator.py:273:1: D400 First line should end with a period
        """
        绘制带技术指标的K线图

        参数:
            data: K线数据
            indicators: 指标字典，格式: {'指标名': Series}
                       支持主图指标（MA, BOLL等）和副图指标（MACD, RSI等）
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径
            figsize: 图表大小

        示例:
            >>> indicators = {
            ...     'MA5': ma5_series,
            ...     'MA20': ma20_series,
            ...     'RSI': rsi_series
            ... }
            >>> generator.plot_with_indicators(
            ...     price_data, indicators,
            ...     save_path="indicators.png"
            ... )
        """
^
src/visualization/chart_generator.py:278:1: RST301 Unexpected indentation.
        """
        绘制带技术指标的K线图

        参数:
            data: K线数据
            indicators: 指标字典，格式: {'指标名': Series}
                       支持主图指标（MA, BOLL等）和副图指标（MACD, RSI等）
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径
            figsize: 图表大小

        示例:
            >>> indicators = {
            ...     'MA5': ma5_series,
            ...     'MA20': ma20_series,
            ...     'RSI': rsi_series
            ... }
            >>> generator.plot_with_indicators(
            ...     price_data, indicators,
            ...     save_path="indicators.png"
            ... )
        """
^
src/visualization/chart_generator.py:279:1: RST201 Block quote ends without a blank line; unexpected unindent.
        """
        绘制带技术指标的K线图

        参数:
            data: K线数据
            indicators: 指标字典，格式: {'指标名': Series}
                       支持主图指标（MA, BOLL等）和副图指标（MACD, RSI等）
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径
            figsize: 图表大小

        示例:
            >>> indicators = {
            ...     'MA5': ma5_series,
            ...     'MA20': ma20_series,
            ...     'RSI': rsi_series
            ... }
            >>> generator.plot_with_indicators(
            ...     price_data, indicators,
            ...     save_path="indicators.png"
            ... )
        """
^
src/visualization/chart_generator.py:309:80: E501 line too long (86 > 79 characters)
            is_sub = any(sub_name in name.upper() for sub_name in sub_indicator_names)
                                                                               ^
src/visualization/chart_generator.py:324:80: E501 line too long (85 > 79 characters)
                mpf.make_addplot(series, panel=0, color=color, width=1.5, label=name)
                                                                               ^
src/visualization/chart_generator.py:331:80: E501 line too long (84 > 79 characters)
                mpf.make_addplot(series, panel=panel_num, color="blue", ylabel=name)
                                                                               ^
src/visualization/chart_generator.py:373:1: D400 First line should end with a period
        """
        绘制完整图表（K线 + 信号 + 指标）

        参数:
            data: K线数据
            signals: 信号数据（可选）
            indicators: 指标字典（可选）
            title: 图表标题
            volume: 是否显示成交量
            show: 是否显示图表
            save_path: 保存路径
            figsize: 图表大小

        示例:
            >>> generator.plot_complete(
            ...     price_data,
            ...     signals=signals,
            ...     indicators={'MA5': ma5, 'MA20': ma20, 'RSI': rsi},
            ...     title="动量策略完整分析",
            ...     save_path="complete.png"
            ... )
        """
^
src/visualization/chart_generator.py:409:80: E501 line too long (80 > 79 characters)
                    sub_name in name.upper() for sub_name in sub_indicator_names
                                                                               ^
src/visualization/chart_generator.py:418:23: B007 Loop control variable 'name' not used within the loop body. If this is intended, start the name with an underscore.
            for idx, (name, series) in enumerate(main_indicators.items()):
                      ^
src/visualization/chart_generator.py:420:80: E501 line too long (86 > 79 characters)
                apds.append(mpf.make_addplot(series, panel=0, color=color, width=1.5))
                                                                               ^
src/visualization/chart_generator.py:426:80: E501 line too long (88 > 79 characters)
                    mpf.make_addplot(series, panel=panel_num, color="blue", ylabel=name)
                                                                               ^
src/visualization/chart_generator.py:438:80: E501 line too long (82 > 79 characters)
                    {"price": buy_signals["entry_price"]}, index=buy_signals.index
                                                                               ^
src/visualization/chart_generator.py:456:80: E501 line too long (84 > 79 characters)
                    {"price": sell_signals["entry_price"]}, index=sell_signals.index
                                                                               ^
src/visualization/chart_generator.py:499:1: D400 First line should end with a period
        """验证K线数据格式"""
^
src/visualization/chart_generator.py:501:80: E501 line too long (80 > 79 characters)
        missing_cols = [col for col in required_cols if col not in data.columns]
                                                                               ^
src/visualization/complete_example.py:1:1: D400 First line should end with a period
"""
完整可视化示例 (Complete Visualization Example)

功能说明:
- 演示策略执行、回测和可视化的完整流程
- 生成K线图、信号图、回测性能图表
- 展示最佳实践

作者: MyStocks量化交易团队
创建时间: 2025-10-18
版本: 1.0.0
"""
^
src/visualization/complete_example.py:19:1: E402 module level import not at top of file
import pandas as pd
^
src/visualization/complete_example.py:20:1: E402 module level import not at top of file
import numpy as np
^
src/visualization/complete_example.py:23:1: E402 module level import not at top of file
from strategy.templates.momentum_template import MomentumStrategy
^
src/visualization/complete_example.py:24:1: E402 module level import not at top of file
from backtest.backtest_engine import BacktestEngine, BacktestConfig
^
src/visualization/complete_example.py:25:1: E402 module level import not at top of file
from src.visualization.chart_generator import ChartGenerator
^
src/visualization/complete_example.py:26:1: E402 module level import not at top of file
from src.visualization.backtest_visualizer import BacktestVisualizer
^
src/visualization/complete_example.py:30:1: D400 First line should end with a period
    """生成示例数据"""
^
src/visualization/complete_example.py:52:1: D400 First line should end with a period
    """完整示例流程"""
^
src/visualization/complete_example.py:80:80: E501 line too long (80 > 79 characters)
    print(f"     - 卖出: {len(valid_signals[valid_signals['signal'] == 'sell'])}")
                                                                               ^
src/visualization/complete_example.py:94:11: F541 f-string is missing placeholders
    print(f"  ✓ 回测完成")
          ^
src/visualization/complete_example.py:112:80: E501 line too long (80 > 79 characters)
    rsi = pd.Series(RSI(price_data["close"].values, 14), index=price_data.index)
                                                                               ^
2     B006 Do not use mutable data structures for argument defaults.  They are created during function definition time. All calls to the function reuse this one instance of that data structure, persisting changes between them.
18    B007 Loop control variable 'i' not used within the loop body. If this is intended, start the name with an underscore.
62    B008 Do not perform function calls in argument defaults.  The call is performed only once at function definition time. All calls to your function will reuse the result of that definition-time function call.  If this is intended, assign the function call to a module-level variable and use that variable as a default value.
2     B027 on_before_execute is an empty method in an abstract base class, but has no abstract decorator. Consider adding @abstractmethod.
1     B039 ContextVar with mutable literal or function call as default. This is only evaluated once, and all subsequent calls to `.get()` will return the same instance of the default.
2     B041 Repeated key-value pair in dictionary literal.
11    B042 Exception class with `__init__` should pass all args to `super().__init__()` in order to work with `copy.copy()`. It should also not take any kwargs.
10    D100 Missing docstring in public module
11    D101 Missing docstring in public class
17    D102 Missing docstring in public method
28    D103 Missing docstring in public function
10    D104 Missing docstring in public package
16    D105 Missing docstring in magic method
121   D107 Missing docstring in __init__
16    D200 One-line docstring should fit on one line with quotes
56    D202 No blank lines allowed after function docstring
1     D204 1 blank line required after class docstring
187   D205 1 blank line required between summary line and description
1     D300 Use """triple double quotes"""
1     D301 Use r""" if any backslashes in a docstring
3544  D400 First line should end with a period
6     D403 First word of the first line should be properly capitalized
32    E128 continuation line under-indented for visual indent
1     E129 visually indented line with same indent as next logical line
1     E131 continuation line unaligned for hanging indent
35    E203 whitespace before ':'
26    E261 at least two spaces before inline comment
1     E266 too many leading '#' for block comment
1     E301 expected 1 blank line, found 0
4     E302 expected 2 blank lines, found 1
2     E303 too many blank lines (2)
106   E402 module level import not at top of file
2375  E501 line too long (80 > 79 characters)
1     E721 do not compare types, for exact checks use `is` / `is not`, for instance checks use `isinstance()`
46    F401 'typing.Optional' imported but unused
1     F402 import 'field' from line 12 shadowed by loop variable
217   F541 f-string is missing placeholders
4     F601 dictionary key 'roa' repeated with different values
13    F811 redefinition of unused 'Optional' from line 13
29    F821 undefined name 'Optional'
65    F841 local variable 'sig' is assigned to but never used
3     N801 class name 'operation_monitor' should use CapWords convention
39    N802 function name 'SubmitBacktest' should be lowercase
11    N803 argument name 'yearType' should be lowercase
119   N806 variable 'ALLOWED_TABLES' in function should be lowercase
1     N817 camelcase 'xml.etree.ElementTree' imported as acronym 'ET'
64    RST201 Block quote ends without a blank line; unexpected unindent.
86    RST203 Definition list ends without a blank line; unexpected unindent.
13    RST206 Field list ends without a blank line; unexpected unindent.
55    RST210 Inline strong start-string without end-string.
3     RST213 Inline emphasis start-string without end-string.
6     RST214 Inline literal start-string without end-string.
6     RST215 Inline interpreted text or phrase reference start-string without end-string.
79    RST301 Unexpected indentation.
3     RST306 Unknown target name: "open".
19    RST401 Unexpected section title.
178   S101 Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
6     S102 Use of exec detected.
1     S105 Possible hardcoded password: 'test_token_abc'
4     S108 Probable insecure usage of temp file/directory.
22    S110 Try, Except, Pass detected.
1     S202 tarfile.extractall used without any validation. Please check and discard dangerous members.
4     S301 Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
437   S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
2     S314 Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
4     S324 Use of weak MD5 hash for security. Consider usedforsecurity=False
4     S403 Consider possible security implications associated with pickle module.
4     S404 Consider possible security implications associated with the subprocess module.
1     S405 Using xml.etree.ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
4     S603 subprocess call - check for execution of untrusted input.
1     S605 Starting a process with a shell, possible injection detected, security issue.
1     S607 Starting a process with a partial executable path
62    S608 Possible SQL injection vector through string-based query construction.
49    W291 trailing whitespace
8     W292 no newline at end of file
7     W293 blank line contains whitespace
1     W391 blank line at end of file
8391
