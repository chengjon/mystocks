# 06 回测竞技场 (Backtest Arena)

## 1. 页面概览
**功能定位**: 验证策略逻辑的试金石。提供高性能回测引擎和详尽的归因分析报告。
**视觉焦点**: 净值曲线图 (Equity Curve) 和 关键绩效指标 (KPIs)。

## 2. 布局结构

### 2.1 回测配置栏 (Control Panel)
*   **组件**: `BacktestConfigBar`
*   **输入项**:
    *   **策略选择**: 下拉选择来自 [策略实验室] 的策略。
    *   **时间范围**: 开始日期 - 结束日期。
    *   **初始资金**: 默认 1,000,000。
    *   **基准指数**: 沪深300 / 中证500。
    *   **频率**: 分钟 / 日线。
*   **动作**: "开始回测" (带有加载动画的按钮)。
*   **API**: `POST /api/v1/strategy/run/single`

### 2.2 绩效概览 (Performance Summary)
*   **组件**: `KPIGrid`
*   **指标**:
    *   **收益类**: 总收益率, 年化收益率 (CAGR), Alpha.
    *   **风险类**: 最大回撤 (Max Drawdown), 夏普比率 (Sharpe), 波动率.
    *   **交易类**: 胜率, 盈亏比, 交易次数, 持仓周期.
*   **ArtDeco**: 每个指标卡片使用金线边框，数字使用大号等宽字体。

### 2.3 核心图表 (Charts Area)
*   **组件**: `EquityChart`
*   **内容**:
    *   **净值走势**: 策略净值 vs 基准净值 (双线对比)。
    *   **回撤区域**: 下方阴影显示动态回撤幅度。
    *   **买卖点标记**: 在曲线上标注主要买卖操作。
*   **组件**: `PositionChart`
    *   **仓位控制**: 每日总仓位占比 (0-100%)。

### 2.4 交易详情 (Trade Details)
*   **组件**: `TradeLogTable`
*   **内容**:
    *   详细的交易记录流水: 时间, 代码, 方向, 价格, 数量, 手续费, 盈亏。
    *   支持导出 Excel/CSV。
*   **API**: `GET /api/v1/strategy/results?detail=trades`

## 3. 交互设计
*   **进度反馈**: 回测运行时，顶部显示进度条 (Progress Bar) 和当前处理的日期。
*   **历史记录**: 侧边栏可展开 "历史回测记录"，点击可快速加载之前的回测结果进行对比。

## 4. API 映射汇总
| 组件区域 | 核心 API 端点 | 请求方式 | 备注 |
| :--- | :--- | :--- | :--- |
| 运行回测 | `/api/v1/strategy/run/single` | POST | 异步任务 |
| 批量回测 | `/api/v1/strategy/run/batch` | POST | 参数扫描 |
| 回测结果 | `/api/v1/strategy/results` | GET | 获取JSON报告 |
