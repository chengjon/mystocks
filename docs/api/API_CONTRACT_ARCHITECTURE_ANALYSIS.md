# MyStocks é¡¹ç›® API å¥‘çº¦æ¶æ„å®Œæ•´åˆ†æ

> ç”Ÿæˆæ—¶é—´: 2026-01-14
> åˆ†æå¯¹è±¡: api-contract-sync-manager å’Œ api-contract-sync ç»„ä»¶
> æ–‡æ¡£ç‰ˆæœ¬: v1.0

---

## ğŸ“‹ ç›®å½•

- [API å¥‘çº¦æ¶æ„æ€»è§ˆ](#-api-å¥‘çº¦æ¶æ„æ€»è§ˆ)
- [æ ¸å¿ƒç»„ä»¶è¯¦è§£](#-æ ¸å¿ƒç»„ä»¶è¯¦è§£)
- [ä¸¤ä¸ªç»„ä»¶åä½œæµç¨‹](#-ä¸¤ä¸ªç»„ä»¶åä½œæµç¨‹)
- [åœ¨MyStocksé¡¹ç›®ä¸­çš„å…·ä½“å®ç°](#-åœ¨mystocksé¡¹ç›®ä¸­çš„å…·ä½“å®ç°)
- [æ ¸å¿ƒä»·å€¼æ€»ç»“](#-æ ¸å¿ƒä»·å€¼æ€»ç»“)

---

## ğŸ—ï¸ API å¥‘çº¦æ¶æ„æ€»è§ˆ

### æ ¸å¿ƒæ¦‚å¿µï¼šAPI å¥‘çº¦
API å¥‘çº¦æ˜¯ API çš„ã€Œå®˜æ–¹ä½¿ç”¨è¯´æ˜ä¹¦ã€ï¼ŒåŒ…å«ï¼š
- **æ¥å£å®šä¹‰**: URLè·¯å¾„ã€HTTPæ–¹æ³•ã€è¯·æ±‚å‚æ•°
- **æ•°æ®æ ¼å¼**: è¯·æ±‚ä½“ç»“æ„ã€å“åº”æ ¼å¼ã€æ•°æ®ç±»å‹
- **ä¸šåŠ¡è§„åˆ™**: çŠ¶æ€ç å«ä¹‰ã€é”™è¯¯ç è§„èŒƒã€ä¸šåŠ¡é€»è¾‘çº¦æŸ
- **ç‰ˆæœ¬ä¿¡æ¯**: APIç‰ˆæœ¬ã€å…¼å®¹æ€§è¯´æ˜

### æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API å¥‘çº¦ç”Ÿæ€ç³»ç»Ÿ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           api-contract-sync-manager                    â”‚ â”‚
â”‚  â”‚           (å¥‘çº¦ç®¡ç†å¹³å°)                               â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   å¥‘çº¦ä»“åº“     â”‚   ç‰ˆæœ¬æ§åˆ¶     â”‚   å¯è§†åŒ–ç¼–è¾‘     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   æƒé™ç®¡ç†     â”‚   æ ¡éªŒè§„åˆ™     â”‚   å·®å¼‚æ£€æµ‹       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            api-contract-sync                           â”‚ â”‚
â”‚  â”‚            (å¥‘çº¦åŒæ­¥å·¥å…·)                              â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   ä»£ç æ‰«æ     â”‚   å“åº”æ ¡éªŒ     â”‚   æµ‹è¯•ç”Ÿæˆ       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   å·®å¼‚å‘Šè­¦     â”‚   CI/CDé›†æˆ    â”‚   æœ¬åœ°åŒæ­¥       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            API å®ç°å±‚                                  â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   FastAPIåº”ç”¨ â”‚   å“åº”æ¨¡å‹     â”‚   é”™è¯¯å¤„ç†       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   PydanticéªŒè¯ â”‚   ä¸šåŠ¡é€»è¾‘     â”‚   æ•°æ®è®¿é—®       â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            å¤–éƒ¨é›†æˆå±‚                                  â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚   å‰ç«¯è°ƒç”¨     â”‚   æµ‹è¯•ç”¨ä¾‹     â”‚   ç¬¬ä¸‰æ–¹ç³»ç»Ÿ     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   æ–‡æ¡£ç”Ÿæˆ     â”‚   ç›‘æ§å‘Šè­¦     â”‚   APIç½‘å…³        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. **api-contract-sync-manager** - API å¥‘çº¦åŒæ­¥ç®¡ç†å™¨

#### **æ ¸å¿ƒå®šä½**
API å¥‘çº¦çš„ã€Œä¸­å¤®ç®¡ç†å¹³å°ã€ï¼Œæ˜¯æ•´ä¸ªå¥‘çº¦ç”Ÿæ€çš„ã€Œå¤§è„‘ã€ï¼Œè´Ÿè´£ç»Ÿä¸€å­˜å‚¨ã€ç‰ˆæœ¬æ§åˆ¶ã€æƒé™ç®¡ç†å’Œè§„åˆ™åˆ¶å®šã€‚

#### **æ ¸å¿ƒåŠŸèƒ½æ¨¡å—**

**ğŸ” æƒé™ç®¡ç†**
- **è§’è‰²å®šä¹‰**: æ¶æ„å¸ˆï¼ˆç¼–è¾‘å¥‘çº¦ï¼‰ã€åç«¯å¼€å‘ï¼ˆæŸ¥çœ‹ä½¿ç”¨ï¼‰ã€å‰ç«¯å¼€å‘ï¼ˆæŸ¥çœ‹è°ƒç”¨ï¼‰ã€æµ‹è¯•äººå‘˜ï¼ˆå®¡æ ¸æ ¡éªŒï¼‰
- **ç²¾ç»†æƒé™**: æŒ‰ä¸šåŠ¡æ¨¡å—åˆ†é…æƒé™ï¼Œé¿å…è¯¯æ“ä½œ
- **å®¡è®¡è¿½è¸ª**: è®°å½•æ‰€æœ‰å¥‘çº¦å˜æ›´çš„ä½œè€…ã€æ—¶é—´ã€åŸå› 

**ğŸ“š å¥‘çº¦ä»“åº“**
- **åˆ†ç±»å­˜å‚¨**: æŒ‰ä¸šåŠ¡åŸŸç»„ç»‡ï¼ˆå¦‚market-apiã€trade-apiã€strategy-apiï¼‰
- **æ‰¹é‡å¯¼å…¥**: ä»Swagger/Postman/Postmanæ‰¹é‡è¿ç§»ç°æœ‰APIæ–‡æ¡£
- **ç»Ÿä¸€æ ¼å¼**: å¼ºåˆ¶OpenAPI 3.0æ ‡å‡†ï¼Œç¡®ä¿æ ¼å¼ä¸€è‡´æ€§

**ğŸ“ å¯è§†åŒ–ç¼–è¾‘**
- **æ— ä»£ç ç¼–è¾‘**: è¡¨å•åŒ–ç•Œé¢é…ç½®APIå­—æ®µï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™YAML
- **æ¨¡æ¿åŒ–**: é¢„å®šä¹‰å¸¸ç”¨å“åº”æ ¼å¼æ¨¡æ¿ï¼ˆå¦‚ç»Ÿä¸€é”™è¯¯å“åº”ï¼‰
- **åœ¨çº¿é¢„è§ˆ**: åµŒå…¥Swagger UIå®æ—¶é¢„è§ˆAPIæ–‡æ¡£æ•ˆæœ

**ğŸ” ç‰ˆæœ¬æ§åˆ¶**
- **è¯­ä¹‰åŒ–ç‰ˆæœ¬**: MAJOR.MINOR.PATCHç‰ˆæœ¬å·ç®¡ç†
- **åˆ†æ”¯ç®¡ç†**: æ”¯æŒå¼€å‘/æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬éš”ç¦»
- **ç‰ˆæœ¬å¯¹æ¯”**: å¯è§†åŒ–å±•ç¤ºç‰ˆæœ¬é—´å­—æ®µå˜æ›´ï¼ˆæ–°å¢/åˆ é™¤/ä¿®æ”¹ï¼‰
- **å›æ»šæ”¯æŒ**: å½“å˜æ›´å¯¼è‡´é—®é¢˜æ—¶å¿«é€Ÿå›æ»šåˆ°å†å²ç‰ˆæœ¬

**âœ… æ ¡éªŒè§„åˆ™é…ç½®**
```yaml
# åŸºç¡€æ ¡éªŒè§„åˆ™ï¼ˆå¼ºåˆ¶ï¼‰
field_name_consistency: true      # å­—æ®µåå¿…é¡»ä¸å¥‘çº¦å®Œå…¨ä¸€è‡´
field_type_consistency: true      # å­—æ®µç±»å‹å¿…é¡»åŒ¹é…
required_fields_check: true       # å¿…å¡«å­—æ®µä¸èƒ½ä¸ºnull

# è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ï¼ˆå¯é€‰ï¼‰
custom_rules:
  - name: "user_age_range"
    condition: "user.age >= 0 AND user.age <= 150"
    message: "å¹´é¾„å¿…é¡»åœ¨0-150å²ä¹‹é—´"
```

#### **å®é™…ä½œç”¨**
1. **ç»Ÿä¸€è®¤çŸ¥**: ç¡®ä¿å‰åç«¯ã€æµ‹è¯•ã€ç¬¬ä¸‰æ–¹å¯¹APIçš„ç†è§£å®Œå…¨ä¸€è‡´
2. **è´¨é‡ç®¡æ§**: é€šè¿‡å®¡æ ¸æµç¨‹é˜²æ­¢ä¸ç¬¦åˆè§„èŒƒçš„APIå‘å¸ƒ
3. **å˜æ›´ç®¡ç†**: è¿½è¸ªAPIæ¼”è¿›å†å²ï¼Œæ”¯æŒå®‰å…¨çš„ç‰ˆæœ¬å‡çº§
4. **åä½œæ•ˆç‡**: æä¾›å¯è§†åŒ–ç•Œé¢é™ä½APIæ–‡æ¡£ç»´æŠ¤æˆæœ¬

---

### 2. **api-contract-sync** - API å¥‘çº¦åŒæ­¥

#### **æ ¸å¿ƒå®šä½**
API å¥‘çº¦çš„ã€ŒåŒæ­¥æ‰§è¡Œè€…ã€ï¼Œæ˜¯è¿æ¥å¥‘çº¦æ ‡å‡†ä¸å®é™…å®ç°çš„ã€Œæ¡¥æ¢å·¥å…·ã€ï¼Œè´Ÿè´£è‡ªåŠ¨æ ¡éªŒå’ŒåŒæ­¥ã€‚

#### **æ ¸å¿ƒåŠŸèƒ½æ¨¡å—**

**ğŸ” ä»£ç å®ç°æ‰«æ**
- **ASTè§£æ**: æ‰«æFastAPIè·¯ç”±å®šä¹‰ï¼Œæå–URLã€æ–¹æ³•ã€å‚æ•°ã€å“åº”æ¨¡å‹
- **è‡ªåŠ¨å¯¹æ¯”**: å°†ä»£ç å®ç°ä¸å¥‘çº¦è§„èŒƒè¿›è¡Œå­—æ®µçº§å¯¹æ¯”
- **ç±»å‹æ ¡éªŒ**: éªŒè¯Pydanticæ¨¡å‹æ˜¯å¦ä¸å¥‘çº¦å®šä¹‰ä¸€è‡´

**ğŸŒ å“åº”å®æ—¶æ ¡éªŒ**
```python
# SDKé›†æˆç¤ºä¾‹
from api_contract_sync import ContractResponseValidator

validator = ContractResponseValidator(manager_url="http://manager:8080")

@pytest.mark.parametrize("user_id", [1, 2, 3])
def test_user_query(user_id):
    response = requests.get(f"/api/user/{user_id}")

    # è‡ªåŠ¨æ ¡éªŒå“åº”æ ¼å¼
    result = validator.validate_response(
        api_path=f"/api/user/{user_id}",
        actual_response=response.json()
    )
    assert result.passed, f"å“åº”æ ¼å¼ä¸åŒ¹é…: {result.errors}"
```

**ğŸ“‹ æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ**
```bash
# ä»å¥‘çº¦è‡ªåŠ¨ç”Ÿæˆpytestæµ‹è¯•
api-contract-sync generate test \
  --contract-path ./contracts \
  --output-path ./tests \
  --type pytest

# ç”ŸæˆPostmané›†åˆ
api-contract-sync generate test \
  --manager-url http://manager:8080 \
  --output-path ./postman_collection.json \
  --type postman
```

**ğŸ”„ CI/CDé›†æˆ**
```yaml
# GitLab CIç¤ºä¾‹
contract_validate:
  stage: validate
  script:
    - pip install api-contract-sync
    - api-contract-sync pull --all --manager-url $MANAGER_URL
    - api-contract-sync validate code --contract-path ./contracts --src-path ./src
    - api-contract-sync validate response --test-suite ./tests
  only:
    - merge_requests
```

**ğŸ“Š å·®å¼‚å‘Šè­¦**
- **å¤šæ¸ é“é€šçŸ¥**: é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€é‚®ä»¶å‘Šè­¦
- **å·®å¼‚è¯¦æƒ…**: æ˜ç¡®æ ‡è®°ä¸åŒ¹é…çš„å­—æ®µå’Œä½ç½®
- **è´£ä»»äººè¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«å˜æ›´è´£ä»»äººå¹¶@æé†’

#### **å®é™…ä½œç”¨**
1. **è‡ªåŠ¨åŒ–æ ¡éªŒ**: å¼€å‘é˜¶æ®µè‡ªåŠ¨å‘ç°APIå®ç°ä¸å¥‘çº¦çš„ä¸ä¸€è‡´
2. **æµ‹è¯•ä¿éšœ**: ç”Ÿæˆç¬¦åˆå¥‘çº¦çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿æ¥å£è¡Œä¸ºç¨³å®š
3. **éƒ¨ç½²é˜²æŠ¤**: CI/CDé›†æˆé˜»æ–­ä¸ç¬¦åˆå¥‘çº¦çš„ä»£ç éƒ¨ç½²
4. **é—®é¢˜å®šä½**: å¿«é€Ÿè¯†åˆ«æ˜¯å¥‘çº¦å˜æ›´è¿˜æ˜¯ä»£ç å®ç°é—®é¢˜

---

## ğŸ”„ ä¸¤ä¸ªç»„ä»¶åä½œæµç¨‹

### å®Œæ•´å·¥ä½œæµç¨‹

```
1. å¥‘çº¦è®¾è®¡é˜¶æ®µ
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æ¶æ„å¸ˆåœ¨managerâ”‚ -> â”‚ åˆ›å»º/ç¼–è¾‘å¥‘çº¦   â”‚
   â”‚ ä¸­è®¾è®¡APIå¥‘çº¦  â”‚    â”‚ è®¾ç½®æ ¡éªŒè§„åˆ™   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
2. å¼€å‘å®ç°é˜¶æ®µ
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ åç«¯å¼€å‘å®ç°APIâ”‚ -> â”‚ syncå·¥å…·è‡ªåŠ¨    â”‚
   â”‚ ä»£ç            â”‚    â”‚ æ ¡éªŒä»£ç åˆè§„æ€§ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
3. æµ‹è¯•éªŒè¯é˜¶æ®µ
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ æµ‹è¯•äººå‘˜æ‰§è¡Œ   â”‚ -> â”‚ syncç”Ÿæˆæµ‹è¯•ç”¨ä¾‹â”‚
   â”‚ æ¥å£æµ‹è¯•       â”‚    â”‚ å®æ—¶æ ¡éªŒå“åº”   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
4. éƒ¨ç½²ä¸Šçº¿é˜¶æ®µ
   â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ CI/CDæµæ°´çº¿    â”‚ -> â”‚ syncé˜»æ–­ä¸ç¬¦åˆ â”‚
   â”‚ è‡ªåŠ¨æ ¡éªŒ       â”‚    â”‚ å¥‘çº¦çš„éƒ¨ç½²     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…¸å‹ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1ï¼šæ–°APIå¼€å‘
```bash
# 1. åç«¯å¼€å‘æ‹‰å–æœ€æ–°å¥‘çº¦
api-contract-sync pull --module user --manager-url http://manager:8080

# 2. å®ç°APIä»£ç 
# ... ç¼–å†™FastAPIè·¯ç”± ...

# 3. æœ¬åœ°æ ¡éªŒåˆè§„æ€§
api-contract-sync validate code --contract-path ./contracts --src-path ./src

# 4. ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
api-contract-sync generate test --contract-path ./contracts --output-path ./tests
```

#### åœºæ™¯2ï¼šAPIå˜æ›´ç®¡ç†
```bash
# 1. åœ¨managerä¸­æ›´æ–°å¥‘çº¦ç‰ˆæœ¬
# 2. æ¿€æ´»æ–°ç‰ˆæœ¬
api-contract-sync activate 2

# 3. åŒæ­¥åˆ°æœ¬åœ°
api-contract-sync pull --all

# 4. æ ¡éªŒç°æœ‰ä»£ç å…¼å®¹æ€§
api-contract-sync validate code --check-breaking
```

---

## ğŸ“Š åœ¨MyStocksé¡¹ç›®ä¸­çš„å…·ä½“å®ç°

### å½“å‰æ¶æ„çŠ¶æ€

åŸºäºä»£ç åˆ†æï¼Œé¡¹ç›®ä¸­çš„APIå¥‘çº¦ç³»ç»ŸåŒ…å«ï¼š

**åç«¯å®ç°** (`web/backend/app/api/contract/`):
- `routes.py`: FastAPIè·¯ç”±ï¼Œæä¾›å¥‘çº¦CRUD API
- `models.py`: æ•°æ®åº“æ¨¡å‹ï¼ˆContractVersionã€ContractDiffç­‰ï¼‰
- `schemas.py`: Pydanticæ•°æ®æ¨¡å‹
- `version_manager.py`: ç‰ˆæœ¬ç®¡ç†é€»è¾‘
- `diff_engine.py`: å·®å¼‚æ£€æµ‹å¼•æ“
- `validator.py`: å¥‘çº¦éªŒè¯é€»è¾‘

**CLIå·¥å…·** (`scripts/cli/api_contract_sync.py`):
- å®Œæ•´çš„å‘½ä»¤è¡Œæ¥å£
- æ”¯æŒcreate/list/show/activate/deleteç­‰æ“ä½œ
- æ”¯æŒdiff/validate/syncç­‰é«˜çº§åŠŸèƒ½
- æ”¯æŒexport/importå¥‘çº¦æ–‡ä»¶

### å®é™…è¿è¡Œç¤ºä¾‹

```bash
# æŸ¥çœ‹å¸®åŠ©
api-contract-sync --help

# åˆ›å»ºæ–°å¥‘çº¦ç‰ˆæœ¬
api-contract-sync create market-api 1.0.0 -s openapi.yaml

# åˆ—å‡ºç‰ˆæœ¬
api-contract-sync list --name market-api

# æ¿€æ´»ç‰ˆæœ¬
api-contract-sync activate 1

# æ ¡éªŒå¥‘çº¦
api-contract-sync validate openapi.yaml

# åŒæ­¥å¥‘çº¦
api-contract-sync sync market-api -s openapi.yaml -d code-to-db
```

---

## ğŸ¯ æ ¸å¿ƒä»·å€¼æ€»ç»“

### **api-contract-sync-manager** çš„ä»·å€¼
- **ç»Ÿä¸€ç®¡æ§**: è§£å†³APIæ–‡æ¡£æ•£è½åœ¨å„å¤„çš„ç®¡ç†éš¾é¢˜
- **è´¨é‡ä¿éšœ**: é€šè¿‡å®¡æ ¸æµç¨‹ç¡®ä¿APIè§„èŒƒæ€§
- **åä½œæ•ˆç‡**: å¯è§†åŒ–ç•Œé¢é™ä½ç»´æŠ¤æˆæœ¬
- **ç‰ˆæœ¬å®‰å…¨**: å®Œæ•´çš„ç‰ˆæœ¬æ§åˆ¶å’Œå›æ»šèƒ½åŠ›

### **api-contract-sync** çš„ä»·å€¼
- **è‡ªåŠ¨åŒ–æ ¡éªŒ**: å¼€å‘é˜¶æ®µè‡ªåŠ¨å‘ç°ä¸ä¸€è‡´é—®é¢˜
- **æµ‹è¯•ä¿éšœ**: ç”Ÿæˆç¬¦åˆå¥‘çº¦çš„æµ‹è¯•ç”¨ä¾‹
- **éƒ¨ç½²å®‰å…¨**: CI/CDé›†æˆé˜²æ­¢ä¸åˆæ ¼APIä¸Šçº¿
- **é—®é¢˜è¯Šæ–­**: å¿«é€Ÿå®šä½å¥‘çº¦ä¸å®ç°åå·®

### **ååŒä»·å€¼**
è¿™ä¸¤ä¸ªç»„ä»¶å½¢æˆå®Œæ•´çš„APIå¥‘çº¦ç®¡ç†é—­ç¯ï¼š
- **manager**è´Ÿè´£ã€Œå®šæ ‡å‡†ã€ç®¡ç‰ˆæœ¬ã€
- **sync**è´Ÿè´£ã€Œæ‰§è¡Œæ ¡éªŒã€ä¿ä¸€è‡´ã€
- **å…±åŒè§£å†³**å¤§è§„æ¨¡APIå¼€å‘ä¸­çš„ã€Œæ–‡æ¡£ä¸ä¸€è‡´ã€æ¥å£ä¸ç¨³å®šã€åä½œæ··ä¹±ã€ä¸‰å¤§æ ¸å¿ƒé—®é¢˜

é€šè¿‡è¿™ä¸ªæ¶æ„ï¼ŒMyStocksé¡¹ç›®èƒ½å¤Ÿç¡®ä¿200+ä¸ªAPIæ¥å£åœ¨å‰åç«¯åˆ†ç¦»ã€å¤šå›¢é˜Ÿåä½œçš„å¤æ‚ç¯å¢ƒä¸‹ä»ç„¶ä¿æŒé«˜åº¦çš„ä¸€è‡´æ€§å’Œç¨³å®šæ€§ã€‚</content>
<parameter name="filePath">docs/api/API_CONTRACT_ARCHITECTURE_ANALYSIS.md