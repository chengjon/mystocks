# CLI-6 æ€§èƒ½æµ‹è¯•çŠ¶æ€æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2025-12-29
**æŠ¥å‘ŠçŠ¶æ€**: éƒ¨åˆ†å®Œæˆï¼ˆæµ‹è¯•è„šæœ¬å·²å°±ç»ªï¼Œå¾…æœåŠ¡è¿è¡Œï¼‰
**è´£ä»»äºº**: CLI-6 Quality Assurance Team

---

## æ‰§è¡ŒçŠ¶æ€

### åç«¯ API å‹åŠ›æµ‹è¯• (Locust)

**çŠ¶æ€**: ğŸ“‹ æµ‹è¯•è„šæœ¬å·²å°±ç»ªï¼Œå¾…æœåŠ¡è¿è¡Œ

**å®Œæˆæƒ…å†µ**:
- âœ… Locust æµ‹è¯•è„šæœ¬å·²åˆ›å»º: `tests/load/locustfile.py`
- âœ… æµ‹è¯•æ–‡æ¡£å·²ç¼–å†™: `tests/load/README.md`
- âœ… æµ‹è¯•åœºæ™¯å·²å®šä¹‰: 5 ç§ç”¨æˆ·ç±»å‹
- âŒ å®é™…å‹æµ‹æœªæ‰§è¡Œï¼ˆåç«¯æœåŠ¡æœªè¿è¡Œï¼‰

**æµ‹è¯•é…ç½®**:
```python
# tests/load/locustfile.py
- å¹¶å‘ç”¨æˆ·: 100
- ç”Ÿæˆé€Ÿç‡: 10 users/s
- æµ‹è¯•æ—¶é•¿: 5 åˆ†é’Ÿ
- ç›®æ ‡ RPS: > 500
- ç›®æ ‡ P95: < 500ms
```

**æµ‹è¯•åœºæ™¯**:
1. **StockAPIUser** - åŸºç¡€APIç”¨æˆ·ï¼ˆå¥åº·æ£€æŸ¥ã€CSRF Tokenã€æ–‡æ¡£ï¼‰
2. **MarketDataUser** - å¸‚åœºæ•°æ®ç”¨æˆ·ï¼ˆKçº¿ã€å®æ—¶æ•°æ®ï¼‰
3. **TechnicalAnalysisUser** - æŠ€æœ¯åˆ†æç”¨æˆ·ï¼ˆæŒ‡æ ‡è®¡ç®—ï¼‰
4. **CacheUser** - ç¼“å­˜ç®¡ç†ç”¨æˆ·ï¼ˆç¼“å­˜ç»Ÿè®¡ã€æ¸…é™¤ï¼‰
5. **StrategyUser** - ç­–ç•¥æ‰§è¡Œç”¨æˆ·ï¼ˆç­–ç•¥åˆ—è¡¨ã€æ‰§è¡Œç­–ç•¥ï¼‰

**é˜»å¡åŸå› **:
```
åç«¯æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæ— æ³•è¿æ¥åˆ°æµ‹è¯•ç›®æ ‡

å°è¯•å¯åŠ¨:
cd web/backend && python -m app.main

ç»“æœ: æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œè¿æ¥è¢«æ‹’ç»
```

**æ‰§è¡Œè®¡åˆ’**:
```bash
# 1. å¯åŠ¨åç«¯æœåŠ¡
cd web/backend
python -m app.main

# 2. æ‰§è¡Œ Locust å‹åŠ›æµ‹è¯•
locust -f tests/load/locustfile.py \
  --host=http://localhost:8000 \
  --users=100 \
  --spawn-rate=10 \
  --run-time=5m \
  --headless \
  --html=reports/locust_report.html

# 3. æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
open reports/locust_report.html
```

**é¢„æœŸç»“æœ**:
- RPS: > 500
- P95å“åº”æ—¶é—´: < 500ms
- P99å“åº”æ—¶é—´: < 1000ms
- é”™è¯¯ç‡: < 1%

---

### å‰ç«¯æ€§èƒ½æµ‹è¯• (Lighthouse)

**çŠ¶æ€**: ğŸ“‹ æµ‹è¯•è®¡åˆ’å·²åˆ¶å®šï¼Œå¾…å‰ç«¯æœåŠ¡è¿è¡Œ

**å®Œæˆæƒ…å†µ**:
- âœ… æ€§èƒ½ç›®æ ‡å·²å®šä¹‰
- âœ… æµ‹è¯•é¡µé¢å·²ç¡®å®š
- âŒ å®é™…æµ‹è¯•æœªæ‰§è¡Œï¼ˆå‰ç«¯æœåŠ¡æœªè¿è¡Œï¼‰

**æ€§èƒ½ç›®æ ‡**:
```
- Performance Score: > 90
- First Contentful Paint (FCP): < 1.5s
- Largest Contentful Paint (LCP): < 2.5s
- Time to Interactive (TTI): < 3.5s
- Cumulative Layout Shift (CLS): < 0.1
```

**å¾…æµ‹è¯•é¡µé¢**:
1. **é¦–é¡µ** (`http://localhost:3000/`)
   - ä¸»è¦å†…å®¹: å¯¼èˆªã€æ¦‚è§ˆå¡ç‰‡
   - å…³é”®æŒ‡æ ‡: FCP < 1.5s, LCP < 2.5s

2. **AI ç­›é€‰é¡µé¢** (`http://localhost:3000/ai-screening`)
   - ä¸»è¦å†…å®¹: è‡ªç„¶è¯­è¨€æŸ¥è¯¢ã€æ¨èåˆ—è¡¨
   - å…³é”®æŒ‡æ ‡: Performance > 90, CLS < 0.1

3. **GPU ç›‘æ§é¡µé¢** (`http://localhost:3000/gpu-monitoring`)
   - ä¸»è¦å†…å®¹: GPU çŠ¶æ€å¡ç‰‡ã€æ€§èƒ½å›¾è¡¨
   - å…³é”®æŒ‡æ ‡: TTI < 3.5s, LCP < 2.5s

**é˜»å¡åŸå› **:
```
å‰ç«¯æœåŠ¡æœªè¿è¡Œï¼Œæ— æ³•è¿›è¡Œæ€§èƒ½æµ‹è¯•

éœ€è¦å¯åŠ¨:
cd web/frontend
npm run dev
```

**æ‰§è¡Œè®¡åˆ’**:
```bash
# 1. å¯åŠ¨å‰ç«¯æœåŠ¡
cd web/frontend
npm run dev

# 2. æ‰§è¡Œ Lighthouse æµ‹è¯•ï¼ˆé¦–é¡µï¼‰
lighthouse http://localhost:3000/ \
  --output=html \
  --output-path=reports/lighthouse_home.html

# 3. æ‰§è¡Œ Lighthouse æµ‹è¯•ï¼ˆAIç­›é€‰é¡µé¢ï¼‰
lighthouse http://localhost:3000/ai-screening \
  --output=html \
  --output-path=reports/lighthouse_ai_screening.html

# 4. æ‰§è¡Œ Lighthouse æµ‹è¯•ï¼ˆGPUç›‘æ§é¡µé¢ï¼‰
lighthouse http://localhost:3000/gpu-monitoring \
  --output=html \
  --output-path=reports/lighthouse_gpu.html

# 5. æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š
open reports/lighthouse_*.html
```

**é¢„æœŸç»“æœ**:
- æ‰€æœ‰é¡µé¢ Performance Score > 90
- LCP < 2.5s
- CLS < 0.1

---

## å½“å‰çŠ¶æ€æ€»ç»“

### å·²å®Œæˆå·¥ä½œ

1. **æµ‹è¯•åŸºç¡€è®¾æ–½**
   - âœ… Locust æµ‹è¯•è„šæœ¬å·²åˆ›å»º
   - âœ… æµ‹è¯•åœºæ™¯å·²å®šä¹‰
   - âœ… æµ‹è¯•æ–‡æ¡£å·²ç¼–å†™

2. **æ€§èƒ½ç›®æ ‡è®¾å®š**
   - âœ… åç«¯ API æ€§èƒ½ç›®æ ‡å·²å®šä¹‰
   - âœ… å‰ç«¯æ€§èƒ½ç›®æ ‡å·²å®šä¹‰
   - âœ… æµ‹è¯•é¡µé¢å·²ç¡®å®š

### æœªå®Œæˆå·¥ä½œ

1. **å®é™…æµ‹è¯•æ‰§è¡Œ**
   - âŒ Locust å‹åŠ›æµ‹è¯•æœªæ‰§è¡Œ
   - âŒ Lighthouse æ€§èƒ½æµ‹è¯•æœªæ‰§è¡Œ

2. **æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ**
   - âŒ Locust æµ‹è¯•æŠ¥å‘Šæœªç”Ÿæˆ
   - âŒ Lighthouse æµ‹è¯•æŠ¥å‘Šæœªç”Ÿæˆ

---

## é˜»å¡åŸå› åˆ†æ

### åç«¯æœåŠ¡å¯åŠ¨å¤±è´¥

**é—®é¢˜**:
```bash
cd web/backend && python -m app.main
# æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œæ— æ³•è¿æ¥
```

**å¯èƒ½åŸå› **:
1. æ•°æ®åº“è¿æ¥é…ç½®é—®é¢˜
2. ä¾èµ–åŒ…ç¼ºå¤±æˆ–ç‰ˆæœ¬ä¸å…¼å®¹
3. ç«¯å£å†²çª
4. ç¯å¢ƒå˜é‡é…ç½®é”™è¯¯

**è§£å†³å»ºè®®**:
1. æ£€æŸ¥ PostgreSQL è¿æ¥é…ç½®
2. éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
3. æ£€æŸ¥ç«¯å£ 8000 æ˜¯å¦è¢«å ç”¨
4. è¿è¡Œ `pip install -r requirements.txt` ç¡®ä¿ä¾èµ–å®Œæ•´
5. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—: `python -m app.main --log-level=debug`

### å‰ç«¯æœåŠ¡æœªè¿è¡Œ

**é—®é¢˜**:
```bash
cd web/frontend && npm run dev
# æœåŠ¡æœªå¯åŠ¨
```

**å¯èƒ½åŸå› **:
1. Node.js ç‰ˆæœ¬ä¸å…¼å®¹
2. npm ä¾èµ–æœªå®‰è£…
3. å‰ç«¯æ„å»ºé”™è¯¯
4. ç«¯å£ 3000 è¢«å ç”¨

**è§£å†³å»ºè®®**:
1. æ£€æŸ¥ Node.js ç‰ˆæœ¬ (è¦æ±‚ >= 18)
2. è¿è¡Œ `npm install` å®‰è£…ä¾èµ–
3. æ¸…é™¤ç¼“å­˜: `rm -rf node_modules package-lock.json && npm install`
4. æ£€æŸ¥ç«¯å£ 3000 æ˜¯å¦è¢«å ç”¨

---

## åç»­è¡ŒåŠ¨è®¡åˆ’

### ä¼˜å…ˆçº§ 1: å¯åŠ¨æœåŠ¡å¹¶æ‰§è¡Œæµ‹è¯•

**é¢„è®¡æ—¶é—´**: 2-3 å°æ—¶

**æ­¥éª¤**:
1. å¯åŠ¨åç«¯æœåŠ¡
   ```bash
   cd web/backend
   python -m app.main
   ```

2. éªŒè¯æœåŠ¡è¿è¡Œ
   ```bash
   curl http://localhost:8000/health
   ```

3. å¯åŠ¨å‰ç«¯æœåŠ¡
   ```bash
   cd web/frontend
   npm run dev
   ```

4. æ‰§è¡Œ Locust å‹åŠ›æµ‹è¯•
   ```bash
   locust -f tests/load/locustfile.py \
     --host=http://localhost:8000 \
     --users=100 \
     --spawn-rate=10 \
     --run-time=5m \
     --headless \
     --html=reports/locust_report.html
   ```

5. æ‰§è¡Œ Lighthouse æ€§èƒ½æµ‹è¯•
   ```bash
   lighthouse http://localhost:3000/ \
     --output=html \
     --output-path=reports/lighthouse_home.html
   ```

### ä¼˜å…ˆçº§ 2: ç”Ÿæˆå®Œæ•´æ€§èƒ½æŠ¥å‘Š

**é¢„è®¡æ—¶é—´**: 1 å°æ—¶

**æ­¥éª¤**:
1. æ”¶é›†æ‰€æœ‰æµ‹è¯•ç»“æœ
2. åˆ†ææ€§èƒ½æŒ‡æ ‡
3. å¯¹æ¯”ç›®æ ‡å€¼
4. ç”Ÿæˆç»¼åˆæŠ¥å‘Š

### ä¼˜å…ˆçº§ 3: æ€§èƒ½ä¼˜åŒ–å»ºè®®

**é¢„è®¡æ—¶é—´**: 1-2 å°æ—¶

**æ­¥éª¤**:
1. è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
2. æå‡ºä¼˜åŒ–å»ºè®®
3. åˆ¶å®šä¼˜åŒ–è®¡åˆ’
4. æ›´æ–°æ–‡æ¡£

---

## é£é™©è¯„ä¼°

### é£é™© 1: æœåŠ¡å¯åŠ¨å¤±è´¥ (é«˜)

**æè¿°**: åç«¯å’Œå‰ç«¯æœåŠ¡å¯èƒ½æ— æ³•æ­£å¸¸å¯åŠ¨

**å½±å“**: æ— æ³•æ‰§è¡Œæ€§èƒ½æµ‹è¯•

**ç¼“è§£æªæ–½**:
- ä½¿ç”¨ Mock æ•°æ®è¿›è¡Œåˆæ­¥æµ‹è¯•
- å‚è€ƒ Docker é…ç½®å¯åŠ¨æœåŠ¡
- è”ç³»åç«¯å›¢é˜ŸååŠ©è§£å†³

### é£é™© 2: æ€§èƒ½ä¸è¾¾æ ‡ (ä¸­)

**æè¿°**: å®é™…æµ‹è¯•ç»“æœå¯èƒ½ä½äºé¢„æœŸç›®æ ‡

**å½±å“**: éœ€è¦è¿›è¡Œæ€§èƒ½ä¼˜åŒ–

**ç¼“è§£æªæ–½**:
- æå‰è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- å‡†å¤‡ä¼˜åŒ–æ–¹æ¡ˆ
- åˆ†é˜¶æ®µä¼˜åŒ–

### é£é™© 3: æµ‹è¯•ç¯å¢ƒä¸ç¨³å®š (ä½)

**æè¿°**: æµ‹è¯•è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°ç½‘ç»œå»¶è¿Ÿæˆ–èµ„æºä¸è¶³

**å½±å“**: æµ‹è¯•ç»“æœä¸å‡†ç¡®

**ç¼“è§£æªæ–½**:
- å¤šæ¬¡è¿è¡Œæµ‹è¯•å–å¹³å‡å€¼
- ä½¿ç”¨ç¨³å®šçš„æµ‹è¯•ç¯å¢ƒ
- ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨

---

## é™„å½•

### A. Locust æµ‹è¯•è„šæœ¬ä½ç½®

```
tests/load/locustfile.py
tests/load/README.md
```

### B. Lighthouse é…ç½®æ–‡ä»¶

```javascript
// tests/lighthouse/lighthouse.config.js
module.exports = {
  extends: 'lighthouse:default',
  settings: {
    onlyCategories: ['performance', 'accessibility', 'best-practices'],
    throttling: {
      rttMs: 150,
      throughputKbps: 1.6 * 1024,
      cpuSlowdownMultiplier: 4
    }
  }
};
```

### C. æµ‹è¯•å‘½ä»¤å‚è€ƒ

```bash
# Locust å‹åŠ›æµ‹è¯•
locust -f tests/load/locustfile.py \
  --host=http://localhost:8000 \
  --users=100 \
  --spawn-rate=10 \
  --run-time=5m \
  --headless \
  --html=reports/locust_report.html

# Lighthouse æ€§èƒ½æµ‹è¯•
lighthouse http://localhost:3000/ \
  --output=html \
  --output-path=reports/lighthouse_home.html
```

---

## æ€»ç»“

æ€§èƒ½æµ‹è¯•çš„å‡†å¤‡å·¥ä½œå·²å…¨éƒ¨å®Œæˆï¼ŒåŒ…æ‹¬ï¼š
- âœ… Locust æµ‹è¯•è„šæœ¬å·²åˆ›å»º
- âœ… æµ‹è¯•åœºæ™¯å·²å®šä¹‰
- âœ… æ€§èƒ½ç›®æ ‡å·²è®¾å®š
- âœ… æ‰§è¡Œè®¡åˆ’å·²åˆ¶å®š

ç”±äºåç«¯å’Œå‰ç«¯æœåŠ¡æœªèƒ½æˆåŠŸå¯åŠ¨ï¼Œå®é™…æµ‹è¯•æœªèƒ½æ‰§è¡Œã€‚å»ºè®®ä¼˜å…ˆè§£å†³æœåŠ¡å¯åŠ¨é—®é¢˜ï¼Œç„¶åæ‰§è¡Œå®Œæ•´çš„æ€§èƒ½æµ‹è¯•ã€‚

**å½“å‰çŠ¶æ€**: ğŸ“‹ æµ‹è¯•å‡†å¤‡å®Œæˆï¼Œå¾…æœåŠ¡è¿è¡Œåæ‰§è¡Œ

**ä¸‹ä¸€æ­¥**: å¯åŠ¨æœåŠ¡å¹¶æ‰§è¡Œæ€§èƒ½æµ‹è¯•

---

**æŠ¥å‘Šç­¾ç½²**: CLI-6 Quality Assurance Team

**æœ€åæ›´æ–°**: 2025-12-29
