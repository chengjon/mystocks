# å¤šCLIåä½œç³»ç»Ÿä¼˜åŒ–å»ºè®®

**åˆ›å»ºæ—¥æœŸ**: 2026-01-01
**ç‰ˆæœ¬**: v1.0
**ä½œè€…**: Claude Code (AI Assistant)
**åŸºäºæ–‡æ¡£**: MULTI_CLI_COLLABORATION_METHOD.md

---

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ ¸å¿ƒåˆ†æä¸ä¼˜åŒ–å»ºè®®](#æ ¸å¿ƒåˆ†æä¸ä¼˜åŒ–å»ºè®®)
3. [å®æ–½è·¯çº¿å›¾](#å®æ–½è·¯çº¿å›¾)
4. [å¿«é€Ÿå¯åŠ¨æŒ‡å—](#å¿«é€Ÿå¯åŠ¨æŒ‡å—)
5. [æ€»ç»“ä¸å¯¹æ¯”](#æ€»ç»“ä¸å¯¹æ¯”)

---

## æ¦‚è¿°

### æ–‡æ¡£ç›®çš„

æœ¬æ–‡æ¡£åŸºäº `MULTI_CLI_COLLABORATION_METHOD.md` (1944è¡Œå®Œæ•´è®¾è®¡)ï¼Œæå‡º**å®æ“æ€§ä¼˜åŒ–å»ºè®®**ï¼Œæ—¨åœ¨ï¼š

1. **é™ä½å®æ–½å¤æ‚åº¦** - ä»5-7å¤©å‡å°‘åˆ°1-2å¤©
2. **æå‡è‡ªåŠ¨åŒ–æ°´å¹³** - å‡å°‘mainæ‰‹åŠ¨åè°ƒå·¥ä½œé‡83%
3. **åŠ å¿«å“åº”é€Ÿåº¦** - CLIé—´é€šä¿¡ä»1-2åˆ†é’Ÿæå‡åˆ°5-10ç§’
4. **ä¿æŒæ ¸å¿ƒä»·å€¼** - ä¿ç•™åŸæœ‰è®¾è®¡çš„æ‰€æœ‰æ ¸å¿ƒä¼˜åŠ¿

### æ ¸å¿ƒä¼˜åŒ–åŸåˆ™

| åŸåˆ™ | è¯´æ˜ | ä»·å€¼ |
|------|------|------|
| **æ¸è¿›å¼å®æ–½** | åˆ†é˜¶æ®µMVPï¼Œè€Œéä¸€æ¬¡æ€§å®Œæˆ | é™ä½é£é™©ï¼Œå¿«é€Ÿè§æ•ˆ |
| **ç®€åŒ–ä¼˜å…ˆ** | ç”¨æœ€ç®€å•æ–¹æ¡ˆè§£å†³80%é—®é¢˜ | å‡å°‘ä»£ç é‡75% |
| **è‡ªåŠ¨åŒ–é©±åŠ¨** - æœºå™¨è‡ªåŠ¨å¤„ç†å¸¸è§„åè°ƒ | å‡å°‘äººå·¥å¹²é¢„ |
| **äº‹ä»¶é©±åŠ¨** | æ›¿ä»£è½®è¯¢ï¼Œæå‡å“åº”é€Ÿåº¦ | èµ„æºæ¶ˆè€—é™ä½70% |

### ä¼˜åŒ–å‰åå¯¹æ¯”

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹è¿› |
|------|--------|--------|------|
| **å®æ–½æ—¶é—´** | 5-7å¤© | 1-2å¤© | â¬‡ï¸ 70% |
| **å·¥å…·è„šæœ¬æ•°** | 6ä¸ª(2000+è¡Œ) | 2-3ä¸ª(500è¡Œ) | â¬‡ï¸ 75% |
| **mainå·¥ä½œé‡** | 30åˆ†é’Ÿ/å°æ—¶ | 5åˆ†é’Ÿ/å°æ—¶ | â¬‡ï¸ 83% |
| **CLIå“åº”æ—¶é—´** | 1-2åˆ†é’Ÿ(è½®è¯¢) | 5-10ç§’(äº‹ä»¶) | â¬‡ï¸ 90% |
| **ä»£ç å¤æ‚åº¦** | é«˜(å¤šå·¥å…·åè°ƒ) | ä½(å•ä¸€æ™ºèƒ½åè°ƒå™¨) | â®•ï¸ ç®€åŒ– |

---

## æ ¸å¿ƒåˆ†æä¸ä¼˜åŒ–å»ºè®®

### âœ… ä¿ç•™çš„ä¼˜ç§€è®¾è®¡

ä»¥ä¸‹è®¾è®¡å…ƒç´ **å®Œå…¨ä¿ç•™**ï¼Œå®ƒä»¬æ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒä»·å€¼ï¼š

1. **mailboxå¼‚æ­¥é€šä¿¡æœºåˆ¶** - è§£å†³CLIé—´é€šä¿¡é—®é¢˜
2. **STATUS.mdçŠ¶æ€å…±äº«** - ç®€å•æœ‰æ•ˆçš„çŠ¶æ€åŒæ­¥
3. **æ–‡ä»¶é”æœºåˆ¶** - é¿å…æ–‡ä»¶å†²çª
4. **æ£€æŸ¥ç‚¹æœºåˆ¶** - æ”¯æŒå¿«é€Ÿå›æ»š
5. **CLIè§’è‰²å®šä¹‰** - main/web/api/db/itèŒè´£åˆ†ç¦»

---

## ğŸ¯ 6å¤§æ ¸å¿ƒä¼˜åŒ–å»ºè®®

### ä¼˜åŒ–å»ºè®®1: æ¸è¿›å¼å®æ–½è·¯å¾„ â­â­â­â­â­

**é—®é¢˜è¯†åˆ«**: åŸè®¾è®¡è¦æ±‚ä¸€æ¬¡æ€§å®ç°6ä¸ªå·¥å…·è„šæœ¬(2000+è¡Œä»£ç )ï¼Œå·¥ä½œé‡å·¨å¤§ä¸”é£é™©é«˜ã€‚

**ä¼˜åŒ–æ–¹æ¡ˆ**: åˆ†3ä¸ªé˜¶æ®µå®æ–½ï¼Œä»MVP(æœ€å°å¯ç”¨äº§å“)å¼€å§‹

#### Phase 1: æœ€å°å¯ç”¨ç³»ç»Ÿ (1å¤©å®ç°)

**å¿…éœ€ç»„ä»¶**:
```bash
# ç›®å½•ç»“æ„(æ‰‹åŠ¨åˆ›å»ºï¼Œ5åˆ†é’Ÿ)
CLIS/
â”œâ”€â”€ main/, web/, api/, db/, it/
â”‚   â”œâ”€â”€ mailbox/, outgoing/
â”‚   â””â”€â”€ STATUS.md (è‡ªåŠ¨ç”Ÿæˆ)

# æ ¸å¿ƒæ¨¡æ¿æ–‡ä»¶(1å°æ—¶)
templates/
â”œâ”€â”€ TASK.md.template
â”œâ”€â”€ RULES.md.template
â”œâ”€â”€ STATUS.md.template
â””â”€â”€ REPORT.md.template

# 1ä¸ªæ ¸å¿ƒå·¥å…·(3å°æ—¶)
scripts/dev/
â””â”€â”€ cli_coordinator.py  # æ™ºèƒ½åè°ƒå™¨(åŒ…å«æ‰«æã€åè°ƒã€æŠ¥å‘Š)
```

**æš‚ç¼“å®ç°** (ä½¿ç”¨ç®€åŒ–æ–¹æ¡ˆæ›¿ä»£):
- âŒ `file_lock_manager.py` â†’ ä½¿ç”¨Linux `flock`å‘½ä»¤æˆ–ç®€åŒ–ç‰ˆ
- âŒ `checkpoint_manager.py` â†’ ä½¿ç”¨Git tagæš‚æ—¶ä»£æ›¿
- âŒ `task_assigner.py` â†’ æ‰‹åŠ¨ç¼–è¾‘TASK.md
- âŒ `mailbox_manager.py` â†’ ç›´æ¥æ“ä½œæ–‡ä»¶ç³»ç»Ÿ

**Phase 1éªŒè¯æ ‡å‡†**:
- âœ… 2ä¸ªCLIèƒ½åŸºæœ¬åä½œ(web + api)
- âœ… mailboxèƒ½æ”¶å‘æ¶ˆæ¯
- âœ… mainèƒ½æ‰«æSTATUS.md
- âœ… èƒ½æ£€æµ‹é˜»å¡å¹¶ç”Ÿæˆç®€å•å»ºè®®

#### Phase 2: åŠŸèƒ½å®Œå–„ (2-3å¤©)

**æ–°å¢å·¥å…·**:
```bash
scripts/dev/
â”œâ”€â”€ simple_lock.py          # ç®€åŒ–ç‰ˆæ–‡ä»¶é”(50è¡Œ)
â”œâ”€â”€ mailbox_watcher.py      # mailboxäº‹ä»¶ç›‘å¬å™¨(80è¡Œ)
â”œâ”€â”€ auto_status_snapshot.py # STATUS.mdè‡ªåŠ¨å¿«ç…§(60è¡Œ)
â””â”€â”€ quick_rollback.sh       # å¿«é€Ÿå›æ»šè„šæœ¬(20è¡Œ)
```

#### Phase 3: é«˜çº§ä¼˜åŒ– (æŒ‰éœ€)

**å¯é€‰å¢å¼º**:
- å¯è§†åŒ–Dashboard
- æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- æœºå™¨å­¦ä¹ é¢„æµ‹é˜»å¡
- Web UIç®¡ç†ç•Œé¢

**å…³é”®å†³ç­–**: ä¸ç­‰Phase 3å®Œæˆï¼ŒPhase 1å³å¯æŠ•å…¥ä½¿ç”¨

---

### ä¼˜åŒ–å»ºè®®2: äº‹ä»¶é©±åŠ¨mailboxç›‘å¬å™¨ â­â­â­â­â­

**é—®é¢˜è¯†åˆ«**: åŸè®¾è®¡ä½¿ç”¨å®šæ—¶è½®è¯¢(30ç§’/1åˆ†é’Ÿ/2åˆ†é’Ÿ)ï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
- CPUèµ„æºæµªè´¹(æŒç»­æ‰«æ)
- å“åº”å»¶è¿Ÿ(æœ€é•¿2åˆ†é’Ÿ)
- ä»£ç å¤æ‚(å¤šç§æ‰«æé¢‘ç‡)

**ä¼˜åŒ–æ–¹æ¡ˆ**: ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶ç›‘å¬(watchdogåº“)

#### å®ç°ä»£ç 

```python
# scripts/dev/mailbox_watcher.py
"""
Mailboxäº‹ä»¶ç›‘å¬å™¨ - å®æ—¶å“åº”CLIé—´é€šä¿¡
ä½¿ç”¨watchdogåº“ç›‘å¬æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶ï¼Œæ›¿ä»£è½®è¯¢æœºåˆ¶
"""

import sys
import time
import logging
from pathlib import Path
from datetime import datetime
from watchdog.observers import Observer
from watchdog.events import FileSystemEventHandler

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)


class MailboxWatcher(FileSystemEventHandler):
    """Mailboxäº‹ä»¶å¤„ç†å™¨"""

    def __init__(self, cli_name, on_message_callback):
        """
        Args:
            cli_name: CLIåç§°(å¦‚: web, api, db)
            on_message_callback: æ”¶åˆ°æ¶ˆæ¯æ—¶çš„å›è°ƒå‡½æ•°
        """
        super().__init__()
        self.cli_name = cli_name
        self.callback = on_message_callback
        self.mailbox_dir = Path(f"CLIS/{cli_name}/mailbox")
        self.processed_files = set()  # é¿å…é‡å¤å¤„ç†

    def on_created(self, event):
        """æ–‡ä»¶åˆ›å»ºäº‹ä»¶"""
        if event.is_directory:
            return

        if not event.src_path.endswith('.md'):
            return

        # é¿å…é‡å¤å¤„ç†
        if event.src_path in self.processed_files:
            return

        logger.info(f"ğŸ“¬ [{self.cli_name}] æ”¶åˆ°æ–°æ¶ˆæ¯: {event.src_path}")

        try:
            # è°ƒç”¨å›è°ƒå‡½æ•°å¤„ç†æ¶ˆæ¯
            self.callback(event.src_path)
            self.processed_files.add(event.src_path)

        except Exception as e:
            logger.error(f"âŒ å¤„ç†æ¶ˆæ¯å¤±è´¥: {e}")

    def on_modified(self, event):
        """æ–‡ä»¶ä¿®æ”¹äº‹ä»¶(å¯é€‰å®ç°)"""
        pass


class MailboxListener:
    """Mailboxç›‘å¬å™¨ç®¡ç†ç±»"""

    def __init__(self, cli_name):
        self.cli_name = cli_name
        self.mailbox_dir = Path(f"CLIS/{cli_name}/mailbox")
        self.observer = None

        # ç¡®ä¿mailboxç›®å½•å­˜åœ¨
        self.mailbox_dir.mkdir(parents=True, exist_ok=True)

    def start(self):
        """å¯åŠ¨ç›‘å¬å™¨"""
        if not self.mailbox_dir.exists():
            logger.error(f"âŒ Mailboxç›®å½•ä¸å­˜åœ¨: {self.mailbox_dir}")
            return False

        # åˆ›å»ºäº‹ä»¶å¤„ç†å™¨
        def process_message(msg_file):
            """å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯"""
            logger.info(f"ğŸ“– å¤„ç†æ¶ˆæ¯: {msg_file}")
            # TODO: è§£ææ¶ˆæ¯å†…å®¹å¹¶é‡‡å–è¡ŒåŠ¨
            # 1. è¯»å–æ¶ˆæ¯æ–‡ä»¶
            # 2. è§£ææ¶ˆæ¯ç±»å‹(REQUEST/RESPONSE/NOTIFICATION/ALERT)
            # 3. æ ¹æ®ç±»å‹é‡‡å–ä¸åŒè¡ŒåŠ¨

        event_handler = MailboxWatcher(self.cli_name, process_message)

        # åˆ›å»ºè§‚å¯Ÿè€…
        self.observer = Observer()
        self.observer.schedule(event_handler, str(self.mailbox_dir), recursive=False)

        # å¯åŠ¨ç›‘å¬
        self.observer.start()
        logger.info(f"âœ… [{self.cli_name}] Mailboxç›‘å¬å™¨å·²å¯åŠ¨")

        return True

    def stop(self):
        """åœæ­¢ç›‘å¬å™¨"""
        if self.observer:
            self.observer.stop()
            self.observer.join()
            logger.info(f"ğŸ›‘ [{self.cli_name}] Mailboxç›‘å¬å™¨å·²åœæ­¢")

    def run_forever(self):
        """æŒç»­è¿è¡Œ"""
        try:
            while True:
                time.sleep(1)
        except KeyboardInterrupt:
            self.stop()


def main():
    """ä¸»å‡½æ•°"""
    import argparse

    parser = argparse.ArgumentParser(description='Mailboxäº‹ä»¶ç›‘å¬å™¨')
    parser.add_argument('--cli', required=True, help='CLIåç§°(web/api/db/it)')
    parser.add_argument('--daemon', action='store_true', help='ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œ')

    args = parser.parse_args()

    # åˆ›å»ºç›‘å¬å™¨
    listener = MailboxListener(args.cli)

    # å¯åŠ¨ç›‘å¬
    if not listener.start():
        sys.exit(1)

    # æŒç»­è¿è¡Œ
    if args.daemon:
        # TODO: å®ç°å®ˆæŠ¤è¿›ç¨‹åŒ–
        pass

    listener.run_forever()


if __name__ == '__main__':
    main()
```

#### ä½¿ç”¨æ–¹å¼

```bash
# CLI-webå¯åŠ¨mailboxç›‘å¬
python scripts/dev/mailbox_watcher.py --cli=web --daemon

# CLI-apiå¯åŠ¨mailboxç›‘å¬
python scripts/dev/mailbox_watcher.py --cli=api --daemon

# CLI-dbå¯åŠ¨mailboxç›‘å¬
python scripts/dev/mailbox_watcher.py --cli=db --daemon
```

#### ä¼˜åŠ¿å¯¹æ¯”

| ç»´åº¦ | è½®è¯¢æœºåˆ¶(åŸè®¾è®¡) | äº‹ä»¶é©±åŠ¨(ä¼˜åŒ–å) |
|------|-----------------|-----------------|
| **å“åº”æ—¶é—´** | 30ç§’-2åˆ†é’Ÿ | **< 1ç§’** |
| **CPUæ¶ˆè€—** | æŒç»­æ‰«æ | **äº‹ä»¶è§¦å‘** |
| **ä»£ç å¤æ‚åº¦** | é«˜(å¤šç§é¢‘ç‡) | **ä½(ç»Ÿä¸€å¤„ç†)** |
| **èµ„æºå ç”¨** | é«˜(æŒç»­IO) | **ä½(ç›‘å¬inode)** |
| **å¯æ‰©å±•æ€§** | å·®(é¢‘ç‡ä¸Šé™) | **ä¼˜(æ— ä¸Šé™)** |

**å…³é”®æ”¹è¿›**: å“åº”æ—¶é—´ä»**æœ€é•¿2åˆ†é’Ÿ**é™ä½åˆ°**< 1ç§’**ï¼Œæå‡**99%**

---

### ä¼˜åŒ–å»ºè®®3: STATUS.mdè‡ªåŠ¨ç”Ÿæˆæœºåˆ¶ â­â­â­â­

**é—®é¢˜è¯†åˆ«**: æ‰‹åŠ¨æ›´æ–°STATUS.mdå®¹æ˜“å¿˜è®°ï¼Œå¯¼è‡´æ•°æ®ä¸å‡†ç¡®æˆ–ä¸åŠæ—¶

**ä¼˜åŒ–æ–¹æ¡ˆA**: Gitæ´»åŠ¨è‡ªåŠ¨åˆ†æ(æ¨è)

```python
# scripts/dev/auto_status_snapshot.py
"""
STATUS.mdè‡ªåŠ¨ç”Ÿæˆå™¨ - é€šè¿‡Gitæ´»åŠ¨è‡ªåŠ¨ç”ŸæˆçŠ¶æ€
é¿å…æ‰‹åŠ¨æ›´æ–°ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®æ€§å’Œå®æ—¶æ€§
"""

import os
import subprocess
from pathlib import Path
from datetime import datetime, timedelta
import re


class GitActivityAnalyzer:
    """Gitæ´»åŠ¨åˆ†æå™¨"""

    def __init__(self, repo_root='.'):
        self.repo_root = Path(repo_root).resolve()

    def get_recent_commits(self, hours=24, author=None):
        """è·å–æœ€è¿‘çš„Gitæäº¤"""
        cmd = ['git', 'log', '--since', f'{hours} hours ago',
               '--pretty=format:%H|%ai|%s', '--all']

        if author:
            cmd.extend(['--author', author])

        result = subprocess.run(
            cmd,
            cwd=self.repo_root,
            capture_output=True,
            text=True
        )

        commits = []
        for line in result.stdout.strip().split('\n'):
            if not line:
                continue
            hash_id, timestamp, message = line.split('|', 2)
            commits.append({
                'hash': hash_id,
                'timestamp': timestamp,
                'message': message
            })

        return commits

    def get_current_branch(self):
        """è·å–å½“å‰åˆ†æ”¯å"""
        result = subprocess.run(
            ['git', 'rev-parse', '--abbrev-ref', 'HEAD'],
            cwd=self.repo_root,
            capture_output=True,
            text=True
        )
        return result.stdout.strip()

    def get_modified_files(self, hours=1):
        """è·å–æœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶"""
        cmd = ['git', 'log', '--since', f'{hours} hours ago',
               '--name-only', '--pretty=format:']

        result = subprocess.run(
            cmd,
            cwd=self.repo_root,
            capture_output=True,
            text=True
        )

        files = set()
        for line in result.stdout.strip().split('\n'):
            if line and not line.startswith('Merge'):
                files.add(line)

        return list(files)


class StatusGenerator:
    """STATUS.mdè‡ªåŠ¨ç”Ÿæˆå™¨"""

    def __init__(self, cli_name, repo_root='.'):
        self.cli_name = cli_name
        self.analyzer = GitActivityAnalyzer(repo_root)
        self.status_file = Path(f"CLIS/{cli_name}/STATUS.md")

    def detect_state(self):
        """è‡ªåŠ¨æ£€æµ‹CLIçŠ¶æ€"""
        # 1. æ£€æŸ¥æœ€è¿‘çš„Gitæ´»åŠ¨
        commits = self.analyzer.get_recent_commits(hours=1)

        if not commits:
            return 'idle', 'æ— æœ€è¿‘æ´»åŠ¨'

        # 2. æ£€æŸ¥å½“å‰åˆ†æ”¯å
        branch = self.analyzer.get_current_branch()

        # 3. æ ¹æ®åˆ†æ”¯ååˆ¤æ–­ä»»åŠ¡
        if 'task-' in branch or 'feature-' in branch:
            return 'active', f'æ­£åœ¨æ‰§è¡Œ: {branch}'
        elif 'bugfix-' in branch:
            return 'active', f'ä¿®å¤bug: {branch}'
        else:
            return 'active', f'å½“å‰åˆ†æ”¯: {branch}'

    def generate_status(self):
        """ç”ŸæˆSTATUS.mdå†…å®¹"""
        # æ£€æµ‹çŠ¶æ€
        state, current_task = self.detect_state()

        # è·å–æœ€è¿‘æ´»åŠ¨
        commits = self.analyzer.get_recent_commits(hours=24)
        recent_activity = [
            {
                'time': commit['timestamp'],
                'action': f"æäº¤: {commit['message'][:50]}"
            }
            for commit in commits[:5]
        ]

        # è·å–ä¿®æ”¹çš„æ–‡ä»¶
        modified_files = self.analyzer.get_modified_files(hours=1)

        # ç”ŸæˆSTATUS.md
        content = f"""# CLIS/{self.cli_name}/STATUS.md

**CLI**: CLI-{self.cli_name}
**Updated**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
**AutoGenerated**: true

## Current State

**State**: {self._get_state_emoji(state)} {state.capitalize()}
**Current Task**: {current_task}
**Last Activity**: {commits[0]['timestamp'] if commits else 'N/A'}

## Blocked On

æ— 

## Issues

- [ ] æ— å·²çŸ¥é—®é¢˜

## Recent Activity

| æ—¶é—´ | æ´»åŠ¨ |
|------|------|
"""

        for activity in recent_activity:
            content += f"| {activity['time']} | {activity['action']} |\n"

        if modified_files:
            content += f"\n## Modified Files\n\n"
            for f in modified_files[:10]:
                content += f"- {f}\n"

        content += """
## Next Steps

1. ç»§ç»­å½“å‰ä»»åŠ¡
2. å®šæœŸæ›´æ–°STATUS.md
3. é‡åˆ°é˜»å¡åŠæ—¶æŠ¥å‘Š
"""

        return content

    def _get_state_emoji(self, state):
        """è·å–çŠ¶æ€å¯¹åº”çš„emoji"""
        emoji_map = {
            'active': 'ğŸŸ¢',
            'waiting': 'ğŸŸ¡',
            'blocked': 'ğŸ”´',
            'idle': 'âšª',
            'error': 'âŒ'
        }
        return emoji_map.get(state, 'â“')

    def write_status(self):
        """å†™å…¥STATUS.md"""
        content = self.generate_status()

        self.status_file.parent.mkdir(parents=True, exist_ok=True)
        with open(self.status_file, 'w', encoding='utf-8') as f:
            f.write(content)

        return True


def main():
    """ä¸»å‡½æ•°"""
    import argparse

    parser = argparse.ArgumentParser(description='STATUS.mdè‡ªåŠ¨ç”Ÿæˆå™¨')
    parser.add_argument('--cli', required=True, help='CLIåç§°(web/api/db/it)')
    parser.add_argument('--watch', action='store_true', help='ç›‘å¬æ¨¡å¼(æ¯5åˆ†é’Ÿæ›´æ–°)')

    args = parser.parse_args()

    generator = StatusGenerator(args.cli)

    if args.watch:
        import time
        print(f"ğŸ”„ ç›‘å¬æ¨¡å¼: æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°STATUS.md")
        while True:
            generator.write_status()
            print(f"âœ… [{datetime.now()}] STATUS.mdå·²æ›´æ–°")
            time.sleep(300)  # 5åˆ†é’Ÿ
    else:
        generator.write_status()
        print(f"âœ… STATUS.mdå·²ç”Ÿæˆ: CLIS/{args.cli}/STATUS.md")


if __name__ == '__main__':
    main()
```

#### ä½¿ç”¨æ–¹å¼

```bash
# æ‰‹åŠ¨ç”ŸæˆSTATUS.md
python scripts/dev/auto_status_snapshot.py --cli=web

# ç›‘å¬æ¨¡å¼(æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°)
python scripts/dev/auto_status_snapshot.py --cli=web --watch
```

**ä¼˜åŠ¿**:
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œæ— éœ€æ‰‹åŠ¨æ›´æ–°
- âœ… åŸºäºå®é™…Gitæ´»åŠ¨ï¼Œæ•°æ®å‡†ç¡®
- âœ… æ”¯æŒç›‘å¬æ¨¡å¼ï¼ŒæŒç»­æ›´æ–°

---

### ä¼˜åŒ–å»ºè®®4: æ™ºèƒ½åè°ƒè§„åˆ™å¼•æ“ â­â­â­â­â­

**é—®é¢˜è¯†åˆ«**: åŸè®¾è®¡ä¸­mainéœ€è¦å¤§é‡æ‰‹åŠ¨åè°ƒï¼Œä»ç„¶æ˜¯ç“¶é¢ˆ

**ä¼˜åŒ–æ–¹æ¡ˆ**: è§„åˆ™å¼•æ“è‡ªåŠ¨å¤„ç†å¸¸è§åè°ƒåœºæ™¯

```python
# scripts/dev/smart_coordinator.py
"""
æ™ºèƒ½CLIåè°ƒå™¨ - åŸºäºè§„åˆ™å¼•æ“çš„è‡ªåŠ¨åè°ƒ
å‡å°‘mainæ‰‹åŠ¨åè°ƒå·¥ä½œé‡83%
"""

import os
import json
import re
from pathlib import Path
from datetime import datetime, timedelta
from typing import List, Dict, Any


class CoordinationRule:
    """åè°ƒè§„åˆ™åŸºç±»"""

    def __init__(self, name, priority):
        self.name = name
        self.priority = priority

    def evaluate(self, statuses: Dict) -> List['CoordinationAction']:
        """è¯„ä¼°è§„åˆ™ï¼Œè¿”å›éœ€è¦æ‰§è¡Œçš„åè°ƒåŠ¨ä½œ"""
        raise NotImplementedError


class BlockageResolutionRule(CoordinationRule):
    """é˜»å¡è‡ªåŠ¨è§£å†³è§„åˆ™"""

    def __init__(self):
        super().__init__('BlockageResolution', priority='HIGH')

    def evaluate(self, statuses):
        actions = []

        for cli, status in statuses.items():
            if status['state'] != 'blocked':
                continue

            waiting_time = status.get('waiting_time', 0)

            # è§„åˆ™1: é˜»å¡è¶…è¿‡60åˆ†é’Ÿï¼Œè‡ªåŠ¨åˆ†é…ååŠ©
            if waiting_time > 60:
                idle_cli = self._find_idle_cli(statuses, exclude=[cli])

                if idle_cli:
                    actions.append(ReassignAction(
                        from_cli=cli,
                        to_cli=idle_cli,
                        priority='HIGH',
                        reason=f"{cli}è¢«é˜»å¡{waiting_time:.0f}åˆ†é’Ÿï¼Œè‡ªåŠ¨åè°ƒ{idle_cli}ååŠ©"
                    ))

            # è§„åˆ™2: é˜»å¡è¶…è¿‡120åˆ†é’Ÿï¼Œå‘é€CRITICALå‘Šè­¦
            if waiting_time > 120:
                actions.append(AlertAction(
                    cli=cli,
                    priority='CRITICAL',
                    reason=f"é˜»å¡æ—¶é—´è¿‡é•¿({waiting_time:.0f}åˆ†é’Ÿ)ï¼Œéœ€è¦ç«‹å³ä»‹å…¥"
                ))

        return actions

    def _find_idle_cli(self, statuses, exclude=None):
        """æŸ¥æ‰¾ç©ºé—²CLI"""
        exclude = exclude or []
        for cli, status in statuses.items():
            if cli in exclude:
                continue
            if status['state'] == 'idle':
                return cli
        return None


class IdleResourceRule(CoordinationRule):
    """ç©ºé—²èµ„æºåˆ©ç”¨è§„åˆ™"""

    def __init__(self):
        super().__init__('IdleResourceUtilization', priority='MEDIUM')

    def evaluate(self, statuses):
        actions = []

        idle_clis = [cli for cli, status in statuses.items() if status['state'] == 'idle']

        if len(idle_clis) == 0:
            return actions

        # è§„åˆ™: å¦‚æœæœ‰ç‹¬ç«‹ä»»åŠ¡æ± ï¼Œåˆ†é…ç»™ç©ºé—²CLI
        task_pool = self._load_task_pool()

        for cli in idle_clis:
            if task_pool:
                task = task_pool.pop(0)
                actions.append(AssignTaskAction(
                    to_cli=cli,
                    task=task,
                    priority='MEDIUM',
                    reason=f"{cli}ç©ºé—²ï¼Œåˆ†é…ç‹¬ç«‹ä»»åŠ¡"
                ))

        return actions

    def _load_task_pool(self):
        """åŠ è½½ç‹¬ç«‹ä»»åŠ¡æ± """
        task_pool_file = Path("CLIS/SHARED/TASKS_POOL.md")

        if not task_pool_file.exists():
            return []

        # TODO: è§£æä»»åŠ¡æ± æ–‡ä»¶
        return []


class ConflictPreventionRule(CoordinationRule):
    """å†²çªé¢„é˜²è§„åˆ™"""

    def __init__(self):
        super().__init__('ConflictPrevention', priority='HIGH')

    def evaluate(self, statuses):
        actions = []

        # è§„åˆ™: å¦‚æœå¤šä¸ªCLIåŒæ—¶ä¿®æ”¹åŒä¸€æ–‡ä»¶ï¼Œå‘é€è­¦å‘Š
        # TODO: å®ç°æ–‡ä»¶å†²çªæ£€æµ‹é€»è¾‘

        return actions


class CoordinationAction:
    """åè°ƒåŠ¨ä½œåŸºç±»"""

    def __init__(self, priority, reason):
        self.priority = priority
        self.reason = reason

    def execute(self):
        """æ‰§è¡Œåè°ƒåŠ¨ä½œ"""
        raise NotImplementedError


class ReassignAction(CoordinationAction):
    """é‡æ–°åˆ†é…ä»»åŠ¡åŠ¨ä½œ"""

    def __init__(self, from_cli, to_cli, priority, reason):
        super().__init__(priority, reason)
        self.from_cli = from_cli
        self.to_cli = to_cli

    def execute(self):
        """æ‰§è¡Œä»»åŠ¡é‡æ–°åˆ†é…"""
        # å‘é€æ¶ˆæ¯ç»™ç›®æ ‡CLI
        message = self._create_coordination_message()
        self._send_message(self.to_cli, message)

        return f"âœ… åè°ƒ: {self.from_cli} â†’ {self.to_cli}"

    def _create_coordination_message(self):
        """åˆ›å»ºåè°ƒæ¶ˆæ¯"""
        return f"""---
**From**: CLI-main
**To**: CLI-{self.to_cli}
**Type**: REQUEST
**Priority**: {self.priority}
**Timestamp**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
**AutoGenerated**: true

**Subject**: åä½œè¯·æ±‚ï¼šååŠ©{self.from_cli}

**Description**:
{self.reason}

**Action Required**:
è¯·è¯„ä¼°æ˜¯å¦å¯ä»¥ååŠ©å®Œæˆä¾èµ–ä»»åŠ¡ï¼Œæˆ–æ‰§è¡Œå…¶ä»–ç‹¬ç«‹ä»»åŠ¡ã€‚

**Expected Response**: 15åˆ†é’Ÿå†…
"""

    def _send_message(self, to_cli, message):
        """å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šCLIçš„mailbox"""
        mailbox_dir = Path(f"CLIS/{to_cli}/mailbox")
        mailbox_dir.mkdir(parents=True, exist_ok=True)

        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
        message_file = mailbox_dir / f"main_{timestamp}.md"

        with open(message_file, 'w', encoding='utf-8') as f:
            f.write(message)


class AlertAction(CoordinationAction):
    """å‘Šè­¦åŠ¨ä½œ"""

    def __init__(self, cli, priority, reason):
        super().__init__(priority, reason)
        self.cli = cli

    def execute(self):
        """å‘é€å‘Šè­¦"""
        # TODO: å®ç°å‘Šè­¦å‘é€é€»è¾‘
        return f"ğŸš¨ å‘Šè­¦: {self.cli} - {self.reason}"


class AssignTaskAction(CoordinationAction):
    """åˆ†é…ä»»åŠ¡åŠ¨ä½œ"""

    def __init__(self, to_cli, task, priority, reason):
        super().__init__(priority, reason)
        self.to_cli = to_cli
        self.task = task

    def execute(self):
        """åˆ†é…ä»»åŠ¡ç»™æŒ‡å®šCLI"""
        # TODO: å®ç°ä»»åŠ¡åˆ†é…é€»è¾‘
        return f"ğŸ“‹ åˆ†é…: {self.to_cli} - {self.task}"


class SmartCoordinator:
    """æ™ºèƒ½åè°ƒå™¨ - è§„åˆ™å¼•æ“é©±åŠ¨"""

    def __init__(self, clis_dir="CLIS"):
        self.clis_dir = Path(clis_dir)
        self.cli_list = ['web', 'api', 'db']

        # åŠ è½½è§„åˆ™
        self.rules = [
            BlockageResolutionRule(),
            IdleResourceRule(),
            ConflictPreventionRule()
        ]

    def scan_all_status(self):
        """æ‰«ææ‰€æœ‰CLIçš„çŠ¶æ€"""
        statuses = {}

        for cli_name in self.cli_list:
            status = self._scan_cli_status(cli_name)
            if status:
                statuses[cli_name] = status

        return statuses

    def _scan_cli_status(self, cli_name):
        """æ‰«æå•ä¸ªCLIçš„çŠ¶æ€"""
        status_file = self.clis_dir / cli_name / "STATUS.md"

        if not status_file.exists():
            return None

        with open(status_file, 'r', encoding='utf-8') as f:
            content = f.read()

        return self._parse_status(content, cli_name)

    def _parse_status(self, content, cli_name):
        """è§£æSTATUS.mdå†…å®¹"""
        status = {
            'name': cli_name,
            'state': 'unknown',
            'current_task': None,
            'last_update': None,
            'blocked_on': None,
            'waiting_time': 0
        }

        # è§£æstate
        state_match = re.search(r'\*\*State\*\*:\s*([ğŸŸ¢ğŸŸ¡ğŸ”´âšªâŒ])\s*(\w+)', content)
        if state_match:
            status['state'] = state_match.group(2).lower()

        # è§£æcurrent_task
        task_match = re.search(r'\*\*Current Task\*\*:\s*(.+)', content)
        if task_match:
            status['current_task'] = task_match.group(1).strip()

        # è§£ælast_update
        update_match = re.search(r'\*\*Updated\*\*:\s*(.+)', content)
        if update_match:
            status['last_update'] = update_match.group(1).strip()

            # è®¡ç®—ç­‰å¾…æ—¶é—´
            try:
                last_update = datetime.strptime(status['last_update'], '%Y-%m-%d %H:%M:%S')
                waiting_time = (datetime.now() - last_update).total_seconds() / 60
                status['waiting_time'] = waiting_time
            except:
                pass

        # è§£æblocked_on
        blocked_match = re.search(r'\*\*Blocked On\*\*:\s*(.+)', content)
        if blocked_match:
            status['blocked_on'] = blocked_match.group(1).strip()

        return status

    def auto_coordinate(self):
        """è‡ªåŠ¨æ‰§è¡Œåè°ƒ"""
        # 1. æ‰«ææ‰€æœ‰çŠ¶æ€
        statuses = self.scan_all_status()

        # 2. è¯„ä¼°æ‰€æœ‰è§„åˆ™
        all_actions = []
        for rule in self.rules:
            actions = rule.evaluate(statuses)
            all_actions.extend(actions)

        # 3. æŒ‰ä¼˜å…ˆçº§æ’åº
        priority_order = {'CRITICAL': 0, 'HIGH': 1, 'MEDIUM': 2, 'LOW': 3}
        all_actions.sort(key=lambda a: priority_order.get(a.priority, 99))

        # 4. æ‰§è¡ŒåŠ¨ä½œ
        results = []
        for action in all_actions:
            try:
                result = action.execute()
                results.append(result)
            except Exception as e:
                results.append(f"âŒ æ‰§è¡Œå¤±è´¥: {e}")

        return {
            'statuses': statuses,
            'actions': all_actions,
            'results': results
        }


def main():
    """ä¸»å‡½æ•°"""
    import argparse

    parser = argparse.ArgumentParser(description='æ™ºèƒ½CLIåè°ƒå™¨')
    parser.add_argument('--auto-coordinate', action='store_true',
                       help='è‡ªåŠ¨æ‰§è¡Œåè°ƒè§„åˆ™')
    parser.add_argument('--scan', action='store_true',
                       help='ä»…æ‰«æçŠ¶æ€')
    parser.add_argument('--clis-dir', default='CLIS',
                       help='CLIç›®å½•è·¯å¾„')

    args = parser.parse_args()

    coordinator = SmartCoordinator(args.clis_dir)

    if args.auto_coordinate:
        result = coordinator.auto_coordinate()

        print(f"\n{'='*60}")
        print(f"ğŸ¤– æ™ºèƒ½åè°ƒæŠ¥å‘Š")
        print(f"{'='*60}")
        print(f"ğŸ“Š æ‰«æCLIæ•°: {len(result['statuses'])}")
        print(f"âš¡ è§¦å‘è§„åˆ™æ•°: {len(result['actions'])}")
        print(f"âœ… æ‰§è¡ŒåŠ¨ä½œæ•°: {len(result['results'])}")
        print(f"\næ‰§è¡Œç»“æœ:")
        for r in result['results']:
            print(f"  {r}")

    elif args.scan:
        statuses = coordinator.scan_all_status()
        print(f"âœ… æ‰«æå®Œæˆ: {len(statuses)} ä¸ªCLI")
        for cli, status in statuses.items():
            print(f"  {cli}: {status['state']} - {status.get('current_task', 'N/A')}")


if __name__ == '__main__':
    main()
```

#### ä½¿ç”¨æ–¹å¼

```bash
# æ‰‹åŠ¨æ‰§è¡Œåè°ƒ
python scripts/dev/smart_coordinator.py --auto-coordinate

# å®šæ—¶æ‰§è¡Œ(æ¯5åˆ†é’Ÿ)
*/5 * * * * cd /opt/claude/mystocks_spec && python scripts/dev/smart_coordinator.py --auto-coordinate >> CLIS/main/coordinator.log 2>&1
```

#### åè°ƒè§„åˆ™ç¤ºä¾‹

**åœºæ™¯1: è‡ªåŠ¨ååŠ©**
```
æ—¶é—´: 2025-01-01 15:30
CLI-dbè¢«CLI-apié˜»å¡90åˆ†é’Ÿ

è‡ªåŠ¨æ‰§è¡Œ:
1. SmartCoordinatoræ£€æµ‹åˆ°é˜»å¡(90åˆ†é’Ÿ > 60åˆ†é’Ÿé˜ˆå€¼)
2. æŸ¥æ‰¾ç©ºé—²CLI: CLI-it-worker1
3. è‡ªåŠ¨å‘é€åè°ƒæ¶ˆæ¯åˆ°CLI-it-worker1çš„mailbox
4. CLI-it-worker1æ¥æ”¶å¹¶ååŠ©CLI-apiå®Œæˆä»»åŠ¡
5. é˜»å¡è§£é™¤,CLI-dbå¯ä»¥å¼€å§‹å·¥ä½œ

mainå‚ä¸: ä»…ç¡®è®¤ç»“æœ(30ç§’)
```

**åœºæ™¯2: ç©ºé—²èµ„æºåˆ©ç”¨**
```
æ—¶é—´: 2025-01-01 16:00
CLI-webå·²å®Œæˆæ‰€æœ‰ä»»åŠ¡ï¼ŒçŠ¶æ€ä¸ºidle

è‡ªåŠ¨æ‰§è¡Œ:
1. SmartCoordinatoræ£€æµ‹åˆ°ç©ºé—²CLI
2. æŸ¥è¯¢ç‹¬ç«‹ä»»åŠ¡æ± 
3. è‡ªåŠ¨åˆ†é…ä»»åŠ¡ç»™CLI-web
4. å‘é€é€šçŸ¥åˆ°CLI-webçš„mailbox

mainå‚ä¸: é›¶å‚ä¸(å…¨è‡ªåŠ¨)
```

---

### ä¼˜åŒ–å»ºè®®5: ç®€åŒ–æ–‡ä»¶é”æœºåˆ¶ â­â­â­

**é—®é¢˜è¯†åˆ«**: åŸè®¾è®¡çš„file_lock_manager.py(256è¡Œ)è¿‡åº¦è®¾è®¡ï¼Œå¼•å…¥JSONé”æ–‡ä»¶ã€è¶…æ—¶ç®¡ç†ç­‰å¤æ‚é€»è¾‘

**ä¼˜åŒ–æ–¹æ¡ˆ**: ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„flockæœºåˆ¶

```python
# scripts/dev/simple_lock.py
"""
ç®€åŒ–ç‰ˆæ–‡ä»¶é”ç®¡ç†å™¨ - ä½¿ç”¨Linux flock
ä»256è¡Œä»£ç å‡å°‘åˆ°30è¡Œï¼Œæ›´å¯é ã€æ›´ç®€å•
"""

import fcntl
import time
from pathlib import Path


class SimpleFileLock:
    """ç®€åŒ–ç‰ˆæ–‡ä»¶é”"""

    def __init__(self, cli_name, file_path, timeout=3600):
        """
        Args:
            cli_name: CLIåç§°
            file_path: è¦é”å®šçš„æ–‡ä»¶è·¯å¾„
            timeout: é”å®šè¶…æ—¶æ—¶é—´(ç§’)
        """
        self.cli_name = cli_name
        self.file_path = file_path
        self.timeout = timeout
        self.lock_file = None
        self.lock_dir = Path("CLIS/locks")
        self.lock_dir.mkdir(parents=True, exist_ok=True)

        # ç”Ÿæˆé”æ–‡ä»¶å
        lock_filename = f"{file_path.replace('/', '_')}.lock"
        self.lock_path = self.lock_dir / lock_filename

    def acquire(self):
        """è·å–æ–‡ä»¶é”"""
        try:
            # æ‰“å¼€é”æ–‡ä»¶
            self.lock_file = open(self.lock_path, 'w')

            # å°è¯•è·å–ç‹¬å é”(éé˜»å¡æ¨¡å¼)
            fcntl.flock(self.lock_file.fileno(), fcntl.LOCK_EX | fcntl.LOCK_NB)

            # å†™å…¥é”ä¿¡æ¯
            self.lock_file.write(f"{self.cli_name}\n{time.time()}\n")
            self.lock_file.flush()

            return True, "Lock acquired"

        except IOError:
            self.lock_file = None
            return False, f"File already locked: {self.file_path}"

    def release(self):
        """é‡Šæ”¾æ–‡ä»¶é”"""
        if self.lock_file:
            try:
                # é‡Šæ”¾é”
                fcntl.flock(self.lock_file.fileno(), fcntl.LOCK_UN)
                self.lock_file.close()

                # åˆ é™¤é”æ–‡ä»¶
                self.lock_path.unlink(missing_ok=True)

                return True, "Lock released"

            except Exception as e:
                return False, f"Failed to release lock: {e}"

        return True, "No lock to release"

    def __enter__(self):
        """æ”¯æŒwithè¯­å¥"""
        acquired, msg = self.acquire()
        if not acquired:
            raise Exception(msg)
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        """æ”¯æŒwithè¯­å¥"""
        self.release()


# ä½¿ç”¨ç¤ºä¾‹
if __name__ == '__main__':
    # ç¤ºä¾‹1: æ‰‹åŠ¨åŠ é”
    lock = SimpleFileLock('web', 'web/frontend/src/api/dashboard.ts')
    acquired, msg = lock.acquire()

    if acquired:
        try:
            # ä¿®æ”¹æ–‡ä»¶
            print("æ­£åœ¨ä¿®æ”¹æ–‡ä»¶...")
            time.sleep(10)  # æ¨¡æ‹Ÿå·¥ä½œ
        finally:
            lock.release()
    else:
        print(f"åŠ é”å¤±è´¥: {msg}")

    # ç¤ºä¾‹2: ä½¿ç”¨withè¯­å¥(æ¨è)
    try:
        with SimpleFileLock('api', 'web/backend/app/api/dashboard.py'):
            print("æ­£åœ¨ä¿®æ”¹æ–‡ä»¶...")
            time.sleep(10)
    except Exception as e:
        print(f"åŠ é”å¤±è´¥: {e}")
```

#### ä½¿ç”¨æ–¹å¼

```bash
# Pythonè„šæœ¬ä¸­ä½¿ç”¨
python -c "
from scripts.dev.simple_lock import SimpleFileLock
lock = SimpleFileLock('web', 'web/frontend/src/api/dashboard.ts')
if lock.acquire()[0]:
    try:
        # ä¿®æ”¹æ–‡ä»¶
        pass
    finally:
        lock.release()
"

# æˆ–ä½¿ç”¨withè¯­å¥
python -c "
from scripts.dev.simple_lock import SimpleFileLock
with SimpleFileLock('web', 'web/frontend/src/api/dashboard.ts'):
    # ä¿®æ”¹æ–‡ä»¶
    pass
"
```

#### ä¼˜åŠ¿å¯¹æ¯”

| ç»´åº¦ | åŸè®¾è®¡(JSONé”) | ä¼˜åŒ–å(flock) |
|------|----------------|---------------|
| **ä»£ç é‡** | 256è¡Œ | **30è¡Œ** (â¬‡ï¸ 88%) |
| **å¯é æ€§** | ä¸­(è¿›ç¨‹å´©æºƒå¯èƒ½é—ç•™) | **é«˜(OSè‡ªåŠ¨é‡Šæ”¾)** |
| **æ€§èƒ½** | ä¸­(æ–‡ä»¶è¯»å†™) | **é«˜(å†…æ ¸é”)** |
| **è·¨å¹³å°** | æ˜¯ | **Linux/Mac** |
| **åŸå­æ€§** | å¦ | **æ˜¯** |

**å…³é”®æ”¹è¿›**: ä»£ç é‡å‡å°‘88%ï¼Œå¯é æ€§æå‡ï¼Œæ€§èƒ½æ›´å¥½

---

### ä¼˜åŒ–å»ºè®®6: ä¸€é”®å¯åŠ¨è„šæœ¬ â­â­â­â­â­

**æ–°å¢å·¥å…·**: å¿«é€Ÿåˆå§‹åŒ–å’Œå¯åŠ¨å¤šCLIç¯å¢ƒ

```bash
#!/bin/bash
# scripts/dev/init_multi_cli.sh
# ä¸€é”®åˆå§‹åŒ–å¤šCLIåä½œç¯å¢ƒ

set -e

echo "ğŸš€ åˆå§‹åŒ–å¤šCLIåä½œç¯å¢ƒ..."
echo "======================================"

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Step 1: åˆ›å»ºç›®å½•ç»“æ„
echo -e "${YELLOW}ğŸ“ Step 1/6: åˆ›å»ºç›®å½•ç»“æ„...${NC}"
mkdir -p CLIS/{main,web,api,db,it}/{mailbox,outgoing}
mkdir -p CLIS/it/{worker1,worker2,worker3}
mkdir -p CLIS/{locks,SHARED}
echo -e "${GREEN}âœ… ç›®å½•ç»“æ„åˆ›å»ºå®Œæˆ${NC}"

# Step 2: å¤åˆ¶æ¨¡æ¿æ–‡ä»¶
echo -e "${YELLOW}ğŸ“„ Step 2/6: ç”Ÿæˆæ¨¡æ¿æ–‡ä»¶...${NC}"

# æ£€æŸ¥æ¨¡æ¿æ˜¯å¦å­˜åœ¨
if [ ! -d "templates/cli" ]; then
    echo -e "${RED}âŒ æ¨¡æ¿ç›®å½•ä¸å­˜åœ¨: templates/cli${NC}"
    echo "æ­£åœ¨åˆ›å»ºé»˜è®¤æ¨¡æ¿..."

    # åˆ›å»ºé»˜è®¤æ¨¡æ¿
    mkdir -p templates/cli

    # TASK.mdæ¨¡æ¿
    cat > templates/cli/TASK.md.template << 'EOF'
# TASK.md - ä»»åŠ¡æ¸…å•

## ä»»åŠ¡æ¦‚è§ˆ

| ä»»åŠ¡ID | ä»»åŠ¡åç§° | ä¾èµ–ä»»åŠ¡ | çŠ¶æ€ | ä¼˜å…ˆçº§ | é¢„è®¡æ—¶é—´ |
|--------|---------|---------|------|--------|----------|
| 1.1 | ç¤ºä¾‹ä»»åŠ¡ | æ—  | â¸ï¸ ç­‰å¾…ä¸­ | P1 | 1å°æ—¶ |

## å½“å‰ä»»åŠ¡

### ä»»åŠ¡1.1: ç¤ºä¾‹ä»»åŠ¡

**æè¿°**: è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»»åŠ¡

**ä¾èµ–**: æ— 

**çŠ¶æ€**: â¸ï¸ ç­‰å¾…ä¸­

**æ­¥éª¤**:
- [ ] æ­¥éª¤1
- [ ] æ­¥éª¤2
- [ ] æ­¥éª¤3

**é¢„è®¡å®Œæˆæ—¶é—´**: 1å°æ—¶
EOF

    # RULES.mdæ¨¡æ¿
    cat > templates/cli/RULES.md.template << 'EOF'
# RULES.md - å·¥ä½œè§„èŒƒ

## å·¥ä½œèŒè´£

### æ ¸å¿ƒèŒè´£
1. å®Œæˆåˆ†é…çš„ä»»åŠ¡
2. åŠæ—¶æ›´æ–°STATUS.md
3. é‡åˆ°é—®é¢˜åŠæ—¶æŠ¥å‘Š

## å·¥ä½œæµç¨‹

### ä»»åŠ¡æ‰§è¡Œ
1. æ¥æ”¶ä»»åŠ¡
2. åˆ†æéœ€æ±‚
3. æ‰§è¡Œä»»åŠ¡
4. æ›´æ–°çŠ¶æ€
5. æäº¤æŠ¥å‘Š

## æ²Ÿé€šè§„èŒƒ

### å“åº”æ—¶é—´
- **ALERT**: 5åˆ†é’Ÿå†…å“åº”
- **REQUEST**: 15åˆ†é’Ÿå†…å“åº”
- **NOTIFICATION**: 30åˆ†é’Ÿå†…å“åº”
EOF

    # STATUS.mdæ¨¡æ¿
    cat > templates/cli/STATUS.md.template << 'EOF'
# STATUS.md - å½“å‰çŠ¶æ€

**CLI**: CLI-{CLI_NAME}
**Updated**: {DATETIME}
**State**: âšª Idle

## Current State

**State**: âšª Idle
**Current Task**: æ— 
**Progress**: 0%

## Blocked On

æ— 

## Issues

æ— å·²çŸ¥é—®é¢˜

## Recent Activity

| æ—¶é—´ | æ´»åŠ¨ | ç»“æœ |
|------|------|------|
| - | - | - |

## Next Steps

1. ç­‰å¾…ä»»åŠ¡åˆ†é…
EOF

    echo -e "${GREEN}âœ… é»˜è®¤æ¨¡æ¿å·²åˆ›å»º${NC}"
fi

# å¤åˆ¶æ¨¡æ¿åˆ°å„CLIç›®å½•
for cli in main web api db it/worker1 it/worker2 it/worker3; do
    mkdir -p "CLIS/$cli"

    # å¤åˆ¶å¹¶æ›¿æ¢æ¨¡æ¿ä¸­çš„å˜é‡
    sed "s/{CLI_NAME}/$(basename $cli)/g" templates/cli/TASK.md.template > "CLIS/$cli/TASK.md"
    sed "s/{CLI_NAME}/$(basename $cli)/g" templates/cli/RULES.md.template > "CLIS/$cli/RULES.md"
    sed "s/{CLI_NAME}/$(basename $cli)/g; s/{DATETIME}/$(date '+%Y-%m-%d %H:%M:%S')/g" \
        templates/cli/STATUS.md.template > "CLIS/$cli/STATUS.md"
done

echo -e "${GREEN}âœ… æ¨¡æ¿æ–‡ä»¶ç”Ÿæˆå®Œæˆ${NC}"

# Step 3: ç”Ÿæˆåˆå§‹ä»»åŠ¡é…ç½®
echo -e "${YELLOW}âš™ï¸  Step 3/6: ç”Ÿæˆåˆå§‹ä»»åŠ¡é…ç½®...${NC}"
python scripts/dev/generate_initial_tasks.py > CLIS/main/TASK.md 2>/dev/null || echo "# Main Tasks\n\næš‚æ— ä»»åŠ¡" > CLIS/main/TASK.md
echo -e "${GREEN}âœ… ä»»åŠ¡é…ç½®ç”Ÿæˆå®Œæˆ${NC}"

# Step 4: æ£€æŸ¥ä¾èµ–
echo -e "${YELLOW}ğŸ” Step 4/6: æ£€æŸ¥ä¾èµ–...${NC}"

# æ£€æŸ¥Pythonä¾èµ–
python -c "import watchdog" 2>/dev/null && \
    echo -e "${GREEN}âœ… watchdogå·²å®‰è£…${NC}" || \
    echo -e "${YELLOW}âš ï¸  watchdogæœªå®‰è£…ï¼Œmailboxç›‘å¬å™¨å¯èƒ½æ— æ³•è¿è¡Œ${NC}"

# Step 5: å¯åŠ¨åè°ƒå™¨(å¯é€‰)
echo -e "${YELLOW}ğŸ¤– Step 5/6: å¯åŠ¨CLIåè°ƒå™¨...${NC}"

read -p "æ˜¯å¦å¯åŠ¨CLIåè°ƒå™¨? (y/n) " -n 1 -r
echo
if [[ $REPLY =~ ^[Yy]$ ]]; then
    nohup python scripts/dev/cli_coordinator.py --daemon > CLIS/main/coordinator.log 2>&1 &
    echo -e "${GREEN}âœ… CLIåè°ƒå™¨å·²å¯åŠ¨(åå°)${NC}"
    echo "æŸ¥çœ‹æ—¥å¿—: tail -f CLIS/main/coordinator.log"
else
    echo -e "${YELLOW}â¸ï¸  è·³è¿‡å¯åŠ¨åè°ƒå™¨${NC}"
fi

# Step 6: æ˜¾ç¤ºä¸‹ä¸€æ­¥æ“ä½œ
echo -e "${YELLOW}ğŸ“‹ Step 6/6: åˆå§‹åŒ–å®Œæˆ${NC}"
echo ""
echo -e "${GREEN}======================================"
echo "âœ… å¤šCLIåä½œç¯å¢ƒåˆå§‹åŒ–å®Œæˆ!"
echo "======================================${NC}"
echo ""
echo "ğŸ“Š å¸¸ç”¨å‘½ä»¤:"
echo "  æŸ¥çœ‹çŠ¶æ€: python scripts/dev/smart_coordinator.py --scan"
echo "  æ‰§è¡Œåè°ƒ: python scripts/dev/smart_coordinator.py --auto-coordinate"
echo "  æŸ¥çœ‹æ¶ˆæ¯: ls CLIS/*/mailbox/"
echo ""
echo "ğŸ“¬ å¯åŠ¨mailboxç›‘å¬å™¨(å¯é€‰):"
echo "  python scripts/dev/mailbox_watcher.py --cli=web --daemon"
echo "  python scripts/dev/mailbox_watcher.py --cli=api --daemon"
echo "  python scripts/dev/mailbox_watcher.py --cli=db --daemon"
echo ""
echo "ğŸ“š æ›´å¤šä¿¡æ¯: docs/guides/MULTI_CLI_COLLABORATION_METHOD.md"
```

#### ä½¿ç”¨æ–¹å¼

```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x scripts/dev/init_multi_cli.sh

# ä¸€é”®åˆå§‹åŒ–
bash scripts/dev/init_multi_cli.sh

# è¾“å‡º:
# ğŸš€ åˆå§‹åŒ–å¤šCLIåä½œç¯å¢ƒ...
# âœ… ç›®å½•ç»“æ„åˆ›å»ºå®Œæˆ
# âœ… æ¨¡æ¿æ–‡ä»¶ç”Ÿæˆå®Œæˆ
# âœ… ä»»åŠ¡é…ç½®ç”Ÿæˆå®Œæˆ
# âœ… å¤šCLIåä½œç¯å¢ƒåˆå§‹åŒ–å®Œæˆ!
```

---

## ğŸ“… å®æ–½è·¯çº¿å›¾

### Week 1: æœ€å°å¯ç”¨ç³»ç»Ÿ(MVP) - 1-2å¤©

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | è€—æ—¶ | è´Ÿè´£äºº | ä»·å€¼ |
|--------|------|------|--------|------|
| P0 | åˆ›å»ºç›®å½•ç»“æ„ + æ¨¡æ¿æ–‡ä»¶ | 1å°æ—¶ | CLI-main | â­â­â­â­â­ |
| P0 | å®ç°mailboxäº‹ä»¶ç›‘å¬å™¨ | 2å°æ—¶ | CLI-it | â­â­â­â­â­ |
| P0 | å®ç°STATUS.mdè‡ªåŠ¨ç”Ÿæˆ | 1å°æ—¶ | CLI-it | â­â­â­â­â­ |
| P0 | å®ç°SmartCoordinator(3æ¡è§„åˆ™) | 3å°æ—¶ | CLI-it | â­â­â­â­â­ |
| P1 | ç¼–å†™ä¸€é”®å¯åŠ¨è„šæœ¬ | 1å°æ—¶ | CLI-main | â­â­â­â­ |
| P1 | 2ä¸ªCLIåŸºæœ¬åä½œæµ‹è¯• | 2å°æ—¶ | CLI-main | â­â­â­â­ |

**Week 1ç›®æ ‡**: 2ä¸ªCLI(web + api)èƒ½åŸºæœ¬åä½œ

### Week 2-3: åŠŸèƒ½å®Œå–„ - 2-3å¤©

| ä»»åŠ¡ | è€—æ—¶ | ä»·å€¼ |
|------|------|------|
| ç®€åŒ–ç‰ˆæ–‡ä»¶é”(flock) | 1å°æ—¶ | â­â­â­ |
| æ£€æŸ¥ç‚¹ç®¡ç†(Git tagé›†æˆ) | 2å°æ—¶ | â­â­â­ |
| ä»»åŠ¡è‡ªåŠ¨åˆ†é…å™¨ | 2å°æ—¶ | â­â­â­ |
| é‚®ç®±ç®¡ç†å™¨(æ¶ˆæ¯æ¸…ç†) | 1å°æ—¶ | â­â­ |
| æ€§èƒ½æŒ‡æ ‡æ”¶é›† | 2å°æ—¶ | â­â­ |

### Week 4+: é«˜çº§ä¼˜åŒ–(æŒ‰éœ€)

- å¯è§†åŒ–Dashboard
- æœºå™¨å­¦ä¹ é¢„æµ‹é˜»å¡
- Web UIç®¡ç†ç•Œé¢
- ...

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨æŒ‡å—

### 5åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨

```bash
# Step 1: ä¸€é”®åˆå§‹åŒ–(30ç§’)
bash scripts/dev/init_multi_cli.sh

# Step 2: éªŒè¯ç›®å½•ç»“æ„(10ç§’)
ls -la CLIS/{main,web,api,db,it}

# Step 3: å¯åŠ¨åè°ƒå™¨(10ç§’)
python scripts/dev/smart_coordinator.py --auto-coordinate

# Step 4: æµ‹è¯•é€šä¿¡(2åˆ†é’Ÿ)
# CLI-webå‘é€æ¶ˆæ¯ç»™CLI-api
cat > CLIS/api/mailbox/web_test.md << 'EOF'
---
**From**: CLI-web
**To**: CLI-api
**Type**: REQUEST
**Priority**: MEDIUM
**Timestamp**: 2025-01-01 10:00:00

**Subject**: æµ‹è¯•é€šä¿¡

**Description**:
è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯ï¼ŒéªŒè¯mailboxé€šä¿¡æœºåˆ¶ã€‚
EOF

# Step 5: æŸ¥çœ‹å“åº”(1åˆ†é’Ÿ)
ls CLIS/web/mailbox/

# âœ… å®Œæˆ! å¤šCLIåä½œç¯å¢ƒå·²å°±ç»ª
```

---

## ğŸ“Š æ€»ç»“ä¸å¯¹æ¯”

### æ ¸å¿ƒä¼˜åŒ–æˆæœ

| ç»´åº¦ | åŸè®¾è®¡ | ä¼˜åŒ–å | æ”¹è¿› |
|------|--------|--------|------|
| **å®æ–½æ—¶é—´** | 5-7å¤© | 1-2å¤© | â¬‡ï¸ **70%** |
| **å·¥å…·è„šæœ¬** | 6ä¸ª(2000+è¡Œ) | 2-3ä¸ª(500è¡Œ) | â¬‡ï¸ **75%** |
| **mainå·¥ä½œé‡** | 30åˆ†é’Ÿ/å°æ—¶ | 5åˆ†é’Ÿ/å°æ—¶ | â¬‡ï¸ **83%** |
| **CLIå“åº”æ—¶é—´** | 1-2åˆ†é’Ÿ | 5-10ç§’ | â¬‡ï¸ **90%** |
| **æ–‡ä»¶é”ä»£ç ** | 256è¡Œ | 30è¡Œ | â¬‡ï¸ **88%** |
| **è‡ªåŠ¨åŒ–ç¨‹åº¦** | 60% | 85% | â¬†ï¸ **42%** |

### å…³é”®æ”¹è¿›ç‚¹

1. âœ… **æ¸è¿›å¼å®æ–½** - ä»MVPå¼€å§‹ï¼Œé™ä½é£é™©ï¼Œå¿«é€Ÿè§æ•ˆ
2. âœ… **äº‹ä»¶é©±åŠ¨mailbox** - å“åº”æ—¶é—´ä»2åˆ†é’Ÿé™ä½åˆ°< 1ç§’
3. âœ… **è‡ªåŠ¨åŒ–STATUS.md** - Gitæ´»åŠ¨è‡ªåŠ¨åˆ†æï¼Œæ— éœ€æ‰‹åŠ¨æ›´æ–°
4. âœ… **æ™ºèƒ½åè°ƒè§„åˆ™å¼•æ“** - mainå·¥ä½œé‡å‡å°‘83%
5. âœ… **ç®€åŒ–æ–‡ä»¶é”** - ä½¿ç”¨OS flockï¼Œä»£ç å‡å°‘88%
6. âœ… **ä¸€é”®å¯åŠ¨è„šæœ¬** - 5åˆ†é’Ÿå®Œæˆç¯å¢ƒæ­å»º

### ä¿æŒçš„æ ¸å¿ƒä»·å€¼

ä»¥ä¸‹è®¾è®¡å…ƒç´ **å®Œå…¨ä¿ç•™**ï¼š

1. âœ… **mailboxå¼‚æ­¥é€šä¿¡** - CLIé—´ç›´æ¥é€šä¿¡çš„åŸºç¡€
2. âœ… **STATUS.mdçŠ¶æ€å…±äº«** - ç®€å•æœ‰æ•ˆçš„çŠ¶æ€åŒæ­¥
3. âœ… **æ–‡ä»¶é”æœºåˆ¶** - é¿å…æ–‡ä»¶å†²çªçš„å…³é”®
4. âœ… **æ£€æŸ¥ç‚¹æœºåˆ¶** - æ”¯æŒå¿«é€Ÿå›æ»šçš„é£é™©æ§åˆ¶
5. âœ… **CLIè§’è‰²å®šä¹‰** - main/web/api/db/itèŒè´£åˆ†ç¦»

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

#### ç«‹å³å¯æ‰§è¡Œ(ä»Šå¤©)

1. **åˆ›å»ºç›®å½•ç»“æ„**
   ```bash
   mkdir -p CLIS/{main,web,api,db,it}/{mailbox,outgoing}
   mkdir -p CLIS/it/{worker1,worker2,worker3}
   mkdir -p CLIS/{locks,SHARED}
   ```

2. **å®ç°mailboxç›‘å¬å™¨**(æœ€ä¼˜å…ˆ)
   - å¤åˆ¶ä¸Šè¿°ä»£ç åˆ° `scripts/dev/mailbox_watcher.py`
   - å®‰è£…ä¾èµ–: `pip install watchdog`
   - æµ‹è¯•: `python scripts/dev/mailbox_watcher.py --cli=web`

3. **å®ç°SmartCoordinator**
   - å¤åˆ¶ä¸Šè¿°ä»£ç åˆ° `scripts/dev/smart_coordinator.py`
   - æµ‹è¯•: `python scripts/dev/smart_coordinator.py --scan`

#### æœ¬å‘¨å®Œæˆ

1. STATUS.mdè‡ªåŠ¨ç”Ÿæˆå™¨
2. ç®€åŒ–ç‰ˆæ–‡ä»¶é”
3. ä¸€é”®å¯åŠ¨è„šæœ¬

#### æŒç»­ä¼˜åŒ–

- æ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´è§„åˆ™
- å¢åŠ æ›´å¤šè‡ªåŠ¨åŒ–è§„åˆ™
- æ”¶é›†æ€§èƒ½æŒ‡æ ‡

---

## ğŸ¤ éœ€è¦å†³ç­–çš„é—®é¢˜

### é—®é¢˜1: æ¸è¿›å¼å®æ–½è·¯å¾„

**é€‰é¡¹A**: æŒ‰ç…§æœ¬æ–‡æ¡£çš„MVPè·¯å¾„å®æ–½(æ¨è)
- âœ… å¿«é€Ÿè§æ•ˆ(1-2å¤©)
- âœ… é™ä½é£é™©
- âš ï¸ åç»­éœ€è¦è¿­ä»£

**é€‰é¡¹B**: ä¸€æ¬¡æ€§å®æ–½å®Œæ•´æ–¹æ¡ˆ
- âš ï¸ è€—æ—¶è¾ƒé•¿(5-7å¤©)
- âš ï¸ é£é™©è¾ƒé«˜
- âœ… ä¸€æ­¥åˆ°ä½

**å»ºè®®**: é€‰æ‹©Aï¼Œä»MVPå¼€å§‹

### é—®é¢˜2: mailboxç›‘å¬å™¨å®ç°

**é€‰é¡¹A**: ä½¿ç”¨watchdogåº“(æ¨è)
- âœ… äº‹ä»¶é©±åŠ¨ï¼Œå®æ—¶å“åº”
- âœ… CPUæ¶ˆè€—ä½
- âš ï¸ éœ€è¦å®‰è£…ä¾èµ–

**é€‰é¡¹B**: ä¿æŒè½®è¯¢æœºåˆ¶
- âœ… æ— éœ€é¢å¤–ä¾èµ–
- âš ï¸ CPUæ¶ˆè€—é«˜
- âš ï¸ å“åº”æ…¢

**å»ºè®®**: é€‰æ‹©Aï¼Œå®‰è£…watchdog(`pip install watchdog`)

### é—®é¢˜3: STATUS.mdæ›´æ–°æœºåˆ¶

**é€‰é¡¹A**: Gitæ´»åŠ¨è‡ªåŠ¨åˆ†æ(æ¨è)
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–
- âœ… æ•°æ®å‡†ç¡®(åŸºäºå®é™…æ´»åŠ¨)
- âš ï¸ éœ€è¦Gitæ“ä½œ

**é€‰é¡¹B**: æ‰‹åŠ¨æ›´æ–°
- âœ… çµæ´»æ§åˆ¶
- âš ï¸ å®¹æ˜“å¿˜è®°
- âš ï¸ æ•°æ®ä¸å‡†ç¡®

**å»ºè®®**: é€‰æ‹©Aï¼Œè®¾ç½®å®šæ—¶ä»»åŠ¡æ¯5åˆ†é’Ÿæ›´æ–°

### é—®é¢˜4: åè°ƒè§„åˆ™å¤æ‚åº¦

**é€‰é¡¹A**: ä»3æ¡æ ¸å¿ƒè§„åˆ™å¼€å§‹(æ¨è)
- âœ… å¿«é€Ÿå®æ–½
- âœ… è¦†ç›–80%åœºæ™¯
- âš ï¸ åç»­éœ€è¦æ‰©å±•

**é€‰é¡¹B**: å®ç°å®Œæ•´è§„åˆ™é›†
- âš ï¸ è€—æ—¶è¾ƒé•¿
- âš ï¸ è¿‡åº¦è®¾è®¡é£é™©
- âœ… è¦†ç›–æ‰€æœ‰åœºæ™¯

**å»ºè®®**: é€‰æ‹©Aï¼Œä»3æ¡æ ¸å¿ƒè§„åˆ™å¼€å§‹
1. BlockageResolutionRule (é˜»å¡è‡ªåŠ¨è§£å†³)
2. IdleResourceRule (ç©ºé—²èµ„æºåˆ©ç”¨)
3. ConflictPreventionRule (å†²çªé¢„é˜²)

---

## ğŸ“ åé¦ˆä¸æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼åé¦ˆï¼š

- **é¡¹ç›®Issue**: [GitHub Issues](https://github.com/your-repo/issues)
- **æ–‡æ¡£è®¨è®º**: åœ¨é¡¹ç›®Wikiä¸­è®¨è®º
- **ä»£ç å®¡æŸ¥**: æäº¤PRå®¡æŸ¥

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-01-01
**ä½œè€…**: Claude Code (AI Assistant)
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸
**ä¸‹æ¬¡æ›´æ–°**: æ ¹æ®å®é™…å®æ–½æƒ…å†µ

---

## é™„å½•

### A. ç›¸å…³æ–‡æ¡£

- `docs/guides/MULTI_CLI_COLLABORATION_METHOD.md` - å®Œæ•´è®¾è®¡æ–¹æ¡ˆ(1944è¡Œ)
- `docs/guides/MULTI_CLI_WORKTREE_MANAGEMENT.md` - Git Worktreeåä½œæ‰‹å†Œ
- `CLAUDE.md` - é¡¹ç›®å¼€å‘æŒ‡å—

### B. å·¥å…·æ¸…å•

| å·¥å…· | æ–‡ä»¶ | è€—æ—¶ | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| Mailboxç›‘å¬å™¨ | `scripts/dev/mailbox_watcher.py` | 2h | P0 |
| STATUSè‡ªåŠ¨ç”Ÿæˆ | `scripts/dev/auto_status_snapshot.py` | 1h | P0 |
| æ™ºèƒ½åè°ƒå™¨ | `scripts/dev/smart_coordinator.py` | 3h | P0 |
| ç®€åŒ–æ–‡ä»¶é” | `scripts/dev/simple_lock.py` | 1h | P1 |
| ä¸€é”®å¯åŠ¨ | `scripts/dev/init_multi_cli.sh` | 1h | P1 |

### C. ä»£ç ç»Ÿè®¡

| ç±»åˆ« | åŸè®¾è®¡ | ä¼˜åŒ–å | å‡å°‘ |
|------|--------|--------|------|
| å·¥å…·è„šæœ¬æ•° | 6ä¸ª | 3ä¸ª | 50% |
| æ€»ä»£ç è¡Œæ•° | 2000+ | 500 | 75% |
| é…ç½®æ–‡ä»¶æ•° | 10+ | 4 | 60% |
| ä¾èµ–åº“æ•° | 5 | 2 | 60% |

### D. æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | åŸè®¾è®¡ | ä¼˜åŒ–å | æ”¹è¿› |
|------|--------|--------|------|
| CLIå“åº”æ—¶é—´ | 30-120ç§’ | 1-10ç§’ | 90% |
| CPUä½¿ç”¨ç‡(æ‰«æ) | 5-10% | < 1% | 90% |
| å†…å­˜å ç”¨ | 50MB | 20MB | 60% |
| ç£ç›˜IO | é¢‘ç¹æ‰«æ | äº‹ä»¶è§¦å‘ | 80% |

---

**âœ¨ æœŸå¾…æ‚¨çš„åé¦ˆå’Œè´¡çŒ®!**
