# Python ä»£ç è´¨é‡ä¿è¯å·¥ä½œæµç¨‹

**ä¼˜åŒ–ç­–ç•¥**: Ruff ä¼˜å…ˆ + Black å…œåº• + Pylint æ·±åº¦å®¡æŸ¥

**ç»Ÿä¸€è¡Œé•¿åº¦**: 120 (Black/Ruff/Pylint ä¿æŒä¸€è‡´)

---

## ğŸ“Š å››é˜¶æ®µè´¨é‡ä¿è¯æµç¨‹

### é˜¶æ®µ 1: æ—¥å¸¸å¼€å‘ (æ•ˆç‡ä¼˜å…ˆ)

**ç›®æ ‡**: å¿«é€Ÿä¿®å¤ä»£ç é—®é¢˜ï¼Œä¸å½±å“å¼€å‘æ•ˆç‡

**å·¥å…·**: Ruff (ä¸€ç«™å¼æ ¼å¼åŒ– + Lint)

**è§¦å‘æ—¶æœº**: æ¯æ¬¡ä¿å­˜æ–‡ä»¶å

**ä½¿ç”¨æ–¹æ³•**:
```bash
# ä¸€é”®ä¿®å¤æ‰€æœ‰é—®é¢˜ï¼ˆæ ¼å¼åŒ– + Lintï¼‰
ruff check --fix .

# ä»…æ ¼å¼åŒ–
ruff format .

# ä»…æ£€æŸ¥ï¼ˆä¸ä¿®å¤ï¼‰
ruff check .
```

**é…ç½®ç‰¹ç‚¹**:
- âœ… **æµ‹è¯•ä¸“å±è§„åˆ™**: å¯ç”¨ PT (pytest ä¸“å±) è§„åˆ™
- âœ… **å¿«é€Ÿå¤±è´¥**: ä»…æ£€æŸ¥å½±å“æµ‹è¯•æ‰§è¡Œçš„é”™è¯¯
- âœ… **è‡ªåŠ¨ä¿®å¤**: å¤§éƒ¨åˆ†é—®é¢˜å¯è‡ªåŠ¨ä¿®å¤
- âœ… **ç»Ÿä¸€è¡Œé•¿åº¦**: 120 å­—ç¬¦

**Ruff è§„åˆ™é€‰æ‹©**:
- `E, W`: åŸºç¡€è¯­æ³•é”™è¯¯å’Œè­¦å‘Š
- `F`: Pyflakes ä»£ç é”™è¯¯æ£€æµ‹
- `IND`: ç¼©è¿›é”™è¯¯æ£€æŸ¥
- `PT`: pytest ä¸“å±è§„åˆ™
- `I`: å¯¼å…¥æ’åº

**æ’é™¤è§„åˆ™**:
- `E501`: è¡Œé•¿åº¦ï¼ˆç”± Black å¤„ç†ï¼‰
- `PT011, PT012, PT015`: æµ‹è¯•ä»£ç ä¸­çš„åˆç†ä¾‹å¤–

---

### é˜¶æ®µ 2: æäº¤å‰æ£€æŸ¥ (æ ¼å¼å…œåº• + æ ¸å¿ƒæ£€æŸ¥)

**ç›®æ ‡**: ç¡®ä¿æäº¤çš„ä»£ç ç¬¦åˆå›¢é˜Ÿæ ‡å‡†

**å·¥å…·**: Pre-commit Hooks (è‡ªåŠ¨è§¦å‘)

**è§¦å‘æ—¶æœº**: æ¯æ¬¡ `git commit` æ—¶è‡ªåŠ¨è¿è¡Œ

**æ‰§è¡Œé¡ºåº** (9 ä¸ªæ­¥éª¤):
1. **Ruff (Lint & Fix)** - å¿«é€Ÿä¿®å¤é”™è¯¯å‹é—®é¢˜
2. **Black (Formatter)** - ç»Ÿä¸€ä»£ç é£æ ¼ï¼ˆ1-2ç§’ï¼‰
3. **Ruff (Check only)** - äºŒæ¬¡æ ¡éªŒï¼Œç¡®ä¿æ— æ–°é—®é¢˜
4. **MyPy** - ç±»å‹æ£€æŸ¥
5. **Bandit** - å®‰å…¨æ‰«æ
6. **Safety** - ä¾èµ–å®‰å…¨æ£€æŸ¥
7. **é€šç”¨æ–‡ä»¶æ£€æŸ¥** - å°¾éšç©ºæ ¼ã€YAML/JSON è¯­æ³•ç­‰
8. **å¯†é’¥æ£€æµ‹** - é˜²æ­¢æäº¤æ•æ„Ÿä¿¡æ¯
9. **Python è¯­æ³•æ£€æŸ¥** - æ£€æŸ¥ blanket noqa/eval ç­‰

**ä½¿ç”¨æ–¹æ³•**:
```bash
# é¦–æ¬¡å®‰è£…
pip install pre-commit
pre-commit install

# æ‰‹åŠ¨è¿è¡Œæ‰€æœ‰æ£€æŸ¥
pre-commit run --all-files

# è¿è¡Œç‰¹å®š hook
pre-commit run ruff --all-files
pre-commit run black --all-files
```

**é…ç½®ç‰¹ç‚¹**:
- âœ… **æ–‡ä»¶èŒƒå›´é™åˆ¶**: ä»…æ£€æŸ¥ `src/` å’Œ `tests/` ç›®å½•
- âœ… **ç»Ÿä¸€è¡Œé•¿åº¦**: Black å’Œ Ruff éƒ½ä½¿ç”¨ 120
- âœ… **è‡ªåŠ¨ä¿®å¤**: Ruff å’Œ Black æ”¯æŒè‡ªåŠ¨ä¿®å¤
- âœ… **å¿«é€Ÿå¤±è´¥**: é”™è¯¯ç›´æ¥é˜»æ–­æäº¤

---

### é˜¶æ®µ 3: å®šæœŸæ·±åº¦è´¨é‡åˆ†æ (Pylint æ ¸å¿ƒä»·å€¼)

**ç›®æ ‡**: å‘ç°ä»£ç è´¨é‡æ·±å±‚æ¬¡é—®é¢˜

**å·¥å…·**: Pylint (æµ‹è¯•ä»£ç ä¸“ç”¨é…ç½®)

**è§¦å‘æ—¶æœº**: æ¯å‘¨ / æ¯è¿­ä»£æœ«

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ£€æŸ¥æµ‹è¯•ä»£ç è´¨é‡
pylint --rcfile=.pylint.test.rc tests/

# ç”Ÿæˆ HTML æŠ¥å‘Š
pylint --rcfile=.pylint.test.rc --output=pylint_test_report.html --output-format=html tests/

# æ£€æŸ¥æºä»£ç ï¼ˆä½¿ç”¨é»˜è®¤ .pylintrcï¼‰
pylint src/
```

**é…ç½®ç‰¹ç‚¹**:
- âœ… **æµ‹è¯•ä¸“ç”¨è§„åˆ™**: åªå…³æ³¨æµ‹è¯•æ ¸å¿ƒé—®é¢˜
- âœ… **ç¦ç”¨æ‰€æœ‰ï¼Œå¯ç”¨æ ¸å¿ƒ**: `disable = all` + `enable = [...]`
- âœ… **æ›´å®½æ¾çš„é˜ˆå€¼**: max-args=15, max-locals=25, max-statements=100
- âœ… **pytest ä¸“å±è§„åˆ™**: PT001-PT025 (éœ€è¦ pylint-pytest æ’ä»¶)

**ä¸»è¦å¯ç”¨è§„åˆ™**:
1. **åŸºç¡€è¯­æ³•é”™è¯¯** (ç¼©è¿›ã€æœªå®šä¹‰å˜é‡)
2. **æµ‹è¯•ä»£ç è´¨é‡** (æœªç”¨å¯¼å…¥ã€å˜é‡è¿‡å¤šã€ç±»æ–¹æ³•è¿‡å°‘)
3. **pytest ä¸“å±è§„åˆ™** (fixture ä½¿ç”¨ã€å‡½æ•°å‘½åã€æ–­è¨€æ–¹å¼)
4. **ä»£ç è´¨é‡è­¦å‘Š** (æœªä½¿ç”¨å˜é‡/å‚æ•°ã€å¤æ‚åº¦è¿‡é«˜)

**è¾“å‡ºåˆ†æ**:
- ğŸ“Š **HTML æŠ¥å‘Š**: å¯è§†åŒ–æŸ¥çœ‹æ‰€æœ‰é—®é¢˜
- ğŸ¯ **é‡ç‚¹å…³æ³¨**:
  - æµ‹è¯•ç”¨ä¾‹æ— æ–­è¨€
  - æµ‹è¯•ä»£ç åœˆå¤æ‚åº¦é«˜
  - å‡½æ•°å˜é‡è¿‡å¤šï¼ˆ>25ï¼‰
  - å‡½æ•°è¯­å¥è¿‡å¤šï¼ˆ>100ï¼‰

---

### é˜¶æ®µ 4: CI/CD é›†æˆ (å¿«é€Ÿå¤±è´¥ + å®Œæ•´æ£€æŸ¥)

**ç›®æ ‡**: ä¿è¯ CI æµæ°´çº¿æ•ˆç‡

**å·¥å…·é¡ºåº**: Ruff+Black â†’ MyPy+Bandit+Safety â†’ Pylint (ä»…è®°å½•)

**CI é…ç½®å»ºè®®**:
```yaml
# .github/workflows/ci.yml
jobs:
  quality-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      # ç¬¬ä¸€é˜¶æ®µï¼šå¿«é€Ÿå¤±è´¥
      - name: Run Ruff
        run: ruff check . --output-format=github

      - name: Run Black
        run: black --check .

      # ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒæ£€æŸ¥
      - name: Run MyPy
        run: mypy src/

      - name: Run Bandit
        run: bandit -r src/

      - name: Run Safety
        run: safety check --json

      # ç¬¬ä¸‰é˜¶æ®µï¼šæ·±åº¦åˆ†æï¼ˆä¸é˜»æ–­æ„å»ºï¼‰
      - name: Run Pylint (Tests)
        run: pylint --rcfile=.pylint.test.rc tests/ || true
        continue-on-error: true
```

**å…³é”®ç­–ç•¥**:
- âœ… **å¿«é€Ÿå¤±è´¥**: Ruff/Black é—®é¢˜ç›´æ¥å¤±è´¥
- âœ… **æ ¸å¿ƒæ£€æŸ¥**: MyPy/Bandit/Safety é—®é¢˜å¿…é¡»ä¿®å¤
- âœ… **è®°å½•æŠ¥å‘Š**: Pylint ä»…ç”ŸæˆæŠ¥å‘Šï¼Œä¸é˜»æ–­æ„å»º

---

## ğŸ› ï¸ å·¥å…·é…ç½®æ€»ç»“

### 1. Ruff (æ—¥å¸¸å¼€å‘)

**é…ç½®ä½ç½®**: `pyproject.toml`

**å…³é”®é…ç½®**:
```toml
[tool.ruff]
line-length = 120
target-version = "py39"

[tool.ruff.lint]
select = ["E", "W", "F", "IND", "PT", "I"]
ignore = ["E501", "I001", "PT011", "PT012", "PT015", "S101", "C901"]
fix = true

[tool.ruff.lint.per-file-ignores]
"tests/**/*.py" = ["S101", "ARG001", "ARG002"]
```

**å¸¸ç”¨å‘½ä»¤**:
```bash
# ä¿®å¤æ‰€æœ‰é—®é¢˜
ruff check --fix .

# æ ¼å¼åŒ–ä»£ç 
ruff format .

# æ£€æŸ¥ä½†ä¸ä¿®å¤
ruff check .
```

---

### 2. Black (æ ¼å¼åŒ–å…œåº•)

**é…ç½®ä½ç½®**: `pyproject.toml`

**å…³é”®é…ç½®**:
```toml
[tool.black]
line-length = 120
target-version = ['py39']
```

**å¸¸ç”¨å‘½ä»¤**:
```bash
# æ ¼å¼åŒ–ä»£ç 
black .

# æ£€æŸ¥æ ¼å¼ï¼ˆä¸ä¿®æ”¹ï¼‰
black --check .
```

---

### 3. Pylint (æ·±åº¦åˆ†æ)

**é…ç½®æ–‡ä»¶**:
- `.pylintrc` - å¸¸è§„ä»£ç æ£€æŸ¥
- `.pylint.test.rc` - æµ‹è¯•ä»£ç æ£€æŸ¥ï¼ˆæ¯å‘¨/æ¯è¿­ä»£æœ«ï¼‰

**æµ‹è¯•ä¸“ç”¨é…ç½®**:
```ini
[MESSAGES CONTROL]
disable = all
enable =
    bad-indentation, E0602, E0601,  # åŸºç¡€è¯­æ³•é”™è¯¯
    W0611, R0914, R0903,             # æµ‹è¯•ä»£ç è´¨é‡
    PT001, PT002, ..., PT025,        # pytest ä¸“å±è§„åˆ™
    W0612, W0613, R0913, R0915,     # å¤æ‚åº¦æ£€æŸ¥
    C0304, C0305, C0321,             # ä»£ç æ ¼å¼

[DESIGN]
max-args = 15
max-locals = 25
max-returns = 10
max-branches = 20
max-statements = 100
```

**å¸¸ç”¨å‘½ä»¤**:
```bash
# æ£€æŸ¥æµ‹è¯•ä»£ç 
pylint --rcfile=.pylint.test.rc tests/

# ç”Ÿæˆ HTML æŠ¥å‘Š
pylint --rcfile=.pylint.test.rc --output=pylint_test_report.html --output-format=html tests/

# æ£€æŸ¥æºä»£ç 
pylint src/
```

---

### 4. Pre-commit Hooks (è‡ªåŠ¨æ£€æŸ¥)

**é…ç½®ä½ç½®**: `.pre-commit-config.yaml`

**æ‰§è¡Œé¡ºåº**:
1. Ruff (Lint & Fix)
2. Black (Formatter)
3. Ruff (Check only)
4. MyPy (Type Check)
5. Bandit (Security Scan)
6. Safety (Dependency Check)
7. é€šç”¨æ–‡ä»¶æ£€æŸ¥
8. å¯†é’¥æ£€æµ‹
9. Python è¯­æ³•æ£€æŸ¥

**å¸¸ç”¨å‘½ä»¤**:
```bash
# é¦–æ¬¡å®‰è£…
pre-commit install

# æ‰‹åŠ¨è¿è¡Œæ‰€æœ‰
pre-commit run --all-files

# æ›´æ–° hooks
pre-commit autoupdate
```

---

### 5. å®‰å…¨å·¥å…· (ä¸å¯æ›¿ä»£)

**Bandit** - ä»£ç å®‰å…¨æ‰«æ
**Safety** - ä¾èµ–å®‰å…¨æ£€æŸ¥

**é…ç½®ä½ç½®**: `config/.security.yml`

**å¸¸ç”¨å‘½ä»¤**:
```bash
# Bandit å®‰å…¨æ‰«æ
bandit -r src/ -c config/.security.yml

# Safety ä¾èµ–æ£€æŸ¥
safety check --json
```

---

## ğŸ¯ é¿å‘æŒ‡å—

### 1. æ ¼å¼åŒ–å†²çª

**é—®é¢˜**: Ruff å’Œ Black åŒæ—¶æ ¼å¼åŒ–å¯¼è‡´å†²çª

**è§£å†³æ–¹æ¡ˆ**:
- âœ… **ç»Ÿä¸€è¡Œé•¿åº¦**: Ruff å’Œ Black éƒ½è®¾ç½®ä¸º 120
- âœ… **ç¦ç”¨å†²çªè§„åˆ™**: Ruff ä¸­ç¦ç”¨ `E501` (è¡Œé•¿åº¦)
- âœ… **æ‰§è¡Œé¡ºåº**: Ruff â†’ Black â†’ Ruff (äºŒæ¬¡æ ¡éªŒ)

### 2. æµ‹è¯•ä»£ç å®¹é”™

**é—®é¢˜**: æµ‹è¯•ä»£ç ä¸­çš„åˆç†æ¨¡å¼è¢«è¯¯æŠ¥

**è§£å†³æ–¹æ¡ˆ**:
- âœ… **æµ‹è¯•æ–‡ä»¶è±å…**:
  ```toml
  [tool.ruff.lint.per-file-ignores]
  "tests/**/*.py" = ["S101", "ARG001", "ARG002"]
  ```
- âœ… **ç¦ç”¨è¿‡äºä¸¥æ ¼çš„è§„åˆ™**: `PT011`, `PT012`, `PT015`

### 3. Pylint æ€§èƒ½

**é—®é¢˜**: Pylint æ£€æŸ¥å¤ªæ…¢ï¼Œå½±å“æ—¥å¸¸å¼€å‘

**è§£å†³æ–¹æ¡ˆ**:
- âœ… **å®šæœŸè¿è¡Œ**: ä»…æ¯å‘¨/æ¯è¿­ä»£æœ«è¿è¡Œ
- âœ… **é™åˆ¶èŒƒå›´**: ä»…æ£€æŸ¥ `tests/` ç›®å½•
- âœ… **ç²¾ç®€è§„åˆ™**: åªå¯ç”¨æ ¸å¿ƒè§„åˆ™ï¼Œç¦ç”¨æ‰€æœ‰å…¶ä»–è§„åˆ™

### 4. CI æµæ°´çº¿æ•ˆç‡

**é—®é¢˜**: æ‰€æœ‰å·¥å…·éƒ½è¿è¡Œå¯¼è‡´ CI å¤ªæ…¢

**è§£å†³æ–¹æ¡ˆ**:
- âœ… **å¿«é€Ÿå¤±è´¥**: Ruff/Black é—®é¢˜ç›´æ¥å¤±è´¥
- âœ… **è®°å½•æŠ¥å‘Š**: Pylint ä»…ç”ŸæˆæŠ¥å‘Šï¼Œä¸é˜»æ–­æ„å»º
- âœ… **å¹¶è¡Œæ‰§è¡Œ**: ç‹¬ç«‹çš„å·¥å…·å¯ä»¥å¹¶è¡Œè¿è¡Œ

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### æ—¥å¸¸å¼€å‘ (æ¯æ¬¡ä¿å­˜)
- [ ] è¿è¡Œ `ruff check --fix .`
- [ ] è¿è¡Œ `ruff format .`

### æäº¤å‰ (æ¯æ¬¡ commit)
- [ ] Pre-commit hooks è‡ªåŠ¨è¿è¡Œ
- [ ] ä¿®å¤æ‰€æœ‰è¢«é˜»æ–­çš„é—®é¢˜

### æ¯å‘¨/æ¯è¿­ä»£æœ«
- [ ] è¿è¡Œ `pylint --rcfile=.pylint.test.rc tests/`
- [ ] æŸ¥çœ‹ç”Ÿæˆçš„ HTML æŠ¥å‘Š
- [ ] ä¿®å¤é«˜ä¼˜å…ˆçº§é—®é¢˜

### CI/CD
- [ ] Ruff + Black å¿«é€Ÿå¤±è´¥
- [ ] MyPy + Bandit + Safety æ ¸å¿ƒæ£€æŸ¥
- [ ] Pylint ç”ŸæˆæŠ¥å‘Šï¼ˆä¸é˜»æ–­ï¼‰

---

## ğŸ”§ å®‰è£…å’Œè®¾ç½®

### é¦–æ¬¡è®¾ç½®

```bash
# 1. å®‰è£…å¼€å‘ä¾èµ–
pip install -e ".[dev]"

# 2. å®‰è£… pre-commit hooks
pre-commit install

# 3. å®‰è£… pylint-pytest æ’ä»¶ï¼ˆå¯é€‰ï¼Œç”¨äºæµ‹è¯•ä»£ç æ£€æŸ¥ï¼‰
pip install pylint-pytest

# 4. éªŒè¯å®‰è£…
ruff --version
black --version
pylint --version
mypy --version
bandit --version
safety --version
```

### æ›´æ–°å·¥å…·

```bash
# æ›´æ–° pre-commit hooks
pre-commit autoupdate

# æ›´æ–° Python å·¥å…·
pip install -U ruff black pylint mypy bandit safety
```

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Ruff æ–‡æ¡£](https://docs.astral.sh/ruff/)
- [Black æ–‡æ¡£](https://black.readthedocs.io/)
- [Pylint æ–‡æ¡£](https://pylint.pycqa.org/)
- [MyPy æ–‡æ¡£](https://mypy.readthedocs.io/)
- [Bandit æ–‡æ¡£](https://bandit.readthedocs.io/)
- [Safety æ–‡æ¡£](https://github.com/pyupio/safety)
- [Pre-commit æ–‡æ¡£](https://pre-commit.com/)

---

## ğŸ‰ æ€»ç»“

é€šè¿‡è¿™å››ä¸ªé˜¶æ®µçš„æµç¨‹ï¼Œæˆ‘ä»¬å®ç°äº†ï¼š

1. **æ—¥å¸¸å¼€å‘** - Ruff å¿«é€Ÿä¿®å¤ï¼Œä¸å½±å“å¼€å‘æ•ˆç‡
2. **æäº¤å‰** - Pre-commit è‡ªåŠ¨æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç è´¨é‡
3. **å®šæœŸåˆ†æ** - Pylint æ·±åº¦å®¡æŸ¥ï¼Œå‘ç°æ½œåœ¨é—®é¢˜
4. **CI/CD** - å¿«é€Ÿå¤±è´¥ + å®Œæ•´æ£€æŸ¥ï¼Œä¿è¯æµæ°´çº¿æ•ˆç‡

**æ ¸å¿ƒåŸåˆ™**: **æ•ˆç‡ä¼˜å…ˆ + è´¨é‡ä¿è¯ + å®‰å…¨é˜²çº¿**
