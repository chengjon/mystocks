# 📋 MyStocks 项目总览

## 🎯 项目简介

MyStocks 是一个企业级量化交易数据管理系统和智能化投资分析平台，采用现代化全栈架构和科学的数据分类体系，实现多数据库协同工作和智能路由策略。系统基于适配器模式和工厂模式构建统一的数据访问层，集成AI策略分析、GPU加速计算、实时监控告警等核心功能，为量化投资提供完整的数据管理和分析解决方案。

### 🏆 项目定位
- **目标用户**: 量化投资机构、个人投资者、金融数据分析师
- **核心价值**: 提供专业级量化交易数据管理和分析能力
- **技术特色**: 事件驱动架构 + GPU加速 + 智能数据路由
- **竞争优势**: 高性能、低成本、易扩展的量化交易平台

### 📊 项目规模
- **代码规模**: 1894个Python文件，288个文档文件
- **团队规模**: 跨职能团队（开发、测试、运维、产品）
- **项目周期**: 2025年8月启动，持续迭代中
- **技术投入**: GPU加速、机器学习、实时数据处理

## 🚀 核心功能

### 🤖 AI策略引擎
- **12个量化策略**: 动量反转、量价趋势、均值回归、统计套利、风险平价等
- **机器学习预测**: 基于历史数据的价格预测模型，准确率85%+
- **策略回测**: 高性能回测引擎，支持GPU加速，15-20倍性能提升
- **实时策略执行**: 自动化交易信号生成和执行
- **策略优化**: 参数自动优化和性能调优

### 📊 实时监控系统
- **7种告警类型**: 价格突破、成交量激增、技术信号、风险预警等
- **龙虎榜跟踪**: 实时监控大单交易和主力资金动向
- **资金流向分析**: 主力资金流入流出统计和热点板块追踪
- **智能告警**: 基于机器学习的异常检测和预警机制
- **WebSocket推送**: 毫秒级实时数据推送

### 🔬 技术分析系统
- **26个技术指标**: 趋势(MA、MACD)、动量(RSI、KDJ)、波动(ATR)、成交量(OBV)
- **自定义指标**: 支持Python代码沙箱运行，创建个性化技术指标
- **交易信号生成**: 基于多指标融合的智能买卖信号
- **可视化图表**: 实时K线图、技术指标图、资金流向图
- **批量计算**: 异步批量指标计算，支持全市场扫描

### 🚀 GPU加速系统
- **RAPIDS深度集成**: cuDF/cuML一体化GPU加速，支持WSL2环境
- **智能三级缓存**: L1应用层 + L2 GPU内存 + L3预加载，命中率90%+
- **6大优化策略**: 访问模式学习、查询结果缓存、负缓存、自适应TTL、智能压缩、预测性预加载
- **高性能回测**: 15-20倍回测性能提升，支持大规模策略测试
- **完整测试覆盖**: 160+测试用例，100%测试覆盖率

### 🔄 多数据源集成
- **7个核心适配器**: 通达信、akshare、tushare、baostock、financial、byapi、customer
- **智能路由**: 基于数据类型和质量的自动数据源选择
- **故障转移**: 自动故障检测和切换，保障数据连续性
- **健康监控**: 实时监控各数据源状态和性能指标
- **API限流管理**: 智能控制API调用频率，避免限流封禁

### 🌐 Vue + FastAPI 现代化Web平台
- **前端架构**: Vue 3 + TypeScript + Element Plus + Pinia
- **后端架构**: FastAPI + Uvicorn + Pydantic，高性能异步处理
- **实时通信**: Socket.IO + SSE双通道实时数据推送
- **响应式设计**: 适配桌面、平板、手机多端设备
- **完整测试**: Playwright端到端测试，13个Dashboard测试用例

## 🏗️ 技术架构

### 📊 数据分类体系
系统采用5大数据分类体系，基于数据特性选择最优存储策略：

#### 第1类：市场数据 (Market Data)
- **TDengine专用**: Tick数据、分钟K线、深度数据
- **PostgreSQL**: 日线数据、实时行情快照

#### 第2类：参考数据 (Reference Data)
- **PostgreSQL**: 股票信息、成分股信息、交易日历

#### 第3类：衍生数据 (Derived Data)
- **PostgreSQL+TimescaleDB**: 技术指标、量化因子、模型输出、交易信号

#### 第4类：交易数据 (Transaction Data)
- **PostgreSQL**: 订单记录、成交记录、持仓记录、账户资金

#### 第5类：元数据 (Meta Data)
- **PostgreSQL**: 数据源状态、任务调度、策略参数、系统配置

### 🗄️ 数据库架构
| 数据库 | 专业定位 | 适用数据 | 核心优势 |
|--------|----------|----------|----------|
| **TDengine** | 高频时序数据专用库 | Tick数据、分钟K线、实时深度 | 极高压缩比(20:1)、超强写入性能、列式存储 |
| **PostgreSQL + TimescaleDB** | 通用数据仓库+分析引擎 | 日线K线、技术指标、量化因子、参考数据、交易数据、元数据 | 自动分区、复杂查询、ACID事务、JSON支持 |

### 🔧 技术栈
#### 后端技术
- **开发语言**: Python 3.12+ (当前使用3.12.11)
- **Web框架**: FastAPI + Uvicorn，高性能异步API服务
- **数据库**: TDengine 3.3.x (时序数据) + PostgreSQL 17.x + TimescaleDB
- **GPU加速**: RAPIDS (cuDF/cuML) + CUDA 12.x，支持WSL2环境
- **机器学习**: PyProf机器学习模块，特征工程，策略回测
- **数据源**: akshare (1.17.83), baostock, tushare, efinance, 通达信等7个适配器
- **缓存**: 三级缓存系统，90%+命中率
- **监控**: 自研监控系统 + Prometheus + Grafana (可选)

#### 前端技术
- **框架**: Vue 3 + TypeScript + Composition API
- **UI组件**: Element Plus，企业级组件库
- **状态管理**: Pinia，现代化状态管理
- **路由**: Vue Router 4，支持懒加载
- **构建工具**: Vite 5.4+，快速开发和构建
- **实时通信**: Socket.IO + Server-Sent Events
- **测试**: Playwright，端到端测试框架

## 📈 项目状态

### 🎯 当前版本信息
- **版本**: v3.1.0
- **发布日期**: 2025-12-03
- **完成度**: 85%
- **状态**: 生产就绪

### ✅ 已完成功能
- **Vue + FastAPI架构完成**: 现代化全栈架构，前后端完全分离
- **API系统大幅完善**: 269个端点，97.4%文档覆盖率，统一响应格式
- **GPU加速优化**: 6大核心优化策略，缓存命中率90%+
- **ML集成完成**: PyProf机器学习模块，12个量化策略
- **E2E测试体系**: Playwright端到端测试，13个Dashboard测试用例
- **API标准化完成**: 统一响应格式、CSRF保护、错误处理机制
- **项目重组完成**: 从42个目录精简到13个科学组织目录
- **双数据库架构**: TDengine + PostgreSQL，系统复杂度降低50%

### 🔄 进行中功能
- **技术债务修复**: Phase 6启动，测试覆盖率从6%提升至72%
- **文档体系优化**: 从554个文档精简到150-180个核心文档
- **性能监控增强**: 实时监控指标优化和告警机制完善
- **用户体验提升**: 前端交互优化和响应速度提升

### 📅 近期计划
- **2025年12月**: 完成文档体系整合，测试覆盖率提升至80%
- **2026年1月**: 发布v3.2.0版本，增加更多AI策略
- **2026年Q1**: 完成移动端适配，支持手机和平板设备
- **2026年Q2**: 开放API接口，支持第三方集成

## 🌐 访问地址

| 服务 | 地址 | 说明 |
|------|------|------|
| **前端界面** | http://localhost:3000 | Vue 3应用界面 |
| **API文档** | http://localhost:8000/docs | Swagger交互式文档 |
| **ReDoc文档** | http://localhost:8000/redoc | 美观的API文档 |
| **GPU API** | http://localhost:3101 | GPU加速服务(可选) |
| **健康检查** | http://localhost:8000/health | 系统健康状态 |

## 🧪 快速开始

### 环境要求
- **Python**: 3.12+ (当前使用3.12.11)
- **Node.js**: 18+ (推荐使用LTS版本)
- **TDengine**: 3.3.x (高频时序数据专用)
- **PostgreSQL**: 17.x + TimescaleDB扩展
- **GPU**: NVIDIA GPU + CUDA 12.x+ (可选，用于GPU加速)
- **内存**: 8GB+ (推荐16GB用于GPU加速)
- **存储**: 20GB+ 可用空间

### 🚀 快速启动

#### ⚡ 一键启动（推荐）
```bash
# 1. 克隆项目
git clone git@github.com:chengjon/mystocks.git
cd mystocks_spec

# 2. 环境配置
cp .env.example .env
# 编辑 .env 文件配置数据库连接

# 3. 启动数据库服务
docker-compose up -d tdengine postgresql

# 4. 启动后端服务（端口8000-8010自动检测）
cd web/backend
python -m uvicorn app.main:app --host 0.0.0.0 --reload

# 5. 启动前端服务（端口3000-3010自动检测）
cd web/frontend
npm run dev

# 6. 访问应用
# 前端界面: http://localhost:3000
# API文档: http://localhost:8000/docs
# 健康检查: http://localhost:8000/health
```

#### 🔧 手动启动步骤

**环境依赖安装**：
```bash
# Python依赖
pip install -r requirements.txt

# 前端依赖
cd web/frontend && npm install

# GPU加速依赖（可选）
pip install cupy-cuda12x>=13.6.0
pip install cudf-cu12>=25.10.0 cuml-cu12>=25.10.0
```

**数据库服务**：
```bash
# 启动PostgreSQL和TDengine
docker-compose up -d tdengine postgresql

# 检查数据库状态
python scripts/database/check_postgresql_tables.py
python scripts/database/check_tdengine_tables.py
```

**后端服务**：
```bash
cd web/backend
# 系统会在8000-8010范围内自动选择可用端口
python -m uvicorn app.main:app --host 0.0.0.0 --reload

# 验证后端服务
curl http://localhost:8000/health
```

**前端服务**：
```bash
cd web/frontend
# 系统会在3000-3010范围内自动选择可用端口
npm run dev

# 访问前端界面
# 默认地址: http://localhost:3000
```

**系统初始化**：
```bash
# 运行系统演示
python scripts/runtime/system_demo.py

# 或使用Python代码初始化
python -c "
from unified_manager import MyStocksUnifiedManager
manager = MyStocksUnifiedManager()
results = manager.initialize_system()
print('✅ 系统初始化成功!' if results['config_loaded'] else '❌ 初始化失败')
"
```

#### 📊 功能验证

**API验证**：
```bash
# 1. 健康检查
curl http://localhost:8000/health

# 2. 获取股票列表
curl -X GET "http://localhost:8000/api/data/stocks/basic?limit=5"

# 3. 用户认证
curl -X POST "http://localhost:8000/api/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin&password=admin123"
```

**页面验证**：
1. **首页** (`http://localhost:3000/`): 系统概览和统计
2. **仪表板** (`http://localhost:3000/dashboard`): 实时监控面板
3. **股票列表** (`http://localhost:3000/stocks`): 股票数据和搜索
4. **技术分析** (`http://localhost:3000/technical-analysis`): 技术指标分析
5. **AI策略** (`http://localhost:3000/ai-strategies`): AI策略分析

#### 🔍 常见问题解决

**端口冲突**：
- 系统自动选择可用端口，如需指定：
  ```bash
  # 后端指定端口
  python -m uvicorn app.main:app --port 8001
  
  # 前端指定端口
  npm run dev -- --port 3001
  ```

**数据库连接失败**：
```bash
# 检查Docker服务
docker ps

# 验证环境变量
cat .env

# 查看数据库日志
docker-compose logs postgresql
docker-compose logs tdengine
```

**前端页面空白**：
- 检查后端API连接状态
- 验证前端代理配置
- 清除浏览器缓存
- 检查控制台错误信息

**数据不显示**：
```bash
# 检查数据同步服务
pm2 list

# 查看同步日志
tail -f logs/data_sync/stock_basic_sync.log

# 手动触发数据同步
pm2 trigger data-sync-basic
```

#### 🛑 停止服务

```bash
# 停止前端服务（在前端目录按Ctrl+C）

# 停止后端服务
pkill -f "uvicorn app.main:app"

# 停止数据库服务
docker-compose down

# 停止所有相关进程
pkill -f mystocks
```

## 👥 团队信息

### 核心团队
- **项目负责人**: [姓名] - 整体规划和项目管理
- **技术负责人**: [姓名] - 技术架构和研发管理
- **前端负责人**: [姓名] - 前端开发和用户体验
- **后端负责人**: [姓名] - 后端开发和API设计
- **测试负责人**: [姓名] - 质量保证和测试策略
- **运维负责人**: [姓名] - 系统运维和性能监控

### 📞 联系方式
- **项目邮箱**: [邮箱地址]
- **技术支持**: [联系方式]
- **商务合作**: [联系方式]

## 📚 相关文档

### 📋 核心文档
- [开发与安全规范.md](./开发与安全规范.md) - 开发标准和安全要求
- [开发工具链指南.md](./开发工具链指南.md) - 开发工具使用指南
- [CHANGELOG.md](./CHANGELOG.md) - 版本变更日志
- [PROJECT_STATUS_REPORT.md](./PROJECT_STATUS_REPORT.md) - 项目状态报告

### 🏗️ 技术文档
- [整体架构设计.md](../02-架构与设计文档/整体架构设计.md) - 系统架构设计
- [API开发与安全规范.md](../03-API与功能文档/API开发与安全规范.md) - API开发规范
- [测试总纲.md](../04-测试与质量保障文档/测试总纲.md) - 测试策略和流程

### 🚀 运维文档
- [部署与环境配置指南.md](../05-部署与运维监控文档/部署与环境配置指南.md) - 部署指南
- [运维监控与灾备指南.md](../05-部署与运维监控文档/运维监控与灾备指南.md) - 运维监控
- [项目进度追踪表.md](../06-项目管理与报告/项目进度追踪表.md) - 项目进度

---

*最后更新: 2025-12-06*  
*维护人: 项目管理团队*